{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/views/3d/layers/AnalysisLayerView3D.js"],"names":["m","w","e","super","this","type","allAnalysisViews","_creatingViewCount","_analysisViewCreationTasks","Map","_analysisModules","module","slice","layer","analyses","_createAnalysisView","handles","add","on","item","s","removeAt","findIndex","analysis","destroy","i","get","abort","delete","remove","drain","clear","promise","t","Promise","reject","some","updating","set","_createAnalysisViewPromise","a","r","_loadAnalysisModule","o","default","view","parent","when","prototype","d"],"mappings":"gHAAA,2KAI6hB,MAAMA,EAAE,wBAAwB,IAAIC,EAAE,cAAc,cAAD,CAAG,SAAI,YAAYC,GAAGC,MAAMD,GAAGE,KAAKC,KAAK,cAAcD,KAAKE,iBAAiB,IAAI,OAAEF,KAAKG,mBAAmB,EAAEH,KAAKI,2BAA2B,IAAIC,IAAIL,KAAKM,iBAAiB,CAAC,mBAAmB,CAACC,OAAO,MAAM,0BAA0B,CAACA,OAAO,MAAM,gBAAgB,CAACA,OAAO,MAAMC,MAAM,CAACD,OAAO,OAAO,aAAa,IAAI,MAAMT,KAAKE,KAAKS,MAAMC,SAASV,KAAKW,oBAAoBb,GAAGE,KAAKY,QAAQC,IAAI,CAACb,KAAKS,MAAMC,SAASI,GAAG,YAAahB,IAAIE,KAAKW,oBAAoBb,EAAEiB,QAASf,KAAKS,MAAMC,SAASI,GAAG,eAAgBhB,IAAI,MAAMkB,EAAEhB,KAAKE,iBAAiBe,SAASjB,KAAKE,iBAAiBgB,UAAWF,GAAGA,EAAEG,WAAWrB,EAAEiB,OAAQ,eAAEC,IAAIA,EAAEI,UAAU,MAAMC,EAAErB,KAAKI,2BAA2BkB,IAAIxB,EAAEiB,MAAM,eAAEM,KAAKA,EAAEE,QAAQvB,KAAKI,2BAA2BoB,OAAO1B,EAAEiB,UAAWnB,GAAG,UAAUI,KAAKY,QAAQa,OAAO7B,GAAGI,KAAKE,iBAAiBwB,MAAO5B,GAAGA,EAAEsB,WAAYpB,KAAKI,2BAA2BuB,QAAQ3B,KAAKG,mBAAmB,EAAE,iBAAiBL,GAAG,MAAMkB,EAAEhB,KAAKI,2BAA2BkB,IAAIxB,GAAG,GAAG,eAAEkB,GAAG,OAAOA,EAAEY,QAAQ,MAAMC,EAAE,IAAI,OAAE,yCAAyC,0EAA0E,CAACV,SAASrB,IAAI,OAAOgC,QAAQC,OAAOF,GAAG,aAAa,OAAO,IAAI7B,KAAKG,oBAAoBH,KAAKE,iBAAiB8B,KAAMlC,GAAGA,EAAEmC,UAAW,oBAAoBnC,GAAGE,KAAKI,2BAA2B8B,IAAIpC,EAAE,eAAGkB,GAAGhB,KAAKmC,2BAA2BrC,EAAEkB,KAAM,iCAAiClB,EAAEkB,GAAGhB,KAAKG,oBAAoB,EAAE,MAAMiC,EAAEtC,EAAEG,KAAKoC,EAAErC,KAAKM,iBAAiB8B,GAAG,GAAG,eAAEC,EAAE9B,QAAQ,CAAC,MAAMT,QAAQE,KAAKsC,oBAAoBF,GAAGC,EAAE9B,OAAOT,EAAE,MAAMyC,EAAE,IAAIF,EAAE9B,OAAOiC,QAAQ,CAACrB,SAASrB,EAAE2C,KAAKzC,KAAKyC,KAAKC,OAAO1C,OAAO,SAASuC,EAAEI,OAAO3C,KAAKG,oBAAoB,EAAE,eAAEa,GAAG,MAAMuB,EAAEnB,UAAU,IAAI,OAAE,yCAAyC,0EAA0E,CAACD,SAASrB,IAAI,OAAOE,KAAKE,iBAAiBW,IAAI0B,GAAGA,EAAE,oBAAoBzC,GAAG,OAAOA,GAAG,IAAI,mBAAmB,OAAO,qFAA+D,IAAI,0BAA0B,OAAO,qFAA2E,IAAI,gBAAgB,OAAO,gDAAuD,IAAI,QAAQ,OAAO,gDAA2C,QAAQ,OAAO,QAAQ,eAAE,CAAC,kBAAKD,EAAE+C,UAAU,YAAO,GAAQ,eAAE,CAAC,kBAAK/C,EAAE+C,UAAU,aAAQ,GAAQ,eAAE,CAAC,kBAAK/C,EAAE+C,UAAU,wBAAmB,GAAQ,eAAE,CAAC,kBAAK/C,EAAE+C,UAAU,0BAAqB,GAAQ/C,EAAE,eAAE,CAAC,eAAE,6CAA6CA,GAAG,MAAMgD,EAAEhD","file":"js/chunk-2d217289.ec761c9b.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import s from\"../../../core/Collection.js\";import\"../../../core/has.js\";import i from\"../../../core/Error.js\";import{isSome as a,isNone as t}from\"../../../core/maybe.js\";import{createTask as r,isAborted as n}from\"../../../core/promiseUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as l}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as y}from\"./LayerView3D.js\";import c from\"../../layers/LayerView.js\";const m=\"analysis-view-handles\";let w=class extends(y(c)){constructor(e){super(e),this.type=\"analysis-3d\",this.allAnalysisViews=new s,this._creatingViewCount=0,this._analysisViewCreationTasks=new Map,this._analysisModules={\"area-measurement\":{module:null},\"direct-line-measurement\":{module:null},\"line-of-sight\":{module:null},slice:{module:null}}}initialize(){for(const e of this.layer.analyses)this._createAnalysisView(e);this.handles.add([this.layer.analyses.on(\"after-add\",(e=>{this._createAnalysisView(e.item)})),this.layer.analyses.on(\"after-remove\",(e=>{const s=this.allAnalysisViews.removeAt(this.allAnalysisViews.findIndex((s=>s.analysis===e.item)));a(s)&&s.destroy();const i=this._analysisViewCreationTasks.get(e.item);a(i)&&(i.abort(),this._analysisViewCreationTasks.delete(e.item))}))],m)}destroy(){this.handles.remove(m),this.allAnalysisViews.drain((e=>e.destroy())),this._analysisViewCreationTasks.clear(),this._creatingViewCount=0}whenAnalysisView(e){const s=this._analysisViewCreationTasks.get(e);if(a(s))return s.promise;const t=new i(\"layerview:no-analysisview-for-analysis\",\"The analysis has not been added to the AnalysisLayer of this layer view\",{analysis:e});return Promise.reject(t)}isUpdating(){return 0!==this._creatingViewCount||this.allAnalysisViews.some((e=>e.updating))}_createAnalysisView(e){this._analysisViewCreationTasks.set(e,r((s=>this._createAnalysisViewPromise(e,s))))}async _createAnalysisViewPromise(e,s){this._creatingViewCount+=1;const a=e.type,r=this._analysisModules[a];if(t(r.module)){const e=await this._loadAnalysisModule(a);r.module=e}const o=new r.module.default({analysis:e,view:this.view,parent:this});if(await o.when(),this._creatingViewCount-=1,n(s))throw o.destroy(),new i(\"layerview:no-analysisview-for-analysis\",\"The analysis has not been added to the AnalysisLayer of this layer view\",{analysis:e});return this.allAnalysisViews.add(o),o}_loadAnalysisModule(e){switch(e){case\"area-measurement\":return import(\"../analysis/AreaMeasurement/AreaMeasurementView3D.js\");case\"direct-line-measurement\":return import(\"../analysis/DirectLineMeasurement/DirectLineMeasurementView3D.js\");case\"line-of-sight\":return import(\"../analysis/LineOfSight/LineOfSightView3D.js\");case\"slice\":return import(\"../analysis/Slice/SliceView3D.js\");default:return null}}};e([o()],w.prototype,\"type\",void 0),e([o()],w.prototype,\"layer\",void 0),e([o()],w.prototype,\"allAnalysisViews\",void 0),e([o()],w.prototype,\"_creatingViewCount\",void 0),w=e([l(\"esri.views.3d.layers.AnalysisLayerView3D\")],w);const d=w;export{d as default};\n"],"sourceRoot":""}
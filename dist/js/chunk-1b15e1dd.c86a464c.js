(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b15e1dd"],{"19db":function(e,t,i){"use strict";i.d(t,"a",(function(){return y})),i.d(t,"b",(function(){return b})),i.d(t,"c",(function(){return T})),i.d(t,"d",(function(){return I})),i.d(t,"e",(function(){return u})),i.d(t,"f",(function(){return V})),i.d(t,"g",(function(){return m})),i.d(t,"h",(function(){return h})),i.d(t,"i",(function(){return f}));var s=i("fa8a"),r=i("b2b2"),a=i("3e27"),n=i("9dee");const o=new Map;o.set("meter-per-second",1),o.set("kilometer-per-hour",.277778),o.set("knots",.514444),o.set("feet-per-second",.3048),o.set("mile-per-hour",.44704);const l=180/Math.PI,c=5,h=new s["a"]({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function u(e,t){return o.get(e)/o.get(t)||1}function d(e){return(450-e)%360}function f(e,t="geographic"){const[i,s]=e,r=Math.sqrt(i*i+s*s);let a=Math.atan2(s,i)*l;return a=(360+a)%360,"geographic"===t&&(a=d(a)),[r,a]}function p(e,t="geographic"){let i=e[1];"geographic"===t&&(i=d(i)),i%=360;const s=e[0];return[s*Math.cos(i/l),s*Math.sin(i/l)]}function y(e,t,i="geographic",s=1){if(!Object(n["i"])(e))return e;const{pixels:r,width:o,height:l}=e,c=o*l,h=r[0],u=r[1],d=a["a"].createEmptyBand(e.pixelType,c),y=a["a"].createEmptyBand(e.pixelType,c);let b=0;for(let a=0;a<l;a++)for(let e=0;e<o;e++)"vector-uv"===t?([d[b],y[b]]=f([h[b],u[b]],i),d[b]*=s):([d[b],y[b]]=p([h[b],u[b]],i),d[b]*=s,y[b]*=s),b++;const m=new a["a"]({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[d,y]});return m.updateStatistics(),m}function b(e,t,i=1){if(1===i||!Object(n["i"])(e))return e;const s=e.clone(),{pixels:r,width:a,height:o}=s,l=r[0],c=r[1];let h=0;for(let n=0;n<o;n++)for(let e=0;e<a;e++)"vector-uv"===t?(l[h]*=i,c[h]*=i):l[h]*=i,h++;return s.updateStatistics(),s}function m(e,t,i,s,a){if(!Object(r["k"])(a)||!a.spatialReference.equals(e.spatialReference))return{extent:e,width:t,height:i,resolution:e.width/t};const n=a.xmin,o=a.ymax;s=Math.max(s||0,30);const l=Math.ceil(t*(1/s)),c=Math.ceil(i*(1/s)),h=((e.xmax-e.xmin)/l+(e.ymax-e.ymin)/c)/2;return e.xmin=n+Math.floor((e.xmin-n)/h)*h,e.xmax=n+Math.ceil((e.xmax-n)/h)*h,e.ymin=o+Math.floor((e.ymin-o)/h)*h,e.ymax=o+Math.ceil((e.ymax-o)/h)*h,{extent:e,width:Math.round(e.width/h),height:Math.round(e.height/h),resolution:h}}const g=w(0,0,0);function w(e=0,t=0,i=Math.PI,s=!0){s&&(i=(2*Math.PI-i)%(2*Math.PI));const r=s?-1:1,a=13*r,n=-7*r,o=-2*r,l=-16*r,c=29,[h,u]=v(0,t+a,i,c),[d,f]=v(e-5.5,t+n,i,c),[p,y]=v(e+5.5,t+n,i,c),[b,m]=v(e-1.5,t+o,i,c),[g,w]=v(e+1.5,t+o,i,c),[x,_]=v(e-1.5,t+l,i,c),[O,j]=v(e+1.5,t+l,i,c);return[h,u,d,f,b,m,g,w,p,y,x,_,O,j]}function x(e=0,t=Math.PI,i=!0){i&&(t=(2*Math.PI-t)%(2*Math.PI));const s=10,r=i?-1:1,a=5*r,n=20*r,o=25*r,l=45,h=0,u=0,d=2,f=0,p=d*r;let[y,b]=[h+s/2,u-n],[m,g]=[y+d,b],[w,x]=[m-f,g+p],[_,O]=[h-s/2,u-o],[j,R]=[_+f,O-p],P=Math.ceil(e/c),S=Math.floor(P/10);P-=8*S;const M=[],k=[];for(let c=0;c<P/2;c++,S--){S<=0&&P%2==1&&c===(P-1)/2&&(_=h,j=_+f,O=(O+b)/2,R=O-p);const[e,i]=v(_,O,t,l);if(S>0){const[s,r]=v(m,O,t,l),[a,n]=v(y,b,t,l);M.push(s),M.push(r),M.push(e),M.push(i),M.push(a),M.push(n)}else{const[s,r]=v(m,g,t,l),[a,n]=v(w,x,t,l),[o,c]=v(j,R,t,l);k.push(e),k.push(i),k.push(o),k.push(c),k.push(a),k.push(n),k.push(s),k.push(r)}O+=a,b+=a,g+=a,x+=a,R+=a}const[I,T]=v(h+s/2,u+n,t,l),V=s/2+d,[C,D]=v(h+V,u+n,t,l),[z,F]=v(h+s/2,u-o,t,l),[L,U]=v(h+V,u-o,t,l);return{pennants:M,barbs:k,shaft:[I,T,C,D,z,F,L,U]}}function v(e,t,i,s=1){const r=Math.sqrt(e*e+t*t)/s,a=(2*Math.PI+Math.atan2(t,e))%(2*Math.PI);return[r,(2*Math.PI+a-i)%(2*Math.PI)]}const _=[0,1,3,6,10,16,21,27,33,40,47,55,63],O=[0,.5,1,1.5,2],j=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function R(e,t,i,s){const r=u(s||"knots",i);let a;for(a=1;a<t.length;a++)if(a===t.length-1){if(e<t[a]*r)break}else if(e<=t[a]*r)break;return Math.min(a-1,t.length-2)}function P(e,t,i,s,r){let a=0;switch(t){case"beaufort_kn":a=R(e,_,"knots",i);break;case"beaufort_km":a=R(e,_,"kilometer-per-hour",i);break;case"beaufort_ft":a=R(e,_,"feet-per-second",i);break;case"beaufort_m":a=R(e,_,"meter-per-second",i);break;case"classified_arrow":a=R(e,r,s,i);break;case"ocean_current_m":a=R(e,O,"meter-per-second",i);break;case"ocean_current_kn":a=R(e,j,"knots",i)}return a}function S(e,t){const{style:i,inputUnit:s,outputUnit:r,breakValues:a}=t,n=h.fromJSON(s),o=h.fromJSON(r),l=42,c=15;let u=0,d=0;const{width:f,height:p,mask:y}=e,b=e.pixels[0],m=e.pixels[1],w=y?y.filter(e=>e>0).length:f*p,x=new Float32Array(w*l),v=new Uint32Array(c*w);for(let h=0;h<p;h++)for(let e=0;e<f;e++){const t=h*f+e;if(!y||y[h*f+e]){var _;const s=null!=(_=(m[t]+360)%360/180*Math.PI)?_:2*Math.PI*Math.random(),r=P(b[t],i,n,o,a);for(let i=0;i<g.length;i+=2)x[u++]=(e+.5)/f,x[u++]=(h+.5)/p,x[u++]=g[i],x[u++]=g[i+1]+s,x[u++]=r,x[u++]=b[t];const c=7*(u/l-1);v[d++]=c,v[d++]=c+1,v[d++]=c+2,v[d++]=c+0,v[d++]=c+4,v[d++]=c+3,v[d++]=c+0,v[d++]=c+2,v[d++]=c+3,v[d++]=c+2,v[d++]=c+5,v[d++]=c+3,v[d++]=c+5,v[d++]=c+6,v[d++]=c+3}}return{vertexData:x,indexData:v}}const M=[];function k(e,t){if(0===M.length)for(let c=0;c<30;c++)M.push(x(5*c,0));const i=u(h.fromJSON(t.inputUnit),"knots"),{width:s,height:r,mask:a}=e,n=e.pixels[0],o=e.pixels[1],l=6,d=[],f=[];let p=0,y=0;for(let h=0;h<r;h++)for(let e=0;e<s;e++){const t=h*s+e,u=n[t]*i;if((!a||a[h*s+e])&&u>=c){var b;const i=null!=(b=(o[t]+360)%360/180*Math.PI)?b:2*Math.PI*Math.random(),{pennants:a,barbs:n,shaft:c}=M[Math.min(Math.floor(u/5),29)];if(a.length+n.length===0)continue;let m=d.length/l;const g=(e+.5)/s,w=(h+.5)/r;for(let e=0;e<a.length;e+=2)d[p++]=g,d[p++]=w,d[p++]=a[e],d[p++]=a[e+1]+i,d[p++]=0,d[p++]=u;for(let e=0;e<n.length;e+=2)d[p++]=g,d[p++]=w,d[p++]=n[e],d[p++]=n[e+1]+i,d[p++]=0,d[p++]=u;for(let e=0;e<c.length;e+=2)d[p++]=g,d[p++]=w,d[p++]=c[e],d[p++]=c[e+1]+i,d[p++]=0,d[p++]=u;for(let e=0;e<a.length/6;e++)f[y++]=m,f[y++]=m+1,f[y++]=m+2,m+=3;for(let e=0;e<n.length/8;e++)f[y++]=m,f[y++]=m+1,f[y++]=m+2,f[y++]=m+1,f[y++]=m+2,f[y++]=m+3,m+=4;f[y++]=m+0,f[y++]=m+1,f[y++]=m+2,f[y++]=m+1,f[y++]=m+3,f[y++]=m+2,m+=4}}return{vertexData:new Float32Array(d),indexData:new Uint32Array(f)}}function I(e,t){const i=24;let s=0,r=0;const{width:a,height:n,mask:o}=e,l=e.pixels[0],h=[],u=[],d="wind_speed"===t.style?c:Number.MAX_VALUE;for(let c=0;c<n;c++)for(let e=0;e<a;e++){const t=c*a+e;if((!o||o[c*a+e])&&l[t]<d){for(let i=0;i<4;i++)h[s++]=(e+.5)/a,h[s++]=(c+.5)/n,h[s++]=i<2?-.5:.5,h[s++]=i%2==0?-.5:.5,h[s++]=0,h[s++]=l[t];const o=4*(s/i-1);u[r++]=o,u[r++]=o+1,u[r++]=o+2,u[r++]=o+1,u[r++]=o+2,u[r++]=o+3}}return{vertexData:new Float32Array(h),indexData:new Uint32Array(u)}}function T(e,t){return"simple_scalar"===t.style?I(e,t):"wind_speed"===t.style?k(e,t):S(e,t)}function V(e,t,i,s=[0,0],r=.5){const{width:n,height:o,mask:l}=e,[c,h]=e.pixels,[u,d]=s,y=Math.round((n-u)/i),b=Math.round((o-d)/i),m=y*b,g=new Float32Array(m),w=new Float32Array(m),x=new Uint8Array(m),v="vector-uv"===t;for(let a=0;a<b;a++)for(let e=0;e<y;e++){let t=0;const s=a*y+e,b=Math.max(0,a*i+d),m=Math.max(0,e*i+u),_=Math.min(o,b+i),O=Math.min(n,m+i);for(let e=b;e<_;e++)for(let i=m;i<O;i++){const r=e*n+i;if(!l||l[r]){t++;const e=v?[c[r],h[r]]:[c[r],(360+h[r])%360],[i,a]=v?e:p(e);g[s]+=i,w[s]+=a}}if(t>=(_-b)*(O-m)*(1-r)){x[s]=1;const[e,i]=f([g[s]/t,w[s]/t]);g[s]=e,w[s]=i}else x[s]=0,g[s]=0,w[s]=0}const _=new a["a"]({width:y,height:b,pixels:[g,w],mask:x});return _.updateStatistics(),_}},"218c":function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return y})),i.d(t,"c",(function(){return f})),i.d(t,"d",(function(){return c})),i.d(t,"e",(function(){return p})),i.d(t,"f",(function(){return h})),i.d(t,"g",(function(){return u})),i.d(t,"h",(function(){return m}));i("e06a");var s=i("b2b2");class r{constructor(e=15e3,t=5e3){this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=e,this._interval=Math.min(e,t)}decreaseRefCount(e,t){const i=e+"/"+t,s=this._cachedBlocks;if(s.has(i)){const e=s.get(i);return e.refCount--,e.refCount<=0&&(s.delete(i),e.controller&&e.controller.abort()),e.refCount}return 0}getBlock(e,t){const i=e+"/"+t,s=this._cachedBlocks;if(s.has(i)){const e=s.get(i);return e.ts=Date.now(),e.refCount++,s.delete(i),s.set(i,e),e.block}return null}putBlock(e,t,i,s=null){const r=this._cachedBlocks,a=e+"/"+t;if(r.has(a)){const e=r.get(a);e.ts=Date.now(),e.refCount++}else r.set(a,{block:i,ts:Date.now(),refCount:1,controller:s});this.trim(),this.updateTimer()}deleteBlock(e,t){const i=this._cachedBlocks,s=e+"/"+t;i.has(s)&&i.delete(s)}updateMaxSize(e){this._size=e,this.trim()}empty(){this._cachedBlocks.clear(),this.clearTimer()}getCurrentSize(){return this._cachedBlocks.size}updateTimer(){if(null!=this._timer)return;const e=this._cachedBlocks;this._timer=setInterval(()=>{const t=Array.from(e),i=Date.now();for(let s=0;s<t.length&&t[s][1].ts<=i-this._duration;s++)e.delete(t[s][0]);0===e.size&&this.clearTimer()},this._interval)}trim(){const e=this._cachedBlocks;if(-1===this._size||this._size>=e.size)return;const t=Array.from(e);for(let i=0;i<t.length-this._size;i++)e.delete(t[i][0])}clearTimer(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}}var a=i("b4e0"),n=i("4ae5");const o=new Map,l=new r;function c(e,t){return null==t?e:`${e}?sliceId=${t}`}function h(e,t){const i={extent:null,rasterInfo:t,cache:new Map};if(o.has(e)){const t=o.get(e);return t.push(i),t.length-1}return o.set(e,[i]),0}function u(e,t){if(o.has(e)){const i=o.get(e);i[t]=null,i.some(e=>null!=e)||o.delete(e)}}function d(e,t,i){if(!o.has(e))return null==t?l.decreaseRefCount(e,i):0;const s=o.get(e);if(null==s[t])return l.decreaseRefCount(e,i);const r=s[t].cache;if(r.has(i)){const e=r.get(i);if(e.refCount--,0===e.refCount){r.delete(i);for(let e=0;e<s.length;e++)s[e]&&s[e].cache.has(i)&&s[e].cache.delete(i);e.controller&&e.controller.abort()}return e.refCount}return 0}function f(e,t,i){if(!o.has(e))return null==t?l.getBlock(e,i):null;const s=o.get(e);if(null==s[t]){for(let e=0;e<s.length;e++)if(s[e]&&s[e].cache.has(i)){const t=s[e].cache.get(i);return t.refCount++,t.block}return l.getBlock(e,i)}const r=s[t].cache;if(r.has(i)){const e=r.get(i);return e.refCount++,e.block}for(let a=0;a<s.length;a++)if(a!==t&&s[a]&&s[a]&&s[a].cache.has(i)){const e=s[a].cache.get(i);return e.refCount++,r.set(i,e),e.block}return null}function p(e,t,i,s,r=null){if(!o.has(e))return void(null==t&&l.putBlock(e,i,s,r));const a=o.get(e);if(null==a[t])return void l.putBlock(e,i,s,r);const n={refCount:1,block:s,isResolved:!1,isRejected:!1,controller:r};s.then(()=>n.isResolved=!0).catch(()=>n.isRejected=!0),a[t].cache.set(i,n)}function y(e,t,i){if(!o.has(e))return void(null==t&&l.deleteBlock(e,i));const s=o.get(e);null!=s[t]?s[t].cache.delete(i):l.deleteBlock(e,i)}function b(e,t){if(!o.has(e))return null;const i=o.get(e);return null==i[t]?null:i[t]}function m(e,t,i,r,o,l,c=null){const h=b(e,t),u=h.extent,{cache:d,rasterInfo:f}=h;if(u&&u.xmin===i.xmin&&u.xmax===i.xmax&&u.ymin===i.ymin&&u.ymax===i.ymax)return;const p=i.clone().normalize(),{spatialReference:y,transform:m}=f,g=new Set;for(let b=0;b<p.length;b++){const e=p[b];if(e.xmax-e.xmin<=r||e.ymax-e.ymin<=r)continue;let t=Object(a["h"])(e,y,c);Object(s["k"])(m)&&(t=m.inverseTransform(t));const i=new n["a"]({x:r,y:r,spatialReference:e.spatialReference});if(null==o&&!(o=Object(a["j"])(i,y,e,c)))return;const{pyramidLevel:h,pyramidResolution:u,excessiveReading:d}=Object(a["m"])(o,f,l||"closest");if(d)return;const{storageInfo:w}=f,{origin:x}=w,v={x:Math.max(0,Math.floor((t.xmin-x.x)/u.x)),y:Math.max(0,Math.floor((x.y-t.ymax)/u.y))},_=Math.ceil((t.xmax-t.xmin)/u.x-.1),O=Math.ceil((t.ymax-t.ymin)/u.y-.1),j=h>0?w.pyramidBlockWidth:w.blockWidth,R=h>0?w.pyramidBlockHeight:w.blockHeight,P=1,S=Math.max(0,Math.floor(v.x/j)-P),M=Math.max(0,Math.floor(v.y/R)-P),k=Math.floor((v.x+_-1)/j)+P,I=Math.floor((v.y+O-1)/R)+P;for(let s=M;s<=I;s++)for(let e=S;e<=k;e++)g.add(`${h}/${s}/${e}`)}d.forEach((e,t)=>{if(!g.has(t)){const e=d.get(t);(null==e||e.isResolved||e.isRejected)&&d.delete(t)}}),h.extent={xmin:i.xmin,ymin:i.ymin,xmax:i.xmax,ymax:i.ymax}}},2616:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return x}));i("e06a");var s=i("e92d"),r=i("38a4"),a=i("b2b2"),n=i("f4cc"),o=i("880d"),l=i("7f83"),c=i("3af1");const h=s["a"].getLogger("esri.views.2d.engine.flow.dataUtils"),u=8;async function d(e,t,i){const s=performance.now(),r=f(e,t),a=performance.now(),o=y(e,r,t.width,t.height),l=performance.now(),c=m(o,!0),u=performance.now(),d=g(c),p=performance.now();if(e.profile){const e={"_createFlowFieldFromData()":Math.round(a-s),"_getStreamlines()":Math.round(l-a),"createAnimatedLinesData()":Math.round(u-l),"createLinesMesh()":Math.round(p-u),"Total elapsed time":Math.round(p-s)};h.info("createStreamlinesMesh profile",e)}return await Promise.resolve(),Object(n["u"])(i),d}function f(e,t){const i=b(t.data,t.width,t.height,e.smoothing);return e.interpolate?(e,s)=>{const r=Math.floor(e),a=Math.floor(s);if(r<0||r>=t.width)return[0,0];if(a<0||a>=t.height)return[0,0];const n=e-r,o=s-a,l=r,c=a,h=r<t.width-1?r+1:r,u=a<t.height-1?a+1:a,d=i[2*(c*t.width+l)],f=i[2*(c*t.width+h)],p=i[2*(u*t.width+l)],y=i[2*(u*t.width+h)],b=i[2*(c*t.width+l)+1],m=i[2*(c*t.width+h)+1];return[(d*(1-o)+p*o)*(1-n)+(f*(1-o)+y*o)*n,(b*(1-o)+i[2*(u*t.width+l)+1]*o)*(1-n)+(m*(1-o)+i[2*(u*t.width+h)+1]*o)*n]}:(e,s)=>{const r=Math.round(e),a=Math.round(s);return r<0||r>=t.width||a<0||a>=t.height?[0,0]:[i[2*(a*t.width+r)+0],i[2*(a*t.width+r)+1]]}}function p(e,t,i,s,r,a,n,o,l){const c=[];let h,u,d=i,f=s,p=0;c.push({x:d,y:f,t:p});for(let y=0;y<e.verticesPerLine;y++){let[i,s]=t(d,f);i*=e.velocityScale,s*=e.velocityScale;const y=Math.sqrt(i*i+s*s);if(y<e.minSpeedThreshold)return c;const b=i/y,m=s/y;if(d+=b*e.segmentLength,f+=m*e.segmentLength,p+=e.segmentLength/y,Math.acos(b*h+m*u)>e.maxTurnAngle)return c;if(e.mergeLines){const e=Math.round(d*l),t=Math.round(f*l);if(e<0||e>n-1||t<0||t>o-1)return c;const i=a[t*n+e];if(-1!==i&&i!==r)return c;a[t*n+e]=r}c.push({x:d,y:f,t:p}),h=b,u=m}return c}function y(e,t,i,s){const r=[],a=new o["a"],n=1/Math.max(e.lineCollisionWidth,1),l=Math.round(i*n),c=Math.round(s*n),h=new Int32Array(l*c);for(let o=0;o<h.length;o++)h[o]=-1;const u=[];for(let o=0;o<s;o+=e.lineSpacing)for(let t=0;t<i;t+=e.lineSpacing)u.push({x:t,y:o,sort:a.getFloat()});u.sort((e,t)=>e.sort-t.sort);for(const{x:o,y:d}of u)if(a.getFloat()<e.density){const i=p(e,t,o,d,r.length,h,l,c,n);if(i.length<2)continue;r.push(i)}return r}function b(e,t,i,s){if(0===s)return e;const r=Math.round(3*s),a=new Array(2*r+1);let n=0;for(let c=-r;c<=r;c++){const e=Math.exp(-c*c/(s*s));a[c+r]=e,n+=e}for(let c=-r;c<=r;c++)a[c+r]/=n;const o=new Float32Array(e.length);for(let c=0;c<i;c++)for(let i=0;i<t;i++){let s=0,n=0;for(let o=-r;o<=r;o++){if(i+o<0||i+o>=t)continue;const l=a[o+r];s+=l*e[2*(c*t+(i+o))+0],n+=l*e[2*(c*t+(i+o))+1]}o[2*(c*t+i)+0]=s,o[2*(c*t+i)+1]=n}const l=new Float32Array(e.length);for(let c=0;c<t;c++)for(let e=0;e<i;e++){let s=0,n=0;for(let l=-r;l<=r;l++){if(e+l<0||e+l>=i)continue;const h=a[l+r];s+=h*o[2*((e+l)*t+c)+0],n+=h*o[2*((e+l)*t+c)+1]}l[2*(e*t+c)+0]=s,l[2*(e*t+c)+1]=n}return l}function m(e,t){const i=new o["a"],s=e.reduce((e,t)=>e+t.length,0),r=new Float32Array(3*s),a=new Array(e.length);let n=0,l=0;for(const o of e){const e=n;for(const t of o)r[3*n+0]=t.x,r[3*n+1]=t.y,r[3*n+2]=t.t,n++;a[l++]={startVertex:e,numberOfVertices:o.length,totalTime:o[o.length-1].t,timeSeed:t?i.getFloat():0}}return{lineVertices:r,lineDescriptors:a}}function g(e,t=10){const{lineVertices:i,lineDescriptors:s}=e;let r=0,a=0;for(const u of s)r+=2*u.numberOfVertices,a+=6*(u.numberOfVertices-1);const n=new Float32Array(r*u),o=new Uint32Array(a);let l=0,c=0;function h(){o[c++]=l-2,o[c++]=l,o[c++]=l-1,o[c++]=l,o[c++]=l+1,o[c++]=l-1}function d(e,t,i,s,r,a,o){const c=l*u;let h=0;n[c+h++]=e,n[c+h++]=t,n[c+h++]=1,n[c+h++]=i,n[c+h++]=a,n[c+h++]=o,n[c+h++]=s,n[c+h++]=r,l++,n[c+h++]=e,n[c+h++]=t,n[c+h++]=-1,n[c+h++]=i,n[c+h++]=a,n[c+h++]=o,n[c+h++]=-s,n[c+h++]=-r,l++}for(const u of s){const{totalTime:e,timeSeed:s}=u;let r=null,a=null,n=null,o=null,l=null;for(let c=0;c<u.numberOfVertices;c++){const f=i[3*(u.startVertex+c)+0],p=i[3*(u.startVertex+c)+1],y=i[3*(u.startVertex+c)+2];let b=null,m=null,g=null,w=null;if(c>0){b=f-r,m=p-a;const i=Math.sqrt(b*b+m*m);if(b/=i,m/=i,c>1){let e=b+o,i=m+l;const s=Math.sqrt(e*e+i*i);e/=s,i/=s;const r=Math.min(1/(e*b+i*m),t);e*=r,i*=r,g=-i,w=e}else g=-m,w=b;null!==g&&null!==w&&(d(r,a,n,g,w,e,s),h())}r=f,a=p,n=y,o=b,l=m}d(r,a,n,-l,o,e,s)}return{vertexData:n,indexData:o}}function w(e,t){const i=t.pixels,{width:s,height:a}=t,n=new Float32Array(s*a*2);if("vector-uv"===e)for(let r=0;r<s*a;r++)n[2*r+0]=i[0][r],n[2*r+1]=-i[1][r];else if("vector-magdir"===e)for(let o=0;o<s*a;o++){const e=i[0][o],t=Object(r["g"])(i[1][o]),s=Math.cos(t-Math.PI/2),a=Math.sin(t-Math.PI/2);n[2*o+0]=s*e,n[2*o+1]=a*e}return{data:n,width:s,height:a}}async function x(e,t,i,s,r){const a=Object(l["e"])(t.spatialReference);if(!a)return v(e,t,i,s,r);const[n,o]=a.valid,h=o-n,u=Math.ceil(t.width/h),d=t.width/u,f=Math.round(i/u);let p=t.xmin;const y=[];for(let l=0;l<u;l++){const i=new c["a"]({xmin:p,xmax:p+d,ymin:t.ymin,ymax:t.ymax,spatialReference:t.spatialReference});y.push(v(e,i,f,s,r)),p+=d}const b=await Promise.all(y),m={data:new Float32Array(i*s*2),width:i,height:s};let g=0;for(const l of b){for(let e=0;e<l.height;e++)for(let t=0;t<l.width;t++)g+t>=i||(m.data[2*(e*i+g+t)+0]=l.data[2*(e*l.width+t)+0],m.data[2*(e*i+g+t)+1]=l.data[2*(e*l.width+t)+1]);g+=l.width}return m}async function v(e,t,i,s,r){if("imagery"===e.type){await e.load({signal:r});const n=e.rasterInfo.dataType,o=await e.fetchImage(t,i,s,{signal:r});return!o||Object(a["j"])(o.pixelData)||Object(a["j"])(o.pixelData.pixelBlock)?{data:new Float32Array(i*s*2),width:i,height:s}:w(n,o.pixelData.pixelBlock)}await e.load({signal:r});const n=e.rasterInfo.dataType,o=await e.fetchPixels(t,i,s,{signal:r});return!o||Object(a["j"])(o.pixelBlock)?{data:new Float32Array(i*s*2),width:i,height:s}:w(n,o.pixelBlock)}},"365a":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var s=i("a4ee"),r=i("fc29"),a=i("ce6d"),n=i("9096"),o=i("a5d8"),l=i("e92d"),c=i("b2b2"),h=i("fab3"),u=i("59b2"),d=(i("b50f"),i("c120"),i("cea0"),i("d386"));let f=class extends(Object(n["b"])(Object(o["a"])(Object(h["b"])(a["a"].EventedMixin(r["a"]))))){constructor(e){super(e),this.layer=null,this.parent=null}initialize(){this.when().catch(e=>{if("layerview:create-error"!==e.name){const t=this.layer&&this.layer.id||"no id",i=this.layer&&this.layer.title||"no title";throw l["a"].getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${i}', id: '${t}')`,e),e}})}get fullOpacity(){return Object(c["s"])(this.get("layer.opacity"),1)*Object(c["s"])(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer.legendEnabled}get updating(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var e;return!0===(null==(e=this.layer)?void 0:e.visible)}set visible(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")}canResume(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1}getSuspendInfo(){const e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{},t=this;return t.view&&t.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};Object(s["a"])([Object(u["b"])()],f.prototype,"fullOpacity",null),Object(s["a"])([Object(u["b"])()],f.prototype,"layer",void 0),Object(s["a"])([Object(u["b"])()],f.prototype,"parent",void 0),Object(s["a"])([Object(u["b"])({readOnly:!0})],f.prototype,"suspended",null),Object(s["a"])([Object(u["b"])({readOnly:!0})],f.prototype,"suspendInfo",null),Object(s["a"])([Object(u["b"])({readOnly:!0})],f.prototype,"legendEnabled",null),Object(s["a"])([Object(u["b"])({type:Boolean,readOnly:!0})],f.prototype,"updating",null),Object(s["a"])([Object(u["b"])({readOnly:!0})],f.prototype,"updatingProgress",null),Object(s["a"])([Object(u["b"])()],f.prototype,"visible",null),f=Object(s["a"])([Object(d["a"])("esri.views.layers.LayerView")],f);const p=f},"45a5":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var s=i("fa8a");const r=new s["a"]({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function a(e){return r.toJSON(e)}function n(e){const{bandCount:t,attributeTable:i,colormap:s,pixelType:r}=e.rasterInfo;return 1===t&&(null!=i||null!=s||"u8"===r||"s8"===r)}},"566d":function(e,t,i){"use strict";i.d(t,"a",(function(){return O}));var s,r=i("a4ee"),a=i("2c4f"),n=i("7d7d"),o=i("3795"),l=i("59b2"),c=(i("b50f"),i("c120"),i("cea0"),i("d386")),h=i("00c0"),u=i("66e4"),d=i("2f51"),f=(i("e06a"),i("3760")),p=i("a9ab"),y=i("3af1"),b=i("1219");const m={base:f["a"],key:"type",typeMap:{extent:y["a"],polygon:b["a"]}};let g=s=class extends u["a"]{constructor(){super(...arguments),this.type="geometry",this.geometry=null}get version(){return(this._get("version")||0)+1}clone(){return new s({geometry:this.geometry.clone()})}};Object(r["a"])([Object(l["b"])({types:m,json:{read:p["a"],write:!0}})],g.prototype,"geometry",void 0),Object(r["a"])([Object(l["b"])({readOnly:!0})],g.prototype,"version",null),g=s=Object(r["a"])([Object(c["a"])("esri.views.layers.support.Geometry")],g);const w=g;let x=class extends u["a"]{constructor(){super(...arguments),this.type="path",this.path=[]}get version(){return(this._get("version")||0)+1}};Object(r["a"])([Object(l["b"])({type:[[[Number]]],json:{write:!0}})],x.prototype,"path",void 0),Object(r["a"])([Object(l["b"])({readOnly:!0})],x.prototype,"version",null),x=Object(r["a"])([Object(c["a"])("esri.views.layers.support.Path")],x);const v=x,_=a["a"].ofType({key:"type",base:u["a"],typeMap:{rect:d["a"],path:v,geometry:w}}),O=e=>{let t=class extends e{constructor(){super(...arguments),this.clips=new _,this.moving=!1,this.attached=!1,this.lastUpdateId=-1,this.updateRequested=!1}initialize(){var e;this.container||(this.container=new h["a"]),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([Object(o["a"])(this,"suspended",e=>{this.container&&(this.container.visible=!e),this.view&&!e&&this.updateRequested&&this.view.requestUpdate()},!0),Object(o["a"])(this,["layer.opacity","container"],()=>{var e,t;this.container&&(this.container.opacity=null!=(e=null==(t=this.layer)?void 0:t.opacity)?e:1)},!0),Object(o["a"])(this,["layer.blendMode"],e=>{this.container&&(this.container.blendMode=e)},!0),Object(o["a"])(this,["layer.effect"],e=>{this.container&&(this.container.effect=e)},!0),this.clips.on("change",()=>{this.container.clips=this.clips,this.notifyChange("clips")})]),null!=(e=this.view)&&e.whenLayerView?this.view.whenLayerView(this.layer).then(e=>{e!==this||this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{}):this.when().then(()=>{this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{})}destroy(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove("initialize"),this.updateRequested=!1}get updating(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!(!this.updatingHandles||!this.updatingHandles.updating)}isVisibleAtScale(e){let t=!0;const i=this.layer,s=i.minScale,r=i.maxScale;if(null!=s&&null!=r){let i=!s,a=!r;!i&&e<=s&&(i=!0),!a&&e>=r&&(a=!0),t=i&&a}return t}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1}hitTest(e,t){return Promise.resolve(null)}isUpdating(){return!1}isRendering(){return!1}canResume(){return!!super.canResume()&&this.isVisibleAtScale(this.view.scale)}};return Object(r["a"])([Object(l["b"])({type:_,set(e){const t=Object(n["b"])(e,this._get("clips"),_);this._set("clips",t)}})],t.prototype,"clips",void 0),Object(r["a"])([Object(l["b"])()],t.prototype,"moving",void 0),Object(r["a"])([Object(l["b"])()],t.prototype,"attached",void 0),Object(r["a"])([Object(l["b"])()],t.prototype,"container",void 0),Object(r["a"])([Object(l["b"])()],t.prototype,"suspended",void 0),Object(r["a"])([Object(l["b"])({readOnly:!0})],t.prototype,"updateParameters",void 0),Object(r["a"])([Object(l["b"])()],t.prototype,"updateRequested",void 0),Object(r["a"])([Object(l["b"])()],t.prototype,"updating",null),Object(r["a"])([Object(l["b"])()],t.prototype,"view",void 0),t=Object(r["a"])([Object(c["a"])("esri.views.2d.layers.LayerView2D")],t),t}},6722:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var s=i("c120"),r=i("c84e"),a=i("9a02"),n=i("6f75"),o=i("ec5e");const l=(e,t)=>e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col;class c extends a["a"]{constructor(e){super(),this._tileInfoView=e}get requiresDedicatedFBO(){return!1}renderChildren(e){this.sortChildren(l),this.setStencilReference(),super.renderChildren(e)}createRenderParams(e){const{state:t}=e,i=super.createRenderParams(e);return i.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,i.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(t.scale),i}prepareRenderPasses(e){const t=super.prepareRenderPasses(e);return t.push(e.registerRenderPass({name:"stencil",brushes:[o["a"]],drawPhase:r["c"].DEBUG|r["c"].MAP|r["c"].HIGHLIGHT,target:()=>this.getStencilTarget()})),Object(s["a"])("esri-tiles-debug")&&t.push(e.registerRenderPass({name:"tileInfo",brushes:[n["a"]],drawPhase:r["c"].DEBUG,target:()=>this.children})),t}getStencilTarget(){return this.children}updateTransforms(e){for(const t of this.children){const i=this._tileInfoView.getTileResolution(t.key);t.setTransform(e,i)}}setStencilReference(){let e=1;for(const t of this.children)t.stencilRef=e++}}},"6c7a":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var s=i("a4ee"),r=i("e92d"),a=i("f4cc"),n=i("3795"),o=i("59b2"),l=(i("b50f"),i("c120"),i("cea0"),i("d386"));const c=e=>{let t=class extends e{initialize(){this.handles.add(Object(n["b"])(this,"layer","refresh",e=>{this.doRefresh(e.dataChanged).catch(e=>{Object(a["l"])(e)||r["a"].getLogger(this.declaredClass).error(e)})}),"RefreshableLayerView")}};return Object(s["a"])([Object(o["b"])()],t.prototype,"layer",void 0),t=Object(s["a"])([Object(l["a"])("esri.layers.mixins.RefreshableLayerView")],t),t}},ad73:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var s=i("b2b2"),r=i("c1da");async function a(e,t=e.popupTemplate){if(!Object(s["k"])(t))return[];const i=await t.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:a}=t,{objectIdField:n,typeIdField:o,globalIdField:l,relationships:c}=e;if(i.includes("*"))return["*"];const h=a?await Object(r["n"])(e):[],u=Object(r["j"])(e.fieldsIndex,[...i,...h]);return o&&u.push(o),u&&n&&e.fieldsIndex.has(n)&&-1===u.indexOf(n)&&u.push(n),u&&l&&e.fieldsIndex.has(l)&&-1===u.indexOf(l)&&u.push(l),c&&c.forEach(t=>{const{keyField:i}=t;u&&i&&e.fieldsIndex.has(i)&&-1===u.indexOf(i)&&u.push(i)}),u}function n(e,t){return e.popupTemplate?e.popupTemplate:Object(s["k"])(t)&&t.defaultPopupTemplateEnabled&&Object(s["k"])(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}},aebc:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return oe}));var s=i("a4ee"),r=i("8d60"),a=i("e92d"),n=i("f4cc"),o=i("3795"),l=i("59b2"),c=(i("b50f"),i("c120"),i("cea0"),i("d386")),h=i("d23c"),u=i("566d"),d=i("b2b2"),f=i("9180"),p=i("a98b"),y=i("3b1a"),b=i("8c71"),m=i("37c9"),g=i("e4b1");class w extends g["a"]{constructor(e,t,i,s,r,a=null){super(e,t,i,s,r),this.bitmap=new m["a"](a,null,null),this.bitmap.coordScale=[s,r],this.bitmap.once("isReady",()=>this.ready())}destroy(){super.destroy(),this.bitmap.destroy(),this.bitmap=null,this.stage=null}set stencilRef(e){this.bitmap.stencilRef=e}get stencilRef(){return this.bitmap.stencilRef}setTransform(e,t){super.setTransform(e,t),this.bitmap.transforms.dvs=this.transforms.dvs}_createTransforms(){return{dvs:Object(b["b"])(),tileMat3:Object(b["b"])()}}onAttach(){this.bitmap.stage=this.stage}onDetach(){this.bitmap.stage=null}}var x=i("c84e"),v=i("6722");class _ extends v["a"]{constructor(){super(...arguments),this.isCustomTilingScheme=!1}createTile(e){const t=this._getTileBounds(e),[i,s]=this._tileInfoView.tileInfo.size;return new w(e,t[0],t[3],i,s)}destroyTile(){}prepareRenderPasses(e){const t=e.registerRenderPass({name:"imagery (tile)",brushes:[y["a"].raster],target:()=>this.children.map(e=>e.bitmap),drawPhase:x["c"].MAP});return[...super.prepareRenderPasses(e),t]}doRender(e){this.visible&&e.drawPhase===x["c"].MAP&&super.doRender(e)}_getTileBounds(e){const t=this._tileInfoView.getTileBounds(Object(f["h"])(),e);if(this.isCustomTilingScheme&&e.world){const{tileInfo:i}=this._tileInfoView,s=Object(p["o"])(i.spatialReference);if(s){const{resolution:r}=i.lodAt(e.level),a=s/r%i.size[0],n=a?(i.size[0]-a)*r:0;t[0]-=n*e.world,t[2]-=n*e.world}}return t}}i("e06a");var O=i("9096"),j=i("4ae5"),R=i("3e27"),P=i("dff3"),S=i("218c"),M=i("9dee"),k=i("b4e0"),I=(i("3e7b"),i("018d")),T=(i("ae54"),i("07cd")),V=i("d302"),C=i("b2af"),D=i("3af1");const z=[0,0],F=a["a"].getLogger("esri.views.2d.layers.ImageryTileLayerView2D");let L=class extends O["a"]{constructor(){super(...arguments),this._emptyTilePixelBlock=null,this._tileStrategy=null,this._tileInfoView=null,this._fetchQueue=null,this._blockCacheRegistryUrl=null,this._blockCacheRegistryId=null,this._srcResolutions=null,this.previousLOD=null,this._needBlockCacheUpdate=!1,this._globalSymbolizerParams=null,this._symbolizerParams=null,this._abortController=null,this._isCustomTilingScheme=!1,this._globalUpdateRequested=!1,this.container=null,this.layer=null,this.redrawOrRefetch=Object(n["h"])((e,t)=>!this.previousLOD||this.layerView.suspended?Promise.resolve():e?this.doRefresh():this._redrawImage(t))}get useWebGLForProcessing(){var e;return null==(e=this._get("useWebGLForProcessing"))||e}set useWebGLForProcessing(e){this._set("useWebGLForProcessing",e)}get useProgressiveUpdate(){return null==this._get("useProgressiveUpdate")||this._get("useProgressiveUpdate")}set useProgressiveUpdate(e){if(this._tileStrategy&&this.useProgressiveUpdate!==e){this._tileStrategy.destroy(),this.container.removeAllChildren();const t=this._getCacheSize(e);this._tileStrategy=new V["a"]({cachePolicy:"purge",acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),cacheSize:t,tileInfoView:this._tileInfoView}),this._set("useProgressiveUpdate",e),this.layerView.requestUpdate()}}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume();const{extent:t,resolution:i,scale:s}=e.state,r=this._tileInfoView.getClosestInfoForScale(s);if(this.layer.raster){var a;if(!this.useProgressiveUpdate||this._needBlockCacheUpdate){const e=this._srcResolutions[r.level],s=t.toJSON?t:D["a"].fromJSON(t);Object(S["h"])(this._blockCacheRegistryUrl,this._blockCacheRegistryId,s,i,e,this.layer.raster.ioConfig.sampling)}this._needBlockCacheUpdate=!1,(null==(a=this.previousLOD)?void 0:a.level)!==r.level&&(this.previousLOD=r,null==this._symbolizerParams||this.layerView.hasTilingEffects||this._updateSymbolizerParams(),this._tileStrategy.updateCacheSize(0))}}moveEnd(){!this.layerView.hasTilingEffects&&this.useProgressiveUpdate||(this._abortController&&this._abortController.abort(),this._abortController=new AbortController,0===this._fetchQueue.length&&this._redrawImage(this._abortController.signal).then(()=>{this._globalUpdateRequested=!1,this.layerView.requestUpdate()}));const e=this._getCacheSize(this.useProgressiveUpdate);this._tileStrategy.updateCacheSize(e),this.layerView.requestUpdate()}get updating(){return this._fetchQueue.length>0||this._globalUpdateRequested||!(!this.updatingHandles||!this.updatingHandles.updating)}attach(){Object(C["a"])().supportsTextureFloat||(this.useWebGLForProcessing=!1),this._initializeTileInfo(),this._tileInfoView=new I["a"](this.layerView.tileInfo,this.layerView.fullExtent);const e=this._computeFetchConcurrency();this._fetchQueue=new T["a"]({tileInfoView:this._tileInfoView,concurrency:e,process:(e,t)=>this._fetchTile1(e,t)});const t=this._getCacheSize(this.useProgressiveUpdate);this._tileStrategy=new V["a"]({cachePolicy:"purge",acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),cacheSize:t,tileInfoView:this._tileInfoView}),this._updateBlockCacheRegistry()}acquireTile(e){const t=this.container.createTile(e);return this._enqueueTileFetch(t),this.layerView.requestUpdate(),this._needBlockCacheUpdate=!0,this._globalUpdateRequested=this.layerView.hasTilingEffects||!this.useProgressiveUpdate,t}releaseTile(e){this._fetchQueue.abort(e.key.id),this.container.removeChild(e),e.once("detach",()=>{e.destroy(),this.layerView.requestUpdate()}),this.layerView.requestUpdate()}uninstall(){this._tileStrategy.destroy(),this._fetchQueue.clear(),this.container.removeAllChildren(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null,this.notifyChange("updating"),Object(S["g"])(this._blockCacheRegistryUrl,this._blockCacheRegistryId)}createEmptyTilePixelBlock(e=null){const t=null==e||e.join(",")===this._tileInfoView.tileInfo.size.join(",");if(t&&Object(d["k"])(this._emptyTilePixelBlock))return this._emptyTilePixelBlock;e=e||this._tileInfoView.tileInfo.size;const[i,s]=e,r=new R["a"]({width:i,height:s,pixels:[new Uint8Array(i*s)],mask:new Uint8Array(i*s),pixelType:"u8"});return t&&(this._emptyTilePixelBlock=r),r}_fetchTile1(e,t){const i=!Object(d["j"])(t)&&t.signal,s=this.canUseWebGLForProcessing(),r={allowPartialFill:!0,datumTransformation:this.layerView.datumTransformation,interpolation:s?"nearest":this.layer.interpolation,registryId:this._blockCacheRegistryId,requestRawData:s,signal:Object(d["r"])(i),srcResolution:this._srcResolutions[e.level],timeExtent:this.layerView.timeExtent,tileInfo:this.layerView.tileInfo};return this.fetchTile(e,r)}_getCacheSize(e){return e?40:0}_initializeTileInfo(){const e=this.layerView.view.spatialReference,t=new j["a"]({x:this.layerView.fullExtent.xmin,y:this.layerView.fullExtent.ymax,spatialReference:e}),{scales:i,srcResolutions:s,isCustomTilingScheme:r}=Object(k["a"])(this.layer.rasterInfo,e),a=P["a"].create({spatialReference:e,size:512,scales:i});(0===a.origin.x||a.origin.x>t.x)&&(a.origin=t),this._isCustomTilingScheme=r,this.layerView.set("tileInfo",a),this._srcResolutions=null!=s?s:[]}_computeFetchConcurrency(){const{blockBoundary:e}=this.layer.rasterInfo.storageInfo,t=e[e.length-1];return(t.maxCol-t.minCol+1)*(t.maxRow-t.minRow+1)>64?2:10}async _enqueueTileFetch(e,t){if(!this._fetchQueue.has(e.key.id)){try{const t=await this._fetchQueue.push(e.key);this.notifyChange("updating");const{bandIds:s}=this.layer;let r=!this.useProgressiveUpdate||this.layerView.hasTilingEffects&&!this._globalSymbolizerParams;if(this._globalUpdateRequested&&!this.layerView.moving&&0===this._fetchQueue.length){r=!1;try{await this._redrawImage(this._abortController&&this._abortController.signal)}catch(i){Object(n["l"])(i)&&F.error(i)}this._globalUpdateRequested=!1}!this.canUseWebGLForProcessing()&&"rasterVF"!==this.type||this.layerView.hasTilingEffects||null!=this._symbolizerParams||this._updateSymbolizerParams();const a=this._tileInfoView.getTileCoords(z,e.key),o=this._tileInfoView.getTileResolution(e.key);await this.updateTileSource(e,{source:t,symbolizerParams:this._symbolizerParams,globalSymbolizerParams:this._globalSymbolizerParams,suspended:r,bandIds:s,coords:a,resolution:o}),e.once("attach",()=>this.layerView.requestUpdate()),this.container.addChild(e)}catch(i){Object(n["l"])(i)||F.error(i)}this.layerView.requestUpdate()}}async _redrawImage(e){if(0===this.container.children.length)return;await this.updatingHandles.addPromise(this.layer.updateRenderer()),this.layerView.hasTilingEffects?await this._updateGlobalSymbolizerParams(e):(this._updateSymbolizerParams(),this._globalSymbolizerParams=null);const t=this.container.children.map(async e=>this.updateTileSymbolizerParameters(e,{local:this._symbolizerParams,global:this._globalSymbolizerParams}));await Object(n["i"])(t),this.container.requestRender()}async _updateGlobalSymbolizerParams(e){const t={srcResolution:this._srcResolutions[this.previousLOD.level],registryId:this._blockCacheRegistryId,signal:e},i=await this.layer.fetchPixels(this.layerView.view.extent,this.layerView.view.width,this.layerView.view.height,t);if(!i||!i.pixelBlock)return;const s=this.layer.symbolizer.generateWebGLParameters({pixelBlock:Object(M["h"])(i.pixelBlock,this.layer.bandIds),isGCS:this.layerView.view.spatialReference.isGeographic,resolution:{x:this.previousLOD.resolution,y:this.previousLOD.resolution},bandIds:this.layer.bandIds});!this.canUseWebGLForProcessing()&&s&&"stretch"===s.type&&this.layer.renderer&&"raster-stretch"===this.layer.renderer.type&&(s.factor=s.factor.map(e=>255*e),s.outMin=Math.round(255*s.outMin),s.outMax=Math.round(255*s.outMax)),this._globalSymbolizerParams=s}_updateSymbolizerParams(){this._symbolizerParams=this.layer.symbolizer.generateWebGLParameters({pixelBlock:null,isGCS:this.layerView.view.spatialReference.isGeographic,resolution:{x:this.previousLOD.resolution,y:this.previousLOD.resolution},bandIds:this.layer.bandIds})}_updateBlockCacheRegistry(e=!1){const{url:t,rasterInfo:i,raster:s}=this.layer,{multidimensionalDefinition:r}=this.layer.normalizeRasterFetchOptions({multidimensionalDefinition:this.layer.multidimensionalDefinition,timeExtent:this.layerView.timeExtent}),a=null!=i&&i.multidimensionalInfo?s.getSliceIndex(r):null,n=Object(S["d"])(t,a);if(n!==this._blockCacheRegistryUrl){if(null!=this._blockCacheRegistryUrl&&Object(S["g"])(this._blockCacheRegistryUrl,this._blockCacheRegistryId),this._blockCacheRegistryId=Object(S["f"])(n,this.layer.raster.rasterInfo),e){const e=this._tileInfoView.getClosestInfoForScale(this.layerView.view.scale),t=this._srcResolutions[e.level];Object(S["h"])(n,this._blockCacheRegistryId,this.layerView.view.extent,this.layerView.view.resolution,t,this.layer.raster.ioConfig.sampling)}this._blockCacheRegistryUrl=n}}async doRefresh(){await this.updatingHandles.addPromise(this.layer.updateRenderer()),this.layerView.hasTilingEffects||this._updateSymbolizerParams(),this._updateBlockCacheRegistry(!0),this._fetchQueue.reset(),this.notifyChange("updating");const e=[];this._tileStrategy.tiles.forEach(t=>e.push(this._enqueueTileFetch(t))),await Object(n["i"])(e)}};Object(s["a"])([Object(l["b"])()],L.prototype,"_globalUpdateRequested",void 0),Object(s["a"])([Object(l["b"])()],L.prototype,"container",void 0),Object(s["a"])([Object(l["b"])()],L.prototype,"layer",void 0),Object(s["a"])([Object(l["b"])()],L.prototype,"layerView",void 0),Object(s["a"])([Object(l["b"])()],L.prototype,"type",void 0),Object(s["a"])([Object(l["b"])()],L.prototype,"useWebGLForProcessing",null),Object(s["a"])([Object(l["b"])()],L.prototype,"useProgressiveUpdate",null),Object(s["a"])([Object(l["b"])()],L.prototype,"updating",null),L=Object(s["a"])([Object(c["a"])("esri.views.2d.layers.imagery.BaseImageryTileSubView2D")],L);var U=i("45a5");let A=class extends L{constructor(){super(...arguments),this.container=null,this.layer=null,this.type="raster"}canUseWebGLForProcessing(){return this.useWebGLForProcessing&&this.layer.symbolizer.canRenderInWebGL&&!("majority"===this.layer.interpolation&&Object(U["a"])(this.layer))}fetchTile(e,t){return this.layer.fetchTile(e.level,e.row,e.col,t)}async updateTileSource(e,t){const{bandIds:i}=this.layer,s=this._getLayerInterpolation(),r=this.canUseWebGLForProcessing(),{source:a,symbolizerParams:n,globalSymbolizerParams:o,suspended:l,coords:c,resolution:h}=t,{bitmap:u}=e;if([u.x,u.y]=c,u.resolution=h,a&&Object(d["k"])(a)&&Object(d["k"])(a.pixelBlock)){const e={extent:a.extent,pixelBlock:a.pixelBlock};if(u.rawPixelData=e,r)u.source=a.pixelBlock,u.isRendereredSource=!1;else{const t=await this.layer.applyRenderer(e,"stretch"===(null==o?void 0:o.type)?o:null);u.source=t,u.isRendereredSource=!0}u.symbolizerParameters=r?n:null,r?u.transformGrid||(u.transformGrid=a.transformGrid):u.transformGrid=null}else{const e=this.createEmptyTilePixelBlock();u.source=e,u.symbolizerParameters=r?n:null,u.transformGrid=null}u.bandIds=r?i:null,u.width=this._tileInfoView.tileInfo.size[0],u.height=this._tileInfoView.tileInfo.size[1],u.interpolation=s,u.suspended=l,u.invalidateTexture()}async updateTileSymbolizerParameters(e,t){const{local:i,global:s}=t,{bandIds:r}=this.layer,a=this._getLayerInterpolation(),n=this.canUseWebGLForProcessing(),{bitmap:o}=e,{rawPixelData:l}=o;!n&&Object(d["k"])(l)?(o.source=await this.layer.applyRenderer(l,"stretch"===(null==s?void 0:s.type)?s:null),o.isRendereredSource=!0):(o.isRendereredSource&&Object(d["k"])(l)&&(o.source=l.pixelBlock),o.isRendereredSource=!1),o.symbolizerParameters=n?s||i:null,o.bandIds=n?r:null,o.interpolation=a,o.suspended=!1}install(e){this.container=new _(this._tileInfoView),this.container.isCustomTilingScheme=this._isCustomTilingScheme,e.addChild(this.container)}uninstall(){this.container.removeAllChildren(),this.container.remove(),super.uninstall()}_getLayerInterpolation(){const e=this.layer.renderer.type;if("raster-colormap"===e||"unique-value"===e||"class-breaks"===e)return"nearest";const{interpolation:t}=this.layer,{renderer:i}=this.layer;return"raster-stretch"===i.type&&null!=i.colorRamp?"bilinear"===t||"cubic"===t?"bilinear":"nearest":t}};Object(s["a"])([Object(l["b"])()],A.prototype,"container",void 0),Object(s["a"])([Object(l["b"])()],A.prototype,"layer",void 0),Object(s["a"])([Object(l["b"])()],A.prototype,"type",void 0),A=Object(s["a"])([Object(c["a"])("esri.views.2d.layers.imagery.ImageryTileView2D")],A);const B=A;var q=i("19db"),E=i("1c92"),G=i("7ce4"),W=(i("d267"),i("1956"),i("d17d"),i("9f8b"),i("a1ff"),i("0fa6")),N=i("7c4b"),H=i("c8dd");class Q extends N["a"]{constructor(e=null){super(),this._source=null,this._symbolizerParameters=null,this._vaoInvalidated=!0,this.coordScale=[1,1],this.height=null,this.stencilRef=0,this.rawPixelData=null,this.width=null,this.source=e}destroy(){var e,t;Object(d["k"])(this.vaoData)&&(null==(e=this.vaoData.magdir)||e.vao.dispose(),null==(t=this.vaoData.scalar)||t.vao.dispose(),this.vaoData=null)}get symbolizerParameters(){return this._symbolizerParameters}set symbolizerParameters(e){JSON.stringify(this._symbolizerParameters)!==JSON.stringify(e)&&(this._symbolizerParameters=e,this.invalidateVAO())}get source(){return this._source}set source(e){this._source=e,this.invalidateVAO()}invalidateVAO(){var e,t;!this._vaoInvalidated&&Object(d["k"])(this.vaoData)&&(null==(e=this.vaoData.magdir)||e.vao.dispose(),null==(t=this.vaoData.scalar)||t.vao.dispose(),this.vaoData=null,this._vaoInvalidated=!0,this.requestRender())}updateVectorFieldVAO(e){if(this._vaoInvalidated){if(this._vaoInvalidated=!1,Object(d["k"])(this.source)&&!Object(d["k"])(this.vaoData)){const{style:t}=this.symbolizerParameters;switch(t){case"beaufort_ft":case"beaufort_km":case"beaufort_kn":case"beaufort_m":case"beaufort_mi":case"classified_arrow":case"ocean_current_kn":case"ocean_current_m":case"single_arrow":{const t=Object(q["c"])(this.source,this.symbolizerParameters),i=this._createVectorFieldVAO(e.context,t);this.vaoData={magdir:i}}break;case"simple_scalar":{const t=Object(q["d"])(this.source,this.symbolizerParameters),i=this._createVectorFieldVAO(e.context,t);this.vaoData={scalar:i}}break;case"wind_speed":{const t=Object(q["c"])(this.source,this.symbolizerParameters),i=this._createVectorFieldVAO(e.context,t),s=Object(q["d"])(this.source,this.symbolizerParameters),r=this._createVectorFieldVAO(e.context,s);this.vaoData={magdir:i,scalar:r}}}}this.ready(),this.requestRender()}}_createTransforms(){return{dvs:Object(b["b"])()}}onAttach(){this.invalidateVAO()}onDetach(){this.invalidateVAO()}_createVectorFieldVAO(e,t){const{vertexData:i,indexData:s}=t,r=G["a"].createVertex(e,35044,new Float32Array(i)),a=G["a"].createIndex(e,35044,new Uint32Array(s)),n=Object(H["g"])("vector-field",{geometry:[{location:0,name:"a_pos",count:2,type:5126,normalized:!1},{location:1,name:"a_offset",count:2,type:5126,normalized:!1},{location:2,name:"a_vv",count:2,type:5126,normalized:!1}]});return{vao:new W["a"](e,n.attributes,n.bufferLayouts,{geometry:r},a),elementCount:s.length}}}class J extends g["a"]{constructor(e,t,i,s,r,a=null){super(e,t,i,s,r),this.tileData=new Q(a),this.tileData.coordScale=[s,r],this.tileData.once("isReady",()=>this.ready())}destroy(){super.destroy(),this.tileData.destroy(),this.tileData=null,this.stage=null}set stencilRef(e){this.tileData.stencilRef=e}get stencilRef(){return this.tileData.stencilRef}_createTransforms(){return{dvs:Object(b["b"])(),tileMat3:Object(b["b"])()}}setTransform(e,t){super.setTransform(e,t);const i=t/(e.resolution*e.pixelRatio),s=this.transforms.tileMat3,[r,a]=this.tileData.offset,n=[this.x+r*t,this.y-a*t],[o,l]=e.toScreenNoRotation([0,0],n),{symbolTileSize:c}=this.tileData.symbolizerParameters,h=Math.round((this.width-this.tileData.offset[0])/c)*c,u=Math.round((this.height-this.tileData.offset[1])/c)*c,d=h/this.rangeX*i,f=u/this.rangeY*i;Object(E["k"])(s,d,0,0,0,f,0,o,l,1),Object(E["h"])(this.transforms.dvs,e.displayViewMat3,s),this.tileData.transforms.dvs=this.transforms.dvs}onAttach(){this.tileData.stage=this.stage}onDetach(){this.tileData.stage=null}}var X=i("c1ef");class $ extends v["a"]{constructor(){super(...arguments),this.isCustomTilingScheme=!1,this.symbolTypes=["triangle"]}createTile(e){const t=this._tileInfoView.getTileBounds(Object(f["h"])(),e),[i,s]=this._tileInfoView.tileInfo.size;return new J(e,t[0],t[3],i,s)}destroyTile(){}prepareRenderPasses(e){const t=e.registerRenderPass({name:"imagery (vf tile)",brushes:[X["a"]],target:()=>this.children.map(e=>e.tileData),drawPhase:x["c"].MAP});return[...super.prepareRenderPasses(e),t]}doRender(e){this.visible&&e.drawPhase===x["c"].MAP&&this.symbolTypes.forEach(t=>{e.renderPass=t,super.doRender(e)})}}let Y=class extends L{constructor(){super(...arguments),this._handle=null,this.container=null,this.layer=null,this.type="rasterVF"}canUseWebGLForProcessing(){return!1}async fetchTile(e,t){const i=await this.layer.fetchTile(e.level,e.row,e.col,t);return"vector-magdir"===this.layer.rasterInfo.dataType&&null!=i&&i.pixelBlock&&(i.pixelBlock=await this.layer.convertVectorFieldData(i.pixelBlock,t)),i}updateTileSource(e,t){const i=t.symbolizerParams,{tileData:s}=e;s.key=e.key,s.width=this._tileInfoView.tileInfo.size[0],s.height=this._tileInfoView.tileInfo.size[1];const{symbolTileSize:r}=i,{source:a}=t;if(s.offset=this._getTileSymbolOffset(s.key,r),Object(d["k"])(a)&&Object(d["k"])(a.pixelBlock)){const e={extent:a.extent,pixelBlock:a.pixelBlock};s.rawPixelData=e,s.source=this._sampleVectorFieldData(a.pixelBlock,i,s.offset),s.symbolizerParameters=i}else{const e=[Math.round((this._tileInfoView.tileInfo[0]-s.offset[0])/r),Math.round((this._tileInfoView.tileInfo[1]-s.offset[1])/r)],t=this.createEmptyTilePixelBlock(e);s.source=t,s.symbolizerParameters=i}return s.invalidateVAO(),Promise.resolve(null)}updateTileSymbolizerParameters(e,t){var i;const s=t.local,{symbolTileSize:r}=s,{tileData:a}=e;a.offset=this._getTileSymbolOffset(a.key,r);const n=a.symbolizerParameters.symbolTileSize;return a.symbolizerParameters=s,Object(d["k"])(null==(i=a.rawPixelData)?void 0:i.pixelBlock)&&n!==r&&(a.source=this._sampleVectorFieldData(a.rawPixelData.pixelBlock,a.symbolizerParameters,a.offset)),Promise.resolve(null)}install(e){this.container=new $(this._tileInfoView),this.container.isCustomTilingScheme=this._isCustomTilingScheme,this._updateSymbolType(this.layer.renderer),this._handle=this.layer.watch("renderer",e=>this._updateSymbolType(e)),e.addChild(this.container)}uninstall(){this.container.removeAllChildren(),this._handle.remove(),this._handle=null,this.container.remove(),super.uninstall()}_getTileSymbolOffset(e,t){const i=e.col*this._tileInfoView.tileInfo.size[0]%t,s=e.row*this._tileInfoView.tileInfo.size[1]%t;return[i>t/2?t-i:-i,s>t/2?t-s:-s]}_sampleVectorFieldData(e,t,i){const{symbolTileSize:s}=t;return Object(q["f"])(e,"vector-uv",s,i)}_updateSymbolType(e){"vector-field"===e.type&&(this.container.symbolTypes="wind-barb"===e.style?["scalar","triangle"]:"simple-scalar"===e.style?["scalar"]:["triangle"])}};Object(s["a"])([Object(l["b"])()],Y.prototype,"container",void 0),Object(s["a"])([Object(l["b"])()],Y.prototype,"layer",void 0),Object(s["a"])([Object(l["b"])()],Y.prototype,"type",void 0),Y=Object(s["a"])([Object(c["a"])("esri.views.2d.layers.imagery.VectorFieldTileView2D")],Y);const K=Y;var Z=i("ce50"),ee=i("22f4"),te=i("ad73");const ie=e=>{let t=class extends e{constructor(){super(...arguments),this._rasterFieldPrefix="Raster.",this.layer=null,this.view=null,this.fullExtent=null,this.tileInfo=null,this.datumTransformation=null}get hasTilingEffects(){return this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}async fetchPopupFeatures(e,t){const{layer:i}=this;if(!e)return Promise.reject(new Z["a"]("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:i}));const{popupEnabled:s}=i,a=Object(te["a"])(i,t);if(!s||!Object(d["k"])(a))throw new Z["a"]("imageryTileLayerView:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:s,popupTemplate:a});const n=[],{value:o,magdirValue:l}=await i.identify(e,{timeExtent:this.timeExtent});let c="";if(o&&o.length){var h,u;c="imagery-tile"===i.type&&i.hasStandardTime()&&null!=o[0]?o.map(e=>i.getStandardTimeValue(e)).join(", "):o.join(", ");const e={ObjectId:0},t="Raster.ServicePixelValue";e[t]=this._formatAttributeValue(c,t);const s=null==(h=i.rasterInfo)||null==(u=h.attributeTable)?void 0:u.features;if(s&&s.length>0){const t=s.filter(e=>{const t=e.attributes.value||e.attributes.Value||e.attributes.VALUE;return String(t)===c});if(t.length>0){const i=t[0];if(i)for(const t in i.attributes)if(i.attributes.hasOwnProperty(t)){const s=this._rasterFieldPrefix+t;e[s]=this._formatAttributeValue(i.attributes[t],s)}}}const a=i.rasterInfo.dataType;"vector-magdir"!==a&&"vector-uv"!==a||(e["Raster.Magnitude"]=null==l?void 0:l[0],e["Raster.Direction"]=null==l?void 0:l[1]);const d=new r["a"](this.fullExtent.clone(),null,e);d.layer=i,d.sourceLayer=d.layer,n.push(d)}return n}updateFullExtent(){const e=this.layer.tileInfo;if(!e||!e.spatialReference)return Promise.reject(new Z["a"]("layerview:tiling-information-missing","The layer doesn't provide tiling information",{layer:this.layer}));if(Object(d["j"])(this.layer.fullExtent))return Promise.reject(new Z["a"]("layerview:extent-missing","The layer doesn't provide a full extent.",{layer:this.layer}));const t=Object(k["b"])(this.layer.fullExtent,this.view.spatialReference,!1),i=Object(k["h"])(this.layer.fullExtent,this.view.spatialReference,t);return null==i?Promise.reject(new Z["a"]("layerview:projection-not-supported","The layer extent cannot be projected to the view's spatial reference",{layer:this.layer})):(this._set("fullExtent",i),this.datumTransformation||(this.datumTransformation=Object(k["b"])(this.layer.fullExtent,this.view.spatialReference,!0)),Promise.resolve())}_formatAttributeValue(e,t){if("string"==typeof e){const i=this.layer.popupTemplate&&this.layer.popupTemplate.fieldInfos,s=this._getFieldInfo(i,t),r=s&&s.format;if(r){let t,i;return e.trim().indexOf(",")>-1?(t=",",i=t+" ",this._formatDelimitedString(e,t,i,r)):e.trim().indexOf(" ")>-1?(t=i=" ",this._formatDelimitedString(e,t,i,r)):this._formatNumberFromString(e,r)}}return e}_getFieldInfo(e,t){if(!e||!e.length||!t)return;const i=t.toLowerCase();let s;return e.some(e=>!(!e.fieldName||e.fieldName.toLowerCase()!==i&&e.fieldName.toLowerCase()!==i.replace(/ /g,"_"))&&(s=e,!0)),s}_formatDelimitedString(e,t,i,s){return e&&t&&i&&s?e.trim().split(t).map(e=>this._formatNumberFromString(e,s)).join(i):e}_formatNumberFromString(e,t){if(!e||!t)return e;const i=Number(e);return isNaN(i)?e:t.format(i)}};return Object(s["a"])([Object(l["b"])()],t.prototype,"layer",void 0),Object(s["a"])([Object(l["b"])(ee["a"])],t.prototype,"timeExtent",void 0),Object(s["a"])([Object(l["b"])()],t.prototype,"view",void 0),Object(s["a"])([Object(l["b"])()],t.prototype,"fullExtent",void 0),Object(s["a"])([Object(l["b"])()],t.prototype,"tileInfo",void 0),Object(s["a"])([Object(l["b"])({readOnly:!0})],t.prototype,"hasTilingEffects",null),t=Object(s["a"])([Object(c["a"])("esri.views.layers.ImageryTileLayerView")],t),t};var se=i("365a"),re=i("6c7a");const ae=a["a"].getLogger("esri.views.2d.layers.ImageryTileLayerView2D");let ne=class extends(ie(Object(re["a"])(Object(u["a"])(se["a"])))){constructor(){super(...arguments),this._useWebGLForProcessing=!0,this._useProgressiveUpdate=!0,this.subview=null}initialize(){const e=this.updateFullExtent();this.addResolvingPromise(e)}get useWebGLForProcessing(){return this._useWebGLForProcessing}set useWebGLForProcessing(e){this._useWebGLForProcessing=e,this.subview&&"useWebGLForProcessing"in this.subview&&(this.subview.useWebGLForProcessing=e)}get useProgressiveUpdate(){return this._useWebGLForProcessing}set useProgressiveUpdate(e){this._useProgressiveUpdate=e,this.subview&&"useProgressiveUpdate"in this.subview&&(this.subview.useProgressiveUpdate=e)}update(e){this.subview.update(e),this.notifyChange("updating")}isUpdating(){return!this.subview||this.subview.updating}attach(){this.layer.increaseRasterJobHandlerUsage(),this._updateSubview(),this.handles.add([Object(o["d"])(this.layer,["bandIds","renderer","interpolation","multidimensionalDefinition"],(e,t,i)=>{const s="multidimensionalDefinition"===i,r="interpolation"===i&&("majority"===e||"majority"===t)&&Object(U["a"])(this.layer),a="renderer"===i&&t.type!==e.type;a&&this._updateSubview();const o=s||r||a;this.subview.redrawOrRefetch(o).catch(e=>{Object(n["l"])(e)||ae.error(e)}),this.notifyChange("updating")}),Object(o["a"])(this,["layer.blendMode"],e=>{this.subview&&(this.subview.container.blendMode=e)},!0),Object(o["a"])(this,["layer.effect"],e=>{this.subview&&(this.subview.container.effect=e)},!0),Object(o["a"])(this,"timeExtent",()=>{this.subview.redrawOrRefetch(!0).catch(e=>{Object(n["l"])(e)||ae.error(e)})})],"attach")}detach(){this.handles.remove("attach"),this.layer.decreaseRasterJobHandlerUsage(),this.subview.uninstall()}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.subview.moveEnd()}async hitTest(e,t){return[new r["a"]({attributes:{},geometry:e.clone()})]}doRefresh(){return this.subview.doRefresh()}_updateSubview(){const e="vector-field"===this.layer.renderer.type?"rasterVF":"animated-flow"===this.layer.renderer.type?"rasterAnimatedFlow":"raster";if(this.subview){if(this.subview.type===e)return;this.subview.uninstall()}const{layer:t}=this;let i;i="rasterVF"===e?new K({layer:t,layerView:this}):"rasterAnimatedFlow"===e?new h["a"]({layer:t,layerView:this}):new B({layer:t,layerView:this}),"useWebGLForProcessing"in i&&(i.useWebGLForProcessing=this._useWebGLForProcessing),"useProgressiveUpdate"in i&&(i.useProgressiveUpdate=this._useProgressiveUpdate),"previousLOD"in i&&(i.previousLOD=this.subview&&"previousLOD"in this.subview&&this.subview.previousLOD),i.attach(),i.install(this.container),i.container.blendMode=t.blendMode,i.container.effect=t.effect,this.subview=i,this.requestUpdate()}};Object(s["a"])([Object(l["b"])()],ne.prototype,"subview",void 0),Object(s["a"])([Object(l["b"])()],ne.prototype,"useWebGLForProcessing",null),Object(s["a"])([Object(l["b"])()],ne.prototype,"useProgressiveUpdate",null),ne=Object(s["a"])([Object(c["a"])("esri.views.2d.layers.ImageryTileLayerView2D")],ne);const oe=ne},b4e0:function(e,t,i){"use strict";i.d(t,"a",(function(){return F})),i.d(t,"b",(function(){return g})),i.d(t,"c",(function(){return T})),i.d(t,"d",(function(){return I})),i.d(t,"e",(function(){return P})),i.d(t,"f",(function(){return k})),i.d(t,"g",(function(){return m})),i.d(t,"h",(function(){return j})),i.d(t,"i",(function(){return v})),i.d(t,"j",(function(){return w})),i.d(t,"k",(function(){return h})),i.d(t,"l",(function(){return D})),i.d(t,"m",(function(){return z}));i("e06a");var s=i("ce50"),r=i("b2b2"),a=i("8048"),n=i("8188"),o=i("3af1"),l=i("4ae5");const c=5e-4;function h(e,t,i){return!Object(n["b"])(e,t,i)}function u(e,t,i){const r=h(e,t,i);if(r&&!Object(n["f"])())throw new s["a"]("rasterprojectionhelper-project","projection engine is not loaded");return r}const d=function(e,t,i){const s=(e[0]+e[4]+e[4*t.cols]+e[4*t.cols+4])/4,r=(e[1]+e[5]+e[4*t.rows+1]+e[4*t.rows+5])/4,a=(e[4*t.cols]-e[0]+e[4*t.cols+4]-e[4])/i[0]*.5,n=(e[4*t.cols+1]-e[1]+e[4*t.cols+5]-e[5])/i[1]*.5;return[0===a||isNaN(a)?0:Math.abs(s-e[2*t.rows+2])/Math.abs(a),0===n||isNaN(n)?0:Math.abs(r-e[2*t.rows+3])/Math.abs(n)]},f={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},p=32,y=4,b=y;async function m(){if(Object(n["f"])())return null;await Object(n["g"])()}function g(e,t,i){return u(e.spatialReference,t)?i?Object(n["d"])(t,e.spatialReference,e):Object(n["d"])(e.spatialReference,t,e):null}function w(e,t,i,s=null){if(e.spatialReference.equals(t))return e;u(e.spatialReference,t,s);const a=i.center,l=new o["a"]({xmin:a.x-e.x/2,xmax:a.x+e.x/2,ymin:a.y-e.y/2,ymax:a.y+e.y/2,spatialReference:e.spatialReference}),c=Object(n["h"])(l,t,s);return Object(r["j"])(c)?null:{x:c.xmax-c.xmin,y:c.ymax-c.ymin}}function x(e,t=.01){return Object(a["d"])(e)?t/Object(a["d"])(e):0}function v(e,t,i=null,s=!0){const r=e.spatialReference;if(r.equals(t))return e;u(r,t,i);const a=Object(n["h"])(e,t,i);if(s&&t.isGeographic){const[t,i]=S(r,!0),s=x(r);s&&null!=t&&null!=i&&(Math.abs(e.x-t)<s&&Math.abs(180-a.x)<c?a.x-=360:Math.abs(e.x-i)<s&&Math.abs(180+a.x)<c&&(a.x+=360))}return a}function _(e,t,i=null){const s=e[0].spatialReference;return s.equals(t)?e:(u(s,t,i),Object(n["h"])(e,t,i))}function O(e){const t=P(e[0].spatialReference);if(e.length<2||!Object(r["k"])(t))return e[0];let{xmin:i,xmax:s,ymin:a,ymax:n}=e[0];for(let r=1;r<e.length;r++){const i=e[r];s=i.xmax+t*r,a=Math.min(a,i.ymin),n=Math.max(n,i.ymax)}return new o["a"]({xmin:i,xmax:s,ymin:a,ymax:n,spatialReference:e[0].spatialReference})}function j(e,t,i=null,s=!0){if(e.spatialReference.equals(t))return e;const a=k(e),n=P(e.spatialReference,!0);return Object(r["k"])(n)&&0!==a?O(e.clone().normalize().map(e=>R(e,t,i,s))):R(e,t,i,s)}function R(e,t,i=null,s=!0){const r=e.spatialReference;if(r.equals(t))return e;u(r,t,i);const a=Object(n["h"])(e,t,i);let[o,h]=S(r,!0);if(a&&s&&r.isWebMercator&&t.isGeographic&&null!=o&&null!=h){const s=.001,n=1e3;if(Math.abs(e.xmin-o)<s&&Math.abs(h-e.xmax)>n&&Math.abs(180-a.xmax)<c){a.xmin=-180;const s=[];s.push(new l["a"](e.xmax,e.ymin,r)),s.push(new l["a"](e.xmax,(e.ymin+e.ymax)/2,r)),s.push(new l["a"](e.xmax,e.ymax,r));const n=s.map(e=>v(e,t,i)).filter(e=>!isNaN(null==e?void 0:e.x)).map(e=>e.x);a.xmax=Math.max.apply(null,n)}if(Math.abs(e.xmax-h)<s&&Math.abs(o-e.xmin)>n&&Math.abs(180+a.xmin)<c){a.xmax=180;const s=[];s.push(new l["a"](e.xmin,e.ymin,r)),s.push(new l["a"](e.xmin,(e.ymin+e.ymax)/2,r)),s.push(new l["a"](e.xmin,e.ymax,r));const n=s.map(e=>v(e,t,i)).filter(e=>!isNaN(null==e?void 0:e.x)).map(e=>e.x);a.xmin=Math.min.apply(null,n)}}[o,h]=S(t,!0);const d=x(t);return d&&null!=o&&null!=h&&a&&(Math.abs(a.xmin-o)<d&&(a.xmin=o),Math.abs(a.xmax-h)<d&&(a.xmax=h)),a}function P(e,t=!1){const i=t?20037508.342787:20037508.342788905;return e.isWebMercator?2*i:e.wkid&&e.isGeographic?360:2*f[e.wkid]||null}function S(e,t=!1){const i=[],s=P(e,t);return Object(r["k"])(s)&&(i.push(-s/2),i.push(s/2)),i}function M(e,t,i,s){let r=(e-t)/i;return r-Math.floor(r)!=0?r=Math.floor(r):s&&(r-=1),r}function k(e,t=!1){const i=P(e.spatialReference);if(!Object(r["k"])(i))return 0;const s=t?0:-i/2;return M(e.xmax,s,i,!0)-M(e.xmin,s,i,!1)}function I(e){const t=e.storageInfo.origin.x,i=P(e.spatialReference,!0);if(!Object(r["k"])(i))return{originX:t,halfWorldWidth:null,pyramidsInfo:null};const s=i/2,{nativePixelSize:a,storageInfo:n,extent:o}=e,{maximumPyramidLevel:l,blockWidth:c,pyramidScalingFactor:h}=n;let u=a.x;const d=[],f=Object(r["k"])(e.transform)&&"gcs-shift"===e.transform.type,p=t+(f?0:s),y=f?i-t:s-t;for(let r=0;r<=l;r++){const e=(o.xmax-t)/u/c,i=e-Math.floor(e)==0?e:Math.ceil(e),s=y/u/c,r=s-Math.floor(s)==0?s:Math.ceil(s),a=Math.floor(p/u/c),n=Math.round(p/u)%c,l=(c-Math.round(y/u)%c)%c;d.push({resolutionX:u,blockWidth:c,datsetColumnCount:i,worldColumnCountFromOrigin:r,leftMargin:n,rightPadding:l,originColumnOffset:a}),u*=h}return{originX:t,halfWorldWidth:s,pyramidsInfo:d,hasGCSSShiftTransform:f}}function T(e){const t=e.isAdaptive&&null==e.spacing,i=e.spacing||[p,p];let s=V(e),r={cols:s.size[0]+1,rows:s.size[1]+1},a=d(s.offsets,r,i);const n=(a[0]+a[1])/2,o=s.outofBoundPointCount>0&&s.outofBoundPointCount<s.offsets.length/2;return t&&(o||n>b)&&(s=V({...e,spacing:[y,y]}),r={cols:s.size[0]+1,rows:s.size[1]+1},a=d(s.offsets,r,i)),s.error=a,s.coefficients=C(s.offsets,r,o),s}function V(e){const{projectedExtent:t,srcBufferExtent:i,pixelSize:s,datumTransformation:a,rasterTransform:n}=e,o=t.spatialReference,c=i.spatialReference;u(o,c);const{xmin:h,ymin:d,xmax:f,ymax:y}=t,b=P(c),m=e.hasWrapAround||"gcs-shift"===(null==n?void 0:n.type),g=e.spacing||[p,p],w={x:g[0]*s.x,y:g[1]*s.y},x={cols:Math.ceil((f-h)/w.x-.1/g[0])+1,rows:Math.ceil((y-d)/w.y-.1/g[1])+1},v=w.x,O=w.y,j=[];let R,S=0;const M=[];for(let r=0;r<x.cols;r++)for(let e=0;e<x.rows;e++)M.push(new l["a"]({x:h+v*r,y:y-O*e,spatialReference:o}));const k=_(M,c,a);for(let l=0;l<x.cols;l++){const e=[];for(let t=0;t<x.rows;t++){let s=k[l*x.rows+t];n&&(s=n.inverseTransform(s)),e.push(s),l>0&&m&&s&&R[t]&&Object(r["k"])(b)&&s.x<R[t].x&&(s.x+=b),s?(j.push((s.x-i.xmin)/(i.xmax-i.xmin)),j.push((i.ymax-s.y)/(i.ymax-i.ymin))):(j.push(NaN),j.push(NaN),S++)}R=e}return{offsets:j,error:null,coefficients:null,outofBoundPointCount:S,spacing:g,size:[x.cols-1,x.rows-1]}}function C(e,t,i){const{cols:s,rows:r}=t,a=new Float32Array((s-1)*(r-1)*2*6),n=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),o=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let l=0;l<s-1;l++){for(let t=0;t<r-1;t++){let i=l*r*2+2*t;const c=e[i],h=e[i+1],u=e[i+2],d=e[i+3];i+=2*r;const f=e[i],p=e[i+1],y=e[i+2],b=e[i+3];let m=0,g=12*(t*(s-1)+l);for(let e=0;e<3;e++)a[g++]=n[m++]*c+n[m++]*u+n[m++]*y;m=0;for(let e=0;e<3;e++)a[g++]=n[m++]*h+n[m++]*d+n[m++]*b;m=0;for(let e=0;e<3;e++)a[g++]=o[m++]*c+o[m++]*f+o[m++]*y;m=0;for(let e=0;e<3;e++)a[g++]=o[m++]*h+o[m++]*p+o[m++]*b}if(i)for(let e=0;e<a.length;e++)isNaN(a[e])&&(a[e]=-1)}return a}function D(e){const t=e.clone().normalize();return 1===t.length?t[0]:O(t)}function z(e,t,i){const{storageInfo:s,pixelSize:a}=t;let n,o=!1;const{pyramidResolutions:c}=s;if(Object(r["k"])(c)&&c.length){const s=(e.x+e.y)/2,r=c[c.length-1],h=(r.x+r.y)/2,u=(a.x+a.y)/2;if(s<=u)n=0;else if(s>=h)n=c.length,o=s/h>8;else{let e,t=u;for(let r=1;r<=c.length;r++){if(e=(c[r-1].x+c[r-1].y)/2,s<=e){s===e?n=r:"down"===i?(n=r-1,o=s/t>8):n="up"===i||s-t>e-s||s/t>2?r:r-1;break}t=e}}const d=0===n?a:c[n-1];return{pyramidLevel:n,pyramidResolution:new l["a"]({x:d.x,y:d.y,spatialReference:t.spatialReference}),excessiveReading:o}}const h=Math.log(e.x/a.x)/Math.LN2,u=Math.log(e.y/a.y)/Math.LN2,d=t.storageInfo.maximumPyramidLevel||0;n="down"===i?Math.floor(Math.min(h,u)):"up"===i?Math.ceil(Math.max(h,u)):Math.round((h+u)/2),n<0?n=0:n>d&&(o=n>d+3,n=d);const f=2**n;return{pyramidLevel:n,pyramidResolution:new l["a"]({x:f*t.nativePixelSize.x,y:f*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:o}}function F(e,t,i=512,s=!0){const{extent:r,spatialReference:n,pixelSize:o}=e,c=w(new l["a"]({x:o.x,y:o.y,spatialReference:n}),t,r);if(null==c)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const h=(c.x+c.y)/2,u=Object(a["d"])(t),d=h*u*96*39.37,f=t.isGeographic?256/i*295828763.7958547:256/i*591657527.591555;let p="vector-magdir"===e.dataType||"vector-uv"===e.dataType;const y=j(r,t);p||s&&(t.isGeographic||t.isWebMercator)&&(p=y.xmin*y.xmax<0);let b,m=d;const g=1.001;if(p){m=f;const e=t.isGeographic?1341104507446289e-21:.29858214164761665,i=e*(96*u*39.37),s=t.isGeographic?4326:3857;b=w(new l["a"]({x:e,y:e,spatialReference:{wkid:s}}),n,y),b.x*=m/i,b.y*=m/i}else{b={x:o.x,y:o.y};const t=Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2);let i=0;for(;m<f*(g/2)&&i<t;)i++,m*=2,b.x*=2,b.y*=2;Math.max(m,f)/Math.min(m,f)<=g&&(m=f)}const x=[m],v=[{x:b.x,y:b.y}],_=70.5310735,O=Math.min(_,d)/g;for(;m>=O;)m/=2,b.x/=2,b.y/=2,x.push(m),v.push({x:b.x,y:b.y});return{projectedPixelSize:c,scales:x,srcResolutions:v,isCustomTilingScheme:!p}}},d23c:function(e,t,i){"use strict";i.d(t,"a",(function(){return F}));var s=i("a4ee"),r=i("fc29"),a=i("59b2"),n=(i("b50f"),i("c120"),i("cea0"),i("d386")),o=i("2616"),l=i("c9ee"),c=i("c84e"),h=i("9a02");class u extends h["a"]{constructor(){super(...arguments),this.flowStyle=null}get requiresDedicatedFBO(){return!1}doRender(e){super.doRender(e)}prepareRenderPasses(e){const t=e.registerRenderPass({name:"flow",brushes:[l["a"]],target:()=>this.children,drawPhase:c["c"].MAP});return[...super.prepareRenderPasses(e),t]}}i("e06a");var d=i("e92d"),f=i("38a4"),p=i("b2b2"),y=i("f4cc"),b=i("4ae5");const m=d["a"].getLogger("esri.views.2d.engine.flow.FlowDisplayData");class g{constructor(e,t,i,s){this.state={name:"created"},this.flowStyle=e,this.extent=t,this.size=i,this.pixelRatio=s}async load(){const e=new AbortController;this.state={name:"loading",abortController:e};const t=await this.flowStyle.loadResources({extent:this.extent,size:this.size,pixelRatio:this.pixelRatio},e.signal);this.state={name:"loaded",resources:t}}prepareForRendering(e,t,i){if("loaded"!==this.state.name)return void m.error("Only loaded resources can be attached.");const s=this.state.resources;s.prepareForRendering(e,t,i),this.state={name:"attached",resources:s}}destroy(){if("loading"===this.state.name)return this.state.abortController.abort(),void(this.state={name:"detached"});"attached"===this.state.name&&(this.state.resources.detach(),this.state={name:"detached"})}update(e){return!!this.flowStyle.areResourcesCompatible(e.flowStyle)&&(!(!this.extent.equals(e.extent)||this.size[0]!==e.size[0]||this.size[1]!==e.size[1]||this.pixelRatio!==e.pixelRatio)&&(this.flowStyle=e.flowStyle,!0))}}var w=i("1c92"),x=i("8c71"),v=i("7c4b");class _ extends v["a"]{constructor(){super(...arguments),this._displayData=null}get displayData(){return this._displayData}set displayData(e){this._displayData=e,this.requestRender()}clear(){Object(p["k"])(this._displayData)&&(this._displayData.destroy(),this._displayData=null,this.requestRender())}setTransform(e){const{displayData:t}=this;if(Object(p["j"])(t))return;const i=t.extent.xmin,s=t.extent.ymax,r=[0,0];e.toScreen(r,[i,s]);const a=(t.extent.xmax-t.extent.xmin)/t.size[0]/e.resolution,n=Object(f["g"])(e.rotation),{dvs:o}=this.transforms;Object(w["b"])(o),Object(w["c"])(o,o,[-1,1,0]),Object(w["d"])(o,o,[2/(e.size[0]*e.pixelRatio),-2/(e.size[1]*e.pixelRatio),1]),Object(w["c"])(o,o,[r[0],r[1],0]),Object(w["j"])(o,o,n),Object(w["d"])(o,o,[a*e.pixelRatio,a*e.pixelRatio,1])}_createTransforms(){return{dvs:Object(x["b"])()}}}var O=i("3af1");const j=1.15,R=d["a"].getLogger("esri.views.2d.engine.flow.FlowStrategy");let P=class extends r["a"]{constructor(e){super(e),this._flowDisplayObject=new _,this._loading=null}initialize(){this.flowContainer.addChild(this._flowDisplayObject)}destroy(){this._clear(),this.flowContainer.removeAllChildren()}get updating(){return null!=this._loading}update(e){const{flowStyle:t}=this.flowContainer;if(Object(p["j"])(t))return void this._clear();const{extent:i,rotation:s,resolution:r,pixelRatio:a}=e.state,n=M(i,s);n.expand(j);const o=[Math.round((n.xmax-n.xmin)/r),Math.round((n.ymax-n.ymin)/r)],l=new g(t,n,o,a);if(Object(p["k"])(this._loading)){if(this._loading.update(l))return;this._loading.destroy(),this._loading=null}!Object(p["j"])(this._flowDisplayObject.displayData)&&this._flowDisplayObject.displayData.update(l)||(l.load().then(()=>{this._flowDisplayObject.clear(),this._flowDisplayObject.displayData=this._loading,this._loading=null},e=>{Object(y["l"])(e)||(R.error("A resource failed to load.",e),this._loading=null)}),this._loading=l)}_clear(){this._flowDisplayObject.clear(),Object(p["k"])(this._loading)&&(this._loading.destroy(),this._loading=null)}};Object(s["a"])([Object(a["b"])()],P.prototype,"_loading",void 0),Object(s["a"])([Object(a["b"])()],P.prototype,"flowContainer",void 0),Object(s["a"])([Object(a["b"])()],P.prototype,"updating",null),P=Object(s["a"])([Object(n["a"])("esri.views.2d.engine.flow.FlowStrategy")],P);const S=P;function M(e,t){const i=new b["a"]({x:(e.xmax+e.xmin)/2,y:(e.ymax+e.ymin)/2,spatialReference:e.spatialReference}),s=e.xmax-e.xmin,r=e.ymax-e.ymin,a=Math.abs(Math.cos(Object(f["g"])(t))),n=Math.abs(Math.sin(Object(f["g"])(t))),o=a*s+n*r,l=n*s+a*r,c=new O["a"]({xmin:i.x-o/2,ymin:i.y-l/2,xmax:i.x+o/2,ymax:i.y+l/2,spatialReference:e.spatialReference});return c.centerAt(i),c}var k=i("a915");function I(e){const t=Object(k["c"])(e.lineWidth),i=2*t,s=Math.round(Object(k["c"])(e.lineLength)/i)+1,r=t,a=10,n=e.lineColor.toRgba(),o=[n[0]/255,n[1]/255,n[2]/255,n[3]],{lineSpeed:l,fadeDuration:c,density:h}=e;return{lineRenderWidth:t,segmentLength:i,verticesPerLine:s,lineCollisionWidth:r,lineSpacing:a,lineColor:o,lineSpeed:l,fadeDuration:c,density:h,smoothing:Object(k["c"])(e.smoothing),velocityScale:1,minWeightThreshold:.001,minSpeedThreshold:.001,maxTurnAngle:1,mergeLines:!0,interpolate:!0,profile:!1}}var T=i("7ce4"),V=(i("d267"),i("1956"),i("d17d"),i("9f8b"),i("a1ff"),i("0fa6"));class C{constructor(e,t){this._vertexData=e,this._indexData=t}prepareForRendering(e,t,i){const s=T["a"].createVertex(e,35044,this._vertexData),r=T["a"].createIndex(e,35044,this._indexData),a=new V["a"](e,t,i,{geometry:s},r);this.vertexBuffer=s,this.indexBuffer=r,this.vertexArray=a,this._vertexData=null,this._indexData=null}detach(){this.vertexArray.dispose(),this.vertexBuffer.dispose(),this.indexBuffer.dispose()}}class D{constructor(e,t,i){this._loadImagery=e,this._createStreamlinesMesh=t,this._rendererSettings=I(i)}get animated(){return this._rendererSettings.lineSpeed>0}get renderSettings(){return this._rendererSettings}areResourcesCompatible(e){let t=!0;return t=t&&e._loadImagery===this._loadImagery,t=t&&e._createStreamlinesMesh===this._createStreamlinesMesh,t=t&&e._rendererSettings.verticesPerLine===this._rendererSettings.verticesPerLine,t=t&&e._rendererSettings.segmentLength===this._rendererSettings.segmentLength,t=t&&e._rendererSettings.lineSpacing===this._rendererSettings.lineSpacing,t=t&&e._rendererSettings.density===this._rendererSettings.density,t=t&&e._rendererSettings.smoothing===this._rendererSettings.smoothing,t=t&&e._rendererSettings.velocityScale===this._rendererSettings.velocityScale,t=t&&e._rendererSettings.minWeightThreshold===this._rendererSettings.minWeightThreshold,t=t&&e._rendererSettings.minSpeedThreshold===this._rendererSettings.minSpeedThreshold,t=t&&e._rendererSettings.mergeLines===this._rendererSettings.mergeLines,t=t&&e._rendererSettings.interpolate===this._rendererSettings.interpolate,t&&this._rendererSettings.mergeLines&&(t=e._rendererSettings.lineCollisionWidth===this._rendererSettings.lineCollisionWidth),!!t}async loadResources(e,t){const{extent:i,size:s}=e;Object(y["u"])(t);const r=await this._loadImagery(i,s[0],s[1],t),{vertexData:a,indexData:n}=await this._createStreamlinesMesh(this._rendererSettings,r,t);return new C(a,n)}}let z=class extends r["a"]{constructor(){super(...arguments),this._loadImagery=(e,t,i,s)=>Object(o["b"])(this.layer,e,t,i,s),this._createStreamlinesMesh=(e,t,i)=>this.layer.createStreamlinesMesh({flowData:t,rendererSettings:e},{signal:i}),this.container=null,this.layer=null,this.type="rasterAnimatedFlow",this.redrawOrRefetch=async()=>{this._rendererChanged()}}get updating(){return!this._strategy||this._strategy.updating}update(e){e.stationary?this._strategy.update(e):this.layerView.requestUpdate()}install(e){this.container=new u,e.addChild(this.container),this._strategy=new S({flowContainer:this.container}),this._rendererChanged()}uninstall(){this._strategy.destroy(),this.container.removeAllChildren(),this.container.remove()}moveEnd(){}async doRefresh(){}attach(){}_rendererChanged(){if("animated-flow"!==this.layer.renderer.type)return;const e=new D(this._loadImagery,this._createStreamlinesMesh,this.layer.renderer);this.container.flowStyle=e,this.layerView.requestUpdate()}};Object(s["a"])([Object(a["b"])()],z.prototype,"_strategy",void 0),Object(s["a"])([Object(a["b"])()],z.prototype,"container",void 0),Object(s["a"])([Object(a["b"])()],z.prototype,"layer",void 0),Object(s["a"])([Object(a["b"])()],z.prototype,"layerView",void 0),Object(s["a"])([Object(a["b"])()],z.prototype,"type",void 0),Object(s["a"])([Object(a["b"])()],z.prototype,"updating",null),z=Object(s["a"])([Object(n["a"])("esri.views.2d.engine.flow.AnimatedFlowView2D")],z);const F=z},e4b1:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i("1c92"),r=i("7c4b"),a=i("ae54");class n extends r["a"]{constructor(e,t,i,s,r,n=s,o=r){super(),this.triangleCountReportedInDebug=0,this.triangleCount=0,this.texture=null,this.key=new a["a"](e),this.x=t,this.y=i,this.width=s,this.height=r,this.rangeX=n,this.rangeY=o}destroy(){this.texture&&(this.texture.dispose(),this.texture=null)}setTransform(e,t){const i=t/(e.resolution*e.pixelRatio),r=this.transforms.tileMat3,[a,n]=e.toScreenNoRotation([0,0],[this.x,this.y]),o=this.width/this.rangeX*i,l=this.height/this.rangeY*i;Object(s["k"])(r,o,0,0,0,l,0,a,n,1),Object(s["h"])(this.transforms.dvs,e.displayViewMat3,r)}}}}]);
//# sourceMappingURL=chunk-1b15e1dd.c86a464c.js.map
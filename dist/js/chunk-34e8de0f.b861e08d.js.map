{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/views/2d/engine/webgl/materialKey/MaterialKey.js","webpack:///./node_modules/@arcgis/core/views/layers/RefreshableLayerView.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/webgl/definitions.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/meshUtils.js","webpack:///./node_modules/@arcgis/core/views/2d/layers/BaseDynamicLayerView2D.js","webpack:///./node_modules/@arcgis/core/views/2d/viewStateUtils.js","webpack:///./node_modules/@arcgis/core/views/2d/layers/support/ExportStrategy.js"],"names":["r","t","s","a","SIZE_FIELD_STOPS","SIZE_MINMAX_VALUE","SIZE_SCALE_STOPS","SIZE_UNIT_VALUE","FIELD_TARGETS_OUTLINE","MINMAX_TARGETS_OUTLINE","SCALE_TARGETS_OUTLINE","UNIT_TARGETS_OUTLINE","isOutline","isOutlinedFill","n","v","o","l","h","S","u","d","V","c","p","g","z","m","y","E","T","M","L","e","FILL","x","from","LINE","B","MARKER","U","TEXT","R","LABEL","b","Error","F","_","load","geometryType","this","_data","shared","data","bits","setBits","bit","setBit","i","mapAligned","pattern","sdf","textureBinding","I","super","hasVV","vvSizeMinMaxValue","vvSizeScaleStops","vvSizeFieldStops","vvSizeUnitValue","setVV","O","vvRotation","ROTATION","A","vvColor","COLOR","f","vvOpacity","OPACITY","dotDensity","stride","fill","simple","outlinedFill","vvFlags","getVariation","placement","handles","add","doRefresh","dataChanged","catch","getLogger","declaredClass","error","prototype","j","k","metrics","width","height","left","top","advance","C","D","G","H","J","K","N","P","Q","W","Y","Z","$","et","ct","ht","it","ot","at","dt","nt","strategy","update","notifyChange","_bitmapContainer","container","addChild","fetchSource","fetchBitmapData","bind","requestUpdate","destroy","removeChild","removeAllChildren","layer","fetchImage","updating","updateRequested","Math","PI","rotation","abs","cos","sin","size","round","imageMaxWidth","imageMaxHeight","imageRotationSupported","imageNormalizationSupported","hidpi","_imagePromise","bitmaps","stationary","destroyed","state","spatialReference","pixelRatio","worldScreenWidth","floor","extent","xmin","valid","xmax","paddedViewState","center","_singleExport","resolution","min","_tiledExport","then","async","children","includes","fadeOut","remove","fadeIn","visible","stage","invalidateTexture","requestRender","signal","ymax","_export","create","scales","scale","getTileCoverage","forEach","set","getTileBounds","push","Promise","all"],"mappings":"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","file":"js/chunk-34e8de0f.b861e08d.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport t from\"../../../../../core/Error.js\";import{WGLVVFlag as e,WGLVVTarget as i,WGLGeometryType as s}from\"../enums.js\";import{isMapAligned as a}from\"../mesh/templates/meshUtils.js\";function r(t,s){const a=e.SIZE_FIELD_STOPS|e.SIZE_MINMAX_VALUE|e.SIZE_SCALE_STOPS|e.SIZE_UNIT_VALUE,r=(t&(i.FIELD_TARGETS_OUTLINE|i.MINMAX_TARGETS_OUTLINE|i.SCALE_TARGETS_OUTLINE|i.UNIT_TARGETS_OUTLINE))>>>4;return s.isOutline||s.isOutlinedFill?a&r:a&~r}const n=0,v=8,o=7,l=8,h=11,S=11,u=12,d=13,V=14,c=15,p=15,g=16,z=17,m=18,y=19,E=20,T=21,M=22;function L(t,e){switch(t){case s.FILL:return x.from(e);case s.LINE:return B.from(e);case s.MARKER:return U.from(e);case s.TEXT:return R.from(e);case s.LABEL:return b.from(e);default:throw new Error(`Unable to createMaterialKey for unknown geometryType ${t}`)}}function F(t){switch(_.load(t).geometryType){case s.MARKER:return new U(t);case s.FILL:return new x(t);case s.LINE:return new B(t);case s.TEXT:return new R(t);case s.LABEL:return new b(t)}}class _{constructor(t){this._data=0,this._data=t}static load(t){const e=this.shared;return e.data=t,e}set data(t){this._data=t}get data(){return this._data}get geometryType(){return this.bits(l,h)}set geometryType(t){this.setBits(t,l,h)}get mapAligned(){return!!this.bit(E)}set mapAligned(t){this.setBit(E,t)}get sdf(){return!!this.bit(S)}set sdf(t){this.setBit(S,t)}get pattern(){return!!this.bit(u)}set pattern(t){this.setBit(u,t)}get textureBinding(){return this.bits(n,v)}set textureBinding(t){this.setBits(t,n,v)}get geometryTypeString(){switch(this.geometryType){case s.FILL:return\"fill\";case s.MARKER:return\"marker\";case s.LINE:return\"line\";case s.TEXT:return\"text\";case s.LABEL:return\"label\";default:throw new t(`Unable to handle unknown geometryType: ${this.geometryType}`)}}setBit(t,e){const i=1<<t;e?this._data|=i:this._data&=~i}bit(t){return(this._data&1<<t)>>t}setBits(t,e,i){for(let s=e,a=0;s<i;s++,a++)this.setBit(s,0!=(t&1<<a))}bits(t,e){let i=0;for(let s=t,a=0;s<e;s++,a++)i|=this.bit(s)<<a;return i}hasVV(){return!1}setVV(t,e){}getVariation(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}}getVariationHash(){return this._data&~(o&this.textureBinding)}}_.shared=new _(0);const I=t=>class extends t{get vvSizeMinMaxValue(){return 0!==this.bit(g)}set vvSizeMinMaxValue(t){this.setBit(g,t)}get vvSizeScaleStops(){return 0!==this.bit(z)}set vvSizeScaleStops(t){this.setBit(z,t)}get vvSizeFieldStops(){return 0!==this.bit(m)}set vvSizeFieldStops(t){this.setBit(m,t)}get vvSizeUnitValue(){return 0!==this.bit(y)}set vvSizeUnitValue(t){this.setBit(y,t)}hasVV(){return super.hasVV()||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}setVV(t,i){super.setVV(t,i);const s=r(t,i)&t;this.vvSizeMinMaxValue=!!(s&e.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(s&e.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(s&e.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(s&e.SIZE_SCALE_STOPS)}},O=t=>class extends t{get vvRotation(){return 0!==this.bit(c)}set vvRotation(t){this.setBit(c,t)}hasVV(){return super.hasVV()||this.vvRotation}setVV(t,i){super.setVV(t,i),this.vvRotation=!i.isOutline&&!!(t&e.ROTATION)}},A=t=>class extends t{get vvColor(){return 0!==this.bit(d)}set vvColor(t){this.setBit(d,t)}hasVV(){return super.hasVV()||this.vvColor}setVV(t,i){super.setVV(t,i),this.vvColor=!i.isOutline&&!!(t&e.COLOR)}},f=t=>class extends t{get vvOpacity(){return 0!==this.bit(V)}set vvOpacity(t){this.setBit(V,t)}hasVV(){return super.hasVV()||this.vvOpacity}setVV(t,i){super.setVV(t,i),this.vvOpacity=!i.isOutline&&!!(t&e.OPACITY)}};class x extends(A(f(I(_)))){static load(t){const e=this.shared;return e.data=t,e}static from(t){const e=this.load(0);return e.geometryType=s.FILL,e.dotDensity=\"dot-density\"===t.stride.fill,e.simple=\"simple\"===t.stride.fill,e.outlinedFill=t.isOutlinedFill,e.dotDensity||e.setVV(t.vvFlags,t),e.data}getVariation(){return{...super.getVariation(),dotDensity:this.dotDensity,outlinedFill:this.outlinedFill,simple:this.simple,vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}get dotDensity(){return!!this.bit(p)}set dotDensity(t){this.setBit(p,t)}get simple(){return!!this.bit(M)}set simple(t){this.setBit(M,t)}get outlinedFill(){return!!this.bit(T)}set outlinedFill(t){this.setBit(T,t)}}x.shared=new x(0);class U extends(A(f(O(I(_))))){static load(t){const e=this.shared;return e.data=t,e}static from(t){const e=this.load(0);return e.geometryType=s.MARKER,e.setVV(t.vvFlags,t),e.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}U.shared=new U(0);class B extends(A(f(I(_)))){static load(t){const e=this.shared;return e.data=t,e}static from(t){const e=this.load(0);return e.geometryType=s.LINE,e.setVV(t.vvFlags,t),e.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}B.shared=new B(0);class R extends(A(f(O(I(_))))){static load(t){const e=this.shared;return e.data=t,e}static from(t){const e=this.load(0);return e.geometryType=s.TEXT,e.setVV(t.vvFlags,t),e.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}R.shared=new R(0);class b extends(I(_)){static load(t){const e=this.shared;return e.data=t,e}static from(t){const e=this.load(0);return e.geometryType=s.LABEL,e.setVV(t.vvFlags,t),e.mapAligned=a(t.placement),e.data}getVariation(){return{...super.getVariation(),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}b.shared=new b(0);export{x as FillMaterialKey,b as LabelMaterialKey,B as LineMaterialKey,U as MarkerMaterialKey,_ as MaterialKeyBase,R as TextMaterialKey,L as createMaterialKey,r as getSizeFlagsMask,F as hydrateMaterialKey};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/watchUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const i=i=>{let c=class extends i{initialize(){this.handles.add(o(this,\"layer\",\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([a(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{i as RefreshableLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nconst t=8,e=t-2,c=1e-30,h=64,i=4294967295,o=512,a=256,d=256/360,n=!1,p=128,r=8,s=29,f=1,g=16,l=16,m=o/p,v=8,w=50,x=10,b=24,j=8,k={metrics:{width:15,height:17,left:0,top:-7,advance:14}},q=1024,u=0,y=0,z=0,A=1,B=2,C=3,D=4,E=5,F=6,G=5,H=6,I=0,J=1,K=2,L=3,M=3,N=2,O=1,P=2,Q=4,R=!1,S=1.05,T=6,U=5,V=6,W=1.15,X=2,Y=2,Z=8,$=500,_=4,tt=128,et=10,ct=2,ht=0,it=1,ot=4,at=8,dt=4,nt=1;export{d as ANGLE_FACTOR_256,J as ATTRIBUTE_DATA_ANIMATION,L as ATTRIBUTE_DATA_DD0,M as ATTRIBUTE_DATA_DD1,I as ATTRIBUTE_DATA_FILTER_FLAGS,K as ATTRIBUTE_DATA_VV,q as ATTRIBUTE_STORE_TEXTURE_SIZE,k as AVERAGE_GLYPH_MOSAIC_ITEM,ct as BITSET_GENERIC_LOCK_COLOR,dt as BITSET_LINE_SCALE_DASH,it as BITSET_MARKER_ALIGNMENT_MAP,ht as BITSET_MARKER_ALIGNMENT_SCREEN,ot as BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE,at as BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY,nt as BITSET_TYPE_FILL_OUTLINE,tt as BUFFER_DATA_MINIMUM_SIZE,_ as BUFFER_DATA_POOL_SIZE,l as COLLISION_BOX_PADDING,p as COLLISION_BUCKET_SIZE,g as COLLISION_EARLY_REJECT_BUCKET_SIZE,f as COLLISION_MAX_ZOOM_DELTA,v as COLLISION_PLACEMENT_PADDING,m as COLLISION_TILE_BOX_SIZE,n as DEBUG_LABELS,Z as DISPLAY_RECORD_INT_PER_ELEMENT,r as DOT_DENSITY_MAX_FIELDS,Q as EFFECT_FLAG_0,R as ENABLE_EARLY_LABEL_DISCARD,h as EXTRUDE_SCALE,P as FILTER_FLAG_0,b as GLYPH_SIZE,x as HEURISTIC_GLYPHS_PER_FEATURE,w as HEURISTIC_GLYPHS_PER_LINE,O as HIGHLIGHT_FLAG,T as HITTEST_SEARCH_SIZE,s as MAGIC_LABEL_LINE_HEIGHT,N as MAX_FILTERS,X as MAX_GPU_UPLOADS_PER_FRAME,et as MIN_MAX_ZOOM_PRECISION_FACTOR,c as NAN_MAGIC_NUMBER,$ as PATCH_PIXEL_BUFFER_ALLOC_SIZE,i as PICTURE_FILL_COLOR,a as RASTER_TILE_SIZE,Y as SPRITE_PADDING,A as TEXTURE_BINDING_ATTRIBUTE_DATA_0,B as TEXTURE_BINDING_ATTRIBUTE_DATA_1,C as TEXTURE_BINDING_ATTRIBUTE_DATA_2,D as TEXTURE_BINDING_ATTRIBUTE_DATA_3,z as TEXTURE_BINDING_BITMAP,y as TEXTURE_BINDING_GLYPH_ATLAS,E as TEXTURE_BINDING_HIGHLIGHT_0,F as TEXTURE_BINDING_HIGHLIGHT_1,G as TEXTURE_BINDING_RENDERER_0,H as TEXTURE_BINDING_RENDERER_1,u as TEXTURE_BINDING_SPRITE_ATLAS,j as TEXT_PLACEMENT_PADDING,S as THIN_LINE_HALF_WIDTH_THRESHOLD,o as TILE_SIZE,W as VTL_HIGH_RES_CUTOFF,V as VTL_TEXTURE_BINDING_UNIT_GLYPHS,U as VTL_TEXTURE_BINDING_UNIT_SPRITES,e as WEBGL_MAX_INNER_STOPS,t as WEBGL_MAX_STOPS};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nfunction e(e){switch(e){case\"above-along\":case\"below-along\":case\"center-along\":case\"esriServerLinePlacementAboveAlong\":case\"esriServerLinePlacementBelowAlong\":case\"esriServerLinePlacementCenterAlong\":return!0;default:return!1}}export{e as isMapAligned};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import e from\"../../../core/Logger.js\";import{isAbortError as r}from\"../../../core/promiseUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import{BitmapContainer as a}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as o}from\"./LayerView2D.js\";import p from\"./support/ExportStrategy.js\";import n from\"../../layers/LayerView.js\";import{RefreshableLayerView as m}from\"../../layers/RefreshableLayerView.js\";const h=e.getLogger(\"esri.views.2d.layers.BaseDynamicLayerView2D\");let c=class extends(m(o(n))){update(t){this.strategy.update(t).catch((t=>{r(t)||h.error(t)})),this.notifyChange(\"updating\")}attach(){this._bitmapContainer=new a,this.container.addChild(this._bitmapContainer),this.strategy=new p({container:this._bitmapContainer,fetchSource:this.fetchBitmapData.bind(this),requestUpdate:this.requestUpdate.bind(this)})}detach(){this.strategy.destroy(),this.strategy=null,this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}fetchBitmapData(t,e,r){return this.layer.fetchImage(t,e,r)}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}};t([s()],c.prototype,\"strategy\",void 0),t([s()],c.prototype,\"updating\",void 0),c=t([i(\"esri.views.2d.layers.BaseDynamicLayerView2D\")],c);const d=c;export{d as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nconst t=Math.PI/180;function n(n){return n*t}function o(t,n,o){const{resolution:r,size:u}=o;return t[0]=r*(Math.round(n[0]/r)+u[0]%2*.5),t[1]=r*(Math.round(n[1]/r)+u[1]%2*.5),t}function r(t,o){const r=n(o.rotation),u=Math.abs(Math.cos(r)),a=Math.abs(Math.sin(r)),[s,c]=o.size;return t[0]=Math.round(c*a+s*u),t[1]=Math.round(c*u+s*a),t}function u(t,n,o,r){const[u,a]=n,[s,c]=r,i=.5*o;return t[0]=u-i*s,t[1]=a-i*c,t[2]=u+i*s,t[3]=a+i*c,t}function a(t,n){const[o,r,u,a]=t,[s,c,i,e]=n;return!(o>i||u<s||r>e||a<c)}export{a as bboxIntersects,u as getBBox,r as getOuterSize,o as snapToPixel};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../core/Accessor.js\";import{debounce as i}from\"../../../../core/promiseUtils.js\";import{property as o}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as r}from\"../../../../core/accessorSupport/decorators/subclass.js\";import s from\"../../../../geometry/Extent.js\";import{create as a}from\"../../../../geometry/support/aaBoundingRect.js\";import{getInfo as p}from\"../../../../geometry/support/spatialReferenceUtils.js\";import n from\"../../../../layers/support/TileInfo.js\";import{getOuterSize as m,getBBox as l}from\"../../viewStateUtils.js\";import{Bitmap as d}from\"../../engine/Bitmap.js\";import h from\"../../tiling/TileInfoView.js\";import c from\"../../tiling/TileKey.js\";const u=a(),g=[0,0],f=new c(0,0,0,0),x={container:null,fetchSource:null,requestUpdate:null,imageMaxWidth:2048,imageMaxHeight:2048,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1};let y=class extends e{constructor(t){super(t),this._imagePromise=null,this.bitmaps=[],this.hidpi=x.hidpi,this.imageMaxWidth=x.imageMaxWidth,this.imageMaxHeight=x.imageMaxHeight,this.imageRotationSupported=x.imageRotationSupported,this.imageNormalizationSupported=x.imageNormalizationSupported,this.update=i((async(t,e)=>{if(!t.stationary||this.destroyed)return null;const i=t.state,o=p(i.spatialReference),r=this.hidpi?t.pixelRatio:1,s=this.imageNormalizationSupported&&i.worldScreenWidth&&i.worldScreenWidth<i.size[0];s?(g[0]=i.worldScreenWidth,g[1]=i.size[1]):this.imageRotationSupported?(g[0]=i.size[0],g[1]=i.size[1]):m(g,i);const a=Math.floor(g[0]*r)>this.imageMaxWidth||Math.floor(g[1]*r)>this.imageMaxHeight,n=o&&(i.extent.xmin<o.valid[0]||i.extent.xmax>o.valid[1]),l=!this.imageNormalizationSupported&&n,d=!a&&!l,h=this.imageRotationSupported?i.rotation:0;if(d){const t=s?i.paddedViewState.center:i.center;this._imagePromise=this._singleExport(i,g,t,i.resolution,h,r,e)}else{let t=Math.min(this.imageMaxWidth,this.imageMaxHeight);l&&(t=Math.min(i.worldScreenWidth,t)),this._imagePromise=this._tiledExport(i,t,h,r,e)}return this._imagePromise.then((async t=>{if(this._imagePromise=null,!this.destroyed){this.bitmaps=null!=t?t:[];for(const e of this.container.children)t.includes(e)||e.fadeOut().then((()=>{e.remove()}));for(const e of t)this.container.addChild(e),e.fadeIn()}})).catch((t=>{throw this._imagePromise=null,t}))}),5e3)}destroy(){this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}updateExports(t){for(const e of this.container.children){if(!e.visible||!e.stage)return;t(e),e.invalidateTexture(),e.requestRender()}}async _export(t,e,i,o,r,s){const a=await this.fetchSource(t,Math.floor(e*r),Math.floor(i*r),{rotation:o,pixelRatio:r,signal:s}),p=new d(a,\"additive\");return p.x=t.xmin,p.y=t.ymax,p.resolution=t.width/e,p.rotation=o,p.pixelRatio=r,p}async _singleExport(t,e,i,o,r,a,p){l(u,i,o,e);const n=new s(u[0],u[1],u[2],u[3],t.spatialReference);return[await this._export(n,e[0],e[1],r,a,p)]}_tiledExport(t,e,i,o,r){const a=n.create({size:e,spatialReference:t.spatialReference,scales:[t.scale]}),p=new h(a),m=p.getTileCoverage(t);if(!m)return null;const l=[];return m.forEach(((a,n,m,d)=>{f.set(a,n,m,d),p.getTileBounds(u,f);const h=new s(u[0],u[1],u[2],u[3],t.spatialReference);l.push(this._export(h,e,e,i,o,r))})),Promise.all(l)}};t([o()],y.prototype,\"_imagePromise\",void 0),t([o()],y.prototype,\"bitmaps\",void 0),t([o()],y.prototype,\"container\",void 0),t([o()],y.prototype,\"fetchSource\",void 0),t([o()],y.prototype,\"hidpi\",void 0),t([o()],y.prototype,\"imageMaxWidth\",void 0),t([o()],y.prototype,\"imageMaxHeight\",void 0),t([o()],y.prototype,\"imageRotationSupported\",void 0),t([o()],y.prototype,\"imageNormalizationSupported\",void 0),t([o()],y.prototype,\"requestUpdate\",void 0),t([o()],y.prototype,\"updating\",null),y=t([r(\"esri.views.2d.layers.support.ExportStrategy\")],y);const S=y;export{S as default};\n"],"sourceRoot":""}
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b4b77ea"],{"405c":function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return f})),i.d(t,"c",(function(){return n})),i.d(t,"d",(function(){return m}));var r=i("661c"),o=i("a9ab"),a=i("0eee");function n(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":{const t=e.symbolLayers;return t&&1===t.length?n(t[0]):null}case"CIMVectorMarker":{var t;const i=e.markerGraphics;if(!i||1!==i.length)return null;const r=i[0];if(!r)return null;const o=r.geometry;if(!o)return null;const a=r.symbol;return!a||"CIMPolygonSymbol"!==a.type&&"CIMLineSymbol"!==a.type||null!=(t=a.symbolLayers)&&t.some(e=>!!e.effects)?null:{geom:o,asFill:"CIMPolygonSymbol"===a.type}}case"sdf":return{geom:e.geom,asFill:e.asFill}}return null}function s(e){return e?e.rings?e.rings:e.paths?e.paths:void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:null:null}function c(e){let t=1/0,i=-1/0,r=1/0,o=-1/0;for(const a of e)for(const e of a)e[0]<t&&(t=e[0]),e[0]>i&&(i=e[0]),e[1]<r&&(r=e[1]),e[1]>o&&(o=e[1]);return new a["a"](t,r,i-t,o-r)}function l(e){let t=1/0,i=-1/0,r=1/0,o=-1/0;for(const a of e)for(const e of a)e[0]<t&&(t=e[0]),e[0]>i&&(i=e[0]),e[1]<r&&(r=e[1]),e[1]>o&&(o=e[1]);return[t,r,i,o]}function f(e){return e?e.rings?l(e.rings):e.paths?l(e.paths):Object(o["d"])(e)?[e.xmin,e.ymin,e.xmax,e.ymax]:null:null}function m(e,t,i,r,o){const[a,n,s,c]=e;if(s<a||c<n)return[0,0,0];const l=s-a,f=c-n,m=128,h=1,u=Math.floor(.5*(.5*m-h)),y=(m-2*(u+h))/Math.max(l,f),b=Math.round(l*y)+2*u,g=Math.round(f*y)+2*u;let p=1;t&&(p=g/y/(t.ymax-t.ymin));let d=0,O=0;if(r)if(o){if(t&&i&&t.ymax-t.ymin>0){const e=(t.xmax-t.xmin)/(t.ymax-t.ymin);d=r.x/(i*e),O=r.y/i}}else d=r.x,O=r.y;return d=.5*(t.xmax+t.xmin)+d*(t.xmax-t.xmin),O=.5*(t.ymax+t.ymin)+O*(t.ymax-t.ymin),d-=a,O-=n,d*=y,O*=y,d+=u,O+=u,[p,d/b-.5,-(O/g-.5)]}function h(e){const t=s(e.geom),i=c(t),r=128,o=1,a=Math.floor(.5*(.5*r-o)),n=(r-2*(a+o))/Math.max(i.width,i.height),l=Math.round(i.width*n)+2*a,f=Math.round(i.height*n)+2*a,m=[];for(const s of t)if(s&&s.length>1){const t=[];for(const r of s){let[o,s]=r;o-=i.x,s-=i.y,o*=n,s*=n,o+=a-.5,s+=a-.5,e.asFill?t.push([o,s]):t.push([Math.round(o),Math.round(s)])}if(e.asFill){const e=t.length-1;t[0][0]===t[e][0]&&t[0][1]===t[e][1]||t.push(t[0])}m.push(t)}const h=u(m,l,f,a);return e.asFill&&y(m,l,f,a,h),[b(h,a),l,f]}function u(e,t,i,r){const o=t*i,a=new Array(o),n=r*r+1;for(let s=0;s<o;++s)a[s]=n;for(const s of e){const e=s.length;for(let o=1;o<e;++o){const e=s[o-1],n=s[o];let c,l,f,m;e[0]<n[0]?(c=e[0],l=n[0]):(c=n[0],l=e[0]),e[1]<n[1]?(f=e[1],m=n[1]):(f=n[1],m=e[1]);let h=Math.floor(c)-r,u=Math.floor(l)+r,y=Math.floor(f)-r,b=Math.floor(m)+r;h<0&&(h=0),u>t&&(u=t),y<0&&(y=0),b>i&&(b=i);const g=n[0]-e[0],p=n[1]-e[1],d=g*g+p*p;for(let r=h;r<u;r++)for(let o=y;o<b;o++){let s,c,l=(r-e[0])*g+(o-e[1])*p;l<0?(s=e[0],c=e[1]):l>d?(s=n[0],c=n[1]):(l/=d,s=e[0]+l*g,c=e[1]+l*p);const f=(r-s)*(r-s)+(o-c)*(o-c),m=(i-o-1)*t+r;f<a[m]&&(a[m]=f)}}}for(let s=0;s<o;++s)a[s]=Math.sqrt(a[s]);return a}function y(e,t,i,r,o){for(const a of e){const e=a.length;for(let n=1;n<e;++n){const e=a[n-1],s=a[n];let c,l,f,m;e[0]<s[0]?(c=e[0],l=s[0]):(c=s[0],l=e[0]),e[1]<s[1]?(f=e[1],m=s[1]):(f=s[1],m=e[1]);let h=Math.floor(c),u=Math.floor(l)+1,y=Math.floor(f),b=Math.floor(m)+1;h<r&&(h=r),u>t-r&&(u=t-r),y<r&&(y=r),b>i-r&&(b=i-r);for(let a=y;a<b;++a){if(e[1]>a==s[1]>a)continue;const n=(i-a-1)*t;for(let t=h;t<u;++t)t<(s[0]-e[0])*(a-e[1])/(s[1]-e[1])+e[0]&&(o[n+t]=-o[n+t]);for(let e=r;e<h;++e)o[n+e]=-o[n+e]}}}}function b(e,t){const i=2*t,o=e.length,a=new Uint8Array(4*o);for(let n=0;n<o;++n){const t=.5-e[n]/i;Object(r["a"])(t,a,4*n)}return a}},"4fcb":function(e,t,i){"use strict";i.d(t,"a",(function(){return $})),i.d(t,"b",(function(){return v}));var r=i("9ef0"),o=i("e92d"),a=i("b2b2"),n=i("a915"),s=i("b3b6"),c=i("82fa"),l=i("793f"),f=i("405c"),m=i("36b8"),h=i("5dbb"),u=i("89cb");const y=o["a"].getLogger("esri.symbols.cim.cimAnalyzer");function b(e){switch(e){case"Butt":return 0;case"Square":return 2;default:return 1}}function g(e){switch(e){case"Bevel":return 0;case"Miter":return 2;default:return 1}}function p(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function d(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function O(e){let t="",i="";if(e){const r=e.toLowerCase();-1!==r.indexOf("italic")?t="italic":-1!==r.indexOf("oblique")&&(t="oblique"),-1!==r.indexOf("bold")?i="bold":-1!==r.indexOf("light")&&(i="lighter")}return{style:t,weight:i}}function S(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}function C(e,t,i,r){let o;e[t]?o=e[t]:(o={},e[t]=o),o[i]=r}function M(e){const t=e.markerPlacement;return t&&t.angleToLine?1:0}async function v(e,t,i,r,o){const a=null!=r?r:[];if(!e)return a;let n,s;const l={};if("CIMSymbolReference"!==e.type)return y.error("Expect cim type to be 'CIMSymbolReference'"),a;if(n=e.symbol,s=e.primitiveOverrides,s){const e=[];for(const i of s){const r=i.valueExpressionInfo;if(r&&t){const o=r.expression,a=Object(c["d"])(o,t.spatialReference,t.fields).then(e=>{e&&C(l,i.primitiveName,i.propertyName,e)});e.push(a)}else null!=i.value&&C(l,i.primitiveName,i.propertyName,i.value)}e.length>0&&await Promise.all(e)}const f=[];switch(W(n,i,f),f.length>0&&await Promise.all(f),n.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":k(n,s,l,t,a,i,o)}return a}function k(e,t,i,r,o,a,n){if(!e)return;const s=e.symbolLayers;if(!s)return;const c=e.effects;let f;const m=l["b"].getSize(e);"CIMPointSymbol"===e.type&&"Map"===e.angleAlignment&&(f=1);let h=s.length;for(;h--;){const u=s[h];if(!u||!1===u.enable)continue;let b;c&&c.length&&(b=[...c]);const g=u.effects;g&&g.length&&(c?b.push(...g):b=[...g]);const p=[];switch(l["c"].findApplicableOverrides(u,t,p),u.type){case"CIMSolidFill":j(u,b,i,p,r,o);break;case"CIMPictureFill":x(u,b,i,p,r,a,o);break;case"CIMHatchFill":P(u,b,i,p,r,o);break;case"CIMGradientFill":I(u,b,i,p,r,o);break;case"CIMSolidStroke":w(u,b,i,p,r,o,"CIMPolygonSymbol"===e.type,m);break;case"CIMPictureStroke":z(u,b,i,p,r,o,"CIMPolygonSymbol"===e.type,m);break;case"CIMGradientStroke":N(u,b,i,p,r,o,"CIMPolygonSymbol"===e.type,m);break;case"CIMCharacterMarker":if(L(u,b,i,p,r,o))break;break;case"CIMPictureMarker":if(L(u,b,i,p,r,o))break;"CIMLineSymbol"===e.type&&(f=M(u)),X(u,b,i,p,r,a,o,f,m);break;case"CIMVectorMarker":if(L(u,b,i,p,r,o))break;"CIMLineSymbol"===e.type&&(f=M(u)),R(u,b,i,p,r,o,a,f,m,n);break;default:y.error("Cannot analyze CIM layer",u.type)}}}function j(e,t,i,r,o,a){const n=e.primitiveName,c=Object(m["e"])(e.color),[l,f]=U(r,n),h=Object(s["b"])(JSON.stringify(e)+f).toString();a.push({type:"fill",templateHash:h,materialHash:l?()=>h:h,cim:e,materialOverrides:null,colorLocked:e.colorLocked,color:T(n,i,"Color",o,c,D),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:t})}function x(e,t,i,r,o,n,c){const l=e.primitiveName,f=e.tintColor?Object(m["e"])(e.tintColor):{r:255,g:255,b:255,a:1},[h,u]=U(r,l),y=Object(s["b"])(JSON.stringify(e)+u).toString(),b=Object(s["b"])(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString();let g=Object(m["f"])(e.scaleX);if("width"in e){const t=e.width;let i=1;const r=n.getResource(e.url);Object(a["l"])(r)&&(i=r.width/r.height),g/=i*(e.height/t)}c.push({type:"fill",templateHash:y,materialHash:h?()=>b:b,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:t,color:T(l,i,"TintColor",o,f,D),height:T(l,i,"Height",o,e.height),scaleX:T(l,i,"ScaleX",o,g),angle:T(l,i,"Rotation",o,Object(m["f"])(e.rotation)),offsetX:T(l,i,"OffsetX",o,Object(m["f"])(e.offsetX)),offsetY:T(l,i,"OffsetY",o,Object(m["f"])(e.offsetY)),url:e.url})}function P(e,t,i,r,o,a){const n=["Rotation","OffsetX","OffsetY"],c=r.filter(t=>t.primitiveName!==e.primitiveName&&-1===n.indexOf(t.propertyName)),l=e.primitiveName,[f,h]=U(r,l),u=Object(s["b"])(JSON.stringify(e)+h).toString(),y=Object(s["b"])(`${e.separation}${JSON.stringify(e.lineSymbol)}`).toString();a.push({type:"fill",templateHash:u,materialHash:f?G(y,i,c,o):y,cim:e,materialOverrides:c,colorLocked:e.colorLocked,effects:t,color:{r:255,g:255,b:255,a:1},height:T(l,i,"Separation",o,e.separation),scaleX:1,angle:T(l,i,"Rotation",o,Object(m["f"])(e.rotation)),offsetX:T(l,i,"OffsetX",o,Object(m["f"])(e.offsetX)),offsetY:T(l,i,"OffsetY",o,Object(m["f"])(e.offsetY))})}function I(e,t,i,r,o,a){const n=e.primitiveName,[c,l]=U(r,n),f=Object(s["b"])(JSON.stringify(e)+l).toString();a.push({type:"fill",templateHash:f,materialHash:c?G(f,i,r,o):f,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:t,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function w(e,t,i,r,o,a,n,c){const l=e.primitiveName,f=Object(m["e"])(e.color),h=void 0!==e.width?e.width:4,u=b(e.capStyle),y=g(e.joinStyle),p=e.miterLimit,[d,O]=U(r,l),S=Object(s["b"])(JSON.stringify(e)+O).toString();let C,M;if(t&&t.length>0){const i=t[t.length-1];if("CIMGeometricEffectDashes"===i.type&&"NoConstraint"===i.lineDashEnding){const i=(t=[...e.effects]).pop();C=i.dashTemplate,M=i.scaleDash}}a.push({type:"line",templateHash:S,materialHash:d?()=>S:S,cim:e,materialOverrides:null,isOutline:n,colorLocked:e.colorLocked,effects:t,color:T(l,i,"Color",o,f,D),width:T(l,i,"Width",o,h),cap:T(l,i,"CapStyle",o,u),join:T(l,i,"JoinStyle",o,y),miterLimit:T(l,i,"MiterLimit",o,p),referenceWidth:c,zOrder:J(e.name),dashTemplate:C,scaleDash:M})}function z(e,t,i,r,o,a,n,c){const l=Object(s["b"])(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),f=e.primitiveName,h=Object(m["e"])(e.tintColor),u=void 0!==e.width?e.width:4,y=b(e.capStyle),p=g(e.joinStyle),d=e.miterLimit,[O,S]=U(r,f),C=Object(s["b"])(JSON.stringify(e)+S).toString();a.push({type:"line",templateHash:C,materialHash:O?()=>l:l,cim:e,materialOverrides:null,isOutline:n,colorLocked:e.colorLocked,effects:t,color:T(f,i,"TintColor",o,h,D),width:T(f,i,"Width",o,u),cap:T(f,i,"CapStyle",o,y),join:T(f,i,"JoinStyle",o,p),miterLimit:T(f,i,"MiterLimit",o,d),referenceWidth:c,zOrder:J(e.name),dashTemplate:null,scaleDash:!1,url:e.url})}function N(e,t,i,r,o,a,n,c){const l=e.primitiveName,f=void 0!==e.width?e.width:4,m=b(e.capStyle),h=g(e.joinStyle),u=e.miterLimit,[y,p]=U(r,l),d=Object(s["b"])(JSON.stringify(e)+p).toString();a.push({type:"line",templateHash:d,materialHash:y?G(d,i,r,o):d,cim:e,materialOverrides:null,isOutline:n,colorLocked:e.colorLocked,effects:t,color:{r:128,g:128,b:128,a:1},width:T(l,i,"Width",o,f),cap:T(l,i,"CapStyle",o,m),join:T(l,i,"JoinStyle",o,h),miterLimit:T(l,i,"MiterLimit",o,u),referenceWidth:c,zOrder:J(e.name),dashTemplate:null,scaleDash:!1})}function L(e,t,i,r,o,a){const n=e.markerPlacement;if(!n||"CIMMarkerPlacementInsidePolygon"!==n.type)return!1;const c=n,l=["Rotation","OffsetX","OffsetY"],f=r.filter(t=>t.primitiveName!==e.primitiveName&&-1===l.indexOf(t.propertyName)),h="url"in e?e.url:null,[u,y]=U(r,c.primitiveName),b=Object(s["b"])(JSON.stringify(e)+y).toString();let g=c.stepY,p=null,d=1;return n.shiftOddRows&&(g*=2,p=function(e){return e?2*e:0},d=.5),a.push({type:"fill",templateHash:b,materialHash:u?G(b,i,f,o):b,cim:e,materialOverrides:f,colorLocked:e.colorLocked,effects:t,color:{r:255,g:255,b:255,a:1},height:T(c.primitiveName,i,"StepY",o,g,p),scaleX:d,angle:T(c.primitiveName,i,"GridAngle",o,c.gridAngle),offsetX:T(c.primitiveName,i,"OffsetX",o,Object(m["f"])(c.offsetX)),offsetY:T(c.primitiveName,i,"OffsetY",o,Object(m["f"])(c.offsetY)),url:h}),!0}function X(e,t,i,r,o,n,c,l,f){var h;const u=e.primitiveName,y=Object(m["f"])(e.size);let b=Object(m["f"])(e.scaleX);const g=Object(m["f"])(e.rotation),p=Object(m["f"])(e.offsetX),d=Object(m["f"])(e.offsetY),O=e.tintColor?Object(m["e"])(e.tintColor):{r:255,g:255,b:255,a:1},S=Object(s["b"])(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),[C,M]=U(r,u),v=Object(s["b"])(JSON.stringify(e)+M).toString(),k=null!=(h=e.anchorPoint)?h:{x:0,y:0};if("width"in e){const t=e.width;let i=1;const r=n.getResource(e.url);Object(a["l"])(r)&&(i=r.width/r.height),b/=i*(y/t)}c.push({type:"marker",templateHash:v,materialHash:C?()=>S:S,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:!1,alignment:l,size:T(u,i,"Size",o,y),scaleX:T(u,i,"ScaleX",o,b),rotation:T(u,i,"Rotation",o,g),offsetX:T(u,i,"OffsetX",o,p),offsetY:T(u,i,"OffsetY",o,d),color:T(u,i,"TintColor",o,O,D),anchorPoint:{x:k.x,y:-k.y},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:e.rotateClockwise,referenceSize:f,sizeRatio:1,markerPlacement:e.markerPlacement,url:e.url})}function R(e,t,i,r,o,a,n,s,c,l){const f=e.markerGraphics;if(!f)return;let m=0;if(e.scaleSymbolsProportionally){const t=e.frame;t&&(m=t.ymax-t.ymin)}for(const h of f)if(h){const f=h.symbol;if(!f)continue;switch(f.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":Y(e,t,h,r,i,o,a,n,s,c,m,l);break;case"CIMTextSymbol":_(e,t,h,i,r,o,a,s,c,m)}}}function _(e,t,i,r,o,a,n,c,f,h){const u=[];l["c"].findApplicableOverrides(i,o,u);const y=i.geometry;if(!("x"in y)||!("y"in y))return;const b=i.symbol,g=S(b),C=O(b.fontStyleName),M=Object(m["m"])(b.fontFamilyName);b.font={family:M,decoration:g,...C};const v=e.frame,k=y.x-.5*(v.xmin+v.xmax),j=y.y-.5*(v.ymin+v.ymax),x=e.size/h,P=e.primitiveName,I=Object(m["f"])(b.height)*x,w=Object(m["f"])(b.angle),z=(Object(m["f"])(b.offsetX)+k)*x,N=(Object(m["f"])(b.offsetY)+j)*x,L=Object(m["e"])(l["b"].getFillColor(b));let X=Object(m["e"])(l["b"].getStrokeColor(b)),R=l["b"].getStrokeWidth(b);R||(X=Object(m["e"])(l["b"].getFillColor(b.haloSymbol)),R=b.haloSize*x);const[_,Y]=U(o,P),A=JSON.stringify(e.effects)+Number(e.colorLocked)+JSON.stringify(e.anchorPoint)+e.anchorPointUnits+JSON.stringify(e.markerPlacement),F=Object(s["b"])(JSON.stringify(i)+A+Y).toString(),H=T(i.primitiveName,r,"TextString",a,i.textString,m["a"],b.textCase),{fontStyleName:J}=b,D=M+(J?"-"+J.toLowerCase():"-regular"),G=D;n.push({type:"text",templateHash:F,materialHash:_||"function"==typeof H||H.match(/\[(.*?)\]/)?(e,t,i)=>G+"-"+Object(m["d"])(H,e,t,i):G+"-"+Object(s["b"])(H),cim:b,materialOverrides:null,colorLocked:e.colorLocked,effects:t,alignment:c,anchorPoint:{x:e.anchorPoint?e.anchorPoint.x:0,y:e.anchorPoint?e.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,fontName:D,decoration:g,weight:T(P,r,"Weight",a,C.weight),style:T(P,r,"Size",a,C.style),size:T(P,r,"Size",a,I),angle:T(P,r,"Rotation",a,w),offsetX:T(P,r,"OffsetX",a,z),offsetY:T(P,r,"OffsetY",a,N),horizontalAlignment:p(b.horizontalAlignment),verticalAlignment:d(b.verticalAlignment),text:H,color:L,outlineColor:X,outlineSize:R,referenceSize:f,sizeRatio:1,markerPlacement:e.markerPlacement})}function Y(e,t,i,r,o,a,n,c,u,y,b,g){const p=i.symbol,d=p.symbolLayers;if(!d)return;if(g)return void F(e,t,i,o,r,a,n,c,u,y,b);let O=d.length;if(E(d))return void A(e,i,d,r,o,a,n,u,y,b);const S=h["a"].applyEffects(p.effects,i.geometry);if(S)for(;O--;){const g=d[O];if(g&&!1!==g.enable)switch(g.type){case"CIMSolidFill":case"CIMSolidStroke":{var C;const c=h["a"].applyEffects(g.effects,S),p=Object(f["b"])(c);if(!p)continue;const[d,O,M]=Object(f["d"])(p,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),v="CIMSolidFill"===g.type,k={type:"sdf",geom:c,asFill:v},j=e.primitiveName,x=null!=(C=Object(m["f"])(e.size))?C:10,P=Object(m["f"])(e.rotation),I=Object(m["f"])(e.offsetX),w=Object(m["f"])(e.offsetY),z=g.path,N=g.primitiveName,L=Object(m["e"])(v?l["b"].getFillColor(g):l["b"].getStrokeColor(g)),X=v?{r:0,g:0,b:0,a:0}:Object(m["e"])(l["b"].getStrokeColor(g)),R=l["b"].getStrokeWidth(g);if(!v&&!R)break;let _=!1,Y="";for(const e of r)e.primitiveName!==N&&e.primitiveName!==j||(void 0!==e.value?Y+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`:e.valueExpressionInfo&&(_=!0));const A=JSON.stringify({...e,markerGraphics:null}),F=Object(s["b"])(JSON.stringify(k)+z).toString(),H={type:"marker",templateHash:Object(s["b"])(JSON.stringify(i)+JSON.stringify(g)+A+Y).toString(),materialHash:_?()=>F:F,cim:k,materialOverrides:null,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:u,anchorPoint:{x:O,y:M},isAbsoluteAnchorPoint:!1,size:T(e.primitiveName,o,"Size",a,x),rotation:T(e.primitiveName,o,"Rotation",a,P),offsetX:T(e.primitiveName,o,"OffsetX",a,I),offsetY:T(e.primitiveName,o,"OffsetY",a,w),scaleX:1,frameHeight:b,rotateClockwise:e.rotateClockwise,referenceSize:y,sizeRatio:d,color:T(N,o,"Color",a,L,D),outlineColor:T(N,o,"Color",a,X,D),outlineWidth:T(N,o,"Width",a,R),markerPlacement:e.markerPlacement,path:z};n.push(H);break}default:F(e,t,i,o,r,a,n,c,u,y,b)}}}function A(e,t,i,r,o,a,n,c,h,u){const y=t.geometry,b=i[0],g=i[1],p=Object(f["b"])(y);if(!p)return;const[d,O,S]=Object(f["d"])(p,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),C={type:"sdf",geom:y,asFill:!0},M=e.primitiveName,v=Object(m["f"])(e.size),k=Object(m["f"])(e.rotation),j=Object(m["f"])(e.offsetX),x=Object(m["f"])(e.offsetY),P=g.path,I=g.primitiveName,w=b.primitiveName,z=Object(m["e"])(l["b"].getFillColor(g)),N=Object(m["e"])(l["b"].getStrokeColor(b)),L=l["b"].getStrokeWidth(b);let X=!1,R="";for(const s of r)s.primitiveName!==I&&s.primitiveName!==w&&s.primitiveName!==M||(void 0!==s.value?R+=`-${s.primitiveName}-${s.propertyName}-${JSON.stringify(s.value)}`:s.valueExpressionInfo&&(X=!0));const _=JSON.stringify({...e,markerGraphics:null}),Y=Object(s["b"])(JSON.stringify(C)+P).toString(),A={type:"marker",templateHash:Object(s["b"])(JSON.stringify(t)+JSON.stringify(g)+JSON.stringify(b)+_+R).toString(),materialHash:X?()=>Y:Y,cim:C,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:c,anchorPoint:{x:O,y:S},isAbsoluteAnchorPoint:!1,size:T(e.primitiveName,o,"Size",a,v),rotation:T(e.primitiveName,o,"Rotation",a,k),offsetX:T(e.primitiveName,o,"OffsetX",a,j),offsetY:T(e.primitiveName,o,"OffsetY",a,x),scaleX:1,frameHeight:u,rotateClockwise:e.rotateClockwise,referenceSize:h,sizeRatio:d,color:T(I,o,"Color",a,z,D),outlineColor:T(w,o,"Color",a,N,D),outlineWidth:T(w,o,"Width",a,L),markerPlacement:e.markerPlacement,path:P};n.push(A)}function F(e,t,i,r,o,a,c,f,h,u,y){const b=H(e,i);let g=[];const p=["Rotation","OffsetX","OffsetY"];g=o.filter(t=>t.primitiveName!==e.primitiveName||-1===p.indexOf(t.propertyName));let d="";for(const n of o)void 0!==n.value&&(d+=`-${n.primitiveName}-${n.propertyName}-${JSON.stringify(n.value)}`);const[O,S,C]=l["b"].getTextureAnchor(b,f),M=e.primitiveName,v=Object(m["f"])(e.rotation),k=Object(m["f"])(e.offsetX),j=Object(m["f"])(e.offsetY),x=Object(s["b"])(JSON.stringify(b)+d).toString(),P={type:"marker",templateHash:x,materialHash:0===g.length?x:G(x,r,g,a),cim:b,materialOverrides:g,colorLocked:e.colorLocked,effects:t,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:h,anchorPoint:{x:O,y:S},isAbsoluteAnchorPoint:!1,size:e.size,rotation:T(M,r,"Rotation",a,v),offsetX:T(M,r,"OffsetX",a,k),offsetY:T(M,r,"OffsetY",a,j),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:y,rotateClockwise:e.rotateClockwise,referenceSize:u,sizeRatio:C/Object(n["g"])(e.size),markerPlacement:e.markerPlacement};c.push(P)}function H(e,t){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[t],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath}}function J(e){if(e&&0===e.indexOf("Level_")){const t=parseInt(e.substr(6),10);if(NaN!==t)return t}return 0}function D(e){if(!e||0===e.length)return null;const t=new r["a"](e).toRgba();return{r:t[0],g:t[1],b:t[2],a:t[3]}}function T(e,t,i,r,o,a,n){const s=t[e];if(s){const e=s[i];if("string"==typeof e||"number"==typeof e||e instanceof Array)return a?a.call(null,e,n):e;if(null!=e&&e instanceof c["a"])return(t,i,s)=>{let c=Object(u["a"])(e,t,{$view:s},r.geometryType,i);return null!==c&&a&&(c=a.call(null,c,n)),null!==c?c:o}}return o}function G(e,t,i,r){for(const o of i)if(o.valueExpressionInfo){const e=t[o.primitiveName]&&t[o.primitiveName][o.propertyName];e instanceof c["a"]&&(o.fn=(t,i,o)=>Object(u["a"])(e,t,{$view:o},r.geometryType,i))}return(t,r,o)=>{for(const e of i)e.fn&&(e.value=e.fn(t,r,o));return Object(s["b"])(e+l["c"].buildOverrideKey(i)).toString()}}function $(e,t){if(!t||0===t.length)return e;const i=JSON.parse(JSON.stringify(e));return l["c"].applyOverrides(i,t),i}function U(e,t){let i=!1,r="";for(const o of e)o.primitiveName===t&&(void 0!==o.value?r+=`-${o.primitiveName}-${o.propertyName}-${JSON.stringify(o.value)}`:o.valueExpressionInfo&&(i=!0));return[i,r]}function W(e,t,i){if(e&&t)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const r=e.symbolLayers;if(!r)return;for(const e of r)switch(e.type){case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMCharacterMarker":case"CIMPictureMarker":"url"in e&&e.url&&i.push(t.fetchResource(e.url,null));break;case"CIMVectorMarker":{const r=e.markerGraphics;if(!r)continue;for(const e of r)if(e){const r=e.symbol;r&&W(r,t,i)}}}}}}const E=e=>e&&2===e.length&&e[0].enable&&e[1].enable&&"CIMSolidStroke"===e[0].type&&"CIMSolidFill"===e[1].type&&!e[0].effects&&!e[1].effects},"5dbb":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i("a9ab"),o=i("b6a7"),a=i("fe24"),n=i("9344");const s=96/72;class c{static executeEffects(e,t){const i=Object(o["c"])(t),r=s;let c=new a["a"](i);for(const o of e){const e=Object(n["a"])(o);e&&(c=e.execute(c,o,r,!0))}return c}static next(e){const t=e.next();return Object(o["d"])(t),t}static applyEffects(e,t){if(!e)return t;let i=new a["a"](t);for(const r of e){const e=Object(n["a"])(r);e&&(i=e.execute(i,r,1,!1))}let o,s=null;for(;o=i.next();)s?Object(r["h"])(s)?Object(r["h"])(o)&&s.paths.push(...o.paths):Object(r["g"])(s)&&Object(r["g"])(o)&&s.rings.push(...o.rings):s=o;return s}}},"6b49":function(e,t,i){"use strict";i.r(t),i.d(t,"CIMSymbolRasterizer",(function(){return O})),i.d(t,"GeometryStyle",(function(){return r}));var r,o=i("9ef0"),a=i("2eab"),n=i("f4cc"),s=i("a915"),c=i("b3b6"),l=i("a9ab"),f=i("4fcb"),m=i("27a2"),h=i("7b82"),u=i("357b"),y=i("36b8"),b=i("d445"),g=i("485a");!function(e){e.Legend="legend",e.Preview="preview"}(r||(r={}));const p=(e,t,i)=>{if(e&&e.targetSize){let r;if(i){const t=Math.max(i.frame.xmax-i.frame.xmin,i.frame.ymax-i.frame.ymin);r=e.targetSize/Object(s["g"])(t)}else r=e.targetSize/t.referenceSize;return r}return e&&e.scaleFactor?e.scaleFactor:1},d={fill:{legend:{frame:{xmax:15,xmin:0,ymax:15,ymin:0},geometry:{rings:[[[0,15],[15,7.5],[15,0],[0,0],[0,15]]]},canvasPaths:{rings:[[[0,15],[0,0],[15,7.5],[15,15],[0,15]]]}},preview:{frame:{xmax:100,xmin:0,ymax:100,ymin:0},geometry:{rings:[[[0,100],[100,100],[100,0],[0,0],[0,100]]]},canvasPaths:{rings:[[[0,100],[0,0],[100,0],[100,100],[0,100]]]}}},stroke:{legend:{frame:{xmax:24,xmin:0,ymax:2,ymin:-2},geometry:{paths:[[[0,0],[12,0],[24,0]]]},canvasPaths:{paths:[[[0,2],[12,2],[24,2]]]}},preview:{frame:{xmax:100,xmin:0,ymax:2,ymin:-2},geometry:{paths:[[[0,0],[50,0],[100,0]]]},canvasPaths:{paths:[[[0,2],[50,2],[100,2]]]}}}};class O{constructor(e,t){this._spatialReference=e,this._avoidSDF=t,this._resourceCache=new Map,this._pictureMarkerCache=new Map,this._textRasterizer=new u["a"],this._cimResourceManager=new m["a"],this._rasterizer=new h["a"](this._cimResourceManager)}async rasterizeCIMSymbolAsync(e,t,i,r,o,a,n,s){r=r||(t?null!=t.centroid?"esriGeometryPolygon":Object(l["c"])(t.geometry):null)||C(e);const c=await this.analyzeCIMSymbol(e,t?S(t.attributes):null,i,r,s);return this.rasterizeCIMSymbol(c,t,r,o,a,n)}async analyzeCIMSymbol(e,t,i,r,o){const a=[],s=t?{geometryType:r,spatialReference:this._spatialReference,fields:t}:null;let c;await Object(f["b"])(e.data,s,this._cimResourceManager,a,this._avoidSDF),Object(n["w"])(o);for(const n of a)"CIMPictureMarker"!==n.cim.type&&"CIMPictureFill"!==n.cim.type&&"CIMPictureStroke"!==n.cim.type||(c||(c=[]),c.push(this.fetchPictureMarkerResource(n,o))),i&&"text"===n.type&&"string"==typeof n.text&&n.text.indexOf("[")>-1&&(n.text=Object(y["c"])(i,n.text,n.cim.textCase));return c&&await Promise.all(c),a}async fetchPictureMarkerResource(e,t){const i=e.materialHash;if(!this._pictureMarkerCache.get(i)){const r=(await Object(a["default"])(e.cim.url,{responseType:"image",signal:t&&t.signal})).data;this._pictureMarkerCache.set(i,r)}}rasterizeCIMSymbol(e,t,i,r,o,a){const n=[];for(const s of e){r&&"function"==typeof r.scaleFactor&&(r.scaleFactor=r.scaleFactor(t,o,a));const e=this._getRasterizedResource(s,t,i,r,o,a);if(!e)continue;let c=0,l=e.anchorX||0,f=e.anchorY||0,m=!1,h=0,u=0;if("esriGeometryPoint"===i){const e=p(r,s,null);if(h=Object(y["d"])(s.offsetX,t,o,a)*e||0,u=Object(y["d"])(s.offsetY,t,o,a)*e||0,"marker"===s.type)c=Object(y["d"])(s.rotation,t,o,a)||0,m=!!s.rotateClockwise&&s.rotateClockwise;else if("text"===s.type){if(c=Object(y["d"])(s.angle,t,o,a)||0,void 0!==s.horizontalAlignment)switch(s.horizontalAlignment){case"left":l=-.5;break;case"right":l=.5;break;default:l=0}if(void 0!==s.verticalAlignment)switch(s.verticalAlignment){case"top":f=.5;break;case"bottom":f=-.5;break;case"baseline":f=-.25;break;default:f=0}}}null!=e&&n.push({angle:c,rotateClockWise:m,anchorX:l,anchorY:f,offsetX:h,offsetY:u,rasterizedResource:e})}return this.getSymbolImage(n)}getSymbolImage(e){const t=document.createElement("canvas"),i=t.getContext("2d");let r=0,o=0,a=0,n=0;const c=[];for(let h=0;h<e.length;h++){const t=e[h],l=t.rasterizedResource;if(!l)continue;const f=l.size,m=t.offsetX,u=t.offsetY,y=t.anchorX,b=t.anchorY,g=t.rotateClockWise||!1;let p=t.angle,d=Object(s["g"])(m)-f[0]*(.5+y),O=Object(s["g"])(u)-f[1]*(.5+b),S=d+f[0],C=O+f[1];if(p){g&&(p=-p);const e=Math.sin(p*Math.PI/180),t=Math.cos(p*Math.PI/180),i=d*t-O*e,r=d*e+O*t,o=d*t-C*e,a=d*e+C*t,n=S*t-C*e,s=S*e+C*t,c=S*t-O*e,l=S*e+O*t;d=Math.min(i,o,n,c),O=Math.min(r,a,s,l),S=Math.max(i,o,n,c),C=Math.max(r,a,s,l)}r=d<r?d:r,o=O<o?O:o,a=S>a?S:a,n=C>n?C:n;const M=i.createImageData(l.size[0],l.size[1]);M.data.set(new Uint8ClampedArray(l.image.buffer));const v={offsetX:m,offsetY:u,rotateClockwise:g,angle:p,rasterizedImage:M,anchorX:y,anchorY:b};c.push(v)}t.width=a-r,t.height=n-o;const l=-r,f=n;for(let h=0;h<c.length;h++){const e=c[h],t=this._imageDataToCanvas(e.rasterizedImage),r=e.rasterizedImage.width,o=e.rasterizedImage.height,a=l-r*(.5+e.anchorX),n=f-o*(.5-e.anchorY);if(e.angle){const r=(360-e.angle)*Math.PI/180;i.save(),i.translate(Object(s["g"])(e.offsetX),-Object(s["g"])(e.offsetY)),i.translate(l,f),i.rotate(r),i.translate(-l,-f),i.drawImage(t,a,n),i.restore()}else i.drawImage(t,a+Object(s["g"])(e.offsetX),n-Object(s["g"])(e.offsetY))}const m=new g["b"]({x:l/t.width-.5,y:f/t.height-.5});return{imageData:0!==t.width&&0!==t.height?i.getImageData(0,0,t.width,t.height):i.createImageData(1,1),anchorPosition:m}}_imageDataToCanvas(e){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const t=this._imageDataCanvas,i=t.getContext("2d");return t.width=e.width,t.height=e.height,i.putImageData(e,0,0),t}_imageTo32Array(e,t,i,r){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const a=this._imageDataCanvas,n=a.getContext("2d");if(a.width=t,a.height=i,n.drawImage(e,0,0,t,i),r){n.save();const a=new o["a"](r);n.fillStyle=a.toHex(),n.globalCompositeOperation="multiply",n.fillRect(0,0,t,i),n.globalCompositeOperation="destination-atop",n.drawImage(e,0,0,t,i),n.restore()}return new Uint32Array(n.getImageData(0,0,t,i).data.buffer)}_getRasterizedResource(e,t,i,o,a,n){let s,l,f,m,h=null,u=null;if("esriGeometryPolyline"===i||"esriGeometryPolygon"===i){const m=o&&o.style?o.style:r.Legend,b="esriGeometryPolyline"===i?d.stroke[m]:d.fill[m];if("line"===e.type){if("CIMSolidStroke"!==e.cim.type){if("CIMPictureStroke"===e.cim.type){const i=Object(y["d"])(e.width,t,a,n),r=Object(y["d"])(e.color,t,a,n),{image:o,width:s,height:c}=this._getPictureResource(e,i,r);return this._rasterizePictureResource(e,o,s,c,b,i)}return null}({analyzedCIM:s,hash:f}=M(e,t,a,n)),l=this._embedCIMLayerInVectorMarker(s,b)}else if("marker"===e.type){if("CIMPictureMarker"===e.cim.type)return null;if("CIMVectorMarker"!==e.cim.type)return null;e.cim.offsetX=Object(y["d"])(e.offsetX,t,a,n),e.cim.offsetY=Object(y["d"])(e.offsetY,t,a,n),e.cim.rotation=Object(y["d"])(e.rotation,t,a,n),e.cim.markerPlacement=e.markerPlacement,({analyzedCIM:s}=M(e,t,a,n)),f=Object(c["b"])(JSON.stringify(s)).toString(),l=this._embedCIMLayerInVectorMarker(s,b),h=Object(y["d"])(e.size,t,a,n),u=e.path}else{if("text"===e.type)return null;if("fill"===e.type){if("CIMHatchFill"===e.cim.type||"CIMVectorMarker"===e.cim.type||"CIMPictureMarker"===e.cim.type||"CIMPictureFill"===e.cim.type){const i=e.cim.size||e.cim.height;let r,o,c;if("CIMPictureMarker"===e.cim.type||"CIMPictureFill"===e.cim.type)({image:r,width:o,height:c}=this._getPictureResource(e,i,Object(y["d"])(e.color,t,a,n)));else{({analyzedCIM:s,hash:f}=M(e,t,a,n));const l=this._rasterizer.rasterizeJSONResource({cim:s,type:e.type,url:e.url,mosaicHash:f,size:i,path:u},1,this._avoidSDF);r=l.image,o=l.size[0],c=l.size[1]}return this._rasterizePictureResource(e,r,o,c,b,null)}if("CIMSolidFill"!==e.cim.type)return null;({analyzedCIM:s,hash:f}=M(e,t,a,n)),l=this._embedCIMLayerInVectorMarker(s,b)}}}else{if("text"===e.type)return m=this._rasterizeTextResource(e,t,o,a,n),m;({analyzedCIM:s,hash:f}=M(e,t,a,n));const i=p(o,e,null);if("CIMPictureMarker"===e.cim.type){const r=Object(y["d"])(e.size,t,a,n)*i,{image:o,width:s,height:c}=this._getPictureResource(e,r,Object(y["d"])(e.color,t,a,n));return m={image:o,size:[s,c],sdf:!1,simplePattern:!1,anchorX:e.anchorPoint?e.anchorPoint.x:0,anchorY:e.anchorPoint?e.anchorPoint.y:0},m}Object(b["c"])(s,i,{preserveOutlineWidth:!1}),l=s}f+=i,o&&(f+=JSON.stringify(o));const g=this._resourceCache;return g.has(f)?g.get(f):(m=this._rasterizer.rasterizeJSONResource({cim:l,type:e.type,url:e.url,mosaicHash:f,size:h,path:u},window.devicePixelRatio||1,this._avoidSDF),g.set(f,m),m)}_rasterizeTextResource(e,t,i,r,o){const a=p(i,e,null),n=Object(y["d"])(e.text,t,r,o);if(!n||0===n.length)return null;const s=Object(y["d"])(e.fontName,t,r,o),c=Object(y["d"])(e.style,t,r,o),l=Object(y["d"])(e.weight,t,r,o),f=Object(y["d"])(e.decoration,t,r,o),m=Object(y["d"])(e.size,t,r,o)*a,h=Object(y["d"])(e.horizontalAlignment,t,r,o),u=Object(y["d"])(e.verticalAlignment,t,r,o),b=Object(y["b"])(Object(y["d"])(e.color,t,r,o)),g=Object(y["b"])(Object(y["d"])(e.outlineColor,t,r,o)),d={color:b,size:m,horizontalAlignment:h,verticalAlignment:u,font:{family:s,style:c,weight:l,decoration:f},halo:{size:Object(y["d"])(e.outlineSize,t,r,o)||0,color:g,style:c},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(n,d)}_rasterizePictureResource(e,t,i,r,o,a){const n=document.createElement("canvas"),c=n.getContext("2d");n.height=Object(s["g"])(Math.max(o.frame.ymax-o.frame.ymin,a)),n.width=Object(s["g"])(o.frame.xmax-o.frame.xmin);const f=c.createImageData(i,r);f.data.set(new Uint8ClampedArray(t.buffer));const m=this._imageDataToCanvas(f),h=c.createPattern(m,"repeat"),u=Math.cos((-e.cim.rotation||0)*Math.PI/180),y=Math.sin((-e.cim.rotation||0)*Math.PI/180);h.setTransform({m11:u,m12:y,m21:-y,m22:u,m41:Object(s["g"])(e.cim.offsetX)||0,m42:Object(s["g"])(e.cim.offsetY)||0});const b=o.canvasPaths;let g,p,d;Object(l["g"])(b)?(g=b.rings,c.fillStyle=h,p=c.fill,d=["evenodd"]):Object(l["h"])(b)&&(g=b.paths,c.strokeStyle=h,c.lineWidth=a,p=c.stroke,g[0][0][1]=n.height/2,g[0][1][1]=n.height/2),c.beginPath();for(const l of g){const e=l?l.length:0;if(e>1){let t=l[0];c.moveTo(Object(s["g"])(t[0]),Object(s["g"])(t[1]));for(let i=1;i<e;++i)t=l[i],c.lineTo(Object(s["g"])(t[0]),Object(s["g"])(t[1]));c.closePath()}}p.apply(c,d);const O=c.getImageData(0,0,n.width,n.height),S=new Uint8Array(O.data);return{size:[n.width,n.height],image:new Uint32Array(S.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}_getPictureResource(e,t,i){const r=this._pictureMarkerCache.get(e.materialHash);if(!r)return null;const o=r.height/r.width,a=t?o>1?Object(s["g"])(t):Object(s["g"])(t)/o:r.width,n=t?o>1?Object(s["g"])(t)*o:Object(s["g"])(t):r.height;return{image:this._imageTo32Array(r,a,n,i),width:a,height:n}}_embedCIMLayerInVectorMarker(e,t){const i=Object(l["g"])(t.geometry)?"CIMPolygonSymbol":"CIMLineSymbol",r=t.frame;return{type:"CIMVectorMarker",frame:r,size:r.ymax-r.ymin,markerGraphics:[{type:"CIMMarkerGraphic",geometry:t.geometry,symbol:{type:i,symbolLayers:[e]}}]}}}function S(e){return(e?Object.keys(e):[]).map(t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"}))}function C(e){if(!(e&&e.data&&e.data.symbol))return null;switch(e.data.symbol.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function M(e,t,i,r){let o,a;return"function"==typeof e.materialHash?(o=(0,e.materialHash)(t,i,r),a=Object(f["a"])(e.cim,e.materialOverrides)):(o=e.materialHash,a=e.cim),{analyzedCIM:a,hash:o}}},"7b82":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i("793f"),o=i("0eee"),a=i("405c"),n=i("36b8");const s=512;class c{constructor(e){this._resourceManager=e}dispose(){this._rasterizationCanvas=null}rasterizeJSONResource(e,t,i){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===e.type||"esriSFS"===e.type){const[i,o,a]=r["d"].rasterizeSimpleFill(this._rasterizationCanvas,e.style,t);return{size:[o,a],image:new Uint32Array(i.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===e.type||"esriSLS"===e.type||"line"===e.type&&e.dashTemplate){let t,i;if("simple-line"===e.type||"esriSLS"===e.type)switch(t=Object(r["e"])(e.style,e.cap),e.cap){case"butt":i="Butt";break;case"square":i="Square";break;default:i="Round"}else t=e.dashTemplate,i=e.cim.capStyle;const[o,a,n]=r["d"].rasterizeSimpleLine(t,i);return{size:[a,n],image:new Uint32Array(o.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let n,s,c;if("simple-marker"===e.type||"esriSMS"===e.type||"line-marker"===e.type?(n=r["b"].fromSimpleMarker(e),c=Object(a["c"])(n)):e.cim&&"CIMHatchFill"===e.cim.type?(n=r["b"].fromCIMHatchFill(e.cim),s=new o["a"](n.frame.xmin,-n.frame.ymax,n.frame.xmax-n.frame.xmin,n.frame.ymax-n.frame.ymin)):e.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===e.cim.markerPlacement.type?(n=r["b"].fromCIMInsidePolygon(e.cim),s=new o["a"](n.frame.xmin,-n.frame.ymax,n.frame.xmax-n.frame.xmin,n.frame.ymax-n.frame.ymin)):(n=e.cim,c=Object(a["c"])(n)),c&&!i){const[e,t,i]=Object(a["a"])(c);return e?{size:[t,i],image:new Uint32Array(e.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const[l,f,m,h,u]=r["b"].rasterize(this._rasterizationCanvas,n,s,this._resourceManager,!i);return l?{size:[f,m],image:new Uint32Array(l.buffer),sdf:!1,simplePattern:!1,anchorX:h,anchorY:u}:null}rasterizeImageResource(e,t,i,r){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),this._rasterizationCanvas.width=e,this._rasterizationCanvas.height=t;const o=this._rasterizationCanvas.getContext("2d");i instanceof ImageData?o.putImageData(i,0,0):(i.setAttribute("width",e+"px"),i.setAttribute("height",t+"px"),o.drawImage(i,0,0,e,t));const a=o.getImageData(0,0,e,t),c=new Uint8Array(a.data);if(r)for(const n of r)if(n&&n.oldColor&&4===n.oldColor.length&&n.newColor&&4===n.newColor.length){const[e,t,i,r]=n.oldColor,[o,a,s,l]=n.newColor;if(e===o&&t===a&&i===s&&r===l)continue;for(let n=0;n<c.length;n+=4)e===c[n]&&t===c[n+1]&&i===c[n+2]&&r===c[n+3]&&(c[n]=o,c[n+1]=a,c[n+2]=s,c[n+3]=l)}let l;for(let n=0;n<c.length;n+=4)l=c[n+3]/255,c[n]=c[n]*l,c[n+1]=c[n+1]*l,c[n+2]=c[n+2]*l;let f=c,m=e,h=t;const u=s;if(m>=u||h>=u){const i=m/h;i>1?(m=u,h=Math.round(u/i)):(h=u,m=Math.round(u*i)),f=new Uint8Array(4*m*h);const r=new Uint8ClampedArray(f.buffer);Object(n["k"])(c,e,t,r,m,h,!1)}return{size:[m,h],image:new Uint32Array(f.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}}}]);
//# sourceMappingURL=chunk-1b4b77ea.5ba55ed8.js.map
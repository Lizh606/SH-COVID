{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/views/3d/analysis/AnalysisView3D.js","webpack:///./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js","webpack:///./node_modules/@arcgis/core/layers/buildingSublayers/BuildingSublayer.js","webpack:///./node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js","webpack:///./node_modules/@arcgis/core/chunks/ShadedColorMaterial.glsl.js","webpack:///./node_modules/@arcgis/core/views/3d/interactive/visualElements/LineVisualElement.js","webpack:///./node_modules/@arcgis/core/views/3d/analysis/support/loggerUtils.js","webpack:///./node_modules/@arcgis/core/views/3d/interactive/Manipulator3D.js","webpack:///./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ShadedColorMaterialTechnique.js","webpack:///./node_modules/@arcgis/core/views/3d/webgl-engine/materials/ShadedColorMaterial.js","webpack:///./node_modules/@arcgis/core/views/3d/interactive/manipulatorUtils.js","webpack:///./node_modules/@arcgis/core/views/3d/interactive/analysisTools/slice/sliceToolConfig.js","webpack:///./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/SlicePlaneMaterialTechnique.js","webpack:///./node_modules/@arcgis/core/views/3d/webgl-engine/materials/SlicePlaneMaterial.js","webpack:///./node_modules/@arcgis/core/views/3d/interactive/visualElements/SlicePlaneVisualElement.js","webpack:///./node_modules/@arcgis/core/widgets/Slice/SlicePlane.js","webpack:///./node_modules/@arcgis/core/views/3d/interactive/analysisTools/slice/sliceToolUtils.js","webpack:///./node_modules/@arcgis/core/views/3d/analysis/Slice/SliceController.js","webpack:///./node_modules/@arcgis/core/views/3d/analysis/Slice/SliceViewData.js","webpack:///./node_modules/@arcgis/core/views/3d/analysis/Slice/SliceVisualization.js","webpack:///./node_modules/@arcgis/core/views/3d/analysis/Slice/SliceView3D.js","webpack:///./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ImageMaterialTechnique.js","webpack:///./node_modules/@arcgis/core/views/3d/webgl-engine/materials/ImageMaterial.js","webpack:///./node_modules/@arcgis/core/chunks/SlicePlaneMaterial.glsl.js","webpack:///./node_modules/@arcgis/core/portal/support/resourceExtension.js","webpack:///./node_modules/@arcgis/core/core/accessorSupport/decorators/persistable.js","webpack:///./node_modules/@arcgis/core/layers/buildingSublayers/BuildingComponentSublayer.js","webpack:///./node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js","webpack:///./node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElement.js"],"names":["p","i","super","arguments","this","parent","r","visible","suspended","analysis","readOnly","prototype","constructOnly","vertex","uniforms","add","code","e","setUniform1f","camera","perScreenPixelRatio","screenSize","l","title","id","modelName","isEmpty","opacity","alias","name","type","String","json","origins","write","read","ignoreOrigin","Boolean","Number","n","c","view","_resources","_transform","object","s","transformation","attached","createResources","_stage","removeMany","geometries","removeAllGeometries","createGeometries","setVisible","addMany","destroyResources","isPickable","updatePolicy","castShadow","createExternalResources","forEachExternalMaterial","layer","remove","dispose","destroyExternalResources","t","include","linearDepth","fragment","attributes","varyings","multipassTerrainEnabled","screenSizeEnabled","shadingEnabled","float","output","OITEnabled","Object","freeze","__proto__","build","m","_renderOccluded","_width","_color","_innerWidth","_innerColor","_stipplePattern","_stippleOffColor","_stipplePreferContinuous","_writeDepthEnabled","_falloff","_polygonOffset","applyProps","push","geometry","spatialReference","renderCoordsHelper","toRenderCoords","lines","forEach","origin","endpoint","basis1","basis2","o","h","a","endRenderSpace","g","transform","points","createRenderGeometry","map","_updateMaterial","_geometry","recreateGeometry","recreate","_material","materialParameters","_createLineGeometries","length","addGeometry","width","color","stippleOffColor","stipplePattern","stipplePreferContinuous","isClosed","falloff","innerColor","innerWidth","polygonOffset","renderOccluded","writeDepth","setParameters","Float64Array","overlayInfo","attributeData","position","removeDuplicateStartEnd","warnOnce","wkid","x","y","z","shader","get","configuration","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","transparencyPassType","cullAboveGround","rctx","P","shadingTint","shadingDirection","program","projectionMatrix","setUniform4fv","setUniform2fv","nearFar","inverseViewport","blendColor","setUniform3fv","setUniformMatrix4fv","viewInverseTransposeMatrix","rebindTextures","blending","transparent","culling","cullFace","depthTest","func","depthWrite","colorWrite","setPipelineState","count","Map","Math","cos","backgroundColor","gridColor","gridWidth","_config","ensureTechnique","technique","bindPass","parameters","_gridWidth","_gridColor","_backgroundColor","createSquareGeometry","heading","tilt","height","nonNullable","range","min","max","normalize","He","getLogger","We","worldUpAtPosition","ft","round","Rt","Ne","ot","writeDepthEnabled","at","dt","fromRenderCoords","u","worldBasisAtPosition","d","renderUnitScaleFactor","bt","ht","plane","error","yt","renderWidth","renderHeight","jt","hasZ","elevationProvider","clone","tiltEnabled","Mt","PI","Ot","_handles","_internalChange","_currentSlicePlane","state","excludedLayers","on","item","preventDefault","includes","ready","_initialize","sync","initial","once","analysisView","analysisViewData","_updateSlicePlaneFromBoundedPlane","_updateLayerViews","excludeGroundSurface","active","_updateActiveController","_updateViewSlicePlane","_allLayerAndSubLayerViews","shape","_updateBoundedPlaneFromSlicePlane","_set","destroy","slicePlane","set","allLayerViews","items","concat","filter","flatMap","sublayerViews","equals","activeController","layers","destroyed","indexOf","sublayer","basemapTerrain","has","all","Error","lastIndexOf","splice","delete","_gridVisualElement","_outlineVisualElement","showGrid","editable","_updateMaterials","_updatePlane","analysisVisualization","analysisController","whenReady","visualization","controller","aliasOf","w","stencilWrite","sceneHasOcludees","stencilTest","enableOffset","_occludeePipelineState","getPipelineState","supportsEdges","techniqueConfig","relativeElevation","material","updateTexture","textureId","hasOccludees","updateParameters","_output","_updateOccludeeState","bindTextures","bindTextureScale","initTextureTransparent","extensions","Blob","url","png","jpeg","jpg","bmp","gif","txt","xml","svg","zip","pbf","gz","v","f","resources","verifyItemRelativeUrls","writtenUrls","rootPath","originIdOf","portalItem","j","I","U","S","resourceFromPath","pendingOperations","b","then","path","itemRelativeUrl","catch","O","toAdd","toUpdate","toKeep","resource","content","finish","R","JSON","stringify","toJSON","async","default","data","responseType","D","Q","LoadableMixin","nodePages","materialDefinitions","textureSetDefinitions","geometryDefinitions","serviceUpdateTimeStamp","fields","associatedLayer","outFields","listMode","renderer","definitionExpression","popupEnabled","popupTemplate","layerType","parsedUrl","query","associatedFeatureServiceItem","associatedLayerID","layerId","displayField","createPopupTemplate","signal","_fetchService","indexInfo","rootNode","apiKey","addResolvingPromise","Promise","resolve","token","fieldsIndex","getFeatureType","feature","domains","getField","domain","types","typeIdField","capabilities","supportsZ","supportsM","isVersioned","geometryType","returnGeometry","returnZ","where","sqlFormat","_getAssociatedLayerForQuery","queryExtent","createQuery","queryFeatureCount","queryFeatures","features","sourceLayer","queryObjectIds","supportsLabelingInfo","supportsRenderer","supportsPopupTemplate","supportsLayerQuery","loaded","_loadAssociatedLayerForQuery","load","source","service","value","enabled","allowNull","target","Point","_attached","_resourcesCreated","_visible","watch","_createResources","_destroyResources","console","updateVisibility"],"mappings":"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","file":"js/chunk-151674ce.76ac0bfc.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../chunks/tslib.es6.js\";import{isSome as t}from\"../../../core/maybe.js\";import{EsriPromiseMixin as s}from\"../../../core/Promise.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as e}from\"../../../core/accessorSupport/decorators/subclass.js\";const p=p=>{let i=class extends(s(p)){constructor(){super(...arguments),this.parent=null}get updating(){return!1}get visible(){const r=!t(this.parent)||this.parent.visible&&!this.parent.suspended;return this.analysis.visible&&r}};return r([o({readOnly:!0})],i.prototype,\"type\",void 0),r([o({constructOnly:!0})],i.prototype,\"analysis\",void 0),r([o({constructOnly:!0})],i.prototype,\"parent\",void 0),r([o({constructOnly:!0})],i.prototype,\"view\",void 0),r([o({readOnly:!0})],i.prototype,\"updating\",null),r([o({readOnly:!0})],i.prototype,\"visible\",null),i=r([e(\"esri.views.3d.analysis.AnalysisView3D\")],i),i};export{p as AnalysisView3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../shaderModules/interfaces.js\";function i(i){i.vertex.uniforms.add(\"camPos\",\"vec3\").add(\"perScreenPixelRatio\",\"float\").add(\"screenSize\",\"float\"),i.vertex.code.add(e`float computeRenderPixelSizeAt( vec3 pWorld ){\nvec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\nfloat viewDirectionDistance = abs(dot(viewForward, pWorld - camPos));\nreturn viewDirectionDistance*perScreenPixelRatio;\n}\nvec3 screenSizeScaling(vec3 position, vec3 anchor){\nreturn position * screenSize * computeRenderPixelSizeAt(anchor) + anchor;\n}`)}function r(e,i,r){e.setUniform1f(\"perScreenPixelRatio\",r.camera.perScreenPixelRatio),e.setUniform1f(\"screenSize\",i.screenSize)}export{i as ScreenSizeScaling,r as bindScreenSizeScalingUniforms};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import{IdentifiableMixin as e}from\"../../core/Identifiable.js\";import{MultiOriginJSONSupport as o}from\"../../core/MultiOriginJSONSupport.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{Integer as i}from\"../../core/accessorSupport/ensureType.js\";import{reader as s}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{readOnlyService as a}from\"../support/commonProperties.js\";let l=class extends(e(o)){constructor(r){super(r),this.title=\"\",this.id=-1,this.modelName=null,this.isEmpty=null,this.visible=!0,this.opacity=1}readTitle(r,e){return\"string\"==typeof e.alias?e.alias:\"string\"==typeof e.name?e.name:\"\"}readIdOnlyOnce(r){return-1!==this.id?this.id:\"number\"==typeof r?r:void 0}};r([t({type:String,json:{origins:{\"web-scene\":{write:!0},\"portal-item\":{write:!0}}}})],l.prototype,\"title\",void 0),r([s(\"service\",\"title\",[\"alias\",\"name\"])],l.prototype,\"readTitle\",null),r([t()],l.prototype,\"layer\",void 0),r([t({type:i,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],l.prototype,\"id\",void 0),r([s(\"service\",\"id\")],l.prototype,\"readIdOnlyOnce\",null),r([t(a(String))],l.prototype,\"modelName\",void 0),r([t(a(Boolean))],l.prototype,\"isEmpty\",void 0),r([t({type:Boolean,json:{name:\"visibility\",write:!0}})],l.prototype,\"visible\",void 0),r([t({type:Number,json:{write:!0}})],l.prototype,\"opacity\",void 0),l=r([p(\"esri.layers.buildingSublayers.BuildingSublayer\")],l);const n=l;export{n as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as s}from\"../../../../core/maybe.js\";import{c as r}from\"../../../../chunks/mat4.js\";import{c as t}from\"../../../../chunks/mat4f64.js\";import{VisualElement as o}from\"./VisualElement.js\";import{Object3D as i}from\"../../webgl-engine/lib/Object3D.js\";import{WebGLLayer as a}from\"../../webgl-engine/lib/WebGLLayer.js\";class c extends o{constructor(e){super(e.view),this._resources=null,this._transform=t()}get object(){return e(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(s){r(this._transform,s),e(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(s(this._resources))return;const e=this._resources.object,r=this.view._stage;r.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),r.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new a({isPickable:!1,updatePolicy:1});e.add(s);const r=new i({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),this.visible||r.setVisible(!1),this._resources={layer:s,object:r}}destroyResources(){const e=this.view._stage;!s(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((s=>{e.remove(s),s.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){s(this._resources)||this._resources.object.setVisible(e)}}export{c as Object3DVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{ScreenSizeScaling as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js\";import{Slice as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as o}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ReadLinearDepth as i}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{multipassTerrainTest as a}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{symbolAlphaCutoff as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{ColorConversion as l}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{glsl as n}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as s}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function t(t){const c=new s;return c.include(o,{linearDepth:!1}),c.include(e,{}),c.include(r,t),c.fragment.include(l),c.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),c.fragment.uniforms.add(\"color\",\"vec4\"),c.attributes.add(\"position\",\"vec3\"),c.varyings.add(\"vWorldPosition\",\"vec3\"),t.multipassTerrainEnabled&&c.varyings.add(\"depth\",\"float\"),t.screenSizeEnabled&&c.attributes.add(\"offset\",\"vec3\"),t.shadingEnabled&&(c.vertex.uniforms.add(\"viewNormal\",\"mat4\"),c.fragment.uniforms.add(\"shadedColor\",\"vec4\").add(\"shadingDirection\",\"vec3\"),c.attributes.add(\"normal\",\"vec3\"),c.varyings.add(\"vViewNormal\",\"vec3\")),c.vertex.code.add(n`\n    void main(void) {\n      vWorldPosition = ${t.screenSizeEnabled?\"screenSizeScaling(offset, position)\":\"position\"};\n  `),t.shadingEnabled&&c.vertex.code.add(n`vec3 worldNormal = normal;\nvViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),c.vertex.code.add(n`\n    ${t.multipassTerrainEnabled?\"depth = (view * vec4(vWorldPosition, 1.0)).z;\":\"\"}\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  `),t.multipassTerrainEnabled&&(c.fragment.include(i),c.include(a,t)),c.fragment.code.add(n`\n    void main() {\n      discardBySlice(vWorldPosition);\n      ${t.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n    `),t.shadingEnabled?c.fragment.code.add(n`vec3 viewNormalNorm = normalize(vViewNormal);\nfloat shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\nvec4 finalColor = mix(color, shadedColor, shadingFactor);`):c.fragment.code.add(n`vec4 finalColor = color;`),c.fragment.code.add(n`\n      if (finalColor.a < ${n.float(d)}) {\n        discard;\n      }\n      ${7===t.output?n`gl_FragColor = vec4(finalColor.a);`:\"\"}\n\n      ${0===t.output?n`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${t.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}`:\"\"}\n    }\n    `),c}const c=Object.freeze({__proto__:null,build:t});export{c as S,t as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../../core/maybe.js\";import{i as r,a as s}from\"../../../../chunks/mat4.js\";import{c as i}from\"../../../../chunks/mat4f64.js\";import{s as o}from\"../../../../chunks/vec3.js\";import{Z as n,c as l}from\"../../../../chunks/vec3f64.js\";import{g as h,c as a}from\"../../../../chunks/vec4.js\";import{f as p,c as d,a as u}from\"../../../../chunks/vec4f32.js\";import{Object3DVisualElement as f}from\"./Object3DVisualElement.js\";import{createGeometry as _}from\"../../layers/graphics/lineUtils.js\";import{RibbonLineMaterial as c}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";class m extends f{constructor(e){super(e),this._renderOccluded=4,this._width=1,this._color=p(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this.applyProps(e)}setGeometryFromRenderSpacePoint(e){const t=1e3,r=[];r.push([[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]]),r.push([[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]]),r.push([[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]),this.geometry=r}setGeometryFromExtent(e){const t=this.view.spatialReference,r=l(),s=l(),i=100,n=[];o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[2],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[3],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),o(r,e[0],e[1],i),this.view.renderCoordsHelper.toRenderCoords(r,t,s),n.push([s[0],s[1],s[2]]),this.geometry=[n]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],r=e.origin,s=e.basis1,i=e.basis2,o=.5,n=l(),h=l(),a=l(),p=l();n[0]=r[0]-s[0]*o-i[0]*o,n[1]=r[1]-s[1]*o-i[1]*o,n[2]=r[2]-s[2]*o-i[2]*o,h[0]=r[0]-s[0]*o+i[0]*o,h[1]=r[1]-s[1]*o+i[1]*o,h[2]=r[2]-s[2]*o+i[2]*o,a[0]=r[0]+s[0]*o+i[0]*o,a[1]=r[1]+s[1]*o+i[1]*o,a[2]=r[2]+s[2]*o+i[2]*o,p[0]=r[0]+s[0]*o-i[0]*o,p[1]=r[1]+s[1]*o-i[1]*o,p[2]=r[2]+s[2]*o-i[2]*o,t.push([n[0],n[1],n[2]]),t.push([h[0],h[1],h[2]]),t.push([a[0],a[1],a[2]]),t.push([p[0],p[1],p[2]]),t.push([n[0],n[1],n[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;r(g),s(g,g,t),this.transform=g;const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e,t=n){r(g),s(g,g,t),this.transform=g,this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){h(e,this._color)||(a(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(r){e(r)?!t(this._innerColor)&&h(r,this._innerColor)||(this._innerColor=a(d(),r),this._updateMaterial()):e(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const r=e(t)!==e(this._stipplePattern);this._stipplePattern=t,r?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(r){(t(r)||t(this._stippleOffColor)||!h(r,this._stippleOffColor))&&(this._stippleOffColor=e(r)?u(r):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){this._stipplePreferContinuous!==e&&(this._stipplePreferContinuous=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}createExternalResources(){this._material=new c(this.materialParameters)}destroyExternalResources(){this._material=null}createGeometries(e){const t=this._createLineGeometries();if(0!==t.length)for(let r=0;r<t.length;++r){const s=_(t[r]);e.addGeometry(s,this._material)}}forEachExternalMaterial(e){e(this._material)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateMaterial(){this.attached&&this._material.setParameters(this.materialParameters)}_createLineGeometries(){const e=this.geometry;if(t(e)||0===e.length)return[];const r=[];return e.forEach((e=>{const t=e.length,s=new Float64Array(3*t);e.forEach(((e,t)=>{s[3*t+0]=e[0],s[3*t+1]=e[1],s[3*t+2]=e[2]}));const i={overlayInfo:null,attributeData:{position:s},removeDuplicateStartEnd:0};r.push(i)})),r}}const g=i();export{m as LineVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nfunction e(e,o,i){i.warnOnce(`Failed to project analysis geometry (id: '${e.id}'), projection from spatial reference (wkid: '${o.wkid}') to view spatial reference is not supported. Projection may be possible after calling projection.load().`)}export{e as logFailedGeometryProjectionError};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport\"../../../geometry.js\";import{neverReached as e}from\"../../../core/compilerUtils.js\";import t from\"../../../core/Evented.js\";import{deg2rad as i}from\"../../../core/mathUtils.js\";import{isSome as s,isNone as o,unwrapOr as r,unwrap as n}from\"../../../core/maybe.js\";import{createScreenPointArray as a,createRenderScreenPointArray3 as c,screenPointObjectToArray as l,castRenderScreenPointArray as h}from\"../../../core/screenUtils.js\";import{once as d}from\"../../../core/accessorSupport/utils.js\";import{f as u}from\"../../../chunks/mat3.js\";import{c as _}from\"../../../chunks/mat3f64.js\";import{c as g,s as m,m as f,i as p}from\"../../../chunks/mat4.js\";import{c as v}from\"../../../chunks/mat4f64.js\";import{a as b}from\"../../../chunks/vec2.js\";import{b as y,t as j,m as L,a as S,g as R,h as w,s as O,f as T}from\"../../../chunks/vec3.js\";import{c as E,Z as A}from\"../../../chunks/vec3f64.js\";import{canProjectWithoutEngine as D,projectPoint as F,sphericalPCPFtoLonLatElevation as z,computeENUToSphericalPCPFLocalRotation as k}from\"../../../geometry/projection.js\";import{getReferenceEllipsoid as P}from\"../../../geometry/projectionEllipsoid.js\";import{containsPointObject as I}from\"../../../geometry/support/aaBoundingRect.js\";import{create as M,distance2 as C,fromPoints as x,closestRayDistance2 as B}from\"../../../geometry/support/lineSegment.js\";import{create as W,fromPositionAndNormal as V,intersectRay as U}from\"../../../geometry/support/plane.js\";import{create as G}from\"../../../geometry/support/ray.js\";import{sv3d as H}from\"../../../geometry/support/vectorStacks.js\";import{clonePoint as Z}from\"../../../layers/graphics/hydratedFeatures.js\";import{getElevationAtPoint as q}from\"../support/ElevationProvider.js\";import{fromScreen as J}from\"../support/geometryUtils/ray.js\";import K from\"../webgl-engine/lib/Camera.js\";import{Object3D as N}from\"../webgl-engine/lib/Object3D.js\";import{WebGLLayer as Q}from\"../webgl-engine/lib/WebGLLayer.js\";import X from\"../../../geometry/Point.js\";class Y{constructor(e){this.camera=new K,this._elevation={offset:0,override:null},this.collisionType={type:\"point\"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=v(),this._worldFrame=null,this._renderLocation=E(),this._renderLocationDirty=!0,this._location=new X({x:0,y:0,z:0}),this._elevationAlignedLocation=new X,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=0,this._focused=!1,this.events=new t.EventEmitter,this._screenLocation={screenPointArray:a(),renderScreenPointArray:c(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=e.view.spatialReference;for(const t in e)this[t]=e[t];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}destroy(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this.camera=null}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:d((()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()}))}}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){$(e)&&(this._screenLocationDirty=!0),g(this._modelTransform,e),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=v()),ee(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(e){Z(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit(\"location-update\",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){Z(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit(\"location-update\",{location:this._location})}_updateElevationAlignedLocation(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;const e=s(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=this.location.spatialReference,this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit(\"select-changed\",{action:e?\"select\":\"deselect\"}))}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject())}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit(\"focus-changed\",{action:!0===e?\"focus\":\"unfocus\"}))}get focused(){return this._focused}get screenLocation(){return this.ensureScreenLocation(),this._screenLocation}ensureScreenLocation(){if(!this._screenLocationDirty)return;this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1;let e;if($(this._modelTransform)){const t=this._calculateModelTransformOffset(_e);e=y(t,t,this.renderLocation)}else e=this.renderLocation;this.camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}intersectionDistance(t,i){if(!this.available)return null;const s=l(t,te),r=this._getCollisionRadius(i),n=-1*this.collisionPriority;switch(this.collisionType.type){case\"point\":if(b(this.screenLocation.screenPointArray,s)<r*r)return this.screenLocation.renderScreenPointArray[2]+n;break;case\"line\":{const e=this.collisionType.paths,t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,ne),a=r*this.screenLocation.pixelSize,c=J(this.camera,s,se);if(o(c))return null;for(const s of e){if(0===s.length)continue;const e=L(ce,s[0],i);for(let t=1;t<s.length;t++){const o=L(le,s[t],i),r=B(x(e,o,ie),c);if(null!=r&&r<a*a){const t=y(H.get(),e,o);S(t,t,.5);const i=h(H.get());return this.camera.projectToRenderScreen(t,i),i[2]+n}R(e,o)}}break}case\"disc\":{var a;const e=this.collisionType.direction,t=null!=(a=this.collisionType.offset)?a:A,i=this._getWorldToScreenObjectScale(),c=this._calculateObjectTransform(i,ne),l=r*this.screenLocation.pixelSize,h=J(this.camera,s,se);if(o(h))return null;const d=u(oe,c),_=j(de,e,d),g=L(ue,t,c);V(g,_,ae);const m=he;if(U(ae,h,m)&&w(m,g)<l*l)return this.screenLocation.renderScreenPointArray[2]+n;break}case\"ribbon\":{const{paths:e,direction:t}=this.collisionType,i=this._getWorldToScreenObjectScale(),a=this._calculateObjectTransform(i,ne),c=r*this.camera.computeScreenPixelSizeAt(this.renderLocation),l=J(this.camera,s,se);if(o(l))return null;const d=u(oe,a),_=j(de,t,d),g=this._calculateModelTransformPosition(ue);V(g,_,ae);const m=he;if(!U(ae,l,m))break;for(const s of e){if(0===s.length)continue;const e=L(ce,s[0],a);for(let t=1;t<s.length;t++){const i=L(le,s[t],a),o=C(x(e,i,ie),m);if(null!=o&&o<c*c){const t=y(H.get(),e,i);S(t,t,.5);const s=h(H.get());return this.camera.projectToRenderScreen(t,s),s[2]+n}R(e,i)}}break}default:e(this.collisionType)}return null}attach(e={manipulator3D:{}}){var t;if(!this.view._stage)return;const i=e.manipulator3D;if(o(i.engineLayerId)){const e=new Q({isPickable:!1,updatePolicy:1});this.view._stage.add(e),i.engineLayerId=e.id,this._engineLayer=e}else null!=(t=this.view._stage)&&t.getObject&&(this._engineLayer=this.view._stage.getObject(i.engineLayerId));i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,o(this._materialIdReferences)&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this.camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),D(this._location.spatialReference,this.view.spatialReference)||(this.location=new X({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(e={manipulator3D:{}}){const t=e.manipulator3D;t.engineLayerReferences--;const i=0===t.engineLayerReferences;i&&(t.engineLayerId=null),this._removeResourcesFromStage(i),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this.camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(e){F(this.location,ge,e.spatialReference),I(e.extent,ge)&&(this.location=this._location)}_evaluateElevationAlignment(e=this.location){if(o(this.elevationInfo))return!1;let t=null,i=0;const s=r(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case\"on-the-ground\":t=r(q(this.view.elevationProvider,e,\"ground\"),0);break;case\"relative-to-ground\":i=r(q(this.view.elevationProvider,e,\"ground\"),0)+s;break;case\"relative-to-scene\":i=r(q(this.view.elevationProvider,e,\"scene\"),0)+s;break;case\"absolute-height\":i=s}return(i!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=i,this._elevation.override=t,!0)}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const e=this._getWorldToScreenObjectScale(),t=ne;if(!0===this.autoScaleRenderObjects){const i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);const{objectsByState:i}=this._ensureEngineResources(),s=(this.focused?2:1)|(this.selected?8:4),o=this._noDisplayCount>0;for(const{stateMask:r,objects:n}of i){if(o){for(const e of n)e.setVisible(!1);continue}const e=!(0!=(15&r))||(s&r)==(15&r),i=!(0!=(65520&r))||(this.state&r)==(65520&r);if(e&&i)for(const s of n)s.setVisible(!0),s.transformation=t;else for(const t of n)t.setVisible(!1)}}_ensureEngineResources(){if(o(this._engineResources)){const e=n(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach((({material:e})=>{i.has(e)||(t.push(e),i.add(e))}));const s=(e,t)=>{const{geometry:i,material:s,transform:o}=t;Array.isArray(i)?i.forEach((t=>e.addGeometry(t,s,o))):e.addGeometry(i,s,o)},o=new Map;this._renderObjects.forEach((e=>{const t=new N({castShadow:!1});s(t,e);const i=e.stateMask||0,r=o.get(i)||[];r.push(t),o.set(i,r)}));const r=[];o.forEach(((e,t)=>r.push({stateMask:t,objects:e}))),this._engineResources={objectsByState:r,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){if(this._engineResourcesAddedToStage||o(this._engineResources))return;const{objectsByState:e,layer:t,materials:i}=this._engineResources;i.forEach((e=>{const t=n(this._materialIdReferences),i=t.get(e.id)||0;0===i&&this.view._stage.add(e),t.set(e.id,i+1)})),e.forEach((({objects:e})=>{t.addMany(e),this.view._stage.addMany(e)})),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(e=!1){if(!this._engineResourcesAddedToStage||o(this._engineResources))return;const{objectsByState:t,layer:i,materials:s}=this._engineResources;t.forEach((({objects:e})=>{i.removeMany(e),this.view._stage.removeMany(e)})),s.forEach((e=>{const t=n(this._materialIdReferences),i=t.get(e.id);1===i?(this.view._stage.remove(e),t.delete(e.id)):t.set(e.id,i-1)})),e&&this.view._stage.remove(i),this._engineResourcesAddedToStage=!1}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*(\"touch\"===e?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){const t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,re);return O(e,i[12],i[13],i[14])}_calculateModelTransformOffset(e){const t=this._calculateModelTransformPosition(e);return T(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return m(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&f(t,t,this._worldFrame),f(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,s(this._applyObjectTransform)&&this._applyObjectTransform(t),t}get test(){let e=!1;if(s(this._engineResources))for(const t in this._engineResources.objectsByState){const i=this._engineResources.objectsByState[t];for(const t of i.objects)if(t.isVisible){e=!0;break}if(e)break}return{areAnyResourcesVisible:e}}}function $(e){return 0!==e[12]||0!==e[13]||0!==e[14]}function ee(e,t,s){switch(e.viewingMode){case\"local\":return p(s),!0;case\"global\":{const o=P(e.renderCoordsHelper.spatialReference);return z(t,0,ce,0,o.radius),k(i(ce[0]),i(ce[1]),s),!0}}}const te=a(),ie=M(),se=G(),oe=_(),re=v(),ne=v(),ae=W(),ce=E(),le=E(),he=E(),de=E(),ue=E(),_e=E(),ge=new X({x:0,y:0,z:0,spatialReference:null});export{Y as Manipulator3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{c as r}from\"../../../../chunks/vec4f64.js\";import{bindScreenSizeScalingUniforms as i}from\"../core/shaderLibrary/ScreenSizeScaling.glsl.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindMultipassTerrainTexture as o}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindProjectionMatrix as s,bindView as a,bindCameraPosition as n}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as l}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as p}from\"../core/shaderTechnique/ShaderTechnique.js\";import{parameter as d,ShaderTechniqueConfiguration as c}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{blendingDefault as h,OITBlending as m,OITDepthWrite as u,OITPolygonOffset as g}from\"../lib/OrderIndependentTransparency.js\";import{Program as b}from\"../lib/Program.js\";import{S as f}from\"../../../../chunks/ShadedColorMaterial.glsl.js\";import{makePipelineState as v,cullingParams as y,defaultDepthWriteParams as T,defaultColorWriteParams as E}from\"../../../webgl/renderState.js\";class S extends p{initializeProgram(e){const r=S.shader.get(),i=this.configuration,t=r.build({output:i.output,slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,screenSizeEnabled:i.screenSizeEnabled,shadingEnabled:i.shadingEnabled,OITEnabled:0===i.transparencyPassType,multipassTerrainEnabled:i.multipassTerrainEnabled,cullAboveGround:i.cullAboveGround});return new b(e.rctx,t,P)}bindPass(e,r){const{screenSizeEnabled:t,shadingEnabled:a}=this.configuration,{color:n,shadingTint:l,shadingDirection:p}=e;s(this.program,r.camera.projectionMatrix),this.program.setUniform4fv(\"color\",n),r.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",r.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",r.inverseViewport),o(this.program,r)),a&&(this.program.setUniform4fv(\"shadedColor\",this.blendColor(w,l,n)),this.program.setUniform3fv(\"shadingDirection\",p),this.program.setUniformMatrix4fv(\"viewNormal\",r.camera.viewInverseTransposeMatrix)),t&&i(this.program,e,r)}bindDraw(e){a(this.program,e),n(this.program,e.origin,e.camera.viewInverseTransposeMatrix),t(this.program,this.configuration,e),this.program.rebindTextures()}blendColor(e,r,i){const t=1-r[3],o=r[3]+i[3]*t;return 0===o?(e[3]=o,e):(e[0]=(r[0]*r[3]+i[0]*i[3]*t)/o,e[1]=(r[1]*r[3]+i[1]*i[3]*t)/o,e[2]=(r[2]*r[3]+i[2]*i[3]*t)/o,e[3]=i[3],e)}setPipelineState(e){const r=this.configuration,i=3===e,t=2===e;return v({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?h:m(e),culling:y(r.cullFace),depthTest:{func:t?513:r.shadingEnabled?515:513},depthWrite:i?r.writeDepth&&T:u(e),colorWrite:E,polygonOffset:i||t?null:g})}initializePipeline(){return this.setPipelineState(this.configuration.transparencyPassType)}}S.shader=new l(f,(()=>import(\"./ShadedColorMaterial.glsl.js\")));class j extends c{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([d({count:8})],j.prototype,\"output\",void 0),e([d({count:3})],j.prototype,\"cullFace\",void 0),e([d()],j.prototype,\"slicePlaneEnabled\",void 0),e([d()],j.prototype,\"transparent\",void 0),e([d()],j.prototype,\"writeDepth\",void 0),e([d()],j.prototype,\"screenSizeEnabled\",void 0),e([d()],j.prototype,\"shadingEnabled\",void 0),e([d({count:4})],j.prototype,\"transparencyPassType\",void 0),e([d()],j.prototype,\"multipassTerrainEnabled\",void 0),e([d()],j.prototype,\"cullAboveGround\",void 0);const P=new Map([[\"position\",0],[\"normal\",1],[\"offset\",2]]),w=r();export{S as ShadedColorMaterialTechnique,j as ShadedColorMaterialTechniqueConfiguration,P as ShadedColorMaterialVertexAttrLocations};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{n as e,s as t,a as r,b as s}from\"../../../../chunks/vec3.js\";import{c as i}from\"../../../../chunks/vec3f64.js\";import{center as a,scale as n}from\"../../../../geometry/support/aaBoundingBox.js\";import{BufferViewVec3f as o}from\"../../../../geometry/support/buffer/BufferView.js\";import{newLayout as u}from\"../../support/buffer/InterleavedLayout.js\";import c from\"../lib/GLMaterial.js\";import{outputFromPass as l}from\"../lib/GLMaterials.js\";import{materialParametersDefaults as f,Material as h}from\"../lib/Material.js\";import{assert as p}from\"../lib/Util.js\";import{writeDefaultAttributes as m,writePosition as d}from\"./internal/bufferWriterUtils.js\";import{intersectTriangleGeometry as b}from\"./internal/MaterialUtil.js\";import{ShadedColorMaterialTechniqueConfiguration as g,ShadedColorMaterialVertexAttrLocations as v,ShadedColorMaterialTechnique as E}from\"../shaders/ShadedColorMaterialTechnique.js\";class q extends h{constructor(e){super(e,C),this.supportsEdges=!0,this.techniqueConfig=new g,this._vertexAttributeLocations=v}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.parameters.cullFace,this.techniqueConfig.slicePlaneEnabled=this.parameters.slicePlaneEnabled,this.techniqueConfig.transparent=this.parameters.transparent,this.techniqueConfig.writeDepth=this.parameters.writeDepth,this.techniqueConfig.screenSizeEnabled=this.parameters.screenSizeEnabled,this.techniqueConfig.shadingEnabled=this.parameters.shadingEnabled,this.techniqueConfig.transparencyPassType=t.transparencyPassType,this.techniqueConfig.multipassTerrainEnabled=t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=t.cullAboveGround,this.techniqueConfig}getPassParameters(){return this.parameters}intersect(e,i,o,u,c,l,f){if(this.parameters.screenSizeEnabled){const o=e.vertexAttributes.get(\"offset\"),h={applyToVertex:(e,i,a,n)=>{const c=t(z,o.data[3*n+0],o.data[3*n+1],o.data[3*n+2]),l=t(w,e,i,a);return r(c,c,this.parameters.screenSize*u.camera.computeRenderPixelSizeAt(c)),s(l,l,c),[l[0],l[1],l[2]]},applyToAabb:e=>{const t=a(e,z);return n(e,this.parameters.screenSize*u.camera.computeRenderPixelSizeAt(t))}};b(e,i,u,c,l,h,f)}else b(e,i,u,c,l,void 0,f)}requiresSlot(e,t){if(4===l(t))return 2===e;let r=2;return this.parameters.transparent&&(r=this.parameters.writeDepth?4:7),e===r||20===e}createGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new S(e):null}createBufferWriter(){return new x(this.parameters.screenSizeEnabled)}}class S extends c{updateParameters(e){return this.ensureTechnique(E,e)}beginSlot(e){return this.updateParameters(e)}bind(e,t){t.bindPass(this._material.getPassParameters(),e)}}const C={color:[1,1,1,1],shadingTint:[0,0,0,.25],shadingDirection:e(i(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,screenSizeEnabled:!1,screenSize:14,shadingEnabled:!0,...f};class x{constructor(e){this.screenSizeEnabled=e;const t=u().vec3f(\"position\").vec3f(\"normal\");this.screenSizeEnabled&&t.vec3f(\"offset\"),this.vertexBufferLayout=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(\"position\").length}write(e,t,r,s){if(m(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,s),this.screenSizeEnabled){if(!t.vertexAttributes.has(\"offset\"))throw new Error(\"offset vertex attribute required for screenSizeEnabled ShadedColorMaterial\");{const i=t.vertexAttributes.get(\"offset\"),a=t.indices.get(\"offset\");p(3===i.size);const n=r.getField(\"offset\",o);if(!n)throw new Error(\"unable to acquire view for offset\");d(a,i.data,e.invTranspTransformation,n,s)}}}}const z=i(),w=i();export{q as ShadedColorMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../core/maybe.js\";import{b as r}from\"../../../chunks/mat4.js\";import{f as n,c as o,m as c,n as a}from\"../../../chunks/vec3.js\";import{f as i}from\"../../../chunks/vec4f64.js\";import{sv3d as s,sm4d as l}from\"../../../geometry/support/vectorStacks.js\";import{hydrateGeometry as m}from\"../../../layers/graphics/hydratedFeatures.js\";import{Manipulator3D as u}from\"./Manipulator3D.js\";import{computeCentroid as p}from\"../layers/graphics/graphicUtils.js\";import g from\"../webgl-engine/lib/GeometryUtil.js\";import{ColorMaterial as f}from\"../webgl-engine/materials/ColorMaterial.js\";import{ShadedColorMaterial as h}from\"../webgl-engine/materials/ShadedColorMaterial.js\";function d(e,t=4,r=!0){const n=i(e[0],e[1],e[2],e.length>3?e[3]:1),o=e[3]<1;return r?new h({color:n,transparent:o,writeDepth:!0,cullFace:2,renderOccluded:t}):new f({color:n,transparent:o,writeDepth:!0,cullFace:2,renderOccluded:t})}function j(e,t=4){const r=i(e[0],e[1],e[2],4===e.length?e[3]:1);return new f({color:r,transparent:!0,writeDepth:!0,cullFace:1,renderOccluded:t})}function w(e,t,r){return new u({view:e,renderObjects:[{geometry:g.createSphereGeometry(1,32,32),material:d(i(t[0],t[1],t[2],null!=r?r:1))}]})}function y(e,t,a,i){const m=n(s.get(),e,a),u=b(m,o(s.get(),i,m),a,l.get());r(u,u);const p=c(s.get(),t,u);return Math.atan2(p[1],p[0])}function b(e,t,r,n){const c=a(s.get(),e),i=a(s.get(),t),l=o(s.get(),c,i);return n[0]=c[0],n[1]=c[1],n[2]=c[2],n[3]=0,n[4]=i[0],n[5]=i[1],n[6]=i[2],n[7]=0,n[8]=l[0],n[9]=l[1],n[10]=l[2],n[11]=0,n[12]=r[0],n[13]=r[1],n[14]=r[2],n[15]=1,n}function O(t,r){const n=t.getViewForGraphic(r);return e(n)&&\"computeAttachmentOrigin\"in n?n.computeAttachmentOrigin(r,t.spatialReference):null}function v(t,r,n){const o=O(t,n);e(o)?r.elevationAlignedLocation=o:F(r,n.geometry)}function F(e,r){if(t(r))return;const n=\"mesh\"===r.type?r.anchor:p(r);t(n)||(e.location=m(n))}export{y as calculateInputRotationTransform,b as calculateTranslateRotateFromBases,d as createManipulatorMaterial,j as createManipulatorOutlineMaterial,w as createSphereManipulator,O as getGraphicAttachmentOrigin,v as placeAtGraphic};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport o from\"../../../../../core/has.js\";import{deg2rad as t}from\"../../../../../core/mathUtils.js\";const r=o(\"mac\")?\"Meta\":\"Control\",s=\"Shift\",a=2,c=1.15,m=1.15,h=1.1,e=2500,i=.02,f=Math.cos(t(45)),p=Math.cos(t(5)),M=.95,j=.3,l=.7,n=[1,.5,0],x=2,C=1,S=[...n,l],U=[0,0,0,.04],b=[...n,.5],d=[...n,1],g=[1,1,1,1],k=[1,.8,.6,1],q=[1,.93,.86,1],u=[...n,1],v=[...n,1],w=3,y=11,z=22.5,A=40,B=48,D=2.25,E=[...n,1],F=4,G=1,H=.3,I=6,J=4,K=12,L=40,N=27,O=1600,P=.4;export{a as DISPLAY_FOCUS_MULTIPLIER,b as GRID_COLOR,i as INITIAL_DEPTH_OFFSET_FRAC,P as INITIAL_PLANE_HALF_SIZE_VIEW_PROPORTION,U as PLANE_BACKGROUND_COLOR,O as PLANE_MIN_BASIS_SCREEN_LEN2,S as PLANE_OUTLINE_COLOR,C as PLANE_OUTLINE_WIDTH,x as PLANE_PREVIEW_OUTLINE_WIDTH,e as POINTER_MOVE_TIMER_MS,M as PREVIEW_FADE_DOT_THRESHOLD,j as PREVIEW_FADE_DURATION_SECONDS,E as RESIZE_HANDLE_COLOR,I as RESIZE_HANDLE_CORNER_INPUT_RADIUS,F as RESIZE_HANDLE_CORNER_WIDTH,J as RESIZE_HANDLE_EDGE_INPUT_RADIUS,H as RESIZE_HANDLE_EDGE_PADDING_FRAC,G as RESIZE_HANDLE_EDGE_WIDTH,d as ROTATE_HEADING_CALLOUT_COLOR,N as ROTATE_HEADING_DISC_RADIUS,h as ROTATE_HEADING_DISC_RADIUS_FOCUS_MULTIPLIER,L as ROTATE_HEADING_OFFSET_DISTANCE,K as ROTATE_HEADING_TIP_LENGTH,k as SHIFT_RESTART_ARROW_CAP_COLOR,B as SHIFT_RESTART_ARROW_LENGTH,D as SHIFT_RESTART_ARROW_OUTLINE_WIDTH,g as SHIFT_RESTART_ARROW_TIP_COLOR,u as SHIFT_RESTART_CALLOUT_COLOR,A as SHIFT_RESTART_OFFSET_DISTANCE,v as SHIFT_RESTART_OUTLINE_COLOR,m as SHIFT_RESTART_TIP_FOCUS_MULTIPLIER,z as SHIFT_RESTART_TIP_LENGTH,y as SHIFT_RESTART_TIP_RADIUS,q as SHIFT_RESTART_TUBE_COLOR,c as SHIFT_RESTART_TUBE_FOCUS_MULTIPLIER,w as SHIFT_RESTART_TUBE_RADIUS,p as SMALL_ANGLE_DOT_THRESHOLD,f as VERTICAL_DOT_THRESHOLD,r as forceHorizontalModifier,s as forceVerticalModifier};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{bindProjectionMatrix as r,bindView as e}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as i}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{Default3D as t}from\"../lib/DefaultVertexAttributeLocations.js\";import{Program as a}from\"../lib/Program.js\";import{S as s}from\"../../../../chunks/SlicePlaneMaterial.glsl.js\";import{makePipelineState as l,separateBlendingParams as n,defaultColorWriteParams as m}from\"../../../webgl/renderState.js\";class d extends o{initializeProgram(r){const e=d.shader.get().build();return new a(r.rctx,e,t)}bindPass(e,i){r(this.program,i.camera.projectionMatrix),this.program.setUniform4fv(\"backgroundColor\",e.backgroundColor),this.program.setUniform4fv(\"gridColor\",e.gridColor),this.program.setUniform1f(\"gridWidth\",e.gridWidth)}bindDraw(r){e(this.program,r),this.program.rebindTextures()}initializePipeline(){return l({blending:n(1,1,771,771),depthTest:{func:513},colorWrite:m})}}d.shader=new i(s,(()=>import(\"./SlicePlaneMaterial.glsl.js\")));export{d as SlicePlaneMaterialTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{unwrap as r}from\"../../../../core/maybe.js\";import{ShaderTechniqueConfiguration as e}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import t from\"../lib/GLMaterial.js\";import{Material as i,materialParametersDefaults as n}from\"../lib/Material.js\";import{DefaultBufferWriter as o,PositionUVLayout as s}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as a}from\"./internal/MaterialUtil.js\";import{SlicePlaneMaterialTechnique as u}from\"../shaders/SlicePlaneMaterialTechnique.js\";class l extends i{constructor(r){super(r,m),this._config=new e}intersect(r,e,t,i,n,o,s){return a(r,e,i,n,o,void 0,s)}createBufferWriter(){return new o(s)}requiresSlot(r){return 7===r}createGLMaterial(r){return 0===r.output?new c(r):null}getTechniqueConfig(){return this._config}}class c extends t{constructor(r){super(r),this.ensureTechnique(u,null)}updateParameters(){return r(this.technique)}beginSlot(){return r(this.technique)}bind(r,e){e.bindPass(this._material.parameters,r)}}const m={backgroundColor:[1,0,0,.5],gridColor:[0,1,0,.5],gridWidth:4,...n};export{l as SlicePlaneMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{isSome as r}from\"../../../../core/maybe.js\";import{c as e}from\"../../../../chunks/vec4.js\";import{f as t}from\"../../../../chunks/vec4f32.js\";import{Object3DVisualElement as i}from\"./Object3DVisualElement.js\";import a from\"../../webgl-engine/lib/GeometryUtil.js\";import{SlicePlaneMaterial as s}from\"../../webgl-engine/materials/SlicePlaneMaterial.js\";class d extends i{constructor(r){super(r),this._material=null,this._renderOccluded=4,this._gridWidth=1,this._gridColor=t(1,0,0,1),this._backgroundColor=t(1,0,0,1),this.applyProps(r)}get renderOccluded(){return this._renderOccluded}set renderOccluded(r){r!==this._renderOccluded&&(this._renderOccluded=r,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(r){this._gridWidth!==r&&(this._gridWidth=r,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(r){e(this._gridColor,r),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(r){e(this._backgroundColor,r),this._updateMaterial()}createExternalResources(){this._material=new s(this.materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(e){r(this._material)&&e(this._material)}createGeometries(e){if(r(this._material)){const r=a.createSquareGeometry();e.addGeometry(r,this._material)}}get materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}_updateMaterial(){r(this._material)&&this._material.setParameters(this.materialParameters)}}export{d as SlicePlaneVisualElement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import{JSONSupport as o}from\"../../core/JSONSupport.js\";import{clone as e}from\"../../core/lang.js\";import{equalsMaybe as i}from\"../../core/maybe.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import{cast as s}from\"../../core/accessorSupport/decorators/cast.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{ensureNumber as h}from\"../../core/accessorSupport/ensureType.js\";import{persistable as n}from\"../../core/accessorSupport/decorators/persistable.js\";import{cyclicalDeg as a}from\"../../views/3d/support/mathUtils.js\";import l from\"../../geometry/Point.js\";var m;let c=m=class extends o{constructor(t){super(t),this.type=\"plane\",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}clone(){return new m({position:e(this.position),heading:this.heading,tilt:this.tilt,width:this.width,height:this.height})}equals(t){return this.heading===t.heading&&this.tilt===t.tilt&&i(this.position,t.position)&&this.width===t.width&&this.height===t.height}};t([r({readOnly:!0,json:{read:!1,write:!0}})],c.prototype,\"type\",void 0),t([r({type:l}),n()],c.prototype,\"position\",void 0),t([r({type:Number,nonNullable:!0,range:{min:0,max:360}}),n(),s((t=>a.normalize(h(t),0,!0)))],c.prototype,\"heading\",void 0),t([r({type:Number,nonNullable:!0,range:{min:0,max:360}}),n(),s((t=>a.normalize(h(t),0,!0)))],c.prototype,\"tilt\",void 0),t([r({type:Number,nonNullable:!0}),n()],c.prototype,\"width\",void 0),t([r({type:Number,nonNullable:!0}),n()],c.prototype,\"height\",void 0),c=m=t([p(\"esri.widgets.Slice.SlicePlane\")],c);const d=c;export{d as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport\"../../../../../geometry.js\";import{neverReached as e}from\"../../../../../core/compilerUtils.js\";import t from\"../../../../../core/Logger.js\";import{rad2deg as i,deg2rad as r}from\"../../../../../core/mathUtils.js\";import{isNone as s,isSome as n,unwrapOr as o}from\"../../../../../core/maybe.js\";import{castRenderScreenPointArray3 as a}from\"../../../../../core/screenUtils.js\";import{r as c,i as l,f as u,m,d,a as p,g}from\"../../../../../chunks/mat4.js\";import{c as f}from\"../../../../../chunks/mat4f64.js\";import{r as b}from\"../../../../../chunks/quat.js\";import{a as h,g as y,d as w,c as j,n as M,b as v,l as k,f as P,p as R,s as x,v as U}from\"../../../../../chunks/vec3.js\";import{a as O,c as S,f as T}from\"../../../../../chunks/vec3f64.js\";import{tryProjectWithZConversion as C}from\"../../../../../geometry/projection.js\";import{r as E,f as L,i as F,c as A,n as z,u as G}from\"../../../../../chunks/boundedPlane.js\";import{fromPositionAndNormal as I,fromVectorsAndPoint as H}from\"../../../../../geometry/support/plane.js\";import{create as D}from\"../../../../../geometry/support/ray.js\";import{angleAroundAxis as B}from\"../../../../../geometry/support/vector.js\";import{sv3d as W,sm4d as V,sq4d as Z}from\"../../../../../geometry/support/vectorStacks.js\";import{Manipulator3D as q}from\"../../Manipulator3D.js\";import{calculateTranslateRotateFromBases as N}from\"../../manipulatorUtils.js\";import{SHIFT_RESTART_TIP_RADIUS as $,RESIZE_HANDLE_EDGE_PADDING_FRAC as J,SMALL_ANGLE_DOT_THRESHOLD as K,PLANE_MIN_BASIS_SCREEN_LEN2 as Q,INITIAL_PLANE_HALF_SIZE_VIEW_PROPORTION as X,SHIFT_RESTART_OFFSET_DISTANCE as Y,SHIFT_RESTART_ARROW_OUTLINE_WIDTH as _,SHIFT_RESTART_ARROW_TIP_COLOR as ee,SHIFT_RESTART_ARROW_CAP_COLOR as te,SHIFT_RESTART_TUBE_COLOR as ie,SHIFT_RESTART_OUTLINE_COLOR as re,SHIFT_RESTART_CALLOUT_COLOR as se,ROTATE_HEADING_OFFSET_DISTANCE as ne,ROTATE_HEADING_DISC_RADIUS as oe,ROTATE_HEADING_CALLOUT_COLOR as ae,PLANE_OUTLINE_COLOR as ce,PLANE_OUTLINE_WIDTH as le,PLANE_BACKGROUND_COLOR as ue,GRID_COLOR as me,RESIZE_HANDLE_CORNER_INPUT_RADIUS as de,RESIZE_HANDLE_EDGE_INPUT_RADIUS as pe,ROTATE_HEADING_TIP_LENGTH as ge,VERTICAL_DOT_THRESHOLD as fe,ROTATE_HEADING_DISC_RADIUS_FOCUS_MULTIPLIER as be,RESIZE_HANDLE_COLOR as he,DISPLAY_FOCUS_MULTIPLIER as ye,RESIZE_HANDLE_EDGE_WIDTH as we,SHIFT_RESTART_ARROW_LENGTH as je,SHIFT_RESTART_TUBE_RADIUS as Me,SHIFT_RESTART_TIP_LENGTH as ve,SHIFT_RESTART_TUBE_FOCUS_MULTIPLIER as ke,SHIFT_RESTART_TIP_FOCUS_MULTIPLIER as Pe,RESIZE_HANDLE_CORNER_WIDTH as Re}from\"./sliceToolConfig.js\";import{LineVisualElement as xe}from\"../../visualElements/LineVisualElement.js\";import{SlicePlaneVisualElement as Ue}from\"../../visualElements/SlicePlaneVisualElement.js\";import{getElevationAtPoint as Oe}from\"../../../support/ElevationProvider.js\";import{RenderCoordsHelper as Se}from\"../../../support/RenderCoordsHelper.js\";import{fromRender as Te}from\"../../../support/geometryUtils/ray.js\";import{Geometry as Ce}from\"../../../webgl-engine/lib/Geometry.js\";import Ee from\"../../../webgl-engine/lib/GeometryUtil.js\";import{ColorMaterial as Le}from\"../../../webgl-engine/materials/ColorMaterial.js\";import{ImageMaterial as Fe}from\"../../../webgl-engine/materials/ImageMaterial.js\";import{NativeLineMaterial as Ae}from\"../../../webgl-engine/materials/NativeLineMaterial.js\";import{RibbonLineMaterial as ze}from\"../../../webgl-engine/materials/RibbonLineMaterial.js\";import Ge from\"../../../../../widgets/Slice/SlicePlane.js\";import Ie from\"../../../../../geometry/Extent.js\";const He=t.getLogger(\"esri.views.3d.interactive.analysisTools.slice.sliceToolUtils\");function De(e,t,i,r,s,n,o,a){return Be(t,o.worldUpAtPosition(e,W.get()),s,n,a.basis1,a.basis2),h(a.basis1,a.basis1,i),h(a.basis2,a.basis2,r),y(a.origin,e),H(a.basis2,a.basis1,a.origin,a.plane),a}function Be(e,t,i,r,s,n){const o=w(e,t),a=W.get(),c=W.get();switch(0===r?Math.abs(o)>fe?1:2:r){case 2:{const r=Math.abs(o)<=K?e:i.viewUp;j(a,r,t),y(c,t);break}case 1:j(a,i.viewUp,t),j(c,t,a);break;case 3:{const r=Math.abs(o)<=K?t:i.viewUp;j(a,r,e),j(c,e,a);break}}const l=j(W.get(),a,c);w(l,i.viewForward)>0&&h(c,c,-1),M(s,a),M(n,c)}function We(e,t,i){const r=t.worldUpAtPosition(e.origin,W.get()),s=e.basis1,n=ft(e,r),o=Math.round(n/Rt)*Rt;return E(e,o-n,s,i)}function Ve(e,t,i,r,s,n){const o=y(W.get(),s.origin);v(o,o,h(W.get(),s.basis1,e.direction[0]<0?1:-1)),v(o,o,h(W.get(),s.basis2,e.direction[1]<0?1:-1));const a=k(s.basis1),c=k(s.basis2),l=P(W.get(),i,o),u=P(W.get(),t,o);let m=0,d=0;if(rt(e)){const t=it(s),i=it(n);m=a-.5*e.direction[0]*w(s.basis1,u)/a,d=c-.5*e.direction[1]*w(s.basis2,u)/c;const r=i/t;m*=r,d*=r}const p=m+.5*e.direction[0]*w(s.basis1,l)/a,g=d+.5*e.direction[1]*w(s.basis2,l)/c,f=h(W.get(),s.basis1,p/a),b=h(W.get(),s.basis2,g/c);(p<=0||et(n.origin,f,r)<=Q)&&y(f,n.basis1),(g<=0||et(n.origin,b,r)<=Q)&&y(b,n.basis2);const j=y(W.get(),o);return v(j,j,h(W.get(),f,e.direction[0]<0?-1:1)),v(j,j,h(W.get(),b,e.direction[1]<0?-1:1)),L(j,f,b,n)}function Ze(e,t){return X*Math.min(t.width,t.height)*t.computeRenderPixelSizeAt(e)}function qe(e,t,i,r){const s=j(W.get(),t,i);return j(s,s,t),I(e,s,r)}function Ne(e,t){return N(e.basis1,e.basis2,e.origin,t)}function $e(e,t,i,r){const s=t.worldUpAtPosition(e.origin,W.get()),n=W.get();switch(i){case 1:y(n,s);break;case 2:y(n,e.basis1)}return I(e.origin,n,r)}function Je(e,t,i,r){const s=_e(i,2),n=V.get();c(n,t,s.edge*Math.PI/2);const o=M(W.get(),s.basis);let l=h(W.get(),o,s.direction*r.computeScreenPixelSizeAt(s.position)*Y);v(l,l,s.position);const u=r.projectToRenderScreen(l,a(W.get())),m=Ke(r,u);Te(r,u,Pt),M(Pt.direction,Pt.direction);const d=W.get();!m&&F(i,Pt,d)&&(l=d),n[12]=0,n[13]=0,n[14]=0,e.modelTransform=n,e.renderLocation=O(l),m?e.state|=kt:e.state&=~kt}function Ke(e,t){const[i,r,s,n]=e.viewport,o=Math.min(s,n)/16;let a=!0;return t[0]<i+o?(t[0]=i+o,a=!1):t[0]>i+s-o&&(t[0]=i+s-o,a=!1),t[1]<r+o?(t[1]=r+o,a=!1):t[1]>r+n-o&&(t[1]=r+n-o,a=!1),a}function Qe(e,t,i,r){const s=k(r.basis1),n=k(r.basis2),o=tt(r),a=it(r),d=x(W.get(),0,0,0);v(d,h(W.get(),r.basis1,t.direction[0]),h(W.get(),r.basis2,t.direction[1])),v(d,r.origin,d);let p=0,g=1;if(rt(t))1===t.direction[0]&&-1===t.direction[1]?p=Rt:1===t.direction[0]&&1===t.direction[1]?p=Math.PI:-1===t.direction[0]&&1===t.direction[1]&&(p=3*Math.PI/2),g=a;else{const e=0!==t.direction[0]?1:2;p=1===e?Rt:0,g=(1===e?n:s)-o}const f=l(V.get());c(f,f,p),u(f,f,x(W.get(),g,g,g)),m(f,i,f),f[12]=0,f[13]=0,f[14]=0,e.modelTransform=f,e.renderLocation=d}function Xe(e,t,i,r){const s=r.worldUpAtPosition(i.origin,W.get()),n=_e(i,0),o=l(V.get());c(o,o,n.edge*Math.PI/2),d(o,o,-ft(i,s)),m(o,t,o),o[12]=0,o[13]=0,o[14]=0,e.modelTransform=o,e.renderLocation=n.position}function Ye(e,t,i){const r=_e(i,1),s=l(V.get());c(s,s,r.edge*Math.PI/2),d(s,s,Rt),m(s,t,s),s[12]=0,s[13]=0,s[14]=0,e.modelTransform=s,e.renderLocation=r.position}function _e(e,t){switch(t){case 0:return{basis:e.basis1,direction:1,position:v(W.get(),e.origin,e.basis1),edge:t};case 1:return{basis:e.basis2,direction:1,position:v(W.get(),e.origin,e.basis2),edge:t};case 2:return{basis:e.basis1,direction:-1,position:P(W.get(),e.origin,e.basis1),edge:t};case 3:return{basis:e.basis2,direction:-1,position:P(W.get(),e.origin,e.basis2),edge:t}}}function et(e,t,i){const r=i.projectToRenderScreen(v(W.get(),e,t),a(W.get())),s=i.projectToRenderScreen(P(W.get(),e,t),a(W.get()));return R(P(r,r,s))}function tt(e){const t=k(e.basis1),i=k(e.basis2);return J*Math.min(t,i)}function it(e){return tt(e)}function rt(e){return 0!==e.direction[0]&&0!==e.direction[1]}function st(e,t=1){const i=0===t?Y:0,r=[T(i,0,-je/2),T(i,0,je/2)],s=mt(r,!0),n=(e,t)=>lt(r,r,{tubeRadius:Me,tipRadius:$,tipLength:ve,tubeFocusMultiplier:ke,tipFocusMultiplier:Pe,padding:e,bothEnds:!0,flat:null,focusTipLength:!0,addCap:t}),o=n(0,!1),a=n(_,!0),c=new Le({color:ee,cullFace:2,renderOccluded:16}),l=new Le({color:te,cullFace:2,renderOccluded:16}),u=new Le({color:ie,cullFace:2,renderOccluded:16}),m=new Le({color:re,transparent:!0,writeDepth:!1,cullFace:1,renderOccluded:2}),d=Ee.createPolylineGeometry([[i,0,0],[i-Y,0,0]]),p=Ee.createPolylineGeometry([[i,0,0],[i-Y,0,0]]),g=new Ae({color:se,renderOccluded:4});return new q({view:e,renderObjects:[...o.normal.map((({part:e,geometry:t,transform:i})=>({geometry:t,material:\"tip\"===e?c:\"cap\"===e?l:u,transform:i,stateMask:1|vt}))),...a.normal.map((({geometry:e,transform:t})=>({geometry:e,material:m,transform:t,stateMask:1|vt}))),{geometry:d,material:g,stateMask:1|vt|kt},...o.focused.map((({part:e,geometry:t,transform:i})=>({geometry:t,material:\"tip\"===e?c:\"cap\"===e?l:u,transform:i,stateMask:2|vt}))),...a.focused.map((({geometry:e,transform:t})=>({geometry:e,material:m,transform:t,stateMask:2|vt}))),{geometry:p,material:g,stateMask:2|vt|kt}],autoScaleRenderObjects:!1,collisionType:{type:\"line\",paths:[s]},collisionPriority:1,radius:$,state:vt})}function nt(e,t){const i=new Fe({transparent:!0,writeDepth:!1,textureId:t.id,renderOccluded:16}),r=ne,s=oe,n=s*be,o=e=>{const t=new Uint32Array([0,1,2,2,3,0]);return new Ce([[\"position\",{size:3,data:[r-e,-e,0,r+e,-e,0,r+e,e,0,r-e,e,0],exclusive:!0}],[\"uv0\",{size:2,data:[0,0,1,0,1,1,0,1]}]],[[\"position\",t],[\"uv0\",t]])},a=Ee.createPolylineGeometry([[0,0,0],[r-s,0,0]]),c=Ee.createPolylineGeometry([[0,0,0],[r-n,0,0]]),l=new Ae({color:ae,renderOccluded:4}),u=[{geometry:o(s),material:i,stateMask:1|vt},{geometry:a,material:l,stateMask:1|vt},{geometry:o(n),material:i,stateMask:2|vt},{geometry:c,material:l,stateMask:2|vt}];return new q({view:e,renderObjects:u,autoScaleRenderObjects:!1,collisionType:{type:\"disc\",direction:[0,0,1],offset:[r,0,0]},collisionPriority:1,radius:s/2,state:vt})}function ot(e){return new xe({view:e,attached:!0,color:ce,width:le,writeDepthEnabled:!1,renderOccluded:4,geometry:[[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]]]})}function at(e){return new Ue({view:e,attached:!0,backgroundColor:[...ue],gridColor:me,gridWidth:4,renderOccluded:4})}function ct(e,t){const i=rt(t),r=i?[T(1,0,0),T(0,0,0),T(0,1,0)]:[T(1,0,0),T(-1,0,0)],s=Ee.createPolylineGeometry(r),n=he,o=e=>new ze({color:n,width:e,renderOccluded:4}),a=()=>new Ae({color:n,renderOccluded:4}),c=i?Re:we,l=c*ye,u=we,m=e=>e>1?o(e):a(),d=[{geometry:s,material:m(c),stateMask:1|xt},{geometry:s,material:m(l),stateMask:2|xt},{geometry:s,material:m(u),stateMask:Ut}],p=new q({view:e,renderObjects:d,collisionType:{type:\"line\",paths:[r]},autoScaleRenderObjects:!1,worldSized:!0,radius:i?de:pe});return p.state=xt,p}function lt(e,t,i){const r=r=>{const s=(r?t:e).slice(0),o=P(W.get(),s[0],s[1]);M(o,o);const a=P(W.get(),s[s.length-1],s[s.length-2]);if(M(a,a),i.padding>0){const e=h(S(),a,-i.padding);if(s[s.length-1]=v(e,e,s[s.length-1]),i.bothEnds){const e=h(S(),o,-i.padding);s[0]=v(e,e,s[0])}}const c=r?i.tipFocusMultiplier:1,d=i.tipLength*(i.focusTipLength?c:1),y=i.tipRadius*c,w=l(V.get());if(i.padding>0){const e=d/4,t=x(W.get(),0,e,0),r=1+i.padding/e;p(w,w,t),u(w,w,x(W.get(),r,r,r)),p(w,w,h(t,t,-1/r))}const j=l(f()),k=T(0,1,0),R=g(f(),b(Z.get(),k,a));R[12]=s[s.length-1][0],R[13]=s[s.length-1][1],R[14]=s[s.length-1][2],m(R,R,w);const U=[{part:\"tube\",geometry:ut(i.tubeRadius*(r?i.tubeFocusMultiplier:1)+i.padding,i.flat,s),transform:j}];let O,C;if(n(i.flat)?O=Ee.createExtrudedTriangle(d,y,y,i.flat.thickness):(O=Ee.createConeGeometry(d,y,24,!1,!1,!0),C=Ee.createConeGeometry(d,y,24,!1,!0,!1)),U.push({part:\"tip\",geometry:O,transform:R}),C&&U.push({part:\"cap\",geometry:C,transform:R}),i.bothEnds){const e=g(f(),b(Z.get(),k,o));e[12]=s[0][0],e[13]=s[0][1],e[14]=s[0][2],m(e,e,w),U.push({part:\"tip\",geometry:O,transform:e}),C&&U.push({part:\"cap\",geometry:C,transform:e})}return U};return{normal:r(!1),focused:r(!0)}}function ut(e,t,i){const r=[];if(n(t))r.push([e,t.thickness/2],[-e,t.thickness/2],[-e,-t.thickness/2],[e,-t.thickness/2]);else{const t=12;for(let i=0;i<t;i++){const s=i/t*2*Math.PI;r.push([Math.cos(s)*e,Math.sin(s)*e])}}return Ee.createPathExtrusionGeometry(r,i,[],[],!1)}function mt(e,t){const i=P(S(),e[e.length-1],e[e.length-2]);if(M(i,i),h(i,i,ge),v(i,i,e[e.length-1]),t){const t=P(S(),e[0],e[1]);return M(t,t),h(t,t,ge),v(t,t,e[0]),[t,...e,i]}return[...e,i]}function dt(e,t,r,n=new Ge){if(s(e))return null;const{renderCoordsHelper:o}=t,a=o.fromRenderCoords(e.origin,t.spatialReference);if(s(a))return null;const c=C(a,r);if(s(c))return null;n.position=c;const l=o.worldUpAtPosition(e.origin,W.get()),u=o.worldBasisAtPosition(e.origin,1,W.get()),m=2*k(e.basis1),d=2*k(e.basis2),p=Se.renderUnitScaleFactor(t.spatialReference,r);return n.width=m*p,n.height=d*p,n.tilt=i(ft(e,l)),n.heading=i(bt(e,l,u)),n}function pt(e,t,i){if(s(e)||s(e.position))return null;const{spatialReference:r}=e.position,o=gt(wt(e,{renderCoordsHelper:t,spatialReference:r},i),t,r);return!e.position.hasZ&&n(o)&&(o.zmin=null,o.zmax=null),o}function gt(e,t,i){if(s(e))return null;const r=e.origin,n=W.get(),o=W.get(),a=W.get(),c=W.get();let l,u,m,d,p,g;v(n,r,e.basis1),v(n,n,e.basis2),v(o,r,e.basis1),U(o,o,e.basis2),U(a,r,e.basis1),U(a,a,e.basis2),U(c,r,e.basis1),v(c,c,e.basis2);for(const f of[n,o,a,c]){const e=t.fromRenderCoords(f,f,i);if(s(e))return null;l=null==l?e[0]:Math.min(l,e[0]),u=null==u?e[0]:Math.max(u,e[0]),m=null==m?e[1]:Math.min(m,e[1]),d=null==d?e[1]:Math.max(d,e[1]),p=null==p?e[2]:Math.min(p,e[2]),g=null==g?e[2]:Math.max(g,e[2])}return new Ie({xmin:l,xmax:u,ymin:m,ymax:d,zmin:p,zmax:g,spatialReference:i})}function ft(e,t){return B(t,e.basis2,e.basis1)+Rt}function bt(e,t,i){return B(e.basis1,i,t)-Rt}function ht(e,t,i,s,n,o,a=A()){return o.toRenderCoords(e,a.origin)?(o.worldBasisAtPosition(a.origin,0,a.basis1),o.worldBasisAtPosition(a.origin,1,a.basis2),H(a.basis2,a.basis1,a.origin,a.plane),E(a,-r(t),z(a),a),E(a,r(i),a.basis1,a),h(a.basis1,a.basis1,s/2),h(a.basis2,a.basis2,n/2),G(a),a):(He.error(`Failed to project slice plane position, projection from ${e.spatialReference.wkid} is not supported`),null)}function yt(e,t){if(s(e)||s(e.position))return null;const i=C(e.position,t);if(s(i))return null;const r=Se.renderUnitScaleFactor(e.position.spatialReference,t),n=e.width*r,o=e.height*r;return{position:i,heading:e.heading,tilt:e.tilt,renderWidth:n,renderHeight:o}}function wt(e,t,i,r=A()){const n=yt(e,t.spatialReference);return s(n)?null:jt(n,t,i,r)}function jt(e,t,i,r=A()){if(s(e))return null;let a=e.position;!e.position.hasZ&&n(t.elevationProvider)&&(a=e.position.clone(),a.z=o(Oe(t.elevationProvider,e.position),0));const c=ht(a,e.heading,e.tilt,e.renderWidth,e.renderHeight,t.renderCoordsHelper,r);return!i.tiltEnabled&&n(c)&&We(c,t.renderCoordsHelper,c),c}function Mt(t){switch(t.type){case\"analysis\":case\"building-scene\":case\"csv\":case\"feature\":case\"geo-rss\":case\"geojson\":case\"graphics\":case\"group\":case\"integrated-mesh\":case\"kml\":case\"map-notes\":case\"ogc-feature\":case\"point-cloud\":case\"route\":case\"scene\":case\"stream\":case\"voxel\":case\"subtype-group\":case\"unknown\":case\"unsupported\":case\"wfs\":case null:return!1;case\"base-dynamic\":case\"base-elevation\":case\"base-tile\":case\"bing-maps\":case\"elevation\":case\"imagery\":case\"imagery-tile\":case\"map-image\":case\"open-street-map\":case\"tile\":case\"vector-tile\":case\"wcs\":case\"web-tile\":case\"wms\":case\"wmts\":return!0;default:return e(t.type),!1}}const vt=16,kt=32,Pt=D(),Rt=Math.PI/2,xt=16,Ut=32;function Ot(e){const t=\"building-scene-3d\"===e.type?e:null;return n(t)}export{vt as DidPointerMoveRecentlyFlag,kt as IsShiftEdgeOnScreenFlag,mt as addArrowTips,Ne as calculateBoundedPlaneTranslateRotate,it as calculateDiagonalResizeHandleScale,Ze as calculatePlaneHalfSize,tt as calculateResizeHandlePadding,et as calculateScreenSpaceBasisLength2,lt as createArrowGeometry,at as createGridVisualElement,ot as createOutlineVisualElement,De as createPlane,ct as createResizeManipulator,nt as createRotateManipulator,$e as createRotatePlane,st as createShiftManipulator,qe as createShiftPlane,We as forceHorizontalOrVertical,Mt as isAlwaysDrapedLayer,rt as isDiagonalResizeHandle,Ot as isIBuildingSceneLayerView3D,Be as normalToBases,gt as planeToExtent,dt as planeToShape,yt as projectShape,jt as projectedShapeToPlane,xt as resizeNormal,Ut as resizeOutlineOnly,Ve as resizePlane,pt as shapeToExtent,wt as shapeToPlane,Qe as updateResizeHandle,Xe as updateRotateHeadingHandle,Ye as updateRotateTiltHandle,Je as updateShiftRestartHandle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import i from\"../../../../core/Accessor.js\";import t from\"../../../../core/Handles.js\";import s from\"../../../../core/Logger.js\";import{isSome as a,isNone as l}from\"../../../../core/maybe.js\";import{reactTruthy as n,react as r}from\"../../../../core/reactiveUtils.js\";import{whenOnce as o}from\"../../../../core/watchUtils.js\";import{property as c}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as d}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{c as h}from\"../../../../chunks/boundedPlane.js\";import y from\"../../../../layers/Layer.js\";import u from\"../../../../layers/buildingSublayers/BuildingComponentSublayer.js\";import{logFailedGeometryProjectionError as p}from\"../support/loggerUtils.js\";import{isAlwaysDrapedLayer as w,isIBuildingSceneLayerView3D as v,projectShape as f,projectedShapeToPlane as m,planeToShape as _}from\"../../interactive/analysisTools/slice/sliceToolUtils.js\";import V from\"../../../../widgets/Slice/SlicePlane.js\";const g=s.getLogger(\"esri.views.3d.analysis.Slice.SliceController\");let S=class extends i{constructor(e){super(e),this._handles=new t,this._internalChange=!1,this._currentSlicePlane=null,this.state=\"pending\"}get ready(){return\"ready\"===this.state}initialize(){this._handles.add(this.analysis.excludedLayers.on(\"before-add\",(e=>{const i=e.item;null!=i&&(i instanceof y||i instanceof u)?i instanceof y&&w(i)?(g.error(\"excludedLayers\",`Layer '${i.title}, id:${i.id}' of type '${i.type}' can not be individually excluded from slicing. Use 'excludeGroundSurface' instead.`),e.preventDefault()):this.analysis.excludedLayers.includes(i)&&e.preventDefault():(g.error(\"excludedLayers\",\"Invalid layer type, layer must derive from Layer or BuildingComponentSublayer\"),e.preventDefault())}))),this._handles.add(n((()=>this.view.ready&&a(this.view.renderCoordsHelper)),(()=>this._initialize()),{sync:!0,initial:!0,once:!0}))}_initialize(){\"destroyed\"!==this.state&&\"ready\"!==this.state&&(L(this.view,this),this._handles.add([r((()=>this.analysisView.analysisViewData.plane),(()=>{this._internalChange||this._updateSlicePlaneFromBoundedPlane(),this._updateLayerViews()}),{sync:!0}),r((()=>this.analysis.excludeGroundSurface),(()=>this._updateLayerViews()),{sync:!0}),this.analysis.excludedLayers.on(\"change\",(()=>this._updateLayerViews())),r((()=>[this.analysisView.active,this.analysisView.visible]),(()=>{this._updateActiveController(),this._updateViewSlicePlane()}),{sync:!0}),r((()=>this._allLayerAndSubLayerViews),(()=>this._updateLayerViews()))]),this._handles.add([r((()=>this.analysis.shape),(()=>{this._internalChange||(this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane())}),{sync:!0})],\"analysis\"),this._set(\"state\",\"ready\"),this._updateActiveController(),this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane())}destroy(){\"destroyed\"!==this.state&&\"pending\"!==this.state&&(this.analysisView.active=!1,x(this.view,this),this._handles.destroy(),this.view.slicePlane=null,this.set(\"view\",null),this._set(\"state\",\"destroyed\"))}async whenReady(){return await o(this,\"ready\"),this}get _allLayerAndSubLayerViews(){const e=this.view.allLayerViews.items;return e.concat(e.filter(v).flatMap((({sublayerViews:e})=>e.items)))}_updateBoundedPlaneFromSlicePlane(){const e=this.analysis.shape,i=this._currentSlicePlane;if(l(i)&&l(e)||a(i)&&a(e)&&e.equals(i))return;let t=null,s=null;if(a(e)&&a(e.position)){const i=e.position.spatialReference,n=f(e,this.view.spatialReference);l(n)&&p(this.analysis,i,g),t=m(n,this.view,{tiltEnabled:this.analysis.tiltEnabled},h()),a(t)&&(s={heading:e.heading,tilt:e.tilt,position:e.position,width:e.width,height:e.height})}this._currentSlicePlane=s,this._internalChange=!0,this.analysisView.analysisViewData.plane=t,this._internalChange=!1}_updateSlicePlaneFromBoundedPlane(){const e=this.analysisView.analysisViewData.plane,i=_(e,this.view,this.view.spatialReference,new V);let t=null;a(i)&&(t={heading:i.heading,tilt:i.tilt,position:i.position,width:i.width,height:i.height}),this._currentSlicePlane=t,this._internalChange=!0,this.analysis.shape=i,this._internalChange=!1,this._updateViewSlicePlane()}_updateActiveController(){if(C)return;const e=j(this.view);if(this.analysisView.active)a(e.activeController)&&e.activeController!==this?(C=!0,e.activeController.analysisView.active=!1,C=!1):a(e.activeController)&&e.activeController,this._updateLayerViews(),e.activeController=this;else{if(a(e.activeController)&&e.activeController!==this)return;a(e.activeController)&&e.activeController===this&&(e.activeController=null,this._updateLayerViews())}}_updateViewSlicePlane(){\"ready\"===this.state&&P(this.view)}_updateLayerViews(){const e=a(this.analysisView.analysisViewData.plane)&&this.analysisView.visible&&this.analysisView.active,i=[],t=e=>{\"layers\"in e?e.layers.forEach(t):i.push(e)};this.analysis.excludedLayers.forEach(t),this.view.allLayerViews.forEach((t=>{t.destroyed||(\"slicePlaneEnabled\"in t&&(t.slicePlaneEnabled=e&&i.indexOf(t.layer)<0),\"sublayerViews\"in t&&t.sublayerViews.forEach((t=>{t.slicePlaneEnabled=e&&i.indexOf(t.sublayer)<0})))})),null!=this.view.basemapTerrain&&(this.view.basemapTerrain.slicePlaneEnabled=e&&!this.analysis.excludeGroundSurface)}};e([c({readOnly:!0})],S.prototype,\"state\",void 0),e([c()],S.prototype,\"view\",void 0),e([c()],S.prototype,\"analysis\",void 0),e([c()],S.prototype,\"analysisView\",void 0),e([c()],S.prototype,\"ready\",null),e([c()],S.prototype,\"_allLayerAndSubLayerViews\",null),S=e([d(\"esri.views.3d.analysis.Slice.SliceController\")],S);const b=new Map;let C=!1;function P(e){const i=j(e).activeController;a(i)&&a(i.analysisView.analysisViewData.plane)&&i.analysisView.visible?e.slicePlane=i.analysisView.analysisViewData.plane:e.slicePlane=null}function L(e,i){b.has(e)||b.set(e,{all:[],activeController:null}),b.get(e).all.push(i)}function j(e){return b.get(e)}function x(e,i){if(!b.has(e))throw new Error(\"view expected in global slice register\");const t=b.get(e),s=t.all.lastIndexOf(i);if(-1===s)throw new Error(\"controller expected in global slice register\");t.all.splice(s,1),0===t.all.length&&b.delete(e)}export{S as SliceController};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../../chunks/tslib.es6.js\";import s from\"../../../../core/Accessor.js\";import{property as o}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as e}from\"../../../../core/accessorSupport/decorators/subclass.js\";let t=class extends s{constructor(){super(...arguments),this.plane=null}};r([o()],t.prototype,\"plane\",void 0),t=r([e(\"esri.views.3d.analysis.Slice.SliceViewData\")],t);export{t as SliceViewData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import i from\"../../../../core/Accessor.js\";import e from\"../../../../core/Handles.js\";import{isNone as s,isSome as r,destroyMaybe as a}from\"../../../../core/maybe.js\";import{react as o,syncAndInitial as l}from\"../../../../core/reactiveUtils.js\";import{whenOnce as n}from\"../../../../core/watchUtils.js\";import{property as d}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as h}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{w as p,m}from\"../../../../chunks/mat4.js\";import{s as c,l as u}from\"../../../../chunks/vec3.js\";import{sv3d as y,sm4d as _}from\"../../../../geometry/support/vectorStacks.js\";import{PLANE_OUTLINE_COLOR as v,PLANE_OUTLINE_WIDTH as w,PLANE_PREVIEW_OUTLINE_WIDTH as V,PLANE_BACKGROUND_COLOR as f,GRID_COLOR as g}from\"../../interactive/analysisTools/slice/sliceToolConfig.js\";import{createGridVisualElement as b,createOutlineVisualElement as j,calculateBoundedPlaneTranslateRotate as E}from\"../../interactive/analysisTools/slice/sliceToolUtils.js\";import{createStipplePatternSimple as S}from\"../../webgl-engine/materials/lineStippleUtils.js\";let k=class extends i{constructor(t){super(t),this._handles=new e,this._gridVisualElement=null,this._outlineVisualElement=null,this.state=\"pending\",this.showGrid=!1,this.editable=!0}get ready(){return\"ready\"===this.state}initialize(){this._initialize()}async _initialize(){if(\"destroyed\"===this.state||\"ready\"===this.state)return;await n(this.view,\"ready\",!0);const t=this.analysisView.analysisViewData;if(s(t))throw new Error(\"expected internal object to be valid\");this._gridVisualElement=b(this.view),this._outlineVisualElement=j(this.view),this._handles.add([o((()=>({visible:r(t.plane)&&this.analysisView.visible,active:this.analysisView.active,editable:this.editable,showGrid:this.showGrid})),(t=>this._updateMaterials(t)),l),o((()=>t.plane),(t=>this._updatePlane(t)),l)],\"internal\"),this._set(\"state\",\"ready\")}destroy(){\"destroyed\"!==this.state&&\"pending\"!==this.state&&(this._handles.destroy(),this._gridVisualElement=a(this._gridVisualElement),this._outlineVisualElement=a(this._outlineVisualElement),this.set(\"view\",null),this._set(\"state\",\"destroyed\"))}async whenReady(){return await n(this,\"ready\"),this}_updatePlane(t){if(s(t))return;const i=c(y.get(),u(t.basis1),u(t.basis2),1),e=p(_.get(),i),r=E(t,_.get()),a=m(e,r,e);this._outlineVisualElement.transform=a,this._gridVisualElement.transform=a}_updateMaterials({visible:t,active:i,editable:e,showGrid:s}){this._outlineVisualElement.color=v,this._outlineVisualElement.width=e?w:V,this._outlineVisualElement.stipplePattern=i?null:S(5);const r=s?g:[0,0,0,0];this._gridVisualElement.backgroundColor=f,this._gridVisualElement.gridColor=r,this._gridVisualElement.visible=t,this._outlineVisualElement.visible=t}};t([d({readOnly:!0})],k.prototype,\"state\",void 0),t([d()],k.prototype,\"view\",void 0),t([d()],k.prototype,\"analysis\",void 0),t([d()],k.prototype,\"analysisView\",void 0),t([d()],k.prototype,\"ready\",null),t([d()],k.prototype,\"showGrid\",void 0),t([d()],k.prototype,\"editable\",void 0),k=t([h(\"esri.views.3d.analysis.Slice.SliceVisualization\")],k);export{k as SliceVisualization};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as i}from\"../../../../chunks/tslib.es6.js\";import s from\"../../../../core/Accessor.js\";import{destroyMaybe as a}from\"../../../../core/maybe.js\";import{property as t}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{AnalysisView3D as e}from\"../AnalysisView3D.js\";import{SliceController as r}from\"./SliceController.js\";import{SliceViewData as l}from\"./SliceViewData.js\";import{SliceVisualization as n}from\"./SliceVisualization.js\";let y=class extends(e(s)){constructor(i){super(i),this.type=\"slice-view\",this.analysisVisualization=null,this.analysisController=null,this.analysisViewData=new l,this.active=!0,this.showGrid=!1,this.editable=!1}initialize(){this.analysisVisualization=new n({view:this.view,analysis:this.analysis,analysisView:this}),this.analysisController=new r({view:this.view,analysis:this.analysis,analysisView:this})}destroy(){this.analysisVisualization=a(this.analysisVisualization),this.analysisController=a(this.analysisController)}async when(){return await this.analysisVisualization.whenReady(),await this.analysisController.whenReady(),this}get testData(){return{visualization:this.analysisVisualization,controller:this.analysisController}}};i([t()],y.prototype,\"type\",void 0),i([t()],y.prototype,\"analysis\",void 0),i([t()],y.prototype,\"analysisViewData\",void 0),i([t()],y.prototype,\"active\",void 0),i([t({aliasOf:\"analysisVisualization.showGrid\"})],y.prototype,\"showGrid\",void 0),i([t({aliasOf:\"analysisVisualization.editable\"})],y.prototype,\"editable\",void 0),y=i([o(\"esri.views.3d.analysis.Slice.SliceView3D\")],y);const p=y;export{p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindMultipassTerrainTexture as r}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindProjectionMatrix as i,bindView as s}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as a}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{parameter as n,ShaderTechniqueConfiguration as l}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Default3D as p}from\"../lib/DefaultVertexAttributeLocations.js\";import{OITBlending as c,OITDepthTest as u,OITDepthWrite as d,getOITPolygonOffset as h}from\"../lib/OrderIndependentTransparency.js\";import{Program as m}from\"../lib/Program.js\";import{stencilWriteMaskOn as b,stencilToolMaskBaseParams as f,stencilBaseAllZerosParams as g}from\"../lib/StencilUtils.js\";import{I as y}from\"../../../../chunks/ImageMaterial.glsl.js\";import{simpleBlendingParams as T,makePipelineState as P,cullingParams as v,defaultDepthWriteParams as j,defaultColorWriteParams as S}from\"../../../webgl/renderState.js\";class E extends o{initializeProgram(e){const t=E.shader.get(),r=this.configuration,i=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new m(e.rctx,i,p)}bindPass(e,t){i(this.program,t.camera.projectionMatrix),this.program.setUniform1f(\"opacity\",e.opacity),t.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",t.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",t.inverseViewport),r(this.program,t))}bindDraw(e){s(this.program,e),t(this.program,this.configuration,e),this.program.rebindTextures()}setPipelineState(e,t){const r=this.configuration,i=3===e,s=2===e;return P({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?w:c(e),culling:v(r.cullFace),depthTest:{func:u(e)},depthWrite:i?r.writeDepth&&j:d(e),colorWrite:S,stencilWrite:r.sceneHasOcludees?b:null,stencilTest:r.sceneHasOcludees?t?f:g:null,polygonOffset:i||s?null:h(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}}E.shader=new a(y,(()=>import(\"./ImageMaterial.glsl.js\")));const w=T(1,771);class O extends l{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([n({count:8})],O.prototype,\"output\",void 0),e([n({count:3})],O.prototype,\"cullFace\",void 0),e([n()],O.prototype,\"slicePlaneEnabled\",void 0),e([n()],O.prototype,\"transparent\",void 0),e([n()],O.prototype,\"enableOffset\",void 0),e([n()],O.prototype,\"writeDepth\",void 0),e([n()],O.prototype,\"sceneHasOcludees\",void 0),e([n({count:4})],O.prototype,\"transparencyPassType\",void 0),e([n()],O.prototype,\"multipassTerrainEnabled\",void 0),e([n()],O.prototype,\"cullAboveGround\",void 0);export{E as ImageMaterialTechnique,O as ImageMaterialTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{outputFromPass as e}from\"../lib/GLMaterials.js\";import t from\"../lib/GLMaterialTexture.js\";import{Material as r,materialParametersDefaults as a}from\"../lib/Material.js\";import{OITPolygonOffsetLimit as s}from\"../lib/OrderIndependentTransparency.js\";import{DefaultBufferWriter as i,PositionUVLayout as n}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as u}from\"./internal/MaterialUtil.js\";import{ImageMaterialTechniqueConfiguration as c,ImageMaterialTechnique as l}from\"../shaders/ImageMaterialTechnique.js\";class h extends r{constructor(e){super(e,o),this.supportsEdges=!0,this.techniqueConfig=new c}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.parameters.cullFace,this.techniqueConfig.slicePlaneEnabled=this.parameters.slicePlaneEnabled,this.techniqueConfig.transparent=this.parameters.transparent,this.techniqueConfig.writeDepth=this.parameters.writeDepth,this.techniqueConfig.sceneHasOcludees=this.parameters.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t.transparencyPassType,this.techniqueConfig.enableOffset=t.camera.relativeElevation<s,this.techniqueConfig.multipassTerrainEnabled=t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=t.cullAboveGround,this.techniqueConfig}intersect(e,t,r,a,s,i,n){u(e,t,a,s,i,void 0,n)}requiresSlot(t,r){if(20===t)return!0;if(4===e(r))return 2===t;return t===(this.parameters.transparent?this.parameters.writeDepth?4:7:2)}createGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new p(e):void 0}createBufferWriter(){return new i(n)}}class p extends t{constructor(e){super({...e,...e.material.parameters})}updateParameters(e){const t=this._material.parameters;return this.updateTexture(t.textureId),this.ensureTechnique(l,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.sceneHasOcludees&&(this._material.setParameters({sceneHasOcludees:e.hasOccludees}),this.updateParameters(e))}beginSlot(e){return 0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e,t){this.bindTextures(t.program),this.bindTextureScale(t.program),t.bindPass(this._material.parameters,e)}}const o={transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,opacity:1,textureId:null,initTextureTransparent:!0,...a};export{h as ImageMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{glsl as d}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as e}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function r(){const r=new e;return r.extensions.add(\"GL_OES_standard_derivatives\"),r.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),r.attributes.add(\"position\",\"vec3\"),r.attributes.add(\"uv0\",\"vec2\"),r.varyings.add(\"vUV\",\"vec2\"),r.vertex.code.add(d`void main(void) {\nvUV = uv0;\ngl_Position = proj * view * vec4(position, 1.0);\n}`),r.fragment.uniforms.add(\"backgroundColor\",\"vec4\").add(\"gridColor\",\"vec4\").add(\"ratio\",\"float\").add(\"gridWidth\",\"float\"),r.fragment.code.add(d`void main() {\nconst float LINE_WIDTH = 1.0;\nvec2 uvScaled = vUV * gridWidth;\nvec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));\nvec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);\ngrid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);\ngrid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);\nfloat gridFade = max(grid.x, grid.y);\nfloat gridAlpha = gridColor.a * gridFade;\ngl_FragColor =\nvec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +\nvec4(gridColor.rgb, 1.0) * gridAlpha;\n}`),r}const a=Object.freeze({__proto__:null,build:r});export{a as S,r as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{getPathExtension as i}from\"../../core/urlUtils.js\";function p(i){return o[n(i)]||e}function n(i){return i instanceof Blob?i.type:t(i.url)}function t(p){const n=i(p);return g[n]||a}const o={},a=\"text/plain\",e=o[a],g={png:\"image/png\",jpeg:\"image/jpeg\",jpg:\"image/jpg\",bmp:\"image/bmp\",gif:\"image/gif\",json:\"application/json\",txt:\"text/plain\",xml:\"application/xml\",svg:\"image/svg+xml\",zip:\"application/zip\",pbf:\"application/vnd.mapbox-vector-tile\",gz:\"application/gzip\"};for(const l in g)o[g[l]]=l;export{p as getResourceContentExtension};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{isSome as t,isNone as r,get as e}from\"../../maybe.js\";import{isMultiOriginJSONMixin as o}from\"../../multiOriginJSONSupportUtils.js\";import{isAbsolute as i,isBlobProtocol as n,join as s,getPathExtension as u}from\"../../urlUtils.js\";import{generateUUID as p}from\"../../uuid.js\";import{getOwnPropertyMetadata as a}from\"../metadata.js\";import{nameToId as c}from\"../PropertyOrigin.js\";import{propertyJSONMeta as l}from\"./property.js\";import{getResourceContentExtension as f}from\"../../../portal/support/resourceExtension.js\";import{r as m,t as y,i as h,p as d}from\"../../../chunks/persistableUrlUtils.js\";function g(r){const e=t(r)&&r.origins?r.origins:[void 0];return(t,o)=>{const i=w(r,t,o);for(const r of e){const e=l(t,r,o);for(const t in i)e[t]=i[t]}}}function w(r,e,o){if(t(r)&&\"resource\"===r.type)return v(r,e,o);switch(t(r)&&r.type?r.type:\"other\"){case\"other\":return{read:!0,write:!0};case\"url\":{const{read:t,write:r}=d;return{read:t,write:r}}}}function v(e,s,u){const p=a(s,u);return{type:String,read:(t,r,e)=>{const o=m(t,r,e);return p.type===String?o:\"function\"==typeof p.type?new p.type({url:o}):void 0},write:{writer(s,a,l,f){if(!f||!f.resources)return\"string\"==typeof s?void(a[l]=y(s,f)):void(a[l]=s.write({},f));const m=P(s),d=m?y(m,{...f,verifyItemRelativeUrls:f&&f.verifyItemRelativeUrls?{writtenUrls:f.verifyItemRelativeUrls.writtenUrls,rootPath:null}:null},1):null,g=p.type!==String&&(!o(this)||f&&f.origin&&this.originIdOf(u)>c(f.origin));f&&f.portalItem&&t(d)&&!i(d)?g?j(this,u,s,d,a,l,f,e):I(d,a,l,f):f&&f.portalItem&&(r(d)||t(h(d))||n(d)||g)?U(this,u,s,d,a,l,f,e):a[l]=d}}}}function U(t,r,o,i,u,a,c,l){const m=p(),y=S(o,i,c),h=s(e(l,\"prefix\"),m),d=`${h}.${f(y)}`,g=c.portalItem.resourceFromPath(d);n(i)&&c.resources.pendingOperations.push(b(i).then((t=>{g.path=`${h}.${f(t)}`,u[a]=g.itemRelativeUrl})).catch((()=>{}))),O(t,r,g,y,c.resources.toAdd),u[a]=g.itemRelativeUrl}function j(t,r,e,o,i,n,s,p){const a=s.portalItem.resourceFromPath(o),c=S(e,o,s);f(c)===u(a.path)?(O(t,r,a,c,s.resources.toUpdate),i[n]=o):U(t,r,e,o,i,n,s,p)}function I(t,r,e,o){o.resources.toKeep.push({resource:o.portalItem.resourceFromPath(t)}),r[e]=t}function O(t,r,e,o,i){i.push({resource:e,content:o,finish:e=>{R(t,r,e)}})}function S(t,r,e){return\"string\"==typeof t?{url:r}:new Blob([JSON.stringify(t.toJSON(e))],{type:\"application/json\"})}async function b(t){const r=(await import(\"../../../request.js\")).default,{data:e}=await r(t,{responseType:\"blob\"});return e}function P(t){return r(t)?null:\"string\"==typeof t?t:t.url}function R(t,r,e){\"string\"==typeof t[r]?t[r]=e.url:t[r].url=e.url}export{g as persistable};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../PopupTemplate.js\";import\"../../renderers/ClassBreaksRenderer.js\";import\"../../renderers/DictionaryRenderer.js\";import\"../../renderers/DotDensityRenderer.js\";import\"../../renderers/HeatmapRenderer.js\";import\"../../renderers/Renderer.js\";import\"../../renderers/SimpleRenderer.js\";import\"../../renderers/UniqueValueRenderer.js\";import\"../../renderers/support/jsonUtils.js\";import{webSceneRendererTypes as t}from\"../../renderers/support/types.js\";import o from\"../../request.js\";import s from\"../../core/Error.js\";import{JSONMap as i}from\"../../core/jsonMap.js\";import a from\"../../core/Loadable.js\";import p from\"../../core/Logger.js\";import{isSome as n,isNone as l}from\"../../core/maybe.js\";import{EsriPromiseMixin as d}from\"../../core/Promise.js\";import{property as y}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{enumeration as u}from\"../../core/accessorSupport/decorators/enumeration.js\";import{reader as c}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as m}from\"../../core/accessorSupport/decorators/subclass.js\";import h from\"../../geometry/Extent.js\";import f from\"../../geometry/SpatialReference.js\";import g from\"../FeatureLayer.js\";import j from\"./BuildingSublayer.js\";import{zeroCapabilities as v}from\"../support/capabilities.js\";import{popupEnabled as b}from\"../support/commonProperties.js\";import{defineFieldProperties as L}from\"../support/fieldProperties.js\";import F from\"../support/FieldsIndex.js\";import{fetchIndexInfo as S}from\"../support/I3SIndexInfo.js\";import{I3SNodePageDefinition as I,I3SMaterialDefinition as O,I3STextureSetDefinition as w,I3SGeometryDefinition as x}from\"../support/I3SLayerDefinitions.js\";import T from\"../../rest/support/Query.js\";import{createPopupTemplate as q}from\"../../support/popupUtils.js\";import P from\"../../symbols/support/ElevationInfo.js\";const D=p.getLogger(\"esri.layers.buildingSublayers.BuildingComponentSublayer\"),Q=L();let R=class extends(a.LoadableMixin(d(j))){constructor(e){super(e),this.type=\"building-component\",this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.fields=null,this.associatedLayer=null,this.outFields=null,this.listMode=\"show\",this.renderer=null,this.definitionExpression=null,this.popupEnabled=!0,this.popupTemplate=null,this.layerType=\"3d-object\"}get parsedUrl(){return this.layer?{path:`${this.layer.parsedUrl.path}/sublayers/${this.id}`,query:this.layer.parsedUrl.query}:null}get fieldsIndex(){return new F(this.fields)}readAssociatedLayer(e,r){const t=this.layer.associatedFeatureServiceItem,o=r.associatedLayerID;return n(t)&&\"number\"==typeof o?new g({portalItem:t,layerId:o}):null}get objectIdField(){if(null!=this.fields)for(const e of this.fields)if(\"oid\"===e.type)return e.name;return null}get displayField(){return n(this.associatedLayer)?this.associatedLayer.displayField:null}get defaultPopupTemplate(){return this.createPopupTemplate()}load(e){const r=n(e)?e.signal:null,t=this._fetchService(r).then((()=>{this.indexInfo=S(this.parsedUrl.path,this.rootNode,this.nodePages,this.apiKey,D,r)}));return this.addResolvingPromise(t),Promise.resolve(this)}createPopupTemplate(e){return q(this,e)}async _fetchService(e){const r=(await o(this.parsedUrl.path,{query:{f:\"json\",token:this.apiKey},responseType:\"json\",signal:e})).data;this.read(r,{origin:\"service\",url:this.parsedUrl})}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,r){var t,o,s,i;const a=null==(t=this.getFeatureType(null==r?void 0:r.feature))||null==(o=t.domains)?void 0:o[e];return a&&\"inherited\"!==a.type?a:null!=(s=null==(i=this.getField(e))?void 0:i.domain)?s:null}getFeatureType(e){return e&&n(this.associatedLayer)?this.associatedLayer.getFeatureType(e):null}get types(){return n(this.associatedLayer)?this.associatedLayer.types:[]}get typeIdField(){return n(this.associatedLayer)?this.associatedLayer.typeIdField:null}get geometryType(){return\"3d-object\"===this.layerType?\"mesh\":\"point\"}get profile(){return\"3d-object\"===this.layerType?\"mesh-pyramids\":\"points\"}get capabilities(){const e=n(this.associatedLayer)&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:v,{query:r,data:{supportsZ:t,supportsM:o,isVersioned:s}}=e;return{query:r,data:{supportsZ:t,supportsM:o,isVersioned:s}}}createQuery(){const e=new T;return\"mesh\"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||\"1=1\",e.sqlFormat=\"standard\",e}queryExtent(e,r){return this._getAssociatedLayerForQuery().then((t=>t.queryExtent(e||this.createQuery(),r)))}queryFeatureCount(e,r){return this._getAssociatedLayerForQuery().then((t=>t.queryFeatureCount(e||this.createQuery(),r)))}queryFeatures(e,r){return this._getAssociatedLayerForQuery().then((t=>t.queryFeatures(e||this.createQuery(),r))).then((e=>{if(null!=e&&e.features)for(const r of e.features)r.layer=this.layer,r.sourceLayer=this;return e}))}queryObjectIds(e,r){return this._getAssociatedLayerForQuery().then((t=>t.queryObjectIds(e||this.createQuery(),r)))}getFieldUsageInfo(e){return this.fieldsIndex.has(e)?{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}:{supportsLabelingInfo:!1,supportsRenderer:!0,supportsPopupTemplate:!0,supportsLayerQuery:n(this.associatedLayer)}}_getAssociatedLayerForQuery(){const e=this.associatedLayer;return n(e)&&e.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}async _loadAssociatedLayerForQuery(){if(await this.load(),l(this.associatedLayer))throw new s(\"buildingscenelayer:query-not-available\",\"BuildingSceneLayer component layer queries are not available without an associated feature layer\",{layer:this});try{await this.associatedLayer.load()}catch(e){throw new s(\"buildingscenelayer:query-not-available\",\"BuildingSceneLayer associated feature layer could not be loaded\",{layer:this,error:e})}return this.associatedLayer}};e([y({readOnly:!0})],R.prototype,\"parsedUrl\",null),e([y({type:I,readOnly:!0})],R.prototype,\"nodePages\",void 0),e([y({type:[O],readOnly:!0})],R.prototype,\"materialDefinitions\",void 0),e([y({type:[w],readOnly:!0})],R.prototype,\"textureSetDefinitions\",void 0),e([y({type:[x],readOnly:!0})],R.prototype,\"geometryDefinitions\",void 0),e([y({readOnly:!0})],R.prototype,\"serviceUpdateTimeStamp\",void 0),e([y({readOnly:!0})],R.prototype,\"store\",void 0),e([y({type:String,readOnly:!0,json:{read:{source:\"store.rootNode\"}}})],R.prototype,\"rootNode\",void 0),e([y({readOnly:!0})],R.prototype,\"attributeStorageInfo\",void 0),e([y(Q.fields)],R.prototype,\"fields\",void 0),e([y({readOnly:!0})],R.prototype,\"fieldsIndex\",null),e([y({readOnly:!0,type:g})],R.prototype,\"associatedLayer\",void 0),e([c(\"service\",\"associatedLayer\",[\"associatedLayerID\"])],R.prototype,\"readAssociatedLayer\",null),e([y(Q.outFields)],R.prototype,\"outFields\",void 0),e([y({type:String,readOnly:!0})],R.prototype,\"objectIdField\",null),e([y({readOnly:!0,type:String,json:{read:!1}})],R.prototype,\"displayField\",null),e([y({readOnly:!0,type:String,aliasOf:\"layer.apiKey\"})],R.prototype,\"apiKey\",void 0),e([y({readOnly:!0,type:h,aliasOf:\"layer.fullExtent\"})],R.prototype,\"fullExtent\",void 0),e([y({readOnly:!0,type:f,aliasOf:\"layer.spatialReference\"})],R.prototype,\"spatialReference\",void 0),e([y({readOnly:!0,aliasOf:\"layer.version\"})],R.prototype,\"version\",void 0),e([y({readOnly:!0,type:P,aliasOf:\"layer.elevationInfo\"})],R.prototype,\"elevationInfo\",void 0),e([y({readOnly:!0,type:Number,aliasOf:\"layer.minScale\"})],R.prototype,\"minScale\",void 0),e([y({readOnly:!0,type:Number,aliasOf:\"layer.maxScale\"})],R.prototype,\"maxScale\",void 0),e([y({type:[\"hide\",\"show\"],json:{write:!0}})],R.prototype,\"listMode\",void 0),e([y({types:t,json:{origins:{service:{read:{source:\"drawingInfo.renderer\"}}},name:\"layerDefinition.drawingInfo.renderer\",write:!0},value:null})],R.prototype,\"renderer\",void 0),e([y({type:String,json:{origins:{service:{read:!1,write:!1}},name:\"layerDefinition.definitionExpression\",write:{enabled:!0,allowNull:!0}}})],R.prototype,\"definitionExpression\",void 0),e([y(b)],R.prototype,\"popupEnabled\",void 0),e([y({type:r,json:{read:{source:\"popupInfo\"},write:{target:\"popupInfo\"}}})],R.prototype,\"popupTemplate\",void 0),e([y({readOnly:!0,type:String,json:{origins:{service:{read:{source:\"store.normalReferenceFrame\"}}},read:!1}})],R.prototype,\"normalReferenceFrame\",void 0),e([y({readOnly:!0,json:{read:!1}})],R.prototype,\"defaultPopupTemplate\",null),e([y()],R.prototype,\"types\",null),e([y()],R.prototype,\"typeIdField\",null),e([y({json:{write:!1}}),u(new i({\"3DObject\":\"3d-object\",Point:\"point\"}))],R.prototype,\"layerType\",void 0),e([y()],R.prototype,\"geometryType\",null),e([y()],R.prototype,\"profile\",null),e([y({readOnly:!0,json:{read:!1}})],R.prototype,\"capabilities\",null),R=e([m(\"esri.layers.buildingSublayers.BuildingComponentSublayer\")],R);const U=R;export{U as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{Slice as e}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ReadLinearDepth as a}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{multipassTerrainTest as o}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{defaultMaskAlphaCutoff as i}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{ColorConversion as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{glsl as t}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as l}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function s(s){const n=new l;return n.include(r,{linearDepth:!1}),n.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),n.attributes.add(\"position\",\"vec3\"),n.attributes.add(\"uv0\",\"vec2\"),n.varyings.add(\"vpos\",\"vec3\"),s.multipassTerrainEnabled&&n.varyings.add(\"depth\",\"float\"),n.vertex.uniforms.add(\"textureCoordinateScaleFactor\",\"vec2\"),n.vertex.code.add(t`\n    void main(void) {\n      vpos = position;\n      ${s.multipassTerrainEnabled?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  `),n.include(e,s),s.multipassTerrainEnabled&&(n.fragment.include(a),n.include(o,s)),n.fragment.uniforms.add(\"tex\",\"sampler2D\"),n.fragment.uniforms.add(\"opacity\",\"float\"),n.varyings.add(\"vTexCoord\",\"vec2\"),7===s.output?n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    `):(n.fragment.include(d),n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ${s.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n    }\n    `)),n}const n=Object.freeze({__proto__:null,build:s});export{n as I,s as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nclass t{constructor(t){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this.view.watch(\"ready\",(t=>{this._resourcesCreated&&(t?this._createResources():this._destroyResources())}))}applyProps(t){let e=!1;for(const s in t)s in this?\"attached\"===s?e=t[s]:this[s]=t[s]:console.error(\"Cannot set unknown property\",s);this.attached=e}destroy(){this.attached=!1}get attached(){return this._attached}set attached(t){t!==this._attached&&this.view._stage&&(this._attached=t,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.attached&&this.updateVisibility(t))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}export{t as VisualElement};\n"],"sourceRoot":""}
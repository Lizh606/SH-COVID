{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/views/2d/layers/WMSLayerView2D.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/BitmapContainer.js","webpack:///./node_modules/@arcgis/core/views/layers/RefreshableLayerView.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/ImageryBitmapSource.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/webgl/Mesh2D.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/webgl/ClippingInfo.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/webgl/WGLContainer.js","webpack:///./node_modules/@arcgis/core/views/layers/WMSLayerView.js","webpack:///./node_modules/@arcgis/core/layers/support/ExportWMSImageParameters.js","webpack:///./node_modules/@arcgis/core/views/2d/viewStateUtils.js","webpack:///./node_modules/@arcgis/core/views/2d/layers/support/ExportStrategy.js","webpack:///./node_modules/@arcgis/core/views/2d/engine/Bitmap.js"],"names":["l","getLogger","y","layer","e","view","r","this","supportsSpatialReference","spatialReference","addResolvingPromise","Promise","reject","strategy","update","catch","error","imageMaxHeight","t","imageMaxWidth","_bitmapContainer","container","addChild","fetchSource","fetchImage","bind","requestUpdate","imageRotationSupported","imageNormalizationSupported","hidpi","handles","add","watch","remove","destroy","removeChild","removeAllChildren","x","i","s","a","n","p","m","children","some","width","height","resolution","h","c","d","xmin","ymin","xmax","ymax","Math","round","extent","updating","updateRequested","timeExtent","prototype","u","blendFunction","registerRenderPass","name","brushes","bitmap","target","drawPhase","MAP","super","prepareRenderPasses","doRefresh","dataChanged","declaredClass","pixelBlock","originalPixelBlock","filter","getAsRGBA","o","createImageData","data","set","putImageData","renderedRasterPixels","Uint8Array","buffer","BYTES_PER_ELEMENT","coords","lengths","length","push","f","slice","_cache","vertices","indices","primitiveType","isMapSpace","fromScreenExtent","path","Uint32Array","floor","geometry","type","fromPolygon","fromMapExtent","fromRect","toScreen","indexBuffer","dispose","vertexBuffers","createIndex","Object","keys","reduce","createVertex","parseFloat","_clip","stage","_handle","_invalidate","ready","mesh","vao","_destroyGL","size","_lastWidth","_lastHeight","_createMesh","getIndexBuffer","getVertexBuffers","dvs","requestRender","left","right","top","bottom","max","_createScreenRect","fromPath","fromGeometry","arguments","constructor","_clips","forEach","clips","_updateClippingInfo","createRenderParams","painter","globalOpacity","profiler","LABEL","HIGHLIGHT","computedOpacity","recordContainerStart","beforeRenderLayer","_clippingInfos","updateTransforms","state","renderChildren","compositeLayer","recordContainerEnd","_renderPasses","beforeRender","render","afterRender","requireFBO","requiresDedicatedFBO","clip","LABEL_ALPHA","DEBUG","setTransform","onAttach","onDetach","items","map","fromClipArea","exportImageParameters","commitProperty","_get","popupEnabled","createFetchPopupFeaturesQuery","resolve","fetchFeatureInfo","readOnly","visible","scale","_set","sublayers","on","notifyChange","propertyName","visibleSublayers","join","minScale","maxScale","unshift","layers","imageFormat","imageTransparency","version","format","request","service","styles","transparent","Number","PI","rotation","abs","cos","sin","g","_imagePromise","bitmaps","stationary","destroyed","pixelRatio","worldScreenWidth","valid","paddedViewState","center","_singleExport","min","_tiledExport","then","async","includes","fadeOut","fadeIn","invalidateTexture","signal","_export","create","scales","getTileCoverage","getTileBounds","all","S","document","createElement","getContext","_","pixelFormat","internalFormat","dataType","wrapMode","requestRenderOnSourceChangedEnabled","_textureInvalidated","stencilRef","coordScale","_height","_source","_width","source","_texture","sourceWidth","sourceHeight","HTMLImageElement","naturalHeight","naturalWidth","updateTexture","context","transforms","toScreenNoRotation","displayViewMat3","mips","descriptor","hasMipmap","generateMipmap","setSamplingMode","samplingMode","bindTexture","resize","getRenderedRasterPixels","setData"],"mappings":"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","file":"js/chunk-05cfba08.b5b9477c.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import r from\"../../../core/Logger.js\";import{isAbortError as i}from\"../../../core/promiseUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import o from\"../../../geometry/Extent.js\";import{BitmapContainer as n}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as p}from\"./LayerView2D.js\";import m from\"./support/ExportStrategy.js\";import h from\"../../layers/LayerView.js\";import{RefreshableLayerView as c}from\"../../layers/RefreshableLayerView.js\";import{WMSLayerView as d}from\"../../layers/WMSLayerView.js\";const l=r.getLogger(\"esri.views.2d.layers.WMSLayerView2D\");let y=class extends(d(c(p(h)))){initialize(){const{layer:e,view:r}=this;e.supportsSpatialReference(r.spatialReference)||this.addResolvingPromise(Promise.reject(new t(\"layerview:spatial-reference-incompatible\",\"The spatial references supported by this WMS layer are incompatible with the spatial reference of the view\",{layer:e})))}update(e){this.strategy.update(e).catch((e=>{i(e)||l.error(e)}))}attach(){const{layer:e}=this,{imageMaxHeight:t,imageMaxWidth:r}=e;this._bitmapContainer=new n,this.container.addChild(this._bitmapContainer),this.strategy=new m({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:t,imageMaxWidth:r,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.handles.add(this.watch(\"exportImageVersion\",(()=>this.requestUpdate())),\"exportImageVersion\")}detach(){this.handles.remove(\"exportImageVersion\"),this.strategy.destroy(),this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQuery(e){const{view:t}=this,r=this._bitmapContainer,{x:i,y:s}=e,{spatialReference:a}=t;let n=null,p=0,m=0;if(r.children.some((e=>{const{width:t,height:r,resolution:h,x:c,y:d}=e,l=c+h*t,y=d-h*r;return i>=c&&i<=l&&s<=d&&s>=y&&(n=new o({xmin:c,ymin:y,xmax:l,ymax:d,spatialReference:a}),p=t,m=r,!0)})),!n)return null;const h=n.width/p,c=Math.round((i-n.xmin)/h),d=Math.round((n.ymax-s)/h);return{extent:n,width:p,height:m,x:c,y:d}}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,r,i){return this.layer.fetchImage(e,t,r,{timeExtent:this.timeExtent,...i})}};e([s()],y.prototype,\"strategy\",void 0),e([s()],y.prototype,\"updating\",void 0),y=e([a(\"esri.views.2d.layers.WMSLayerView2D\")],y);const u=y;export{u as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{brushes as e}from\"./brushes.js\";import{WGLDrawPhase as r}from\"./webgl/enums.js\";import s from\"./webgl/WGLContainer.js\";class t extends s{get requiresDedicatedFBO(){return this.children.some((e=>\"additive\"===e.blendFunction))}prepareRenderPasses(s){const t=s.registerRenderPass({name:\"bitmap\",brushes:[e.bitmap],target:()=>this.children,drawPhase:r.MAP});return[...super.prepareRenderPasses(s),t]}}export{t as BitmapContainer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/watchUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const i=i=>{let c=class extends i{initialize(){this.handles.add(o(this,\"layer\",\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([a(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{i as RefreshableLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../core/maybe.js\";class i{constructor(e,t,i){this.pixelBlock=e,this.extent=t,this.originalPixelBlock=i}get width(){return e(this.pixelBlock)?this.pixelBlock.width:0}get height(){return e(this.pixelBlock)?this.pixelBlock.height:0}render(e){const i=this.pixelBlock;if(t(i))return;const l=this.filter({pixelBlock:i});if(t(l.pixelBlock))return;const r=l.pixelBlock.getAsRGBA(),o=e.createImageData(l.pixelBlock.width,l.pixelBlock.height);o.data.set(r),e.putImageData(o,0,0)}getRenderedRasterPixels(){const e=this.filter({pixelBlock:this.pixelBlock});return t(e.pixelBlock)?null:{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}}}export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";import t from\"../../../../core/Logger.js\";import{isSome as r}from\"../../../../core/maybe.js\";import{e as s}from\"../../../../chunks/earcut.js\";import{s as n}from\"../../../../chunks/vec2.js\";import{a as o}from\"../../../../chunks/vec2f64.js\";import{convertFromNestedArray as c,convertFromPolygon as i}from\"../../../../layers/graphics/featureConversionUtils.js\";import a from\"../../../../layers/graphics/OptimizedGeometry.js\";import{i1616to32 as f}from\"./number.js\";import h from\"../../../webgl/BufferObject.js\";const m=t.getLogger(\"esri.views.2d.engine.webgl.Mesh2D\"),u=t=>{switch(t.BYTES_PER_ELEMENT){case 1:return 5121;case 2:return 5123;case 4:return 5125;default:throw new e(\"Cannot get DataType of array\")}},y=(e,t,r,s)=>{let n=0;for(let o=1;o<r;o++){const r=e[2*(t+o-1)],s=e[2*(t+o-1)+1];n+=(e[2*(t+o)]-r)*(e[2*(t+o)+1]+s)}return s?n>0:n<0},x=({coords:e,lengths:t},r)=>{const n=[];for(let o=0,c=0;o<t.length;c+=t[o],o+=1){const i=c,a=[];for(;o<t.length-1&&y(e,c+t[o],t[o+1],r);o+=1,c+=t[o])a.push(c+t[o]-i);const f=e.slice(2*i,2*(c+t[o])),h=s(f,a,2);for(const e of h)n.push(e+i)}return n};class g{constructor(e,t,r,s=!1){this._cache={},this.vertices=e,this.indices=t,this.primitiveType=r,this.isMapSpace=s}static fromRect({x:e,y:t,width:r,height:s}){const n=e,o=t,c=n+r,i=o+s;return g.fromScreenExtent({xmin:n,ymin:o,xmax:c,ymax:i})}static fromPath(e){const t=c(new a,e.path,!1,!1),r=t.coords,s=new Uint32Array(x(t,!0)),n=new Uint32Array(r.length/2);for(let o=0;o<n.length;o++)n[o]=f(Math.floor(r[2*o]),Math.floor(r[2*o+1]));return new g({geometry:n},s,4)}static fromGeometry(t,r){const s=r.geometry.type;switch(s){case\"polygon\":return g.fromPolygon(t,r.geometry);case\"extent\":return g.fromMapExtent(t,r.geometry);default:return m.error(new e(\"mapview-bad-type\",`Unable to create a mesh from type ${s}`,r)),g.fromRect({x:0,y:0,width:1,height:1})}}static fromPolygon(e,t){const r=i(new a,t,!1,!1),s=r.coords,c=new Uint32Array(x(r,!1)),h=new Uint32Array(s.length/2),m=o(),u=o();for(let o=0;o<h.length;o++)n(m,s[2*o],s[2*o+1]),e.toScreen(u,m),h[o]=f(Math.floor(u[0]),Math.floor(u[1]));return new g({geometry:h},c,4,!0)}static fromScreenExtent({xmin:e,xmax:t,ymin:r,ymax:s}){const n={geometry:new Uint32Array([f(e,r),f(t,r),f(e,s),f(e,s),f(t,r),f(t,s)])},o=new Uint32Array([0,1,2,3,4,5]);return new g(n,o,4)}static fromMapExtent(e,t){const[r,s]=e.toScreen([0,0],[t.xmin,t.ymin]),[n,o]=e.toScreen([0,0],[t.xmax,t.ymax]),c={geometry:new Uint32Array([f(r,s),f(n,s),f(r,o),f(r,o),f(n,s),f(n,o)])},i=new Uint32Array([0,1,2,3,4,5]);return new g(c,i,4)}destroy(){r(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const e in this._cache.vertexBuffers)r(this._cache.vertexBuffers[e])&&this._cache.vertexBuffers[e].dispose()}get elementType(){return u(this.indices)}getIndexBuffer(e,t=35044){return this._cache.indexBuffer||(this._cache.indexBuffer=h.createIndex(e,t,this.indices)),this._cache.indexBuffer}getVertexBuffers(e,t=35044){return this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce(((r,s)=>({...r,[s]:h.createVertex(e,t,this.vertices[s])})),{})),this._cache.vertexBuffers}}export{g as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/Error.js\";import e from\"../../../../core/Logger.js\";import{isSome as r,isNone as s}from\"../../../../core/maybe.js\";import{c as i}from\"../../../../chunks/mat3f32.js\";import{DisplayObject as o}from\"../DisplayObject.js\";import h from\"./Mesh2D.js\";import a from\"../../../webgl/VertexArrayObject.js\";const c=e.getLogger(\"esri.views.2d.engine.webgl.ClippingInfo\"),n=t=>parseFloat(t)/100;class m extends o{constructor(t,e){super(),this._clip=e,this._cache={},this.stage=t,this._handle=e.watch(\"version\",(()=>this._invalidate())),this.ready()}static fromClipArea(t,e){return new m(t,e)}_destroyGL(){r(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null),r(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)}destroy(){this._destroyGL(),this._handle.remove()}getVAO(t,e,r,i){const[o,h]=e.size;if(\"geometry\"!==this._clip.type&&this._lastWidth===o&&this._lastHeight===h||(this._lastWidth=o,this._lastHeight=h,this._destroyGL()),s(this._cache.vao)){const s=this._createMesh(e,this._clip),o=s.getIndexBuffer(t),h=s.getVertexBuffers(t);this._cache.mesh=s,this._cache.vao=new a(t,r,i,h,o)}return this._cache.vao}_createTransforms(){return{dvs:i()}}_invalidate(){this._destroyGL(),this.requestRender()}_createScreenRect(t,e){const[r,s]=t.size,i=\"string\"==typeof e.left?n(e.left)*r:e.left,o=\"string\"==typeof e.right?n(e.right)*r:e.right,h=\"string\"==typeof e.top?n(e.top)*s:e.top,a=\"string\"==typeof e.bottom?n(e.bottom)*s:e.bottom,c=i,m=h;return{x:c,y:m,width:Math.max(r-o-c,0),height:Math.max(s-a-m,0)}}_createMesh(e,r){switch(r.type){case\"rect\":return h.fromRect(this._createScreenRect(e,r));case\"path\":return h.fromPath(r);case\"geometry\":return h.fromGeometry(e,r);default:return c.error(new t(\"mapview-bad-type\",\"Unable to create ClippingInfo mesh from clip of type: ${clip.type}\")),h.fromRect({x:0,y:0,width:1,height:1})}}}export{m as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{isNone as e,isSome as r}from\"../../../../core/maybe.js\";import{c as s}from\"../../../../chunks/mat3f32.js\";import{brushes as t}from\"../brushes.js\";import{Container as i}from\"../Container.js\";import n from\"./ClippingInfo.js\";import{WGLDrawPhase as o}from\"./enums.js\";class a extends i{constructor(){super(...arguments),this.name=this.constructor.name}set clips(e){this._clips=e,this.children.forEach((r=>r.clips=e)),this._updateClippingInfo()}_createTransforms(){return{dvs:s()}}doRender(e){const r=this.createRenderParams(e),{painter:s,globalOpacity:t,profiler:i,drawPhase:n}=r,a=n===o.LABEL||n===o.HIGHLIGHT?1:t*this.computedOpacity;i.recordContainerStart(this.name),s.beforeRenderLayer(r,this._clippingInfos?255:0,a),this.updateTransforms(e.state),this.renderChildren(r),s.compositeLayer(r,a),i.recordContainerEnd()}renderChildren(r){e(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(r.painter));for(const e of this.children)e.beforeRender(r);for(const e of this._renderPasses)try{e.render(r)}catch(s){}for(const e of this.children)e.afterRender(r)}createRenderParams(e){return e.requireFBO=this.requiresDedicatedFBO,e}prepareRenderPasses(e){return[e.registerRenderPass({name:\"clip\",brushes:[t.clip],target:()=>this._clippingInfos,drawPhase:o.MAP|o.LABEL|o.LABEL_ALPHA|o.DEBUG|o.HIGHLIGHT})]}updateTransforms(e){for(const r of this.children)r.setTransform(e)}onAttach(){super.onAttach(),this._updateClippingInfo()}onDetach(){super.onDetach(),this._updateClippingInfo()}_updateClippingInfo(){if(r(this._clippingInfos)&&(this._clippingInfos.forEach((e=>e.destroy())),this._clippingInfos=null),!this.stage)return;const e=this._clips;r(e)&&e.length&&(this._clippingInfos=e.items.map((e=>n.fromClipArea(this.stage,e)))),this.requestRender()}}export{a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as s}from\"../../layers/support/commonProperties.js\";import{ExportWMSImageParameters as p}from\"../../layers/support/ExportWMSImageParameters.js\";const a=a=>{let i=class extends a{initialize(){this.exportImageParameters=new p({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get exportImageVersion(){var e;return null==(e=this.exportImageParameters)||e.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),(this._get(\"exportImageVersion\")||0)+1}fetchPopupFeatures(e){const{layer:t}=this;if(!e)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:t}));const{popupEnabled:o}=t;if(!o)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"popupEnabled should be true\",{popupEnabled:o}));const s=this.createFetchPopupFeaturesQuery(e);if(!s)return Promise.resolve([]);const{extent:p,width:a,height:i,x:m,y:n}=s;if(!(p&&a&&i))throw new r(\"wmslayerview:fetchPopupFeatures\",\"WMSLayer does not support fetching features.\",{extent:p,width:a,height:i});const u=t.fetchFeatureInfo(p,a,i,m,n);return Promise.resolve(u?[u]:[])}};return e([t()],i.prototype,\"exportImageParameters\",void 0),e([t({readOnly:!0})],i.prototype,\"exportImageVersion\",null),e([t()],i.prototype,\"layer\",void 0),e([t(s)],i.prototype,\"timeExtent\",void 0),i=e([o(\"esri.layers.mixins.WMSLayerView\")],i),i};export{a as WMSLayerView,a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{HandleOwnerMixin as s}from\"../../core/HandleOwner.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";const a={visible:\"visibleSublayers\"};let l=class extends(s(r)){constructor(e){super(e),this.scale=0}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.sublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"wms-sublayer-update\",(e=>this.notifyChange(a[e.propertyName])))],\"layer\"))}get layers(){const{visibleSublayers:e}=this;return e.filter((e=>e.name)).map((e=>e.name)).join(\",\")}get version(){this.commitProperty(\"layers\");const e=this.layer;return e&&e.commitProperty(\"imageTransparency\"),(this._get(\"version\")||0)+1}get visibleSublayers(){const{layer:e,scale:r}=this,s=null==e?void 0:e.sublayers,t=[],o=e=>{const{minScale:s,maxScale:a,sublayers:l,visible:i}=e;i&&(0===r||(0===s||r<=s)&&(0===a||r>=a))&&(l?l.forEach(o):t.unshift(e))};return null==s||s.forEach(o),t}toJSON(){const{layer:e,layers:r}=this,{imageFormat:s,imageTransparency:t,version:o}=e;return{format:s,request:\"GetMap\",service:\"WMS\",styles:\"\",transparent:t,version:o,layers:r}}};e([t()],l.prototype,\"layer\",null),e([t({readOnly:!0})],l.prototype,\"layers\",null),e([t({type:Number})],l.prototype,\"scale\",void 0),e([t({readOnly:!0})],l.prototype,\"version\",null),e([t({readOnly:!0})],l.prototype,\"visibleSublayers\",null),l=e([o(\"esri.layers.support.ExportWMSImageParameters\")],l);export{l as ExportWMSImageParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nconst t=Math.PI/180;function n(n){return n*t}function o(t,n,o){const{resolution:r,size:u}=o;return t[0]=r*(Math.round(n[0]/r)+u[0]%2*.5),t[1]=r*(Math.round(n[1]/r)+u[1]%2*.5),t}function r(t,o){const r=n(o.rotation),u=Math.abs(Math.cos(r)),a=Math.abs(Math.sin(r)),[s,c]=o.size;return t[0]=Math.round(c*a+s*u),t[1]=Math.round(c*u+s*a),t}function u(t,n,o,r){const[u,a]=n,[s,c]=r,i=.5*o;return t[0]=u-i*s,t[1]=a-i*c,t[2]=u+i*s,t[3]=a+i*c,t}function a(t,n){const[o,r,u,a]=t,[s,c,i,e]=n;return!(o>i||u<s||r>e||a<c)}export{a as bboxIntersects,u as getBBox,r as getOuterSize,o as snapToPixel};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import e from\"../../../../core/Accessor.js\";import{debounce as i}from\"../../../../core/promiseUtils.js\";import{property as o}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as r}from\"../../../../core/accessorSupport/decorators/subclass.js\";import s from\"../../../../geometry/Extent.js\";import{create as a}from\"../../../../geometry/support/aaBoundingRect.js\";import{getInfo as p}from\"../../../../geometry/support/spatialReferenceUtils.js\";import n from\"../../../../layers/support/TileInfo.js\";import{getOuterSize as m,getBBox as l}from\"../../viewStateUtils.js\";import{Bitmap as d}from\"../../engine/Bitmap.js\";import h from\"../../tiling/TileInfoView.js\";import c from\"../../tiling/TileKey.js\";const u=a(),g=[0,0],f=new c(0,0,0,0),x={container:null,fetchSource:null,requestUpdate:null,imageMaxWidth:2048,imageMaxHeight:2048,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1};let y=class extends e{constructor(t){super(t),this._imagePromise=null,this.bitmaps=[],this.hidpi=x.hidpi,this.imageMaxWidth=x.imageMaxWidth,this.imageMaxHeight=x.imageMaxHeight,this.imageRotationSupported=x.imageRotationSupported,this.imageNormalizationSupported=x.imageNormalizationSupported,this.update=i((async(t,e)=>{if(!t.stationary||this.destroyed)return null;const i=t.state,o=p(i.spatialReference),r=this.hidpi?t.pixelRatio:1,s=this.imageNormalizationSupported&&i.worldScreenWidth&&i.worldScreenWidth<i.size[0];s?(g[0]=i.worldScreenWidth,g[1]=i.size[1]):this.imageRotationSupported?(g[0]=i.size[0],g[1]=i.size[1]):m(g,i);const a=Math.floor(g[0]*r)>this.imageMaxWidth||Math.floor(g[1]*r)>this.imageMaxHeight,n=o&&(i.extent.xmin<o.valid[0]||i.extent.xmax>o.valid[1]),l=!this.imageNormalizationSupported&&n,d=!a&&!l,h=this.imageRotationSupported?i.rotation:0;if(d){const t=s?i.paddedViewState.center:i.center;this._imagePromise=this._singleExport(i,g,t,i.resolution,h,r,e)}else{let t=Math.min(this.imageMaxWidth,this.imageMaxHeight);l&&(t=Math.min(i.worldScreenWidth,t)),this._imagePromise=this._tiledExport(i,t,h,r,e)}return this._imagePromise.then((async t=>{if(this._imagePromise=null,!this.destroyed){this.bitmaps=null!=t?t:[];for(const e of this.container.children)t.includes(e)||e.fadeOut().then((()=>{e.remove()}));for(const e of t)this.container.addChild(e),e.fadeIn()}})).catch((t=>{throw this._imagePromise=null,t}))}),5e3)}destroy(){this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}updateExports(t){for(const e of this.container.children){if(!e.visible||!e.stage)return;t(e),e.invalidateTexture(),e.requestRender()}}async _export(t,e,i,o,r,s){const a=await this.fetchSource(t,Math.floor(e*r),Math.floor(i*r),{rotation:o,pixelRatio:r,signal:s}),p=new d(a,\"additive\");return p.x=t.xmin,p.y=t.ymax,p.resolution=t.width/e,p.rotation=o,p.pixelRatio=r,p}async _singleExport(t,e,i,o,r,a,p){l(u,i,o,e);const n=new s(u[0],u[1],u[2],u[3],t.spatialReference);return[await this._export(n,e[0],e[1],r,a,p)]}_tiledExport(t,e,i,o,r){const a=n.create({size:e,spatialReference:t.spatialReference,scales:[t.scale]}),p=new h(a),m=p.getTileCoverage(t);if(!m)return null;const l=[];return m.forEach(((a,n,m,d)=>{f.set(a,n,m,d),p.getTileBounds(u,f);const h=new s(u[0],u[1],u[2],u[3],t.spatialReference);l.push(this._export(h,e,e,i,o,r))})),Promise.all(l)}};t([o()],y.prototype,\"_imagePromise\",void 0),t([o()],y.prototype,\"bitmaps\",void 0),t([o()],y.prototype,\"container\",void 0),t([o()],y.prototype,\"fetchSource\",void 0),t([o()],y.prototype,\"hidpi\",void 0),t([o()],y.prototype,\"imageMaxWidth\",void 0),t([o()],y.prototype,\"imageMaxHeight\",void 0),t([o()],y.prototype,\"imageRotationSupported\",void 0),t([o()],y.prototype,\"imageNormalizationSupported\",void 0),t([o()],y.prototype,\"requestUpdate\",void 0),t([o()],y.prototype,\"updating\",null),y=t([r(\"esri.views.2d.layers.support.ExportStrategy\")],y);const S=y;export{S as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../../../core/maybe.js\";import{b as e,c as i,r as s,j as r,m as h}from\"../../../chunks/mat3.js\";import{c as n}from\"../../../chunks/mat3f32.js\";import{f as u}from\"../../../chunks/vec2f32.js\";import{DisplayObject as o}from\"./DisplayObject.js\";import a from\"./ImageryBitmapSource.js\";import d from\"../../webgl/Texture.js\";function c(t){return t&&\"render\"in t}function l(t){return t&&!(\"render\"in t)}function x(t){const e=document.createElement(\"canvas\");return e.width=t.width,e.height=t.height,t.render(e.getContext(\"2d\")),e}function _(t,e,i){const s={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return e&&i&&(s.width=e,s.height=i),new d(t,s)}class g extends o{constructor(t=null,e,i=!0){super(),this.requestRenderOnSourceChangedEnabled=i,this._textureInvalidated=!0,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.blendFunction=e,this.source=t,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null)}get isSourceScaled(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}get height(){return void 0!==this._height?this._height:this.sourceHeight}set height(t){this._height=t}get source(){return this._source}set source(t){this._source=t,this.invalidateTexture()}get sourceHeight(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}get sourceWidth(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}get width(){return void 0!==this._width?this._width:this.sourceWidth}set width(t){this._width=t}beforeRender(t){super.beforeRender(t),this.updateTexture(t.context)}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}_createTransforms(){return{dvs:n()}}setTransform(t){const n=e(this.transforms.dvs),[o,a]=t.toScreenNoRotation([0,0],[this.x,this.y]),d=this.resolution/this.pixelRatio/t.resolution,c=d*this.width,l=d*this.height,x=Math.PI*this.rotation/180;i(n,n,u(o,a)),i(n,n,u(c/2,l/2)),s(n,n,-x),i(n,n,u(-c/2,-l/2)),r(n,n,u(c,l)),h(this.transforms.dvs,t.displayViewMat3,n)}setSamplingProfile(t){this._texture&&(t.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(t.samplingMode))}bind(t,e){this._texture&&t.bindTexture(this._texture,e)}updateTexture(e){var i;if(!this.stage)return null==(i=this._texture)||i.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this.source?this._texture=_(e,this.sourceWidth,this.sourceHeight):this._texture=_(e));const s=this.source;if(s){if(this._texture.resize(this.sourceWidth,this.sourceHeight),c(s))if(s instanceof a){const e=s.getRenderedRasterPixels();this._texture.setData(t(e)?e.renderedRasterPixels:null)}else this._texture.setData(x(s));else l(s)&&this._texture.setData(s);this.ready()}else this._texture.setData(null)}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}}export{g as Bitmap,c as isImageSource,x as rasterize};\n"],"sourceRoot":""}
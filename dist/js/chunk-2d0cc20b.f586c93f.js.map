{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/views/layers/GroupLayerView.js"],"names":["o","e","super","this","type","layerViews","handles","add","on","_layerViewsChangeHandler","_layerViewsAfterChangesHandler","layer","watch","_visibilityModeHandler","_visibleHandler","target","added","toArray","removed","moved","_set","_get","some","updating","length","reduce","i","updatingProgress","_isOverridden","find","layers","_findLayerViewForLayer","visible","_hasLayerViewVisibleOverrides","_firstVisibleOnLayerOrder","getItemAt","forEach","remove","map","_layerViewVisibleHandler","s","_enforceVisibility","_updateUpdating","visibilityMode","_enforceExclusiveVisibility","notifyChange","cast","prototype","readOnly","h"],"mappings":"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","file":"js/chunk-2d0cc20b.f586c93f.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import i from\"../../core/Collection.js\";import{castForReferenceSetter as s,referenceSetter as r}from\"../../core/collectionUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import l from\"./LayerView.js\";let o=class extends l{constructor(e){super(e),this.type=\"group\",this.layerViews=new i}initialize(){this.handles.add([this.layerViews.on(\"change\",(e=>this._layerViewsChangeHandler(e))),this.layerViews.on(\"after-changes\",(()=>this._layerViewsAfterChangesHandler())),this.layer.watch(\"visibilityMode\",(()=>this._visibilityModeHandler()),!0),this.watch(\"visible\",(()=>this._visibleHandler()),!0)],\"grouplayerview\"),this._layerViewsChangeHandler({target:null,added:this.layerViews.toArray(),removed:[],moved:[]}),this._layerViewsAfterChangesHandler()}set layerViews(e){this._set(\"layerViews\",r(e,this._get(\"layerViews\")))}isUpdating(){return this.layerViews.some((e=>e.updating))}get updatingProgress(){return 0===this.layerViews.length?1:this.layerViews.reduce(((e,i)=>e+i.updatingProgress),0)/this.layerViews.length}_hasLayerViewVisibleOverrides(){return this.layerViews.some((e=>e._isOverridden(\"visible\")))}_findLayerViewForLayer(e){return e&&this.layerViews.find((i=>i.layer===e))}_firstVisibleOnLayerOrder(){const e=this.layer.layers.find((e=>{const i=this._findLayerViewForLayer(e);return i&&i.visible}));return e&&this._findLayerViewForLayer(e)}_enforceExclusiveVisibility(e){this._hasLayerViewVisibleOverrides()&&(e||!(e=this._firstVisibleOnLayerOrder())&&this.layerViews.length>0&&(e=this._findLayerViewForLayer(this.layer.layers.getItemAt(0))),this.layerViews.forEach((i=>{i.visible=i===e})))}_layerViewsChangeHandler(e){this.handles.remove(\"grouplayerview:visible\"),this.handles.add(this.layerViews.map((e=>e.watch(\"visible\",(i=>this._layerViewVisibleHandler(i,e)),!0))).toArray(),\"grouplayerview:visible\");const i=e.added[e.added.length-1];let s=null;i&&i.visible&&(s=i),this._enforceVisibility(s)}_layerViewsAfterChangesHandler(){this.handles.remove(\"grouplayerview:updating\"),this.handles.add(this.layerViews.map((e=>e.watch(\"updating\",(()=>this._updateUpdating()),!0))).toArray(),\"grouplayerview:updating\"),this._updateUpdating()}_enforceVisibility(e){if(this._hasLayerViewVisibleOverrides())switch(this.layer.visibilityMode){case\"inherited\":{const e=this.visible;this.layerViews.forEach((i=>{i.visible=e}));break}case\"exclusive\":this._enforceExclusiveVisibility(e)}}_visibilityModeHandler(){this._enforceVisibility()}_layerViewVisibleHandler(e,i){if(this._hasLayerViewVisibleOverrides())switch(this.layer.visibilityMode){case\"inherited\":e!==this.visible&&(i.visible=this.visible);break;case\"exclusive\":this._enforceExclusiveVisibility(e&&i)}}_visibleHandler(){var e;this._hasLayerViewVisibleOverrides()&&\"inherited\"===(null==(e=this.layer)?void 0:e.visibilityMode)&&this._enforceVisibility()}_updateUpdating(){this.notifyChange(\"updating\")}};e([t({cast:s})],o.prototype,\"layerViews\",null),e([t()],o.prototype,\"view\",void 0),e([t({readOnly:!0})],o.prototype,\"updatingProgress\",null),o=e([a(\"esri.views.layers.GroupLayerView\")],o);const h=o;export{h as default};\n"],"sourceRoot":""}
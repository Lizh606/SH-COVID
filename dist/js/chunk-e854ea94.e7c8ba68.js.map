{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/views/2d/layers/TileLayerView2D.js","webpack:///./node_modules/@arcgis/core/views/layers/TileLayerView.js","webpack:///./node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","webpack:///./node_modules/@arcgis/core/views/support/drapedUtils.js"],"names":["d","getLogger","_","I","super","arguments","this","_tileStrategy","_fetchQueue","layer","e","tileInfo","i","spatialReference","s","equals","view","watch","doRefresh","addResolvingPromise","Promise","reject","resampling","pause","state","update","resume","notifyChange","tileServers","_tileInfoView","fullExtent","tileInfoView","concurrency","length","process","t","fetchTile","cachePolicy","acquireTile","releaseTile","requestUpdate","container","requestRender","attach","detach","destroy","clear","removeAllChildren","updateRequested","suspended","reset","tiles","forEach","_enqueueTileFetch","_bitmapView","createTile","bitmap","x","y","getTileCoords","key","resolution","getTileResolution","width","height","size","addChild","abort","id","removeChild","once","tilemapCache","signal","r","resamplingLevel","a","_fetchImage","c","getTileParentId","l","o","fetchAvailabilityUpsample","level","row","col","has","push","source","error","prototype","T","type","get","allSublayers","toArray","filter","minScale","maxScale","popupTemplate","popupEnabled","visible","map","async","createQuery","event","renderer","geometry","createFetchPopupFeaturesQueryGeometry","outFields","getRequiredFields","queryFeatures","features","then","concat","value","Boolean","xoffset","Math","max","abs","yoffset","n","stops","maxSize","minSize","f","floor","pointerType","visualVariables","symbol","uniqueValueInfos","classBreakInfos","overlayPixelSizeInMapUnits","basemapSpatialReference","m","p","xmin","min","ymin","xmax","ymax"],"mappings":"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","file":"js/chunk-e854ea94.e7c8ba68.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import i from\"../../../core/Logger.js\";import{isAbortError as s}from\"../../../core/promiseUtils.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{BitmapTileLayerView2D as l}from\"./BitmapTileLayerView2D.js\";import{LayerView2DMixin as o}from\"./LayerView2D.js\";import{createBlankImage as h,resampleImage as n}from\"./support/imageUtils.js\";import c from\"../tiling/TileInfoView.js\";import u from\"../tiling/TileKey.js\";import p from\"../tiling/TileQueue.js\";import f from\"../tiling/TileStrategy.js\";import m from\"../../layers/LayerView.js\";import{RefreshableLayerView as y}from\"../../layers/RefreshableLayerView.js\";import{TileLayerView as w}from\"../../layers/TileLayerView.js\";import{createQueryGeometry as g}from\"../../support/drapedUtils.js\";const d=i.getLogger(\"esri.views.2d.layers.TileLayerView2D\"),_=[0,0];let I=class extends(w(y(l(o(m))))){constructor(){super(...arguments),this._tileStrategy=null,this._fetchQueue=null,this.layer=null}initialize(){const e=this.layer.tileInfo,i=e&&e.spatialReference;let s;i||(s=new t(\"layerview:tiling-information-missing\",\"The layer doesn't provide tiling information\",{layer:this.layer})),i.equals(this.view.spatialReference)||(s=new t(\"layerview:spatial-reference-incompatible\",\"The spatial reference of this layer does not meet the requirements of the view\",{layer:this.layer})),this.watch(\"resampling\",(()=>{this.doRefresh()})),s&&this.addResolvingPromise(Promise.reject(s))}get resampling(){return!(\"resampling\"in this.layer)||!1!==this.layer.resampling}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume(),this.notifyChange(\"updating\")}attach(){const e=\"tileServers\"in this.layer?this.layer.tileServers:null;this._tileInfoView=new c(this.layer.tileInfo,this.layer.fullExtent),this._fetchQueue=new p({tileInfoView:this._tileInfoView,concurrency:e&&10*e.length||10,process:(e,t)=>this.fetchTile(e,t)}),this._tileStrategy=new f({cachePolicy:\"keep\",resampling:this.resampling,acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),tileInfoView:this._tileInfoView}),this.requestUpdate(),this.container.requestRender(),super.attach()}detach(){super.detach(),this._tileStrategy.destroy(),this._fetchQueue.clear(),this.container.removeAllChildren(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQueryGeometry(e,t){return g(e,t,this.view)}async doRefresh(){this.updateRequested||this.suspended||(this._fetchQueue.reset(),this._tileStrategy.tiles.forEach((e=>this._enqueueTileFetch(e))),this.notifyChange(\"updating\"))}isUpdating(){var e;return(null==(e=this._fetchQueue)?void 0:e.length)>0}acquireTile(e){const t=this._bitmapView.createTile(e),i=t.bitmap;return[i.x,i.y]=this._tileInfoView.getTileCoords(_,t.key),i.resolution=this._tileInfoView.getTileResolution(t.key),[i.width,i.height]=this._tileInfoView.tileInfo.size,this._enqueueTileFetch(t),this._bitmapView.addChild(t),this.requestUpdate(),t}releaseTile(e){this._fetchQueue.abort(e.key.id),this._bitmapView.removeChild(e),e.once(\"detach\",(()=>e.destroy())),this.requestUpdate()}async fetchTile(e,t={}){const i=\"tilemapCache\"in this.layer?this.layer.tilemapCache:null,{signal:r,resamplingLevel:a=0}=t;if(!i)try{return await this._fetchImage(e,r)}catch(c){if(!s(c)&&!this.resampling)return h(this._tileInfoView.tileInfo.size);if(a<3){const i=this._tileInfoView.getTileParentId(e.id);if(i){const s=new u(i),r=await this.fetchTile(s,{...t,resamplingLevel:a+1});return n(this._tileInfoView,r,s,e)}}throw c}const l=new u(0,0,0,0);let o;try{if(await i.fetchAvailabilityUpsample(e.level,e.row,e.col,l,{signal:r}),l.level!==e.level&&!this.resampling)return h(this._tileInfoView.tileInfo.size);o=await this._fetchImage(l,r)}catch(c){if(s(c))throw c;o=await this._fetchImage(e,r)}return this.resampling?n(this._tileInfoView,o,l,e):o}async _enqueueTileFetch(e){if(!this._fetchQueue.has(e.key.id)){try{const t=await this._fetchQueue.push(e.key);e.bitmap.source=t,e.bitmap.width=this._tileInfoView.tileInfo.size[0],e.bitmap.height=this._tileInfoView.tileInfo.size[1],e.once(\"attach\",(()=>this.requestUpdate()))}catch(t){s(t)||d.error(t)}this.requestUpdate()}}async _fetchImage(e,t){return this.layer.fetchTile(e.level,e.row,e.col,{signal:t})}};e([r()],I.prototype,\"resampling\",null),I=e([a(\"esri.views.2d.layers.TileLayerView2D\")],I);const T=I;export{T as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{isSome as t}from\"../../core/maybe.js\";import{eachAlways as o}from\"../../core/promiseUtils.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{calculateTolerance as p}from\"../../renderers/support/clickToleranceUtils.js\";const i=i=>{let c=class extends i{async fetchPopupFeatures(e,s){const{layer:a}=this;if(!e)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:a}));if(\"tile\"!==a.type)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Layer type should be 'tile'\",{type:a.type}));const i=this.get(\"view.scale\"),c=a.allSublayers.toArray().filter((e=>{const r=0===e.minScale||i<=e.minScale,t=0===e.maxScale||i>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&r&&t}));return o(c.map((async r=>{const o=r.createQuery(),a=t(s)?s.event:null,i=p({renderer:r.renderer,event:a});o.geometry=this.createFetchPopupFeaturesQueryGeometry(e,i),o.outFields=await r.popupTemplate.getRequiredFields();return(await r.queryFeatures(o)).features}))).then((e=>[].concat(...e.map((e=>e.value)).filter(Boolean))))}};return e([s()],c.prototype,\"layer\",void 0),c=e([a(\"esri.layers.mixins.TileLayerView\")],c),c};export{i as TileLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}function n(t,n){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>\"size\"===t.type)).map((e=>{const{maxSize:r,minSize:s}=e;return(n(r,t)+n(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let n=0;n<o;n++)s+=r[n];const f=Math.floor(s/o);return Math.max(f,t)}function s(e){const n=e&&e.renderer,s=\"touch\"===(e&&e.event&&e.event.pointerType)?9:6;if(!n)return s;const o=\"visualVariables\"in n?r(s,n.visualVariables):s;if(\"simple\"===n.type)return t(o,n.symbol);if(\"unique-value\"===n.type){let e=o;return n.uniqueValueInfos.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===n.type){let e=o;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return n.type,o}export{s as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{isSome as e,isNone as t}from\"../../core/maybe.js\";import{getMetersPerUnitForSR as r}from\"../../core/unitUtils.js\";import{calculateTolerance as n}from\"../../renderers/support/clickToleranceUtils.js\";import i from\"../../geometry/Extent.js\";function a(t,n,a,o=new i){let s;if(\"2d\"===a.type)s=n*a.resolution;else if(\"3d\"===a.type){const i=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?r(o)/r(a.spatialReference):n*i}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,i){const o=i.toMap(e);if(t(o))return!1;return a(o,n(),i,s).intersects(r)}const s=new i;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n"],"sourceRoot":""}
{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/views/3d/layers/WMSLayerView3D.js","webpack:///./node_modules/@arcgis/core/views/layers/RefreshableLayerView.js","webpack:///./node_modules/@arcgis/core/views/3d/layers/support/overlayImageUtils.js","webpack:///./node_modules/@arcgis/core/views/3d/layers/DynamicLayerView3D.js","webpack:///./node_modules/@arcgis/core/views/layers/WMSLayerView.js","webpack:///./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ImageMaterialTechnique.js","webpack:///./node_modules/@arcgis/core/views/3d/webgl-engine/materials/ImageMaterial.js","webpack:///./node_modules/@arcgis/core/layers/support/ExportWMSImageParameters.js","webpack:///./node_modules/@arcgis/core/views/3d/layers/support/projectExtentUtils.js","webpack:///./node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js"],"names":["p","super","arguments","this","type","layer","supportsSpatialReference","view","spatialReference","addResolvingPromise","Promise","reject","updatingHandles","add","exportImageParameters","addPromise","refreshDebounced","e","t","findExtentInfoAt","r","extent","s","_spatialReference","o","imageSize","a","width","height","n","x","Math","round","xmin","y","ymax","timeExtent","prototype","i","c","handles","doRefresh","dataChanged","catch","getLogger","declaredClass","error","createSquareGeometry","min","max","h","u","l","m","g","Float64Array","w","Float32Array","d","Uint32Array","f","M","v","length","size","data","exclusive","P","O","drapeSourceType","updatePolicy","fullExtentInLocalViewSpatialReference","maximumDataResolution","_images","Array","_extents","_overlays","updateWhenStationary","async","destroyed","_doRefresh","then","_set","_suspendedChangeHandler","resourceController","scheduler","registerIdleStateCallbacks","_isScaleRangeActive","notifyChange","_isScaleRangeLayer","clear","forEach","index","_updateImageExtent","_clippedExtent","H","resolution","pixelRatio","imageMaxWidth","imageMaxHeight","floor","_imageSizeEquals","suspended","_fetch","_clearImage","push","canResume","minScale","maxScale","scale","some","loadingPromise","HTMLImageElement","HTMLCanvasElement","image","contains","_createStageObjects","abs","TESTS_DISABLE_OPTIMIZATIONS","texture","material","renderGeometry","loadingAbortController","pixelData","renderExtent","abort","AbortController","signal","_waitFetchReady","requestAsImageElement","getFetchOptions","fetchImage","warnOnce","processResult","aborted","basemapTerrain","overlayManager","renderer","removeGeometries","_stage","remove","preMultiplyAlpha","wrap","loadSynchronous","transparent","textureId","id","setParameters","origin","renderLocalOrigin","addGeometries","viewingMode","ready","readOnly","V","destroy","commitProperty","_get","popupEnabled","createFetchPopupFeaturesQuery","resolve","fetchFeatureInfo","shader","get","configuration","build","output","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","OITEnabled","transparencyPassType","multipassTerrainEnabled","cullAboveGround","rctx","program","camera","projectionMatrix","setUniform1f","opacity","setUniform2fv","nearFar","inverseViewport","rebindTextures","blending","culling","cullFace","depthTest","func","depthWrite","writeDepth","colorWrite","stencilWrite","sceneHasOcludees","stencilTest","polygonOffset","enableOffset","_occludeePipelineState","setPipelineState","getPipelineState","count","supportsEdges","techniqueConfig","parameters","relativeElevation","_material","updateTexture","ensureTechnique","hasOccludees","updateParameters","_output","_updateOccludeeState","bindTextures","bindTextureScale","bindPass","initTextureTransparent","visible","sublayers","on","propertyName","visibleSublayers","filter","name","map","join","unshift","layers","imageFormat","imageTransparency","version","format","request","service","styles","Number","fullExtent","equals","clone","state","isLocal","portalItem","include","linearDepth","vertex","uniforms","attributes","varyings","code","fragment","float","Object","freeze","__proto__"],"mappings":"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","file":"js/chunk-0e83f8cb.35af4313.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";import i from\"../../../geometry/Extent.js\";import o from\"./DynamicLayerView3D.js\";import{WMSLayerView as a}from\"../../layers/WMSLayerView.js\";let p=class extends(a(o)){constructor(){super(...arguments),this.type=\"wms-3d\"}initialize(){this.layer.supportsSpatialReference(this.view.spatialReference)||this.addResolvingPromise(Promise.reject(new t(\"layerview:spatial-reference-incompatible\",\"The spatial references supported by this WMS layer are incompatible with the spatial reference of the view\"))),this.updatingHandles.add(this.exportImageParameters,\"version\",(()=>{this.updatingHandles.addPromise(this.refreshDebounced())}))}createFetchPopupFeaturesQuery(e){const t=this.findExtentInfoAt(e),r=t.extent,s=new i(r[0],r[1],r[2],r[3],this._spatialReference),o=t.imageSize,a=o.width,p=o.height,n=s.width/a;return{extent:s,width:a,height:p,x:Math.round((e.x-s.xmin)/n),y:Math.round((s.ymax-e.y)/n)}}getFetchOptions(){return{timeExtent:this.timeExtent}}};e([r()],p.prototype,\"suspended\",void 0),p=e([s(\"esri.views.3d.layers.WMSLayerView3D\")],p);const n=p;export{n as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/watchUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const i=i=>{let c=class extends i{initialize(){this.handles.add(o(this,\"layer\",\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([a(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{i as RefreshableLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{width as t,height as e,intersects as n}from\"../../../../geometry/support/aaBoundingRect.js\";import{Geometry as i}from\"../../webgl-engine/lib/Geometry.js\";import r from\"../../webgl-engine/lib/GeometryUtil.js\";function o(n,i,r){const o=t(n)/e(n),a={width:r,height:r};return o>1.0001?a.height=r/o:o<.9999&&(a.width=r*o),a.width=Math.round(a.width/(t(n)/t(i))),a.height=Math.round(a.height/(e(n)/e(i))),a}function a(t){return r.createSquareGeometry([[t[0],t[1],-1],[t[2],t[1],-1],[t[2],t[3],-1],[t[0],t[3],-1]])}function h(t,e){if(!n(t,e))return a(e);const r=[t[1]-e[1],Math.min(t[3],e[3])-Math.max(t[1],e[1]),e[3]-t[3],123456],o=[t[0]-e[0],Math.min(t[2],e[2])-Math.max(t[0],e[0]),e[2]-t[2],123456],h=e[2]-e[0],u=e[3]-e[1],l=o[0]>0&&o[2]>0?3:2,m=r[0]>0&&r[2]>0?3:2,c=(m+1)*(l+1),g=new Float64Array(3*c),w=new Float32Array(2*c),d=new Uint32Array(6*(m*l-1));let f=0,p=0,y=0,x=0,M=0;for(let n=0;n<4;n++){const t=r[n];if(t<=0)continue;let i=0;for(let r=0;r<4;r++){const t=o[r];t<=0||(g[p++]=e[0]+i,g[p++]=e[1]+f,g[p++]=-1,w[y++]=i/h,w[y++]=f/u,r<3&&n<3&&(1!==r||1!==n)&&(d[M++]=x,d[M++]=x+1,d[M++]=x+l+1,d[M++]=x+1,d[M++]=x+l+2,d[M++]=x+l+1),x++,i+=t)}f+=t}const v=new Uint32Array(d.length);return new i([[\"position\",{size:3,data:g,exclusive:!0}],[\"normal\",{size:3,data:s,exclusive:!0}],[\"uv0\",{size:2,data:w,exclusive:!0}]],[[\"position\",d],[\"normal\",v],[\"uv0\",d]])}const s=[0,0,1];export{o as computeImageExportSize,a as createGeometryForExtent,h as createOuterImageGeometry};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{forEach as t,result as i}from\"../../../core/asyncUtils.js\";import r from\"../../../core/Logger.js\";import{isNone as a,isSome as s}from\"../../../core/maybe.js\";import{debounce as n,isAbortError as o,eachAlways as l,onAbort as h,isAborted as m,createAbortError as d,always as c,throwIfAborted as g}from\"../../../core/promiseUtils.js\";import{whenOnce as u}from\"../../../core/watchUtils.js\";import{property as p}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as y}from\"../../../core/accessorSupport/decorators/subclass.js\";import f from\"../../../geometry/Extent.js\";import{equals as x,create as w,width as _,height as v,copy as b,intersection as R}from\"../../../geometry/support/aaBoundingRect.js\";import{LayerView3D as S}from\"./LayerView3D.js\";import{computeImageExportSize as j,createGeometryForExtent as E,createOuterImageGeometry as I}from\"./support/overlayImageUtils.js\";import{toViewIfLocal as A}from\"./support/projectExtentUtils.js\";import C from\"../support/debugFlags.js\";import{RenderGeometry as L}from\"../webgl-engine/lib/RenderGeometry.js\";import{Texture as M}from\"../webgl-engine/lib/Texture.js\";import{ImageMaterial as D}from\"../webgl-engine/materials/ImageMaterial.js\";import G from\"../../layers/LayerView.js\";import{RefreshableLayerView as T}from\"../../layers/RefreshableLayerView.js\";const P=r.getLogger(\"esri.views.3d.layers.DynamicLayerView3D\");let O=class extends(T(S(G))){constructor(){super(...arguments),this.drapeSourceType=0,this.updatePolicy=1,this.fullExtentInLocalViewSpatialReference=null,this.maximumDataResolution=null,this._images=new Array,this._extents=new Array,this._overlays=new Array,this.updateWhenStationary=!0,this.refreshDebounced=n((async e=>{this.destroyed||await this._doRefresh(e).catch((e=>{o(e)||r.getLogger(this.declaredClass).error(e)}))}),2e3)}initialize(){this.addResolvingPromise(A(this).then((e=>this._set(\"fullExtentInLocalViewSpatialReference\",e)))),this.updatingHandles.add(this,\"suspended\",(()=>this._suspendedChangeHandler())),this.handles.add(this.view.resourceController.scheduler.registerIdleStateCallbacks((()=>{this._isScaleRangeActive()&&this.notifyChange(\"suspended\")}),(()=>{}))),this._isScaleRangeLayer()&&this.updatingHandles.add(this.layer,\"scaleRangeId\",(()=>this.notifyChange(\"suspended\")))}destroy(){this.clear()}setDrapingExtent(e,t){this._spatialReference=t,e.forEach((e=>{this._overlays[e.index]=e,this._updateImageExtent(e)}))}_updateImageExtent(e){const t=this._clippedExtent(e.extent,H);if(a(t))return;const i=j(e.extent,t,e.resolution);let r=e.pixelRatio*this.view.pixelRatio;if(\"imageMaxWidth\"in this.layer||\"imageMaxHeight\"in this.layer){const e=this.layer.imageMaxWidth,t=this.layer.imageMaxHeight;if(i.width>e){const t=e/i.width;i.height=Math.floor(i.height*t),i.width=e,r*=t}if(i.height>t){const e=t/i.height;i.width=Math.floor(i.width*e),i.height=t,r*=e}}const s=this._extents[e.index];s&&x(s.extent,t)&&this._imageSizeEquals(t,s.imageSize,i)||(this._extents[e.index]={extent:w(t),imageSize:i,pixelRatio:r},this.suspended||this._fetch(e.index).catch((e=>{o(e)||P.error(e)})))}clear(){for(let e=0;e<this._images.length;e++)this._clearImage(e)}async doRefresh(){return this._doRefresh()}async _doRefresh(e){if(this.suspended)return;const t=[];for(let i=0;i<this._extents.length;i++)this._extents[i]&&t.push(this._fetch(i,e));await l(t)}canResume(){if(!super.canResume())return!1;if(this._isScaleRangeLayer()){const{minScale:e,maxScale:t}=this.layer;if(e>0||t>0){const i=this.view.scale;if(i<t||e>0&&i>e)return!1}}return!0}isUpdating(){return this._images.some((e=>!!e.loadingPromise))}async processResult(e,t,i){(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement)&&(e.image=t)}findExtentInfoAt(e){for(const t of this._extents){const i=t.extent;if(new f(i[0],i[1],i[2],i[3],this._spatialReference).contains(e))return t}return null}getFetchOptions(){}async redraw(e,i){await t(this._images,(async(t,r)=>{t&&(await e(t,i),await this._createStageObjects(r,t.image,i))}))}_imageSizeEquals(e,t,i){if(!this.maximumDataResolution)return!1;const r=_(e)/this.maximumDataResolution.x,a=v(e)/this.maximumDataResolution.y,s=r/t.width,n=a/t.height,o=r/i.width,l=a/i.height,h=Math.abs(s-o),m=Math.abs(n-l),d=C.TESTS_DISABLE_OPTIMIZATIONS?0:1.5;return h<=d&&m<=d}async _fetch(e,t){if(this.suspended)return;const i=this._extents[e],r=i.extent;this._images[e]||(this._images[e]={texture:null,material:null,renderGeometry:null,loadingPromise:null,loadingAbortController:null,image:null,pixelData:null,renderExtent:w(r)});const a=this._images[e];a.loadingAbortController&&(a.loadingAbortController.abort(),a.loadingAbortController=null);const s=new f(r[0],r[1],r[2],r[3],this._spatialReference);if(0===s.width||0===s.height)return void this._clearImage(e);const n=new AbortController;a.loadingAbortController=n,h(t,(()=>n.abort()));const l=n.signal,g=this._waitFetchReady(l).then((()=>{const t={requestAsImageElement:!0,pixelRatio:this._overlays[e].pixelRatio,...this.getFetchOptions(),signal:l},{height:r,width:a}=i.imageSize;return this.layer.fetchImage(s,a,r,t)})).then((e=>{if(m(l))throw P.warnOnce(\"A call to fetchImage resolved even though the request was aborted. fetchImage should not resolve if options.signal.aborted is true.\"),d();return this.processResult(a,e)})).then((()=>b(a.renderExtent,r)));a.loadingPromise=g,c(g,(()=>{g===a.loadingPromise&&(a.loadingPromise=null,a.loadingAbortController=null)})),this.notifyChange(\"updating\"),await g.then((async()=>{if(l.aborted)throw d();await this._createStageObjects(e,a.image,l),this.notifyChange(\"updating\")})).catch((e=>{throw e&&!o(e)&&P.error(e),this.notifyChange(\"updating\"),e}))}_clearImage(e){const t=this._images[e];if(t){s(t.renderGeometry)&&(this.view.basemapTerrain.overlayManager.renderer.removeGeometries([t.renderGeometry],this,2),t.renderGeometry=null);const e=this.view._stage;e.remove(t.texture),t.texture=null,e.remove(t.material),t.material=null,t.loadingAbortController&&(t.loadingAbortController.abort(),t.loadingAbortController=null),t.loadingPromise=null,t.image=null,t.pixelData=null}}async _createStageObjects(e,t,r){const n=this.view._stage,o=this._images[e],l=this.view.basemapTerrain.overlayManager.renderer,h=()=>{n.remove(o.texture),o.texture=null,s(o.renderGeometry)&&(l.removeGeometries([o.renderGeometry],this,2),o.renderGeometry=null)};if(t){const s=new M(t,{width:t.width,height:t.height,preMultiplyAlpha:!0,wrap:{s:33071,t:33071}});let m;if(await i(this._images[0===e?1:0].loadingPromise),g(r),0===e)m=E(o.renderExtent);else{const e=this._images[0].renderExtent;if(!e)return void h();m=I(e,o.renderExtent)}h(),n.add(s),n.loadSynchronous(s),o.texture=s,a(o.material)?(o.material=new D({transparent:!0,textureId:s.id}),n.add(o.material)):o.material.setParameters({textureId:s.id}),o.renderGeometry=new L(m,o.material),o.renderGeometry.origin=this._overlays[e].renderLocalOrigin,l.addGeometries([o.renderGeometry],this,2)}else h(),n.remove(o.material),o.material=null}_isScaleRangeLayer(){return\"minScale\"in this.layer&&\"maxScale\"in this.layer}_isScaleRangeActive(){return!!this._isScaleRangeLayer()&&(this.layer.minScale>0||this.layer.maxScale>0)}_clippedExtent(e,t){if(\"local\"!==this.view.viewingMode)return b(t,e);const i=this.view.basemapTerrain;return i.ready?R(e,i.extent,t):b(t,e)}_suspendedChangeHandler(){this.suspended?this.clear():this.refreshDebounced()}async _waitFetchReady(e){await u(this.view,\"stationary\",e),g(e)}};e([p()],O.prototype,\"layer\",void 0),e([p()],O.prototype,\"suspended\",void 0),e([p({readOnly:!0})],O.prototype,\"fullExtentInLocalViewSpatialReference\",void 0),e([p()],O.prototype,\"updating\",void 0),O=e([y(\"esri.views.3d.layers.DynamicLayerView3D\")],O);const H=w(),V=O;export{V as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as s}from\"../../layers/support/commonProperties.js\";import{ExportWMSImageParameters as p}from\"../../layers/support/ExportWMSImageParameters.js\";const a=a=>{let i=class extends a{initialize(){this.exportImageParameters=new p({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get exportImageVersion(){var e;return null==(e=this.exportImageParameters)||e.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),(this._get(\"exportImageVersion\")||0)+1}fetchPopupFeatures(e){const{layer:t}=this;if(!e)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:t}));const{popupEnabled:o}=t;if(!o)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"popupEnabled should be true\",{popupEnabled:o}));const s=this.createFetchPopupFeaturesQuery(e);if(!s)return Promise.resolve([]);const{extent:p,width:a,height:i,x:m,y:n}=s;if(!(p&&a&&i))throw new r(\"wmslayerview:fetchPopupFeatures\",\"WMSLayer does not support fetching features.\",{extent:p,width:a,height:i});const u=t.fetchFeatureInfo(p,a,i,m,n);return Promise.resolve(u?[u]:[])}};return e([t()],i.prototype,\"exportImageParameters\",void 0),e([t({readOnly:!0})],i.prototype,\"exportImageVersion\",null),e([t()],i.prototype,\"layer\",void 0),e([t(s)],i.prototype,\"timeExtent\",void 0),i=e([o(\"esri.layers.mixins.WMSLayerView\")],i),i};export{a as WMSLayerView,a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{bindSliceUniformsWithOrigin as t}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindMultipassTerrainTexture as r}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{bindProjectionMatrix as i,bindView as s}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as a}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{parameter as n,ShaderTechniqueConfiguration as l}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{Default3D as p}from\"../lib/DefaultVertexAttributeLocations.js\";import{OITBlending as c,OITDepthTest as u,OITDepthWrite as d,getOITPolygonOffset as h}from\"../lib/OrderIndependentTransparency.js\";import{Program as m}from\"../lib/Program.js\";import{stencilWriteMaskOn as b,stencilToolMaskBaseParams as f,stencilBaseAllZerosParams as g}from\"../lib/StencilUtils.js\";import{I as y}from\"../../../../chunks/ImageMaterial.glsl.js\";import{simpleBlendingParams as T,makePipelineState as P,cullingParams as v,defaultDepthWriteParams as j,defaultColorWriteParams as S}from\"../../../webgl/renderState.js\";class E extends o{initializeProgram(e){const t=E.shader.get(),r=this.configuration,i=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new m(e.rctx,i,p)}bindPass(e,t){i(this.program,t.camera.projectionMatrix),this.program.setUniform1f(\"opacity\",e.opacity),t.multipassTerrainEnabled&&(this.program.setUniform2fv(\"cameraNearFar\",t.camera.nearFar),this.program.setUniform2fv(\"inverseViewport\",t.inverseViewport),r(this.program,t))}bindDraw(e){s(this.program,e),t(this.program,this.configuration,e),this.program.rebindTextures()}setPipelineState(e,t){const r=this.configuration,i=3===e,s=2===e;return P({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?w:c(e),culling:v(r.cullFace),depthTest:{func:u(e)},depthWrite:i?r.writeDepth&&j:d(e),colorWrite:S,stencilWrite:r.sceneHasOcludees?b:null,stencilTest:r.sceneHasOcludees?t?f:g:null,polygonOffset:i||s?null:h(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}}E.shader=new a(y,(()=>import(\"./ImageMaterial.glsl.js\")));const w=T(1,771);class O extends l{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1}}e([n({count:8})],O.prototype,\"output\",void 0),e([n({count:3})],O.prototype,\"cullFace\",void 0),e([n()],O.prototype,\"slicePlaneEnabled\",void 0),e([n()],O.prototype,\"transparent\",void 0),e([n()],O.prototype,\"enableOffset\",void 0),e([n()],O.prototype,\"writeDepth\",void 0),e([n()],O.prototype,\"sceneHasOcludees\",void 0),e([n({count:4})],O.prototype,\"transparencyPassType\",void 0),e([n()],O.prototype,\"multipassTerrainEnabled\",void 0),e([n()],O.prototype,\"cullAboveGround\",void 0);export{E as ImageMaterialTechnique,O as ImageMaterialTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{outputFromPass as e}from\"../lib/GLMaterials.js\";import t from\"../lib/GLMaterialTexture.js\";import{Material as r,materialParametersDefaults as a}from\"../lib/Material.js\";import{OITPolygonOffsetLimit as s}from\"../lib/OrderIndependentTransparency.js\";import{DefaultBufferWriter as i,PositionUVLayout as n}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as u}from\"./internal/MaterialUtil.js\";import{ImageMaterialTechniqueConfiguration as c,ImageMaterialTechnique as l}from\"../shaders/ImageMaterialTechnique.js\";class h extends r{constructor(e){super(e,o),this.supportsEdges=!0,this.techniqueConfig=new c}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.parameters.cullFace,this.techniqueConfig.slicePlaneEnabled=this.parameters.slicePlaneEnabled,this.techniqueConfig.transparent=this.parameters.transparent,this.techniqueConfig.writeDepth=this.parameters.writeDepth,this.techniqueConfig.sceneHasOcludees=this.parameters.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t.transparencyPassType,this.techniqueConfig.enableOffset=t.camera.relativeElevation<s,this.techniqueConfig.multipassTerrainEnabled=t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=t.cullAboveGround,this.techniqueConfig}intersect(e,t,r,a,s,i,n){u(e,t,a,s,i,void 0,n)}requiresSlot(t,r){if(20===t)return!0;if(4===e(r))return 2===t;return t===(this.parameters.transparent?this.parameters.writeDepth?4:7:2)}createGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new p(e):void 0}createBufferWriter(){return new i(n)}}class p extends t{constructor(e){super({...e,...e.material.parameters})}updateParameters(e){const t=this._material.parameters;return this.updateTexture(t.textureId),this.ensureTechnique(l,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.sceneHasOcludees&&(this._material.setParameters({sceneHasOcludees:e.hasOccludees}),this.updateParameters(e))}beginSlot(e){return 0!==this._output&&7!==this._output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e,t){this.bindTextures(t.program),this.bindTextureScale(t.program),t.bindPass(this._material.parameters,e)}}const o={transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,opacity:1,textureId:null,initTextureTransparent:!0,...a};export{h as ImageMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{HandleOwnerMixin as s}from\"../../core/HandleOwner.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";const a={visible:\"visibleSublayers\"};let l=class extends(s(r)){constructor(e){super(e),this.scale=0}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.sublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"wms-sublayer-update\",(e=>this.notifyChange(a[e.propertyName])))],\"layer\"))}get layers(){const{visibleSublayers:e}=this;return e.filter((e=>e.name)).map((e=>e.name)).join(\",\")}get version(){this.commitProperty(\"layers\");const e=this.layer;return e&&e.commitProperty(\"imageTransparency\"),(this._get(\"version\")||0)+1}get visibleSublayers(){const{layer:e,scale:r}=this,s=null==e?void 0:e.sublayers,t=[],o=e=>{const{minScale:s,maxScale:a,sublayers:l,visible:i}=e;i&&(0===r||(0===s||r<=s)&&(0===a||r>=a))&&(l?l.forEach(o):t.unshift(e))};return null==s||s.forEach(o),t}toJSON(){const{layer:e,layers:r}=this,{imageFormat:s,imageTransparency:t,version:o}=e;return{format:s,request:\"GetMap\",service:\"WMS\",styles:\"\",transparent:t,version:o,layers:r}}};e([t()],l.prototype,\"layer\",null),e([t({readOnly:!0})],l.prototype,\"layers\",null),e([t({type:Number})],l.prototype,\"scale\",void 0),e([t({readOnly:!0})],l.prototype,\"version\",null),e([t({readOnly:!0})],l.prototype,\"visibleSublayers\",null),l=e([o(\"esri.layers.support.ExportWMSImageParameters\")],l);export{l as ExportWMSImageParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as r}from\"../../../../core/maybe.js\";import{project as o}from\"../../../../geometry/support/webMercatorUtils.js\";import{projectGeometry as t}from\"../../../../portal/support/geometryServiceUtils.js\";function l(l){const s=l.view.spatialReference,i=l.layer.fullExtent,n=e(i)&&i.spatialReference;if(r(i)||!n)return Promise.resolve(null);if(n.equals(s))return Promise.resolve(i.clone());const a=o(i,s);return e(a)?Promise.resolve(a):l.view.state.isLocal?t(i,s,l.layer.portalItem).then((e=>!l.destroyed&&e?e:void 0)).catch((()=>null)):Promise.resolve(null)}export{l as toViewIfLocal};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{Slice as e}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ReadLinearDepth as a}from\"../views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js\";import{multipassTerrainTest as o}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{defaultMaskAlphaCutoff as i}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaDiscard.glsl.js\";import{ColorConversion as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{glsl as t}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as l}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";function s(s){const n=new l;return n.include(r,{linearDepth:!1}),n.vertex.uniforms.add(\"proj\",\"mat4\").add(\"view\",\"mat4\"),n.attributes.add(\"position\",\"vec3\"),n.attributes.add(\"uv0\",\"vec2\"),n.varyings.add(\"vpos\",\"vec3\"),s.multipassTerrainEnabled&&n.varyings.add(\"depth\",\"float\"),n.vertex.uniforms.add(\"textureCoordinateScaleFactor\",\"vec2\"),n.vertex.code.add(t`\n    void main(void) {\n      vpos = position;\n      ${s.multipassTerrainEnabled?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  `),n.include(e,s),s.multipassTerrainEnabled&&(n.fragment.include(a),n.include(o,s)),n.fragment.uniforms.add(\"tex\",\"sampler2D\"),n.fragment.uniforms.add(\"opacity\",\"float\"),n.varyings.add(\"vTexCoord\",\"vec2\"),7===s.output?n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    `):(n.fragment.include(d),n.fragment.code.add(t`\n    void main() {\n      discardBySlice(vpos);\n      ${s.multipassTerrainEnabled?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ${t.float(i)}) {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ${s.OITEnabled?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n    }\n    `)),n}const n=Object.freeze({__proto__:null,build:s});export{n as I,s as b};\n"],"sourceRoot":""}
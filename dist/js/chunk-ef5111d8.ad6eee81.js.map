{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/views/layers/TileLayerView.js","webpack:///./node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","webpack:///./node_modules/@arcgis/core/views/layers/RefreshableLayerView.js","webpack:///./node_modules/@arcgis/core/views/3d/layers/TileLayerView3D.js","webpack:///./node_modules/@arcgis/core/views/support/drapedUtils.js"],"names":["i","c","e","s","layer","a","this","Promise","reject","type","get","allSublayers","toArray","filter","r","minScale","t","maxScale","popupTemplate","popupEnabled","visible","map","async","o","createQuery","event","renderer","geometry","createFetchPopupFeaturesQueryGeometry","outFields","getRequiredFields","queryFeatures","features","then","concat","value","Boolean","prototype","xoffset","Math","max","abs","yoffset","n","length","size","stops","maxSize","minSize","f","floor","pointerType","visualVariables","symbol","uniqueValueInfos","forEach","classBreakInfos","handles","add","doRefresh","dataChanged","catch","getLogger","declaredClass","error","super","arguments","tileInfo","format","lods","scale","levelRangeFromScaleRange","minLevel","maxLevel","originOf","fullExtent","addResolvingPromise","_addTilingSchemeMatchPromise","view","suspended","emit","readOnly","aliasOf","y","resolution","overlayPixelSizeInMapUnits","basemapSpatialReference","equals","spatialReference","m","x","p","l","xmin","min","ymin","xmax","ymax"],"mappings":"kHAAA,0JAIghB,MAAMA,EAAEA,IAAI,IAAIC,EAAE,cAAcD,EAAE,yBAAyBE,EAAEC,GAAG,MAAMC,MAAMC,GAAGC,KAAK,IAAIJ,EAAE,OAAOK,QAAQC,OAAO,IAAI,OAAE,mCAAmC,gCAAgC,CAACJ,MAAMC,KAAK,GAAG,SAASA,EAAEI,KAAK,OAAOF,QAAQC,OAAO,IAAI,OAAE,mCAAmC,8BAA8B,CAACC,KAAKJ,EAAEI,QAAQ,MAAMT,EAAEM,KAAKI,IAAI,cAAcT,EAAEI,EAAEM,aAAaC,UAAUC,OAAQX,IAAI,MAAMY,EAAE,IAAIZ,EAAEa,UAAUf,GAAGE,EAAEa,SAASC,EAAE,IAAId,EAAEe,UAAUjB,GAAGE,EAAEe,SAAS,OAAOf,EAAEgB,eAAehB,EAAEiB,cAAcjB,EAAEkB,SAASN,GAAGE,IAAK,OAAO,eAAEf,EAAEoB,IAAI,MAACC,IAAU,MAAMC,EAAET,EAAEU,cAAcnB,EAAE,eAAEF,GAAGA,EAAEsB,MAAM,KAAKzB,EAAE,eAAE,CAAC0B,SAASZ,EAAEY,SAASD,MAAMpB,IAAqH,OAAjHkB,EAAEI,SAASrB,KAAKsB,sCAAsC1B,EAAEF,GAAGuB,EAAEM,gBAAgBf,EAAEI,cAAcY,2BAAiChB,EAAEiB,cAAcR,IAAIS,YAAaC,KAAM/B,GAAG,GAAGgC,UAAUhC,EAAEmB,IAAKnB,GAAGA,EAAEiC,OAAQtB,OAAOuB,aAAc,OAAO,eAAE,CAAC,kBAAKnC,EAAEoC,UAAU,aAAQ,GAAQpC,EAAE,eAAE,CAAC,eAAE,qCAAqCA,GAAGA,I,oCCA77C,SAASe,EAAEA,EAAEd,GAAG,OAAOA,EAAE,YAAYA,GAAGA,EAAEoC,QAAQC,KAAKC,IAAIxB,EAAEuB,KAAKE,IAAIvC,EAAEoC,UAAU,YAAYpC,GAAGA,EAAEwC,QAAQH,KAAKC,IAAIxB,EAAEuB,KAAKE,IAAIvC,EAAEwC,SAAS,IAAI1B,EAAEA,EAAE,SAASd,EAAEc,GAAG,IAAId,EAAE,EAAEyC,EAAE,EAAE,IAAI,IAAI7B,EAAE,EAAEA,EAAEE,EAAE4B,OAAO9B,IAAI,CAAC,MAAMX,EAAEa,EAAEF,GAAG+B,KAAK,iBAAiB1C,IAAID,GAAGC,EAAEwC,KAAK,OAAOzC,EAAEyC,EAAE,SAASA,EAAE3B,EAAE2B,GAAG,MAAM,iBAAiB3B,EAAEA,EAAEA,GAAGA,EAAE8B,OAAO9B,EAAE8B,MAAMF,OAAO1C,EAAEc,EAAE8B,OAAOH,EAAE,SAAS7B,EAAEE,EAAEd,GAAG,IAAIA,EAAE,OAAOc,EAAE,MAAMF,EAAEZ,EAAEW,OAAQG,GAAG,SAASA,EAAEP,MAAOY,IAAKnB,IAAI,MAAM6C,QAAQjC,EAAEkC,QAAQ7C,GAAGD,EAAE,OAAOyC,EAAE7B,EAAEE,GAAG2B,EAAExC,EAAEa,IAAI,IAAK,IAAIb,EAAE,EAAE,MAAMoB,EAAET,EAAE8B,OAAO,GAAG,IAAIrB,EAAE,OAAOP,EAAE,IAAI,IAAI2B,EAAE,EAAEA,EAAEpB,EAAEoB,IAAIxC,GAAGW,EAAE6B,GAAG,MAAMM,EAAEV,KAAKW,MAAM/C,EAAEoB,GAAG,OAAOgB,KAAKC,IAAIS,EAAEjC,GAAG,SAASb,EAAED,GAAG,MAAMyC,EAAEzC,GAAGA,EAAEwB,SAASvB,EAAE,WAAWD,GAAGA,EAAEuB,OAAOvB,EAAEuB,MAAM0B,aAAa,EAAE,EAAE,IAAIR,EAAE,OAAOxC,EAAE,MAAMoB,EAAE,oBAAoBoB,EAAE7B,EAAEX,EAAEwC,EAAES,iBAAiBjD,EAAE,GAAG,WAAWwC,EAAElC,KAAK,OAAOO,EAAEO,EAAEoB,EAAEU,QAAQ,GAAG,iBAAiBV,EAAElC,KAAK,CAAC,IAAIP,EAAEqB,EAAE,OAAOoB,EAAEW,iBAAiBC,QAASZ,IAAIzC,EAAEc,EAAEd,EAAEyC,EAAEU,UAAWnD,EAAE,GAAG,iBAAiByC,EAAElC,KAAK,CAAC,IAAIP,EAAEqB,EAAE,OAAOoB,EAAEa,gBAAgBD,QAASZ,IAAIzC,EAAEc,EAAEd,EAAEyC,EAAEU,UAAWnD,EAAE,OAAOyC,EAAElC,KAAKc,EAJr+B,mC,oCCAA,8IAIgc,MAAMvB,EAAEA,IAAI,IAAIC,EAAE,cAAcD,EAAE,aAAaM,KAAKmD,QAAQC,IAAI,eAAEpD,KAAK,QAAQ,UAAWQ,IAAIR,KAAKqD,UAAU7C,EAAE8C,aAAaC,MAAO/C,IAAI,eAAEA,IAAI,OAAEgD,UAAUxD,KAAKyD,eAAeC,MAAMlD,OAAS,0BAA0B,OAAO,eAAE,CAAC,kBAAKb,EAAEoC,UAAU,aAAQ,GAAQpC,EAAE,eAAE,CAAC,eAAE,4CAA4CA,GAAGA,I,kCCJvvB,mOAIo0B,IAAIA,EAAE,cAAc,cAAD,CAAG,eAAE,eAAE,eAAE,YAAO,cAAcgE,SAASC,WAAW5D,KAAKG,KAAK,UAAU,0BAA0B,MAAM,QAAQH,KAAKF,MAAM+D,SAASC,OAAO,2BAA2B,MAAM,UAAU9D,KAAKF,MAAM+D,SAASC,OAAO,qBAAqB,GAAG9D,KAAK6D,SAAS,CAAC,MAAMjE,EAAEI,KAAK6D,SAASE,KAAKvD,EAAEZ,EAAE,GAAGoE,MAAMtD,EAAEd,EAAEA,EAAE0C,OAAO,GAAG0B,MAAM,OAAOhE,KAAKiE,yBAAyBzD,EAAEE,GAAG,MAAM,CAACwD,SAAS,EAAEC,SAAS,GAAG,aAAa,GAAG,aAAanE,KAAKF,MAAMK,KAAK,CAAC,MAAMP,EAAEI,KAAKF,MAAMM,IAAI,+BAA+BV,EAAEM,KAAKF,MAAMM,IAAI,6BAA6B,GAAG,eAAER,IAAI,eAAEF,KAAK,eAAEE,EAAEF,GAAG,CAAC,MAAME,EAAE,aAAaI,KAAKF,MAAMsE,SAAS,eAAe,eAAEpE,KAAKF,MAAMuE,YAAY,4EAA4E,0GAA0GrE,KAAKsE,oBAAoBrE,QAAQC,OAAO,IAAI,OAAE,oCAAoCN,MAAMI,KAAKuE,+BAA+B,sCAAsC3E,EAAEY,GAAG,OAAO,eAAEZ,EAAEY,EAAER,KAAKwE,MAAM,kBAAkBxE,KAAKyE,WAAWzE,KAAK0E,KAAK,kBAAkB,eAAE,CAAC,eAAE,CAACC,UAAS,KAAMhF,EAAEoC,UAAU,sBAAsB,MAAM,eAAE,CAAC,eAAE,CAAC4C,UAAS,KAAMhF,EAAEoC,UAAU,uBAAuB,MAAM,eAAE,CAAC,eAAE,CAAC6C,QAAQ,sBAAsBjF,EAAEoC,UAAU,kBAAa,GAAQ,eAAE,CAAC,kBAAKpC,EAAEoC,UAAU,aAAQ,GAAQ,eAAE,CAAC,eAAE,CAAC6C,QAAQ,oBAAoBjF,EAAEoC,UAAU,gBAAW,GAAQ,eAAE,CAAC,eAAE,CAAC4C,UAAS,KAAMhF,EAAEoC,UAAU,iBAAiB,MAAMpC,EAAE,eAAE,CAAC,eAAE,yCAAyCA,GAAG,MAAMkF,EAAElF,G,kCCJzxE,gGAI+Q,SAASI,EAAEW,EAAE2B,EAAEtC,EAAEkB,EAAE,IAAI,QAAG,IAAIpB,EAAE,GAAG,OAAOE,EAAEI,KAAKN,EAAEwC,EAAEtC,EAAE+E,gBAAgB,GAAG,OAAO/E,EAAEI,KAAK,CAAC,MAAMT,EAAEK,EAAEgF,2BAA2BrE,GAAGO,EAAElB,EAAEiF,wBAAwBnF,EAAE,eAAEoB,KAAKA,EAAEgE,OAAOlF,EAAEmF,kBAAkB,eAAEjE,GAAG,eAAElB,EAAEmF,kBAAkB7C,EAAE3C,EAAE,MAAMyF,EAAEzE,EAAE0E,EAAEvF,EAAEwF,EAAE3E,EAAEmE,EAAEhF,EAAEF,EAAEe,EAAE0E,EAAEvF,EAAEyF,EAAE5E,EAAEmE,EAAEhF,GAAGqF,iBAAiBvC,GAAG5C,EAAE,OAAOkB,EAAEsE,KAAKtD,KAAKuD,IAAIL,EAAExF,GAAGsB,EAAEwE,KAAKxD,KAAKuD,IAAIH,EAAEC,GAAGrE,EAAEyE,KAAKzD,KAAKC,IAAIiD,EAAExF,GAAGsB,EAAE0E,KAAK1D,KAAKC,IAAImD,EAAEC,GAAGrE,EAAEiE,iBAAiBvC,EAAE1B,EAAkG,IAAI","file":"js/chunk-ef5111d8.ad6eee81.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{isSome as t}from\"../../core/maybe.js\";import{eachAlways as o}from\"../../core/promiseUtils.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{calculateTolerance as p}from\"../../renderers/support/clickToleranceUtils.js\";const i=i=>{let c=class extends i{async fetchPopupFeatures(e,s){const{layer:a}=this;if(!e)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:a}));if(\"tile\"!==a.type)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Layer type should be 'tile'\",{type:a.type}));const i=this.get(\"view.scale\"),c=a.allSublayers.toArray().filter((e=>{const r=0===e.minScale||i<=e.minScale,t=0===e.maxScale||i>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&r&&t}));return o(c.map((async r=>{const o=r.createQuery(),a=t(s)?s.event:null,i=p({renderer:r.renderer,event:a});o.geometry=this.createFetchPopupFeaturesQueryGeometry(e,i),o.outFields=await r.popupTemplate.getRequiredFields();return(await r.queryFeatures(o)).features}))).then((e=>[].concat(...e.map((e=>e.value)).filter(Boolean))))}};return e([s()],c.prototype,\"layer\",void 0),c=e([a(\"esri.layers.mixins.TileLayerView\")],c),c};export{i as TileLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}function n(t,n){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>\"size\"===t.type)).map((e=>{const{maxSize:r,minSize:s}=e;return(n(r,t)+n(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let n=0;n<o;n++)s+=r[n];const f=Math.floor(s/o);return Math.max(f,t)}function s(e){const n=e&&e.renderer,s=\"touch\"===(e&&e.event&&e.event.pointerType)?9:6;if(!n)return s;const o=\"visualVariables\"in n?r(s,n.visualVariables):s;if(\"simple\"===n.type)return t(o,n.symbol);if(\"unique-value\"===n.type){let e=o;return n.uniqueValueInfos.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===n.type){let e=o;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return n.type,o}export{s as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/watchUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const i=i=>{let c=class extends i{initialize(){this.handles.add(o(this,\"layer\",\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([a(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{i as RefreshableLayerView,i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Error.js\";import{isNone as t}from\"../../../core/maybe.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{canProjectWithoutEngine as s}from\"../../../geometry/projection.js\";import{LayerView3D as a}from\"./LayerView3D.js\";import{TiledLayerView3D as l}from\"./TiledLayerView3D.js\";import n from\"../../layers/LayerView.js\";import{RefreshableLayerView as p}from\"../../layers/RefreshableLayerView.js\";import{TileLayerView as m}from\"../../layers/TileLayerView.js\";import{createQueryGeometry as f}from\"../../support/drapedUtils.js\";let c=class extends(p(l(m(a(n))))){constructor(){super(...arguments),this.type=\"tile-3d\"}get imageFormatIsOpaque(){return\"jpg\"===this.layer.tileInfo.format}get hasMixedImageFormats(){return\"mixed\"===this.layer.tileInfo.format}get dataLevelRange(){if(this.tileInfo){const e=this.tileInfo.lods,r=e[0].scale,t=e[e.length-1].scale;return this.levelRangeFromScaleRange(r,t)}return{minLevel:0,maxLevel:0}}initialize(){if(\"web-tile\"===this.layer.type){const e=this.layer.get(\"fullExtent.spatialReference\"),i=this.layer.get(\"tileInfo.spatialReference\");if(t(e)||t(i)||!s(e,i)){const e=\"defaults\"===this.layer.originOf(\"fullExtent\")||t(this.layer.fullExtent)?\"SceneView requires fullExtent to be specified by the user on WebTileLayer\":\"SceneView requires fullExtent to be specified in the same spatial reference as tileInfo on WebTileLayer\";this.addResolvingPromise(Promise.reject(new r(\"layerview:incompatible-fullextent\",e)))}}this._addTilingSchemeMatchPromise()}createFetchPopupFeaturesQueryGeometry(e,r){return f(e,r,this.view)}async doRefresh(){this.suspended||this.emit(\"data-changed\")}};e([i({readOnly:!0})],c.prototype,\"imageFormatIsOpaque\",null),e([i({readOnly:!0})],c.prototype,\"hasMixedImageFormats\",null),e([i({aliasOf:\"layer.fullExtent\"})],c.prototype,\"fullExtent\",void 0),e([i()],c.prototype,\"layer\",void 0),e([i({aliasOf:\"layer.tileInfo\"})],c.prototype,\"tileInfo\",void 0),e([i({readOnly:!0})],c.prototype,\"dataLevelRange\",null),c=e([o(\"esri.views.3d.layers.TileLayerView3D\")],c);const y=c;export{y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.22/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{isSome as e,isNone as t}from\"../../core/maybe.js\";import{getMetersPerUnitForSR as r}from\"../../core/unitUtils.js\";import{calculateTolerance as n}from\"../../renderers/support/clickToleranceUtils.js\";import i from\"../../geometry/Extent.js\";function a(t,n,a,o=new i){let s;if(\"2d\"===a.type)s=n*a.resolution;else if(\"3d\"===a.type){const i=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?r(o)/r(a.spatialReference):n*i}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,i){const o=i.toMap(e);if(t(o))return!1;return a(o,n(),i,s).intersects(r)}const s=new i;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n"],"sourceRoot":""}
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54645729"],{"19db":function(e,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return y})),i.d(t,"c",(function(){return k})),i.d(t,"d",(function(){return T})),i.d(t,"e",(function(){return u})),i.d(t,"f",(function(){return C})),i.d(t,"g",(function(){return b})),i.d(t,"h",(function(){return h})),i.d(t,"i",(function(){return f}));var r=i("fa8a"),s=i("b2b2"),n=i("3e27"),a=i("9dee");const o=new Map;o.set("meter-per-second",1),o.set("kilometer-per-hour",.277778),o.set("knots",.514444),o.set("feet-per-second",.3048),o.set("mile-per-hour",.44704);const l=180/Math.PI,c=5,h=new r["a"]({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function u(e,t){return o.get(e)/o.get(t)||1}function d(e){return(450-e)%360}function f(e,t="geographic"){const[i,r]=e,s=Math.sqrt(i*i+r*r);let n=Math.atan2(r,i)*l;return n=(360+n)%360,"geographic"===t&&(n=d(n)),[s,n]}function p(e,t="geographic"){let i=e[1];"geographic"===t&&(i=d(i)),i%=360;const r=e[0];return[r*Math.cos(i/l),r*Math.sin(i/l)]}function m(e,t,i="geographic",r=1){if(!Object(a["i"])(e))return e;const{pixels:s,width:o,height:l}=e,c=o*l,h=s[0],u=s[1],d=n["a"].createEmptyBand(e.pixelType,c),m=n["a"].createEmptyBand(e.pixelType,c);let y=0;for(let n=0;n<l;n++)for(let e=0;e<o;e++)"vector-uv"===t?([d[y],m[y]]=f([h[y],u[y]],i),d[y]*=r):([d[y],m[y]]=p([h[y],u[y]],i),d[y]*=r,m[y]*=r),y++;const b=new n["a"]({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[d,m]});return b.updateStatistics(),b}function y(e,t,i=1){if(1===i||!Object(a["i"])(e))return e;const r=e.clone(),{pixels:s,width:n,height:o}=r,l=s[0],c=s[1];let h=0;for(let a=0;a<o;a++)for(let e=0;e<n;e++)"vector-uv"===t?(l[h]*=i,c[h]*=i):l[h]*=i,h++;return r.updateStatistics(),r}function b(e,t,i,r,n){if(!Object(s["l"])(n)||!n.spatialReference.equals(e.spatialReference))return{extent:e,width:t,height:i,resolution:e.width/t};const a=n.xmin,o=n.ymax;r=Math.max(r||0,30);const l=Math.ceil(t*(1/r)),c=Math.ceil(i*(1/r)),h=((e.xmax-e.xmin)/l+(e.ymax-e.ymin)/c)/2;return e.xmin=a+Math.floor((e.xmin-a)/h)*h,e.xmax=a+Math.ceil((e.xmax-a)/h)*h,e.ymin=o+Math.floor((e.ymin-o)/h)*h,e.ymax=o+Math.ceil((e.ymax-o)/h)*h,{extent:e,width:Math.round(e.width/h),height:Math.round(e.height/h),resolution:h}}const g=x(0,0,0);function x(e=0,t=0,i=Math.PI,r=!0){r&&(i=(2*Math.PI-i)%(2*Math.PI));const s=r?-1:1,n=13*s,a=-7*s,o=-2*s,l=-16*s,c=29,[h,u]=_(0,t+n,i,c),[d,f]=_(e-5.5,t+a,i,c),[p,m]=_(e+5.5,t+a,i,c),[y,b]=_(e-1.5,t+o,i,c),[g,x]=_(e+1.5,t+o,i,c),[w,v]=_(e-1.5,t+l,i,c),[O,j]=_(e+1.5,t+l,i,c);return[h,u,d,f,y,b,g,x,p,m,w,v,O,j]}function w(e=0,t=Math.PI,i=!0){i&&(t=(2*Math.PI-t)%(2*Math.PI));const r=10,s=i?-1:1,n=5*s,a=20*s,o=25*s,l=45,h=0,u=0,d=2,f=0,p=d*s;let[m,y]=[h+r/2,u-a],[b,g]=[m+d,y],[x,w]=[b-f,g+p],[v,O]=[h-r/2,u-o],[j,P]=[v+f,O-p],R=Math.ceil(e/c),S=Math.floor(R/10);R-=8*S;const M=[],I=[];for(let c=0;c<R/2;c++,S--){S<=0&&R%2==1&&c===(R-1)/2&&(v=h,j=v+f,O=(O+y)/2,P=O-p);const[e,i]=_(v,O,t,l);if(S>0){const[r,s]=_(b,O,t,l),[n,a]=_(m,y,t,l);M.push(r),M.push(s),M.push(e),M.push(i),M.push(n),M.push(a)}else{const[r,s]=_(b,g,t,l),[n,a]=_(x,w,t,l),[o,c]=_(j,P,t,l);I.push(e),I.push(i),I.push(o),I.push(c),I.push(n),I.push(a),I.push(r),I.push(s)}O+=n,y+=n,g+=n,w+=n,P+=n}const[T,k]=_(h+r/2,u+a,t,l),C=r/2+d,[V,D]=_(h+C,u+a,t,l),[z,L]=_(h+r/2,u-o,t,l),[F,A]=_(h+C,u-o,t,l);return{pennants:M,barbs:I,shaft:[T,k,V,D,z,L,F,A]}}function _(e,t,i,r=1){const s=Math.sqrt(e*e+t*t)/r,n=(2*Math.PI+Math.atan2(t,e))%(2*Math.PI);return[s,(2*Math.PI+n-i)%(2*Math.PI)]}const v=[0,1,3,6,10,16,21,27,33,40,47,55,63],O=[0,.5,1,1.5,2],j=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function P(e,t,i,r){const s=u(r||"knots",i);let n;for(n=1;n<t.length;n++)if(n===t.length-1){if(e<t[n]*s)break}else if(e<=t[n]*s)break;return Math.min(n-1,t.length-2)}function R(e,t,i,r,s){let n=0;switch(t){case"beaufort_kn":n=P(e,v,"knots",i);break;case"beaufort_km":n=P(e,v,"kilometer-per-hour",i);break;case"beaufort_ft":n=P(e,v,"feet-per-second",i);break;case"beaufort_m":n=P(e,v,"meter-per-second",i);break;case"classified_arrow":n=P(e,s,r,i);break;case"ocean_current_m":n=P(e,O,"meter-per-second",i);break;case"ocean_current_kn":n=P(e,j,"knots",i)}return n}function S(e,t){const{style:i,inputUnit:r,outputUnit:s,breakValues:n}=t,a=h.fromJSON(r),o=h.fromJSON(s),l=42,c=15;let u=0,d=0;const{width:f,height:p,mask:m}=e,y=e.pixels[0],b=e.pixels[1],x=m?m.filter(e=>e>0).length:f*p,w=new Float32Array(x*l),_=new Uint32Array(c*x);for(let h=0;h<p;h++)for(let e=0;e<f;e++){const t=h*f+e;if(!m||m[h*f+e]){var v;const r=null!=(v=(b[t]+360)%360/180*Math.PI)?v:2*Math.PI*Math.random(),s=R(y[t],i,a,o,n);for(let i=0;i<g.length;i+=2)w[u++]=(e+.5)/f,w[u++]=(h+.5)/p,w[u++]=g[i],w[u++]=g[i+1]+r,w[u++]=s,w[u++]=y[t];const c=7*(u/l-1);_[d++]=c,_[d++]=c+1,_[d++]=c+2,_[d++]=c+0,_[d++]=c+4,_[d++]=c+3,_[d++]=c+0,_[d++]=c+2,_[d++]=c+3,_[d++]=c+2,_[d++]=c+5,_[d++]=c+3,_[d++]=c+5,_[d++]=c+6,_[d++]=c+3}}return{vertexData:w,indexData:_}}const M=[];function I(e,t){if(0===M.length)for(let c=0;c<30;c++)M.push(w(5*c,0));const i=u(h.fromJSON(t.inputUnit),"knots"),{width:r,height:s,mask:n}=e,a=e.pixels[0],o=e.pixels[1],l=6,d=[],f=[];let p=0,m=0;for(let h=0;h<s;h++)for(let e=0;e<r;e++){const t=h*r+e,u=a[t]*i;if((!n||n[h*r+e])&&u>=c){var y;const i=null!=(y=(o[t]+360)%360/180*Math.PI)?y:2*Math.PI*Math.random(),{pennants:n,barbs:a,shaft:c}=M[Math.min(Math.floor(u/5),29)];if(n.length+a.length===0)continue;let b=d.length/l;const g=(e+.5)/r,x=(h+.5)/s;for(let e=0;e<n.length;e+=2)d[p++]=g,d[p++]=x,d[p++]=n[e],d[p++]=n[e+1]+i,d[p++]=0,d[p++]=u;for(let e=0;e<a.length;e+=2)d[p++]=g,d[p++]=x,d[p++]=a[e],d[p++]=a[e+1]+i,d[p++]=0,d[p++]=u;for(let e=0;e<c.length;e+=2)d[p++]=g,d[p++]=x,d[p++]=c[e],d[p++]=c[e+1]+i,d[p++]=0,d[p++]=u;for(let e=0;e<n.length/6;e++)f[m++]=b,f[m++]=b+1,f[m++]=b+2,b+=3;for(let e=0;e<a.length/8;e++)f[m++]=b,f[m++]=b+1,f[m++]=b+2,f[m++]=b+1,f[m++]=b+2,f[m++]=b+3,b+=4;f[m++]=b+0,f[m++]=b+1,f[m++]=b+2,f[m++]=b+1,f[m++]=b+3,f[m++]=b+2,b+=4}}return{vertexData:new Float32Array(d),indexData:new Uint32Array(f)}}function T(e,t){const i=24;let r=0,s=0;const{width:n,height:a,mask:o}=e,l=e.pixels[0],h=[],u=[],d="wind_speed"===t.style?c:Number.MAX_VALUE;for(let c=0;c<a;c++)for(let e=0;e<n;e++){const t=c*n+e;if((!o||o[c*n+e])&&l[t]<d){for(let i=0;i<4;i++)h[r++]=(e+.5)/n,h[r++]=(c+.5)/a,h[r++]=i<2?-.5:.5,h[r++]=i%2==0?-.5:.5,h[r++]=0,h[r++]=l[t];const o=4*(r/i-1);u[s++]=o,u[s++]=o+1,u[s++]=o+2,u[s++]=o+1,u[s++]=o+2,u[s++]=o+3}}return{vertexData:new Float32Array(h),indexData:new Uint32Array(u)}}function k(e,t){return"simple_scalar"===t.style?T(e,t):"wind_speed"===t.style?I(e,t):S(e,t)}function C(e,t,i,r=[0,0],s=.5){const{width:a,height:o,mask:l}=e,[c,h]=e.pixels,[u,d]=r,m=Math.round((a-u)/i),y=Math.round((o-d)/i),b=m*y,g=new Float32Array(b),x=new Float32Array(b),w=new Uint8Array(b),_="vector-uv"===t;for(let n=0;n<y;n++)for(let e=0;e<m;e++){let t=0;const r=n*m+e,y=Math.max(0,n*i+d),b=Math.max(0,e*i+u),v=Math.min(o,y+i),O=Math.min(a,b+i);for(let e=y;e<v;e++)for(let i=b;i<O;i++){const s=e*a+i;if(!l||l[s]){t++;const e=_?[c[s],h[s]]:[c[s],(360+h[s])%360],[i,n]=_?e:p(e);g[r]+=i,x[r]+=n}}if(t>=(v-y)*(O-b)*(1-s)){w[r]=1;const[e,i]=f([g[r]/t,x[r]/t]);g[r]=e,x[r]=i}else w[r]=0,g[r]=0,x[r]=0}const v=new n["a"]({width:m,height:y,pixels:[g,x],mask:w});return v.updateStatistics(),v}},"218c":function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return m})),i.d(t,"c",(function(){return f})),i.d(t,"d",(function(){return c})),i.d(t,"e",(function(){return p})),i.d(t,"f",(function(){return h})),i.d(t,"g",(function(){return u})),i.d(t,"h",(function(){return b}));i("e06a");var r=i("b2b2");class s{constructor(e=15e3,t=5e3){this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=e,this._interval=Math.min(e,t)}decreaseRefCount(e,t){const i=e+"/"+t,r=this._cachedBlocks;if(r.has(i)){const e=r.get(i);return e.refCount--,e.refCount<=0&&(r.delete(i),e.controller&&e.controller.abort()),e.refCount}return 0}getBlock(e,t){const i=e+"/"+t,r=this._cachedBlocks;if(r.has(i)){const e=r.get(i);return e.ts=Date.now(),e.refCount++,r.delete(i),r.set(i,e),e.block}return null}putBlock(e,t,i,r=null){const s=this._cachedBlocks,n=e+"/"+t;if(s.has(n)){const e=s.get(n);e.ts=Date.now(),e.refCount++}else s.set(n,{block:i,ts:Date.now(),refCount:1,controller:r});this.trim(),this.updateTimer()}deleteBlock(e,t){const i=this._cachedBlocks,r=e+"/"+t;i.has(r)&&i.delete(r)}updateMaxSize(e){this._size=e,this.trim()}empty(){this._cachedBlocks.clear(),this.clearTimer()}getCurrentSize(){return this._cachedBlocks.size}updateTimer(){if(null!=this._timer)return;const e=this._cachedBlocks;this._timer=setInterval(()=>{const t=Array.from(e),i=Date.now();for(let r=0;r<t.length&&t[r][1].ts<=i-this._duration;r++)e.delete(t[r][0]);0===e.size&&this.clearTimer()},this._interval)}trim(){const e=this._cachedBlocks;if(-1===this._size||this._size>=e.size)return;const t=Array.from(e);for(let i=0;i<t.length-this._size;i++)e.delete(t[i][0])}clearTimer(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}}var n=i("b4e0"),a=i("4ae5");const o=new Map,l=new s;function c(e,t){return null==t?e:`${e}?sliceId=${t}`}function h(e,t){const i={extent:null,rasterInfo:t,cache:new Map};if(o.has(e)){const t=o.get(e);return t.push(i),t.length-1}return o.set(e,[i]),0}function u(e,t){if(o.has(e)){const i=o.get(e);i[t]=null,i.some(e=>null!=e)||o.delete(e)}}function d(e,t,i){if(!o.has(e))return null==t?l.decreaseRefCount(e,i):0;const r=o.get(e);if(null==r[t])return l.decreaseRefCount(e,i);const s=r[t].cache;if(s.has(i)){const e=s.get(i);if(e.refCount--,0===e.refCount){s.delete(i);for(let e=0;e<r.length;e++)r[e]&&r[e].cache.has(i)&&r[e].cache.delete(i);e.controller&&e.controller.abort()}return e.refCount}return 0}function f(e,t,i){if(!o.has(e))return null==t?l.getBlock(e,i):null;const r=o.get(e);if(null==r[t]){for(let e=0;e<r.length;e++)if(r[e]&&r[e].cache.has(i)){const t=r[e].cache.get(i);return t.refCount++,t.block}return l.getBlock(e,i)}const s=r[t].cache;if(s.has(i)){const e=s.get(i);return e.refCount++,e.block}for(let n=0;n<r.length;n++)if(n!==t&&r[n]&&r[n]&&r[n].cache.has(i)){const e=r[n].cache.get(i);return e.refCount++,s.set(i,e),e.block}return null}function p(e,t,i,r,s=null){if(!o.has(e))return void(null==t&&l.putBlock(e,i,r,s));const n=o.get(e);if(null==n[t])return void l.putBlock(e,i,r,s);const a={refCount:1,block:r,isResolved:!1,isRejected:!1,controller:s};r.then(()=>a.isResolved=!0).catch(()=>a.isRejected=!0),n[t].cache.set(i,a)}function m(e,t,i){if(!o.has(e))return void(null==t&&l.deleteBlock(e,i));const r=o.get(e);null!=r[t]?r[t].cache.delete(i):l.deleteBlock(e,i)}function y(e,t){if(!o.has(e))return null;const i=o.get(e);return null==i[t]?null:i[t]}function b(e,t,i,s,o,l,c=null){const h=y(e,t),u=h.extent,{cache:d,rasterInfo:f}=h;if(u&&u.xmin===i.xmin&&u.xmax===i.xmax&&u.ymin===i.ymin&&u.ymax===i.ymax)return;const p=i.clone().normalize(),{spatialReference:m,transform:b}=f,g=new Set;for(let y=0;y<p.length;y++){const e=p[y];if(e.xmax-e.xmin<=s||e.ymax-e.ymin<=s)continue;let t=Object(n["h"])(e,m,c);Object(r["l"])(b)&&(t=b.inverseTransform(t));const i=new a["a"]({x:s,y:s,spatialReference:e.spatialReference});if(null==o&&!(o=Object(n["j"])(i,m,e,c)))return;const{pyramidLevel:h,pyramidResolution:u,excessiveReading:d}=Object(n["m"])(o,f,l||"closest");if(d)return;const{storageInfo:x}=f,{origin:w}=x,_={x:Math.max(0,Math.floor((t.xmin-w.x)/u.x)),y:Math.max(0,Math.floor((w.y-t.ymax)/u.y))},v=Math.ceil((t.xmax-t.xmin)/u.x-.1),O=Math.ceil((t.ymax-t.ymin)/u.y-.1),j=h>0?x.pyramidBlockWidth:x.blockWidth,P=h>0?x.pyramidBlockHeight:x.blockHeight,R=1,S=Math.max(0,Math.floor(_.x/j)-R),M=Math.max(0,Math.floor(_.y/P)-R),I=Math.floor((_.x+v-1)/j)+R,T=Math.floor((_.y+O-1)/P)+R;for(let r=M;r<=T;r++)for(let e=S;e<=I;e++)g.add(`${h}/${r}/${e}`)}d.forEach((e,t)=>{if(!g.has(t)){const e=d.get(t);(null==e||e.isResolved||e.isRejected)&&d.delete(t)}}),h.extent={xmin:i.xmin,ymin:i.ymin,xmax:i.xmax,ymax:i.ymax}}},2616:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return w}));i("e06a");var r=i("e92d"),s=i("38a4"),n=i("b2b2"),a=i("f4cc"),o=i("880d"),l=i("7f83"),c=i("3af1");const h=r["a"].getLogger("esri.views.2d.engine.flow.dataUtils"),u=8;async function d(e,t,i){const r=performance.now(),s=f(e,t),n=performance.now(),o=m(e,s,t.width,t.height),l=performance.now(),c=b(o,!0),u=performance.now(),d=g(c),p=performance.now();if(e.profile){const e={"_createFlowFieldFromData()":Math.round(n-r),"_getStreamlines()":Math.round(l-n),"createAnimatedLinesData()":Math.round(u-l),"createLinesMesh()":Math.round(p-u),"Total elapsed time":Math.round(p-r)};h.info("createStreamlinesMesh profile",e)}return await Promise.resolve(),Object(a["w"])(i),d}function f(e,t){const i=y(t.data,t.width,t.height,e.smoothing);return e.interpolate?(e,r)=>{const s=Math.floor(e),n=Math.floor(r);if(s<0||s>=t.width)return[0,0];if(n<0||n>=t.height)return[0,0];const a=e-s,o=r-n,l=s,c=n,h=s<t.width-1?s+1:s,u=n<t.height-1?n+1:n,d=i[2*(c*t.width+l)],f=i[2*(c*t.width+h)],p=i[2*(u*t.width+l)],m=i[2*(u*t.width+h)],y=i[2*(c*t.width+l)+1],b=i[2*(c*t.width+h)+1];return[(d*(1-o)+p*o)*(1-a)+(f*(1-o)+m*o)*a,(y*(1-o)+i[2*(u*t.width+l)+1]*o)*(1-a)+(b*(1-o)+i[2*(u*t.width+h)+1]*o)*a]}:(e,r)=>{const s=Math.round(e),n=Math.round(r);return s<0||s>=t.width||n<0||n>=t.height?[0,0]:[i[2*(n*t.width+s)+0],i[2*(n*t.width+s)+1]]}}function p(e,t,i,r,s,n,a,o,l){const c=[];let h,u,d=i,f=r,p=0;c.push({x:d,y:f,t:p});for(let m=0;m<e.verticesPerLine;m++){let[i,r]=t(d,f);i*=e.velocityScale,r*=e.velocityScale;const m=Math.sqrt(i*i+r*r);if(m<e.minSpeedThreshold)return c;const y=i/m,b=r/m;if(d+=y*e.segmentLength,f+=b*e.segmentLength,p+=e.segmentLength/m,Math.acos(y*h+b*u)>e.maxTurnAngle)return c;if(e.mergeLines){const e=Math.round(d*l),t=Math.round(f*l);if(e<0||e>a-1||t<0||t>o-1)return c;const i=n[t*a+e];if(-1!==i&&i!==s)return c;n[t*a+e]=s}c.push({x:d,y:f,t:p}),h=y,u=b}return c}function m(e,t,i,r){const s=[],n=new o["a"],a=1/Math.max(e.lineCollisionWidth,1),l=Math.round(i*a),c=Math.round(r*a),h=new Int32Array(l*c);for(let o=0;o<h.length;o++)h[o]=-1;const u=[];for(let o=0;o<r;o+=e.lineSpacing)for(let t=0;t<i;t+=e.lineSpacing)u.push({x:t,y:o,sort:n.getFloat()});u.sort((e,t)=>e.sort-t.sort);for(const{x:o,y:d}of u)if(n.getFloat()<e.density){const i=p(e,t,o,d,s.length,h,l,c,a);if(i.length<2)continue;s.push(i)}return s}function y(e,t,i,r){if(0===r)return e;const s=Math.round(3*r),n=new Array(2*s+1);let a=0;for(let c=-s;c<=s;c++){const e=Math.exp(-c*c/(r*r));n[c+s]=e,a+=e}for(let c=-s;c<=s;c++)n[c+s]/=a;const o=new Float32Array(e.length);for(let c=0;c<i;c++)for(let i=0;i<t;i++){let r=0,a=0;for(let o=-s;o<=s;o++){if(i+o<0||i+o>=t)continue;const l=n[o+s];r+=l*e[2*(c*t+(i+o))+0],a+=l*e[2*(c*t+(i+o))+1]}o[2*(c*t+i)+0]=r,o[2*(c*t+i)+1]=a}const l=new Float32Array(e.length);for(let c=0;c<t;c++)for(let e=0;e<i;e++){let r=0,a=0;for(let l=-s;l<=s;l++){if(e+l<0||e+l>=i)continue;const h=n[l+s];r+=h*o[2*((e+l)*t+c)+0],a+=h*o[2*((e+l)*t+c)+1]}l[2*(e*t+c)+0]=r,l[2*(e*t+c)+1]=a}return l}function b(e,t){const i=new o["a"],r=e.reduce((e,t)=>e+t.length,0),s=new Float32Array(3*r),n=new Array(e.length);let a=0,l=0;for(const o of e){const e=a;for(const t of o)s[3*a+0]=t.x,s[3*a+1]=t.y,s[3*a+2]=t.t,a++;n[l++]={startVertex:e,numberOfVertices:o.length,totalTime:o[o.length-1].t,timeSeed:t?i.getFloat():0}}return{lineVertices:s,lineDescriptors:n}}function g(e,t=10){const{lineVertices:i,lineDescriptors:r}=e;let s=0,n=0;for(const u of r)s+=2*u.numberOfVertices,n+=6*(u.numberOfVertices-1);const a=new Float32Array(s*u),o=new Uint32Array(n);let l=0,c=0;function h(){o[c++]=l-2,o[c++]=l,o[c++]=l-1,o[c++]=l,o[c++]=l+1,o[c++]=l-1}function d(e,t,i,r,s,n,o){const c=l*u;let h=0;a[c+h++]=e,a[c+h++]=t,a[c+h++]=1,a[c+h++]=i,a[c+h++]=n,a[c+h++]=o,a[c+h++]=r,a[c+h++]=s,l++,a[c+h++]=e,a[c+h++]=t,a[c+h++]=-1,a[c+h++]=i,a[c+h++]=n,a[c+h++]=o,a[c+h++]=-r,a[c+h++]=-s,l++}for(const u of r){const{totalTime:e,timeSeed:r}=u;let s=null,n=null,a=null,o=null,l=null;for(let c=0;c<u.numberOfVertices;c++){const f=i[3*(u.startVertex+c)+0],p=i[3*(u.startVertex+c)+1],m=i[3*(u.startVertex+c)+2];let y=null,b=null,g=null,x=null;if(c>0){y=f-s,b=p-n;const i=Math.sqrt(y*y+b*b);if(y/=i,b/=i,c>1){let e=y+o,i=b+l;const r=Math.sqrt(e*e+i*i);e/=r,i/=r;const s=Math.min(1/(e*y+i*b),t);e*=s,i*=s,g=-i,x=e}else g=-b,x=y;null!==g&&null!==x&&(d(s,n,a,g,x,e,r),h())}s=f,n=p,a=m,o=y,l=b}d(s,n,a,-l,o,e,r)}return{vertexData:a,indexData:o}}function x(e,t){const i=t.pixels,{width:r,height:n}=t,a=new Float32Array(r*n*2);if("vector-uv"===e)for(let s=0;s<r*n;s++)a[2*s+0]=i[0][s],a[2*s+1]=-i[1][s];else if("vector-magdir"===e)for(let o=0;o<r*n;o++){const e=i[0][o],t=Object(s["h"])(i[1][o]),r=Math.cos(t-Math.PI/2),n=Math.sin(t-Math.PI/2);a[2*o+0]=r*e,a[2*o+1]=n*e}return{data:a,width:r,height:n}}async function w(e,t,i,r,s){const n=Object(l["e"])(t.spatialReference);if(!n)return _(e,t,i,r,s);const[a,o]=n.valid,h=o-a,u=Math.ceil(t.width/h),d=t.width/u,f=Math.round(i/u);let p=t.xmin;const m=[];for(let l=0;l<u;l++){const i=new c["a"]({xmin:p,xmax:p+d,ymin:t.ymin,ymax:t.ymax,spatialReference:t.spatialReference});m.push(_(e,i,f,r,s)),p+=d}const y=await Promise.all(m),b={data:new Float32Array(i*r*2),width:i,height:r};let g=0;for(const l of y){for(let e=0;e<l.height;e++)for(let t=0;t<l.width;t++)g+t>=i||(b.data[2*(e*i+g+t)+0]=l.data[2*(e*l.width+t)+0],b.data[2*(e*i+g+t)+1]=l.data[2*(e*l.width+t)+1]);g+=l.width}return b}async function _(e,t,i,r,s){if("imagery"===e.type){await e.load({signal:s});const a=e.rasterInfo.dataType,o=await e.fetchImage(t,i,r,{signal:s});return!o||Object(n["k"])(o.pixelData)||Object(n["k"])(o.pixelData.pixelBlock)?{data:new Float32Array(i*r*2),width:i,height:r}:x(a,o.pixelData.pixelBlock)}await e.load({signal:s});const a=e.rasterInfo.dataType,o=await e.fetchPixels(t,i,r,{signal:s});return!o||Object(n["k"])(o.pixelBlock)?{data:new Float32Array(i*r*2),width:i,height:r}:x(a,o.pixelBlock)}},"45a5":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return n}));var r=i("fa8a");const s=new r["a"]({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function n(e){return s.toJSON(e)}function a(e){const{bandCount:t,attributeTable:i,colormap:r,pixelType:s}=e.rasterInfo;return 1===t&&(null!=i||null!=r||"u8"===s||"s8"===s)}},6722:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i("c120"),s=i("c84e"),n=i("9a02"),a=i("6f75"),o=i("ec5e");const l=(e,t)=>e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col;class c extends n["a"]{constructor(e){super(),this._tileInfoView=e}get requiresDedicatedFBO(){return!1}renderChildren(e){this.sortChildren(l),this.setStencilReference(),super.renderChildren(e)}createRenderParams(e){const{state:t}=e,i=super.createRenderParams(e);return i.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,i.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(t.scale),i}prepareRenderPasses(e){const t=super.prepareRenderPasses(e);return t.push(e.registerRenderPass({name:"stencil",brushes:[o["a"]],drawPhase:s["c"].DEBUG|s["c"].MAP|s["c"].HIGHLIGHT,target:()=>this.getStencilTarget()})),Object(r["a"])("esri-tiles-debug")&&t.push(e.registerRenderPass({name:"tileInfo",brushes:[a["a"]],drawPhase:s["c"].DEBUG,target:()=>this.children})),t}getStencilTarget(){return this.children}updateTransforms(e){for(const t of this.children){const i=this._tileInfoView.getTileResolution(t.key);t.setTransform(e,i)}}setStencilReference(){let e=1;for(const t of this.children)t.stencilRef=e++}}},"6c7a":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i("a4ee"),s=i("e92d"),n=i("f4cc"),a=i("3795"),o=i("59b2"),l=(i("b50f"),i("c120"),i("cea0"),i("d386"));const c=e=>{let t=class extends e{initialize(){this.handles.add(Object(a["b"])(this,"layer","refresh",e=>{this.doRefresh(e.dataChanged).catch(e=>{Object(n["m"])(e)||s["a"].getLogger(this.declaredClass).error(e)})}),"RefreshableLayerView")}};return Object(r["a"])([Object(o["b"])()],t.prototype,"layer",void 0),t=Object(r["a"])([Object(l["a"])("esri.layers.mixins.RefreshableLayerView")],t),t}},"72d8":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i("a4ee"),s=i("8d60"),n=i("ce50"),a=i("b2b2"),o=i("59b2"),l=(i("b50f"),i("c120"),i("cea0"),i("d386")),c=i("22f4"),h=i("b4e0"),u=i("ad73");const d=e=>{let t=class extends e{constructor(){super(...arguments),this._rasterFieldPrefix="Raster.",this.layer=null,this.view=null,this.fullExtent=null,this.tileInfo=null,this.datumTransformation=null}get hasTilingEffects(){return this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}async fetchPopupFeatures(e,t){const{layer:i}=this;if(!e)return Promise.reject(new n["a"]("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:i}));const{popupEnabled:r}=i,o=Object(u["a"])(i,t);if(!r||!Object(a["l"])(o))throw new n["a"]("imageryTileLayerView:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:r,popupTemplate:o});const l=[],{value:c,magdirValue:h}=await i.identify(e,{timeExtent:this.timeExtent});let d="";if(c&&c.length){var f,p;d="imagery-tile"===i.type&&i.hasStandardTime()&&null!=c[0]?c.map(e=>i.getStandardTimeValue(e)).join(", "):c.join(", ");const e={ObjectId:0},t="Raster.ServicePixelValue";e[t]=this._formatAttributeValue(d,t);const r=null==(f=i.rasterInfo)||null==(p=f.attributeTable)?void 0:p.features;if(r&&r.length>0){const t=r.filter(e=>{const t=e.attributes.value||e.attributes.Value||e.attributes.VALUE;return String(t)===d});if(t.length>0){const i=t[0];if(i)for(const t in i.attributes)if(i.attributes.hasOwnProperty(t)){const r=this._rasterFieldPrefix+t;e[r]=this._formatAttributeValue(i.attributes[t],r)}}}const n=i.rasterInfo.dataType;"vector-magdir"!==n&&"vector-uv"!==n||(e["Raster.Magnitude"]=null==h?void 0:h[0],e["Raster.Direction"]=null==h?void 0:h[1]);const a=new s["a"](this.fullExtent.clone(),null,e);a.layer=i,a.sourceLayer=a.layer,l.push(a)}return l}updateFullExtent(){const e=this.layer.tileInfo;if(!e||!e.spatialReference)return Promise.reject(new n["a"]("layerview:tiling-information-missing","The layer doesn't provide tiling information",{layer:this.layer}));if(Object(a["k"])(this.layer.fullExtent))return Promise.reject(new n["a"]("layerview:extent-missing","The layer doesn't provide a full extent.",{layer:this.layer}));const t=Object(h["b"])(this.layer.fullExtent,this.view.spatialReference,!1),i=Object(h["h"])(this.layer.fullExtent,this.view.spatialReference,t);return null==i?Promise.reject(new n["a"]("layerview:projection-not-supported","The layer extent cannot be projected to the view's spatial reference",{layer:this.layer})):(this._set("fullExtent",i),this.datumTransformation||(this.datumTransformation=Object(h["b"])(this.layer.fullExtent,this.view.spatialReference,!0)),Promise.resolve())}_formatAttributeValue(e,t){if("string"==typeof e){const i=this.layer.popupTemplate&&this.layer.popupTemplate.fieldInfos,r=this._getFieldInfo(i,t),s=r&&r.format;if(s){let t,i;return e.trim().indexOf(",")>-1?(t=",",i=t+" ",this._formatDelimitedString(e,t,i,s)):e.trim().indexOf(" ")>-1?(t=i=" ",this._formatDelimitedString(e,t,i,s)):this._formatNumberFromString(e,s)}}return e}_getFieldInfo(e,t){if(!e||!e.length||!t)return;const i=t.toLowerCase();let r;return e.some(e=>!(!e.fieldName||e.fieldName.toLowerCase()!==i&&e.fieldName.toLowerCase()!==i.replace(/ /g,"_"))&&(r=e,!0)),r}_formatDelimitedString(e,t,i,r){return e&&t&&i&&r?e.trim().split(t).map(e=>this._formatNumberFromString(e,r)).join(i):e}_formatNumberFromString(e,t){if(!e||!t)return e;const i=Number(e);return isNaN(i)?e:t.format(i)}};return Object(r["a"])([Object(o["b"])()],t.prototype,"layer",void 0),Object(r["a"])([Object(o["b"])(c["a"])],t.prototype,"timeExtent",void 0),Object(r["a"])([Object(o["b"])()],t.prototype,"view",void 0),Object(r["a"])([Object(o["b"])()],t.prototype,"fullExtent",void 0),Object(r["a"])([Object(o["b"])()],t.prototype,"tileInfo",void 0),Object(r["a"])([Object(o["b"])({readOnly:!0})],t.prototype,"hasTilingEffects",null),t=Object(r["a"])([Object(l["a"])("esri.views.layers.ImageryTileLayerView")],t),t}},"9a02":function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));i("c120");var r=i("b2b2"),s=i("8c71"),n=i("3b1a"),a=i("00c0"),o=i("ce50"),l=i("e92d"),c=i("7c4b"),h=i("9812"),u=i("3349"),d=i("02f1"),f=i("6655"),p=i("8152"),m=i("d114"),y=i("7ce4");const b=l["a"].getLogger("esri.views.2d.engine.webgl.Mesh2D"),g=e=>{switch(e.BYTES_PER_ELEMENT){case 1:return 5121;case 2:return 5123;case 4:return 5125;default:throw new o["a"]("Cannot get DataType of array")}},x=(e,t,i,r)=>{let s=0;for(let n=1;n<i;n++){const i=e[2*(t+n-1)],r=e[2*(t+n-1)+1];s+=(e[2*(t+n)]-i)*(e[2*(t+n)+1]+r)}return r?s>0:s<0},w=({coords:e,lengths:t},i)=>{const r=[];for(let s=0,n=0;s<t.length;n+=t[s],s+=1){const a=n,o=[];for(;s<t.length-1&&x(e,n+t[s],t[s+1],i);s+=1,n+=t[s])o.push(n+t[s]-a);const l=e.slice(2*a,2*(n+t[s])),c=Object(h["a"])(l,o,2);for(const e of c)r.push(e+a)}return r};class _{constructor(e,t,i,r=!1){this._cache={},this.vertices=e,this.indices=t,this.primitiveType=i,this.isMapSpace=r}static fromRect({x:e,y:t,width:i,height:r}){const s=e,n=t,a=s+i,o=n+r;return _.fromScreenExtent({xmin:s,ymin:n,xmax:a,ymax:o})}static fromPath(e){const t=Object(f["f"])(new p["a"],e.path,!1,!1),i=t.coords,r=new Uint32Array(w(t,!0)),s=new Uint32Array(i.length/2);for(let n=0;n<s.length;n++)s[n]=Object(m["a"])(Math.floor(i[2*n]),Math.floor(i[2*n+1]));return new _({geometry:s},r,4)}static fromGeometry(e,t){const i=t.geometry.type;switch(i){case"polygon":return _.fromPolygon(e,t.geometry);case"extent":return _.fromMapExtent(e,t.geometry);default:return b.error(new o["a"]("mapview-bad-type","Unable to create a mesh from type "+i,t)),_.fromRect({x:0,y:0,width:1,height:1})}}static fromPolygon(e,t){const i=Object(f["g"])(new p["a"],t,!1,!1),r=i.coords,s=new Uint32Array(w(i,!1)),n=new Uint32Array(r.length/2),a=Object(d["b"])(),o=Object(d["b"])();for(let l=0;l<n.length;l++)Object(u["s"])(a,r[2*l],r[2*l+1]),e.toScreen(o,a),n[l]=Object(m["a"])(Math.floor(o[0]),Math.floor(o[1]));return new _({geometry:n},s,4,!0)}static fromScreenExtent({xmin:e,xmax:t,ymin:i,ymax:r}){const s={geometry:new Uint32Array([Object(m["a"])(e,i),Object(m["a"])(t,i),Object(m["a"])(e,r),Object(m["a"])(e,r),Object(m["a"])(t,i),Object(m["a"])(t,r)])},n=new Uint32Array([0,1,2,3,4,5]);return new _(s,n,4)}static fromMapExtent(e,t){const[i,r]=e.toScreen([0,0],[t.xmin,t.ymin]),[s,n]=e.toScreen([0,0],[t.xmax,t.ymax]),a={geometry:new Uint32Array([Object(m["a"])(i,r),Object(m["a"])(s,r),Object(m["a"])(i,n),Object(m["a"])(i,n),Object(m["a"])(s,r),Object(m["a"])(s,n)])},o=new Uint32Array([0,1,2,3,4,5]);return new _(a,o,4)}destroy(){Object(r["l"])(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const e in this._cache.vertexBuffers)Object(r["l"])(this._cache.vertexBuffers[e])&&this._cache.vertexBuffers[e].dispose()}get elementType(){return g(this.indices)}getIndexBuffer(e,t=35044){return this._cache.indexBuffer||(this._cache.indexBuffer=y["a"].createIndex(e,t,this.indices)),this._cache.indexBuffer}getVertexBuffers(e,t=35044){return this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((i,r)=>({...i,[r]:y["a"].createVertex(e,t,this.vertices[r])}),{})),this._cache.vertexBuffers}}var v=i("0fa6");const O=l["a"].getLogger("esri.views.2d.engine.webgl.ClippingInfo"),j=e=>parseFloat(e)/100;class P extends c["a"]{constructor(e,t){super(),this._clip=t,this._cache={},this.stage=e,this._handle=t.watch("version",()=>this._invalidate()),this.ready()}static fromClipArea(e,t){return new P(e,t)}_destroyGL(){Object(r["l"])(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null),Object(r["l"])(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)}destroy(){this._destroyGL(),this._handle.remove()}getVAO(e,t,i,s){const[n,a]=t.size;if("geometry"!==this._clip.type&&this._lastWidth===n&&this._lastHeight===a||(this._lastWidth=n,this._lastHeight=a,this._destroyGL()),Object(r["k"])(this._cache.vao)){const r=this._createMesh(t,this._clip),n=r.getIndexBuffer(e),a=r.getVertexBuffers(e);this._cache.mesh=r,this._cache.vao=new v["a"](e,i,s,a,n)}return this._cache.vao}_createTransforms(){return{dvs:Object(s["b"])()}}_invalidate(){this._destroyGL(),this.requestRender()}_createScreenRect(e,t){const[i,r]=e.size,s="string"==typeof t.left?j(t.left)*i:t.left,n="string"==typeof t.right?j(t.right)*i:t.right,a="string"==typeof t.top?j(t.top)*r:t.top,o="string"==typeof t.bottom?j(t.bottom)*r:t.bottom,l=s,c=a;return{x:l,y:c,width:Math.max(i-n-l,0),height:Math.max(r-o-c,0)}}_createMesh(e,t){switch(t.type){case"rect":return _.fromRect(this._createScreenRect(e,t));case"path":return _.fromPath(t);case"geometry":return _.fromGeometry(e,t);default:return O.error(new o["a"]("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),_.fromRect({x:0,y:0,width:1,height:1})}}}var R=i("c84e");class S extends a["a"]{constructor(){super(...arguments),this.name=this.constructor.name}set clips(e){this._clips=e,this.children.forEach(t=>t.clips=e),this._updateClippingInfo()}_createTransforms(){return{dvs:Object(s["b"])()}}doRender(e){const t=this.createRenderParams(e),{painter:i,globalOpacity:r,profiler:s,drawPhase:n}=t,a=n===R["c"].LABEL||n===R["c"].HIGHLIGHT?1:r*this.computedOpacity;s.recordContainerStart(this.name),i.beforeRenderLayer(t,this._clippingInfos?255:0,a),this.updateTransforms(e.state),this.renderChildren(t),i.compositeLayer(t,a),s.recordContainerEnd()}renderChildren(e){Object(r["k"])(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(e.painter));for(const i of this.children)i.beforeRender(e);for(const i of this._renderPasses)try{i.render(e)}catch(t){}for(const i of this.children)i.afterRender(e)}createRenderParams(e){return e.requireFBO=this.requiresDedicatedFBO,e}prepareRenderPasses(e){return[e.registerRenderPass({name:"clip",brushes:[n["a"].clip],target:()=>this._clippingInfos,drawPhase:R["c"].MAP|R["c"].LABEL|R["c"].LABEL_ALPHA|R["c"].DEBUG|R["c"].HIGHLIGHT})]}updateTransforms(e){for(const t of this.children)t.setTransform(e)}onAttach(){super.onAttach(),this._updateClippingInfo()}onDetach(){super.onDetach(),this._updateClippingInfo()}_updateClippingInfo(){if(Object(r["l"])(this._clippingInfos)&&(this._clippingInfos.forEach(e=>e.destroy()),this._clippingInfos=null),!this.stage)return;const e=this._clips;Object(r["l"])(e)&&e.length&&(this._clippingInfos=e.items.map(e=>P.fromClipArea(this.stage,e))),this.requestRender()}}},ad73:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return n}));var r=i("b2b2"),s=i("c1da");async function n(e,t=e.popupTemplate){if(!Object(r["l"])(t))return[];const i=await t.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:n}=t,{objectIdField:a,typeIdField:o,globalIdField:l,relationships:c}=e;if(i.includes("*"))return["*"];const h=n?await Object(s["n"])(e):[],u=Object(s["j"])(e.fieldsIndex,[...i,...h]);return o&&u.push(o),u&&a&&e.fieldsIndex.has(a)&&-1===u.indexOf(a)&&u.push(a),u&&l&&e.fieldsIndex.has(l)&&-1===u.indexOf(l)&&u.push(l),c&&c.forEach(t=>{const{keyField:i}=t;u&&i&&e.fieldsIndex.has(i)&&-1===u.indexOf(i)&&u.push(i)}),u}function a(e,t){return e.popupTemplate?e.popupTemplate:Object(r["l"])(t)&&t.defaultPopupTemplateEnabled&&Object(r["l"])(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}},aebc:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return se}));var r=i("a4ee"),s=i("8d60"),n=i("e92d"),a=i("f4cc"),o=i("3795"),l=i("59b2"),c=(i("b50f"),i("c120"),i("cea0"),i("d386")),h=i("d23c"),u=i("566d"),d=i("b2b2"),f=i("9180"),p=i("a98b"),m=i("3b1a"),y=i("8c71"),b=i("37c9"),g=i("e4b1");class x extends g["a"]{constructor(e,t,i,r,s,n=null){super(e,t,i,r,s),this.bitmap=new b["a"](n,null,null),this.bitmap.coordScale=[r,s],this.bitmap.once("isReady",()=>this.ready())}destroy(){super.destroy(),this.bitmap.destroy(),this.bitmap=null,this.stage=null}set stencilRef(e){this.bitmap.stencilRef=e}get stencilRef(){return this.bitmap.stencilRef}setTransform(e,t){super.setTransform(e,t),this.bitmap.transforms.dvs=this.transforms.dvs}_createTransforms(){return{dvs:Object(y["b"])(),tileMat3:Object(y["b"])()}}onAttach(){this.bitmap.stage=this.stage}onDetach(){this.bitmap.stage=null}}var w=i("c84e"),_=i("6722");class v extends _["a"]{constructor(){super(...arguments),this.isCustomTilingScheme=!1}createTile(e){const t=this._getTileBounds(e),[i,r]=this._tileInfoView.tileInfo.size;return new x(e,t[0],t[3],i,r)}destroyTile(){}prepareRenderPasses(e){const t=e.registerRenderPass({name:"imagery (tile)",brushes:[m["a"].raster],target:()=>this.children.map(e=>e.bitmap),drawPhase:w["c"].MAP});return[...super.prepareRenderPasses(e),t]}doRender(e){this.visible&&e.drawPhase===w["c"].MAP&&super.doRender(e)}_getTileBounds(e){const t=this._tileInfoView.getTileBounds(Object(f["l"])(),e);if(this.isCustomTilingScheme&&e.world){const{tileInfo:i}=this._tileInfoView,r=Object(p["o"])(i.spatialReference);if(r){const{resolution:s}=i.lodAt(e.level),n=r/s%i.size[0],a=n?(i.size[0]-n)*s:0;t[0]-=a*e.world,t[2]-=a*e.world}}return t}}i("e06a");var O=i("9096"),j=i("4ae5"),P=i("3e27"),R=i("dff3"),S=i("218c"),M=i("9dee"),I=i("b4e0"),T=(i("3e7b"),i("018d")),k=(i("ae54"),i("07cd")),C=i("d302"),V=i("b2af"),D=i("3af1");const z=[0,0],L=n["a"].getLogger("esri.views.2d.layers.ImageryTileLayerView2D");let F=class extends O["a"]{constructor(){super(...arguments),this._emptyTilePixelBlock=null,this._tileStrategy=null,this._tileInfoView=null,this._fetchQueue=null,this._blockCacheRegistryUrl=null,this._blockCacheRegistryId=null,this._srcResolutions=null,this.previousLOD=null,this._needBlockCacheUpdate=!1,this._globalSymbolizerParams=null,this._symbolizerParams=null,this._abortController=null,this._isCustomTilingScheme=!1,this._globalUpdateRequested=!1,this.container=null,this.layer=null,this.redrawOrRefetch=Object(a["i"])((e,t)=>!this.previousLOD||this.layerView.suspended?Promise.resolve():e?this.doRefresh():this._redrawImage(t))}get useWebGLForProcessing(){var e;return null==(e=this._get("useWebGLForProcessing"))||e}set useWebGLForProcessing(e){this._set("useWebGLForProcessing",e)}get useProgressiveUpdate(){return null==this._get("useProgressiveUpdate")||this._get("useProgressiveUpdate")}set useProgressiveUpdate(e){if(this._tileStrategy&&this.useProgressiveUpdate!==e){this._tileStrategy.destroy(),this.container.removeAllChildren();const t=this._getCacheSize(e);this._tileStrategy=new C["a"]({cachePolicy:"purge",acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),cacheSize:t,tileInfoView:this._tileInfoView}),this._set("useProgressiveUpdate",e),this.layerView.requestUpdate()}}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume();const{extent:t,resolution:i,scale:r}=e.state,s=this._tileInfoView.getClosestInfoForScale(r);if(this.layer.raster){var n;if(!this.useProgressiveUpdate||this._needBlockCacheUpdate){const e=this._srcResolutions[s.level],r=t.toJSON?t:D["a"].fromJSON(t);Object(S["h"])(this._blockCacheRegistryUrl,this._blockCacheRegistryId,r,i,e,this.layer.raster.ioConfig.sampling)}this._needBlockCacheUpdate=!1,(null==(n=this.previousLOD)?void 0:n.level)!==s.level&&(this.previousLOD=s,null==this._symbolizerParams||this.layerView.hasTilingEffects||this._updateSymbolizerParams(),this._tileStrategy.updateCacheSize(0))}}moveEnd(){!this.layerView.hasTilingEffects&&this.useProgressiveUpdate||(this._abortController&&this._abortController.abort(),this._abortController=new AbortController,0===this._fetchQueue.length&&this._redrawImage(this._abortController.signal).then(()=>{this._globalUpdateRequested=!1,this.layerView.requestUpdate()}));const e=this._getCacheSize(this.useProgressiveUpdate);this._tileStrategy.updateCacheSize(e),this.layerView.requestUpdate()}get updating(){return this._fetchQueue.length>0||this._globalUpdateRequested||!(!this.updatingHandles||!this.updatingHandles.updating)}attach(){Object(V["a"])().supportsTextureFloat||(this.useWebGLForProcessing=!1),this._initializeTileInfo(),this._tileInfoView=new T["a"](this.layerView.tileInfo,this.layerView.fullExtent);const e=this._computeFetchConcurrency();this._fetchQueue=new k["a"]({tileInfoView:this._tileInfoView,concurrency:e,process:(e,t)=>this._fetchTile1(e,t)});const t=this._getCacheSize(this.useProgressiveUpdate);this._tileStrategy=new C["a"]({cachePolicy:"purge",acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),cacheSize:t,tileInfoView:this._tileInfoView}),this._updateBlockCacheRegistry()}acquireTile(e){const t=this.container.createTile(e);return this._enqueueTileFetch(t),this.layerView.requestUpdate(),this._needBlockCacheUpdate=!0,this._globalUpdateRequested=this.layerView.hasTilingEffects||!this.useProgressiveUpdate,t}releaseTile(e){this._fetchQueue.abort(e.key.id),this.container.removeChild(e),e.once("detach",()=>{e.destroy(),this.layerView.requestUpdate()}),this.layerView.requestUpdate()}uninstall(){this._tileStrategy.destroy(),this._fetchQueue.clear(),this.container.removeAllChildren(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null,this.notifyChange("updating"),Object(S["g"])(this._blockCacheRegistryUrl,this._blockCacheRegistryId)}createEmptyTilePixelBlock(e=null){const t=null==e||e.join(",")===this._tileInfoView.tileInfo.size.join(",");if(t&&Object(d["l"])(this._emptyTilePixelBlock))return this._emptyTilePixelBlock;e=e||this._tileInfoView.tileInfo.size;const[i,r]=e,s=new P["a"]({width:i,height:r,pixels:[new Uint8Array(i*r)],mask:new Uint8Array(i*r),pixelType:"u8"});return t&&(this._emptyTilePixelBlock=s),s}_fetchTile1(e,t){const i=!Object(d["k"])(t)&&t.signal,r=this.canUseWebGLForProcessing(),s={allowPartialFill:!0,datumTransformation:this.layerView.datumTransformation,interpolation:r?"nearest":this.layer.interpolation,registryId:this._blockCacheRegistryId,requestRawData:r,signal:Object(d["u"])(i),srcResolution:this._srcResolutions[e.level],timeExtent:this.layerView.timeExtent,tileInfo:this.layerView.tileInfo};return this.fetchTile(e,s)}_getCacheSize(e){return e?40:0}_initializeTileInfo(){const e=this.layerView.view.spatialReference,t=new j["a"]({x:this.layerView.fullExtent.xmin,y:this.layerView.fullExtent.ymax,spatialReference:e}),{scales:i,srcResolutions:r,isCustomTilingScheme:s}=Object(I["a"])(this.layer.rasterInfo,e),n=R["a"].create({spatialReference:e,size:512,scales:i});(0===n.origin.x||n.origin.x>t.x)&&(n.origin=t),this._isCustomTilingScheme=s,this.layerView.set("tileInfo",n),this._srcResolutions=null!=r?r:[]}_computeFetchConcurrency(){const{blockBoundary:e}=this.layer.rasterInfo.storageInfo,t=e[e.length-1];return(t.maxCol-t.minCol+1)*(t.maxRow-t.minRow+1)>64?2:10}async _enqueueTileFetch(e,t){if(!this._fetchQueue.has(e.key.id)){try{const t=await this._fetchQueue.push(e.key);this.notifyChange("updating");const{bandIds:r}=this.layer;let s=!this.useProgressiveUpdate||this.layerView.hasTilingEffects&&!this._globalSymbolizerParams;if(this._globalUpdateRequested&&!this.layerView.moving&&0===this._fetchQueue.length){s=!1;try{await this._redrawImage(this._abortController&&this._abortController.signal)}catch(i){Object(a["m"])(i)&&L.error(i)}this._globalUpdateRequested=!1}!this.canUseWebGLForProcessing()&&"rasterVF"!==this.type||this.layerView.hasTilingEffects||null!=this._symbolizerParams||this._updateSymbolizerParams();const n=this._tileInfoView.getTileCoords(z,e.key),o=this._tileInfoView.getTileResolution(e.key);await this.updateTileSource(e,{source:t,symbolizerParams:this._symbolizerParams,globalSymbolizerParams:this._globalSymbolizerParams,suspended:s,bandIds:r,coords:n,resolution:o}),e.once("attach",()=>this.layerView.requestUpdate()),this.container.addChild(e)}catch(i){Object(a["m"])(i)||L.error(i)}this.layerView.requestUpdate()}}async _redrawImage(e){if(0===this.container.children.length)return;await this.updatingHandles.addPromise(this.layer.updateRenderer()),this.layerView.hasTilingEffects?await this._updateGlobalSymbolizerParams(e):(this._updateSymbolizerParams(),this._globalSymbolizerParams=null);const t=this.container.children.map(async e=>this.updateTileSymbolizerParameters(e,{local:this._symbolizerParams,global:this._globalSymbolizerParams}));await Object(a["j"])(t),this.container.requestRender()}async _updateGlobalSymbolizerParams(e){const t={srcResolution:this._srcResolutions[this.previousLOD.level],registryId:this._blockCacheRegistryId,signal:e},i=await this.layer.fetchPixels(this.layerView.view.extent,this.layerView.view.width,this.layerView.view.height,t);if(!i||!i.pixelBlock)return;const r=this.layer.symbolizer.generateWebGLParameters({pixelBlock:Object(M["h"])(i.pixelBlock,this.layer.bandIds),isGCS:this.layerView.view.spatialReference.isGeographic,resolution:{x:this.previousLOD.resolution,y:this.previousLOD.resolution},bandIds:this.layer.bandIds});!this.canUseWebGLForProcessing()&&r&&"stretch"===r.type&&this.layer.renderer&&"raster-stretch"===this.layer.renderer.type&&(r.factor=r.factor.map(e=>255*e),r.outMin=Math.round(255*r.outMin),r.outMax=Math.round(255*r.outMax)),this._globalSymbolizerParams=r}_updateSymbolizerParams(){this._symbolizerParams=this.layer.symbolizer.generateWebGLParameters({pixelBlock:null,isGCS:this.layerView.view.spatialReference.isGeographic,resolution:{x:this.previousLOD.resolution,y:this.previousLOD.resolution},bandIds:this.layer.bandIds})}_updateBlockCacheRegistry(e=!1){const{url:t,rasterInfo:i,raster:r}=this.layer,{multidimensionalDefinition:s}=this.layer.normalizeRasterFetchOptions({multidimensionalDefinition:this.layer.multidimensionalDefinition,timeExtent:this.layerView.timeExtent}),n=null!=i&&i.multidimensionalInfo?r.getSliceIndex(s):null,a=Object(S["d"])(t,n);if(a!==this._blockCacheRegistryUrl){if(null!=this._blockCacheRegistryUrl&&Object(S["g"])(this._blockCacheRegistryUrl,this._blockCacheRegistryId),this._blockCacheRegistryId=Object(S["f"])(a,this.layer.raster.rasterInfo),e){const e=this._tileInfoView.getClosestInfoForScale(this.layerView.view.scale),t=this._srcResolutions[e.level];Object(S["h"])(a,this._blockCacheRegistryId,this.layerView.view.extent,this.layerView.view.resolution,t,this.layer.raster.ioConfig.sampling)}this._blockCacheRegistryUrl=a}}async doRefresh(){await this.updatingHandles.addPromise(this.layer.updateRenderer()),this.layerView.hasTilingEffects||this._updateSymbolizerParams(),this._updateBlockCacheRegistry(!0),this._fetchQueue.reset(),this.notifyChange("updating");const e=[];this._tileStrategy.tiles.forEach(t=>e.push(this._enqueueTileFetch(t))),await Object(a["j"])(e)}};Object(r["a"])([Object(l["b"])()],F.prototype,"_globalUpdateRequested",void 0),Object(r["a"])([Object(l["b"])()],F.prototype,"container",void 0),Object(r["a"])([Object(l["b"])()],F.prototype,"layer",void 0),Object(r["a"])([Object(l["b"])()],F.prototype,"layerView",void 0),Object(r["a"])([Object(l["b"])()],F.prototype,"type",void 0),Object(r["a"])([Object(l["b"])()],F.prototype,"useWebGLForProcessing",null),Object(r["a"])([Object(l["b"])()],F.prototype,"useProgressiveUpdate",null),Object(r["a"])([Object(l["b"])()],F.prototype,"updating",null),F=Object(r["a"])([Object(c["a"])("esri.views.2d.layers.imagery.BaseImageryTileSubView2D")],F);var A=i("45a5");let B=class extends F{constructor(){super(...arguments),this.container=null,this.layer=null,this.type="raster"}canUseWebGLForProcessing(){return this.useWebGLForProcessing&&this.layer.symbolizer.canRenderInWebGL&&!("majority"===this.layer.interpolation&&Object(A["a"])(this.layer))}fetchTile(e,t){return this.layer.fetchTile(e.level,e.row,e.col,t)}async updateTileSource(e,t){const{bandIds:i}=this.layer,r=this._getLayerInterpolation(),s=this.canUseWebGLForProcessing(),{source:n,symbolizerParams:a,globalSymbolizerParams:o,suspended:l,coords:c,resolution:h}=t,{bitmap:u}=e;if([u.x,u.y]=c,u.resolution=h,n&&Object(d["l"])(n)&&Object(d["l"])(n.pixelBlock)){const e={extent:n.extent,pixelBlock:n.pixelBlock};if(u.rawPixelData=e,s)u.source=n.pixelBlock,u.isRendereredSource=!1;else{const t=await this.layer.applyRenderer(e,"stretch"===(null==o?void 0:o.type)?o:null);u.source=t,u.isRendereredSource=!0}u.symbolizerParameters=s?a:null,s?u.transformGrid||(u.transformGrid=n.transformGrid):u.transformGrid=null}else{const e=this.createEmptyTilePixelBlock();u.source=e,u.symbolizerParameters=s?a:null,u.transformGrid=null}u.bandIds=s?i:null,u.width=this._tileInfoView.tileInfo.size[0],u.height=this._tileInfoView.tileInfo.size[1],u.interpolation=r,u.suspended=l,u.invalidateTexture()}async updateTileSymbolizerParameters(e,t){const{local:i,global:r}=t,{bandIds:s}=this.layer,n=this._getLayerInterpolation(),a=this.canUseWebGLForProcessing(),{bitmap:o}=e,{rawPixelData:l}=o;!a&&Object(d["l"])(l)?(o.source=await this.layer.applyRenderer(l,"stretch"===(null==r?void 0:r.type)?r:null),o.isRendereredSource=!0):(o.isRendereredSource&&Object(d["l"])(l)&&(o.source=l.pixelBlock),o.isRendereredSource=!1),o.symbolizerParameters=a?r||i:null,o.bandIds=a?s:null,o.interpolation=n,o.suspended=!1}install(e){this.container=new v(this._tileInfoView),this.container.isCustomTilingScheme=this._isCustomTilingScheme,e.addChild(this.container)}uninstall(){this.container.removeAllChildren(),this.container.remove(),super.uninstall()}_getLayerInterpolation(){const e=this.layer.renderer.type;if("raster-colormap"===e||"unique-value"===e||"class-breaks"===e)return"nearest";const{interpolation:t}=this.layer,{renderer:i}=this.layer;return"raster-stretch"===i.type&&null!=i.colorRamp?"bilinear"===t||"cubic"===t?"bilinear":"nearest":t}};Object(r["a"])([Object(l["b"])()],B.prototype,"container",void 0),Object(r["a"])([Object(l["b"])()],B.prototype,"layer",void 0),Object(r["a"])([Object(l["b"])()],B.prototype,"type",void 0),B=Object(r["a"])([Object(c["a"])("esri.views.2d.layers.imagery.ImageryTileView2D")],B);const U=B;var E=i("19db"),G=i("1c92"),q=i("7ce4"),W=(i("d267"),i("1956"),i("d17d"),i("9f8b"),i("a1ff"),i("0fa6")),N=i("7c4b"),H=i("c8dd");class Q extends N["a"]{constructor(e=null){super(),this._source=null,this._symbolizerParameters=null,this._vaoInvalidated=!0,this.coordScale=[1,1],this.height=null,this.stencilRef=0,this.rawPixelData=null,this.width=null,this.source=e}destroy(){var e,t;Object(d["l"])(this.vaoData)&&(null==(e=this.vaoData.magdir)||e.vao.dispose(),null==(t=this.vaoData.scalar)||t.vao.dispose(),this.vaoData=null)}get symbolizerParameters(){return this._symbolizerParameters}set symbolizerParameters(e){JSON.stringify(this._symbolizerParameters)!==JSON.stringify(e)&&(this._symbolizerParameters=e,this.invalidateVAO())}get source(){return this._source}set source(e){this._source=e,this.invalidateVAO()}invalidateVAO(){var e,t;!this._vaoInvalidated&&Object(d["l"])(this.vaoData)&&(null==(e=this.vaoData.magdir)||e.vao.dispose(),null==(t=this.vaoData.scalar)||t.vao.dispose(),this.vaoData=null,this._vaoInvalidated=!0,this.requestRender())}updateVectorFieldVAO(e){if(this._vaoInvalidated){if(this._vaoInvalidated=!1,Object(d["l"])(this.source)&&!Object(d["l"])(this.vaoData)){const{style:t}=this.symbolizerParameters;switch(t){case"beaufort_ft":case"beaufort_km":case"beaufort_kn":case"beaufort_m":case"beaufort_mi":case"classified_arrow":case"ocean_current_kn":case"ocean_current_m":case"single_arrow":{const t=Object(E["c"])(this.source,this.symbolizerParameters),i=this._createVectorFieldVAO(e.context,t);this.vaoData={magdir:i}}break;case"simple_scalar":{const t=Object(E["d"])(this.source,this.symbolizerParameters),i=this._createVectorFieldVAO(e.context,t);this.vaoData={scalar:i}}break;case"wind_speed":{const t=Object(E["c"])(this.source,this.symbolizerParameters),i=this._createVectorFieldVAO(e.context,t),r=Object(E["d"])(this.source,this.symbolizerParameters),s=this._createVectorFieldVAO(e.context,r);this.vaoData={magdir:i,scalar:s}}}}this.ready(),this.requestRender()}}_createTransforms(){return{dvs:Object(y["b"])()}}onAttach(){this.invalidateVAO()}onDetach(){this.invalidateVAO()}_createVectorFieldVAO(e,t){const{vertexData:i,indexData:r}=t,s=q["a"].createVertex(e,35044,new Float32Array(i)),n=q["a"].createIndex(e,35044,new Uint32Array(r)),a=Object(H["g"])("vector-field",{geometry:[{location:0,name:"a_pos",count:2,type:5126,normalized:!1},{location:1,name:"a_offset",count:2,type:5126,normalized:!1},{location:2,name:"a_vv",count:2,type:5126,normalized:!1}]});return{vao:new W["a"](e,a.attributes,a.bufferLayouts,{geometry:s},n),elementCount:r.length}}}class J extends g["a"]{constructor(e,t,i,r,s,n=null){super(e,t,i,r,s),this.tileData=new Q(n),this.tileData.coordScale=[r,s],this.tileData.once("isReady",()=>this.ready())}destroy(){super.destroy(),this.tileData.destroy(),this.tileData=null,this.stage=null}set stencilRef(e){this.tileData.stencilRef=e}get stencilRef(){return this.tileData.stencilRef}_createTransforms(){return{dvs:Object(y["b"])(),tileMat3:Object(y["b"])()}}setTransform(e,t){super.setTransform(e,t);const i=t/(e.resolution*e.pixelRatio),r=this.transforms.tileMat3,[s,n]=this.tileData.offset,a=[this.x+s*t,this.y-n*t],[o,l]=e.toScreenNoRotation([0,0],a),{symbolTileSize:c}=this.tileData.symbolizerParameters,h=Math.round((this.width-this.tileData.offset[0])/c)*c,u=Math.round((this.height-this.tileData.offset[1])/c)*c,d=h/this.rangeX*i,f=u/this.rangeY*i;Object(G["n"])(r,d,0,0,0,f,0,o,l,1),Object(G["k"])(this.transforms.dvs,e.displayViewMat3,r),this.tileData.transforms.dvs=this.transforms.dvs}onAttach(){this.tileData.stage=this.stage}onDetach(){this.tileData.stage=null}}var $=i("c1ef");class X extends _["a"]{constructor(){super(...arguments),this.isCustomTilingScheme=!1,this.symbolTypes=["triangle"]}createTile(e){const t=this._tileInfoView.getTileBounds(Object(f["l"])(),e),[i,r]=this._tileInfoView.tileInfo.size;return new J(e,t[0],t[3],i,r)}destroyTile(){}prepareRenderPasses(e){const t=e.registerRenderPass({name:"imagery (vf tile)",brushes:[$["a"]],target:()=>this.children.map(e=>e.tileData),drawPhase:w["c"].MAP});return[...super.prepareRenderPasses(e),t]}doRender(e){this.visible&&e.drawPhase===w["c"].MAP&&this.symbolTypes.forEach(t=>{e.renderPass=t,super.doRender(e)})}}let K=class extends F{constructor(){super(...arguments),this._handle=null,this.container=null,this.layer=null,this.type="rasterVF"}canUseWebGLForProcessing(){return!1}async fetchTile(e,t){const i=await this.layer.fetchTile(e.level,e.row,e.col,t);return"vector-magdir"===this.layer.rasterInfo.dataType&&null!=i&&i.pixelBlock&&(i.pixelBlock=await this.layer.convertVectorFieldData(i.pixelBlock,t)),i}updateTileSource(e,t){const i=t.symbolizerParams,{tileData:r}=e;r.key=e.key,r.width=this._tileInfoView.tileInfo.size[0],r.height=this._tileInfoView.tileInfo.size[1];const{symbolTileSize:s}=i,{source:n}=t;if(r.offset=this._getTileSymbolOffset(r.key,s),Object(d["l"])(n)&&Object(d["l"])(n.pixelBlock)){const e={extent:n.extent,pixelBlock:n.pixelBlock};r.rawPixelData=e,r.source=this._sampleVectorFieldData(n.pixelBlock,i,r.offset),r.symbolizerParameters=i}else{const e=[Math.round((this._tileInfoView.tileInfo[0]-r.offset[0])/s),Math.round((this._tileInfoView.tileInfo[1]-r.offset[1])/s)],t=this.createEmptyTilePixelBlock(e);r.source=t,r.symbolizerParameters=i}return r.invalidateVAO(),Promise.resolve(null)}updateTileSymbolizerParameters(e,t){var i;const r=t.local,{symbolTileSize:s}=r,{tileData:n}=e;n.offset=this._getTileSymbolOffset(n.key,s);const a=n.symbolizerParameters.symbolTileSize;return n.symbolizerParameters=r,Object(d["l"])(null==(i=n.rawPixelData)?void 0:i.pixelBlock)&&a!==s&&(n.source=this._sampleVectorFieldData(n.rawPixelData.pixelBlock,n.symbolizerParameters,n.offset)),Promise.resolve(null)}install(e){this.container=new X(this._tileInfoView),this.container.isCustomTilingScheme=this._isCustomTilingScheme,this._updateSymbolType(this.layer.renderer),this._handle=this.layer.watch("renderer",e=>this._updateSymbolType(e)),e.addChild(this.container)}uninstall(){this.container.removeAllChildren(),this._handle.remove(),this._handle=null,this.container.remove(),super.uninstall()}_getTileSymbolOffset(e,t){const i=e.col*this._tileInfoView.tileInfo.size[0]%t,r=e.row*this._tileInfoView.tileInfo.size[1]%t;return[i>t/2?t-i:-i,r>t/2?t-r:-r]}_sampleVectorFieldData(e,t,i){const{symbolTileSize:r}=t;return Object(E["f"])(e,"vector-uv",r,i)}_updateSymbolType(e){"vector-field"===e.type&&(this.container.symbolTypes="wind-barb"===e.style?["scalar","triangle"]:"simple-scalar"===e.style?["scalar"]:["triangle"])}};Object(r["a"])([Object(l["b"])()],K.prototype,"container",void 0),Object(r["a"])([Object(l["b"])()],K.prototype,"layer",void 0),Object(r["a"])([Object(l["b"])()],K.prototype,"type",void 0),K=Object(r["a"])([Object(c["a"])("esri.views.2d.layers.imagery.VectorFieldTileView2D")],K);const Y=K;var Z=i("72d8"),ee=i("365a"),te=i("6c7a");const ie=n["a"].getLogger("esri.views.2d.layers.ImageryTileLayerView2D");let re=class extends(Object(Z["a"])(Object(te["a"])(Object(u["a"])(ee["a"])))){constructor(){super(...arguments),this._useWebGLForProcessing=!0,this._useProgressiveUpdate=!0,this.subview=null}initialize(){const e=this.updateFullExtent();this.addResolvingPromise(e)}get useWebGLForProcessing(){return this._useWebGLForProcessing}set useWebGLForProcessing(e){this._useWebGLForProcessing=e,this.subview&&"useWebGLForProcessing"in this.subview&&(this.subview.useWebGLForProcessing=e)}get useProgressiveUpdate(){return this._useWebGLForProcessing}set useProgressiveUpdate(e){this._useProgressiveUpdate=e,this.subview&&"useProgressiveUpdate"in this.subview&&(this.subview.useProgressiveUpdate=e)}update(e){this.subview.update(e),this.notifyChange("updating")}isUpdating(){return!this.subview||this.subview.updating}attach(){this.layer.increaseRasterJobHandlerUsage(),this._updateSubview(),this.handles.add([Object(o["e"])(this.layer,["bandIds","renderer","interpolation","multidimensionalDefinition"],(e,t,i)=>{const r="multidimensionalDefinition"===i,s="interpolation"===i&&("majority"===e||"majority"===t)&&Object(A["a"])(this.layer),n="renderer"===i&&t.type!==e.type;n&&this._updateSubview();const o=r||s||n;this.subview.redrawOrRefetch(o).catch(e=>{Object(a["m"])(e)||ie.error(e)}),this.notifyChange("updating")}),Object(o["a"])(this,["layer.blendMode"],e=>{this.subview&&(this.subview.container.blendMode=e)},!0),Object(o["a"])(this,["layer.effect"],e=>{this.subview&&(this.subview.container.effect=e)},!0),Object(o["a"])(this,"timeExtent",()=>{this.subview.redrawOrRefetch(!0).catch(e=>{Object(a["m"])(e)||ie.error(e)})})],"attach")}detach(){this.handles.remove("attach"),this.layer.decreaseRasterJobHandlerUsage(),this.subview.uninstall()}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.subview.moveEnd()}async hitTest(e,t){return[new s["a"]({attributes:{},geometry:e.clone()})]}doRefresh(){return this.subview.doRefresh()}_updateSubview(){const e="vector-field"===this.layer.renderer.type?"rasterVF":"animated-flow"===this.layer.renderer.type?"rasterAnimatedFlow":"raster";if(this.subview){if(this.subview.type===e)return;this.subview.uninstall()}const{layer:t}=this;let i;i="rasterVF"===e?new Y({layer:t,layerView:this}):"rasterAnimatedFlow"===e?new h["a"]({layer:t,layerView:this}):new U({layer:t,layerView:this}),"useWebGLForProcessing"in i&&(i.useWebGLForProcessing=this._useWebGLForProcessing),"useProgressiveUpdate"in i&&(i.useProgressiveUpdate=this._useProgressiveUpdate),"previousLOD"in i&&(i.previousLOD=this.subview&&"previousLOD"in this.subview&&this.subview.previousLOD),i.attach(),i.install(this.container),i.container.blendMode=t.blendMode,i.container.effect=t.effect,this.subview=i,this.requestUpdate()}};Object(r["a"])([Object(l["b"])()],re.prototype,"subview",void 0),Object(r["a"])([Object(l["b"])()],re.prototype,"useWebGLForProcessing",null),Object(r["a"])([Object(l["b"])()],re.prototype,"useProgressiveUpdate",null),re=Object(r["a"])([Object(c["a"])("esri.views.2d.layers.ImageryTileLayerView2D")],re);const se=re},b4e0:function(e,t,i){"use strict";i.d(t,"a",(function(){return L})),i.d(t,"b",(function(){return g})),i.d(t,"c",(function(){return k})),i.d(t,"d",(function(){return T})),i.d(t,"e",(function(){return R})),i.d(t,"f",(function(){return I})),i.d(t,"g",(function(){return b})),i.d(t,"h",(function(){return j})),i.d(t,"i",(function(){return _})),i.d(t,"j",(function(){return x})),i.d(t,"k",(function(){return h})),i.d(t,"l",(function(){return D})),i.d(t,"m",(function(){return z}));i("e06a");var r=i("ce50"),s=i("b2b2"),n=i("8048"),a=i("8188"),o=i("3af1"),l=i("4ae5");const c=5e-4;function h(e,t,i){return!Object(a["b"])(e,t,i)}function u(e,t,i){const s=h(e,t,i);if(s&&!Object(a["h"])())throw new r["a"]("rasterprojectionhelper-project","projection engine is not loaded");return s}const d=function(e,t,i){const r=(e[0]+e[4]+e[4*t.cols]+e[4*t.cols+4])/4,s=(e[1]+e[5]+e[4*t.rows+1]+e[4*t.rows+5])/4,n=(e[4*t.cols]-e[0]+e[4*t.cols+4]-e[4])/i[0]*.5,a=(e[4*t.cols+1]-e[1]+e[4*t.cols+5]-e[5])/i[1]*.5;return[0===n||isNaN(n)?0:Math.abs(r-e[2*t.rows+2])/Math.abs(n),0===a||isNaN(a)?0:Math.abs(s-e[2*t.rows+3])/Math.abs(a)]},f={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},p=32,m=4,y=m;async function b(){if(Object(a["h"])())return null;await Object(a["i"])()}function g(e,t,i){return u(e.spatialReference,t)?i?Object(a["f"])(t,e.spatialReference,e):Object(a["f"])(e.spatialReference,t,e):null}function x(e,t,i,r=null){if(e.spatialReference.equals(t))return e;u(e.spatialReference,t,r);const n=i.center,l=new o["a"]({xmin:n.x-e.x/2,xmax:n.x+e.x/2,ymin:n.y-e.y/2,ymax:n.y+e.y/2,spatialReference:e.spatialReference}),c=Object(a["m"])(l,t,r);return Object(s["k"])(c)?null:{x:c.xmax-c.xmin,y:c.ymax-c.ymin}}function w(e,t=.01){return Object(n["f"])(e)?t/Object(n["f"])(e):0}function _(e,t,i=null,r=!0){const s=e.spatialReference;if(s.equals(t))return e;u(s,t,i);const n=Object(a["m"])(e,t,i);if(r&&t.isGeographic){const[t,i]=S(s,!0),r=w(s);r&&null!=t&&null!=i&&(Math.abs(e.x-t)<r&&Math.abs(180-n.x)<c?n.x-=360:Math.abs(e.x-i)<r&&Math.abs(180+n.x)<c&&(n.x+=360))}return n}function v(e,t,i=null){const r=e[0].spatialReference;return r.equals(t)?e:(u(r,t,i),Object(a["m"])(e,t,i))}function O(e){const t=R(e[0].spatialReference);if(e.length<2||!Object(s["l"])(t))return e[0];let{xmin:i,xmax:r,ymin:n,ymax:a}=e[0];for(let s=1;s<e.length;s++){const i=e[s];r=i.xmax+t*s,n=Math.min(n,i.ymin),a=Math.max(a,i.ymax)}return new o["a"]({xmin:i,xmax:r,ymin:n,ymax:a,spatialReference:e[0].spatialReference})}function j(e,t,i=null,r=!0){if(e.spatialReference.equals(t))return e;const n=I(e),a=R(e.spatialReference,!0);return Object(s["l"])(a)&&0!==n?O(e.clone().normalize().map(e=>P(e,t,i,r))):P(e,t,i,r)}function P(e,t,i=null,r=!0){const s=e.spatialReference;if(s.equals(t))return e;u(s,t,i);const n=Object(a["m"])(e,t,i);let[o,h]=S(s,!0);if(n&&r&&s.isWebMercator&&t.isGeographic&&null!=o&&null!=h){const r=.001,a=1e3;if(Math.abs(e.xmin-o)<r&&Math.abs(h-e.xmax)>a&&Math.abs(180-n.xmax)<c){n.xmin=-180;const r=[];r.push(new l["a"](e.xmax,e.ymin,s)),r.push(new l["a"](e.xmax,(e.ymin+e.ymax)/2,s)),r.push(new l["a"](e.xmax,e.ymax,s));const a=r.map(e=>_(e,t,i)).filter(e=>!isNaN(null==e?void 0:e.x)).map(e=>e.x);n.xmax=Math.max.apply(null,a)}if(Math.abs(e.xmax-h)<r&&Math.abs(o-e.xmin)>a&&Math.abs(180+n.xmin)<c){n.xmax=180;const r=[];r.push(new l["a"](e.xmin,e.ymin,s)),r.push(new l["a"](e.xmin,(e.ymin+e.ymax)/2,s)),r.push(new l["a"](e.xmin,e.ymax,s));const a=r.map(e=>_(e,t,i)).filter(e=>!isNaN(null==e?void 0:e.x)).map(e=>e.x);n.xmin=Math.min.apply(null,a)}}[o,h]=S(t,!0);const d=w(t);return d&&null!=o&&null!=h&&n&&(Math.abs(n.xmin-o)<d&&(n.xmin=o),Math.abs(n.xmax-h)<d&&(n.xmax=h)),n}function R(e,t=!1){const i=t?20037508.342787:20037508.342788905;return e.isWebMercator?2*i:e.wkid&&e.isGeographic?360:2*f[e.wkid]||null}function S(e,t=!1){const i=[],r=R(e,t);return Object(s["l"])(r)&&(i.push(-r/2),i.push(r/2)),i}function M(e,t,i,r){let s=(e-t)/i;return s-Math.floor(s)!=0?s=Math.floor(s):r&&(s-=1),s}function I(e,t=!1){const i=R(e.spatialReference);if(!Object(s["l"])(i))return 0;const r=t?0:-i/2;return M(e.xmax,r,i,!0)-M(e.xmin,r,i,!1)}function T(e){const t=e.storageInfo.origin.x,i=R(e.spatialReference,!0);if(!Object(s["l"])(i))return{originX:t,halfWorldWidth:null,pyramidsInfo:null};const r=i/2,{nativePixelSize:n,storageInfo:a,extent:o}=e,{maximumPyramidLevel:l,blockWidth:c,pyramidScalingFactor:h}=a;let u=n.x;const d=[],f=Object(s["l"])(e.transform)&&"gcs-shift"===e.transform.type,p=t+(f?0:r),m=f?i-t:r-t;for(let s=0;s<=l;s++){const e=(o.xmax-t)/u/c,i=e-Math.floor(e)==0?e:Math.ceil(e),r=m/u/c,s=r-Math.floor(r)==0?r:Math.ceil(r),n=Math.floor(p/u/c),a=Math.round(p/u)%c,l=(c-Math.round(m/u)%c)%c;d.push({resolutionX:u,blockWidth:c,datsetColumnCount:i,worldColumnCountFromOrigin:s,leftMargin:a,rightPadding:l,originColumnOffset:n}),u*=h}return{originX:t,halfWorldWidth:r,pyramidsInfo:d,hasGCSSShiftTransform:f}}function k(e){const t=e.isAdaptive&&null==e.spacing,i=e.spacing||[p,p];let r=C(e),s={cols:r.size[0]+1,rows:r.size[1]+1},n=d(r.offsets,s,i);const a=(n[0]+n[1])/2,o=r.outofBoundPointCount>0&&r.outofBoundPointCount<r.offsets.length/2;return t&&(o||a>y)&&(r=C({...e,spacing:[m,m]}),s={cols:r.size[0]+1,rows:r.size[1]+1},n=d(r.offsets,s,i)),r.error=n,r.coefficients=V(r.offsets,s,o),r}function C(e){const{projectedExtent:t,srcBufferExtent:i,pixelSize:r,datumTransformation:n,rasterTransform:a}=e,o=t.spatialReference,c=i.spatialReference;u(o,c);const{xmin:h,ymin:d,xmax:f,ymax:m}=t,y=R(c),b=e.hasWrapAround||"gcs-shift"===(null==a?void 0:a.type),g=e.spacing||[p,p],x={x:g[0]*r.x,y:g[1]*r.y},w={cols:Math.ceil((f-h)/x.x-.1/g[0])+1,rows:Math.ceil((m-d)/x.y-.1/g[1])+1},_=x.x,O=x.y,j=[];let P,S=0;const M=[];for(let s=0;s<w.cols;s++)for(let e=0;e<w.rows;e++)M.push(new l["a"]({x:h+_*s,y:m-O*e,spatialReference:o}));const I=v(M,c,n);for(let l=0;l<w.cols;l++){const e=[];for(let t=0;t<w.rows;t++){let r=I[l*w.rows+t];a&&(r=a.inverseTransform(r)),e.push(r),l>0&&b&&r&&P[t]&&Object(s["l"])(y)&&r.x<P[t].x&&(r.x+=y),r?(j.push((r.x-i.xmin)/(i.xmax-i.xmin)),j.push((i.ymax-r.y)/(i.ymax-i.ymin))):(j.push(NaN),j.push(NaN),S++)}P=e}return{offsets:j,error:null,coefficients:null,outofBoundPointCount:S,spacing:g,size:[w.cols-1,w.rows-1]}}function V(e,t,i){const{cols:r,rows:s}=t,n=new Float32Array((r-1)*(s-1)*2*6),a=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),o=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let l=0;l<r-1;l++){for(let t=0;t<s-1;t++){let i=l*s*2+2*t;const c=e[i],h=e[i+1],u=e[i+2],d=e[i+3];i+=2*s;const f=e[i],p=e[i+1],m=e[i+2],y=e[i+3];let b=0,g=12*(t*(r-1)+l);for(let e=0;e<3;e++)n[g++]=a[b++]*c+a[b++]*u+a[b++]*m;b=0;for(let e=0;e<3;e++)n[g++]=a[b++]*h+a[b++]*d+a[b++]*y;b=0;for(let e=0;e<3;e++)n[g++]=o[b++]*c+o[b++]*f+o[b++]*m;b=0;for(let e=0;e<3;e++)n[g++]=o[b++]*h+o[b++]*p+o[b++]*y}if(i)for(let e=0;e<n.length;e++)isNaN(n[e])&&(n[e]=-1)}return n}function D(e){const t=e.clone().normalize();return 1===t.length?t[0]:O(t)}function z(e,t,i){const{storageInfo:r,pixelSize:n}=t;let a,o=!1;const{pyramidResolutions:c}=r;if(Object(s["l"])(c)&&c.length){const r=(e.x+e.y)/2,s=c[c.length-1],h=(s.x+s.y)/2,u=(n.x+n.y)/2;if(r<=u)a=0;else if(r>=h)a=c.length,o=r/h>8;else{let e,t=u;for(let s=1;s<=c.length;s++){if(e=(c[s-1].x+c[s-1].y)/2,r<=e){r===e?a=s:"down"===i?(a=s-1,o=r/t>8):a="up"===i||r-t>e-r||r/t>2?s:s-1;break}t=e}}const d=0===a?n:c[a-1];return{pyramidLevel:a,pyramidResolution:new l["a"]({x:d.x,y:d.y,spatialReference:t.spatialReference}),excessiveReading:o}}const h=Math.log(e.x/n.x)/Math.LN2,u=Math.log(e.y/n.y)/Math.LN2,d=t.storageInfo.maximumPyramidLevel||0;a="down"===i?Math.floor(Math.min(h,u)):"up"===i?Math.ceil(Math.max(h,u)):Math.round((h+u)/2),a<0?a=0:a>d&&(o=a>d+3,a=d);const f=2**a;return{pyramidLevel:a,pyramidResolution:new l["a"]({x:f*t.nativePixelSize.x,y:f*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:o}}function L(e,t,i=512,r=!0){const{extent:s,spatialReference:a,pixelSize:o}=e,c=x(new l["a"]({x:o.x,y:o.y,spatialReference:a}),t,s);if(null==c)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const h=(c.x+c.y)/2,u=Object(n["f"])(t),d=h*u*96*39.37,f=t.isGeographic?256/i*295828763.7958547:256/i*591657527.591555;let p="vector-magdir"===e.dataType||"vector-uv"===e.dataType;const m=j(s,t);p||r&&(t.isGeographic||t.isWebMercator)&&(p=m.xmin*m.xmax<0);let y,b=d;const g=1.001;if(p){b=f;const e=t.isGeographic?1341104507446289e-21:.29858214164761665,i=e*(96*u*39.37),r=t.isGeographic?4326:3857;y=x(new l["a"]({x:e,y:e,spatialReference:{wkid:r}}),a,m),y.x*=b/i,y.y*=b/i}else{y={x:o.x,y:o.y};const t=Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2);let i=0;for(;b<f*(g/2)&&i<t;)i++,b*=2,y.x*=2,y.y*=2;Math.max(b,f)/Math.min(b,f)<=g&&(b=f)}const w=[b],_=[{x:y.x,y:y.y}],v=70.5310735,O=Math.min(v,d)/g;for(;b>=O;)b/=2,y.x/=2,y.y/=2,w.push(b),_.push({x:y.x,y:y.y});return{projectedPixelSize:c,scales:w,srcResolutions:_,isCustomTilingScheme:!p}}},d23c:function(e,t,i){"use strict";i.d(t,"a",(function(){return L}));var r=i("a4ee"),s=i("fc29"),n=i("59b2"),a=(i("b50f"),i("c120"),i("cea0"),i("d386")),o=i("2616"),l=i("c9ee"),c=i("c84e"),h=i("9a02");class u extends h["a"]{constructor(){super(...arguments),this.flowStyle=null}get requiresDedicatedFBO(){return!1}doRender(e){super.doRender(e)}prepareRenderPasses(e){const t=e.registerRenderPass({name:"flow",brushes:[l["a"]],target:()=>this.children,drawPhase:c["c"].MAP});return[...super.prepareRenderPasses(e),t]}}i("e06a");var d=i("e92d"),f=i("38a4"),p=i("b2b2"),m=i("f4cc"),y=i("4ae5");const b=d["a"].getLogger("esri.views.2d.engine.flow.FlowDisplayData");class g{constructor(e,t,i,r){this.state={name:"created"},this.flowStyle=e,this.extent=t,this.size=i,this.pixelRatio=r}async load(){const e=new AbortController;this.state={name:"loading",abortController:e};const t=await this.flowStyle.loadResources({extent:this.extent,size:this.size,pixelRatio:this.pixelRatio},e.signal);this.state={name:"loaded",resources:t}}prepareForRendering(e,t,i){if("loaded"!==this.state.name)return void b.error("Only loaded resources can be attached.");const r=this.state.resources;r.prepareForRendering(e,t,i),this.state={name:"attached",resources:r}}destroy(){if("loading"===this.state.name)return this.state.abortController.abort(),void(this.state={name:"detached"});"attached"===this.state.name&&(this.state.resources.detach(),this.state={name:"detached"})}update(e){return!!this.flowStyle.areResourcesCompatible(e.flowStyle)&&(!(!this.extent.equals(e.extent)||this.size[0]!==e.size[0]||this.size[1]!==e.size[1]||this.pixelRatio!==e.pixelRatio)&&(this.flowStyle=e.flowStyle,!0))}}var x=i("1c92"),w=i("8c71"),_=i("7c4b");class v extends _["a"]{constructor(){super(...arguments),this._displayData=null}get displayData(){return this._displayData}set displayData(e){this._displayData=e,this.requestRender()}clear(){Object(p["l"])(this._displayData)&&(this._displayData.destroy(),this._displayData=null,this.requestRender())}setTransform(e){const{displayData:t}=this;if(Object(p["k"])(t))return;const i=t.extent.xmin,r=t.extent.ymax,s=[0,0];e.toScreen(s,[i,r]);const n=(t.extent.xmax-t.extent.xmin)/t.size[0]/e.resolution,a=Object(f["h"])(e.rotation),{dvs:o}=this.transforms;Object(x["b"])(o),Object(x["c"])(o,o,[-1,1,0]),Object(x["d"])(o,o,[2/(e.size[0]*e.pixelRatio),-2/(e.size[1]*e.pixelRatio),1]),Object(x["c"])(o,o,[s[0],s[1],0]),Object(x["m"])(o,o,a),Object(x["d"])(o,o,[n*e.pixelRatio,n*e.pixelRatio,1])}_createTransforms(){return{dvs:Object(w["b"])()}}}var O=i("3af1");const j=1.15,P=d["a"].getLogger("esri.views.2d.engine.flow.FlowStrategy");let R=class extends s["a"]{constructor(e){super(e),this._flowDisplayObject=new v,this._loading=null}initialize(){this.flowContainer.addChild(this._flowDisplayObject)}destroy(){this._clear(),this.flowContainer.removeAllChildren()}get updating(){return null!=this._loading}update(e){const{flowStyle:t}=this.flowContainer;if(Object(p["k"])(t))return void this._clear();const{extent:i,rotation:r,resolution:s,pixelRatio:n}=e.state,a=M(i,r);a.expand(j);const o=[Math.round((a.xmax-a.xmin)/s),Math.round((a.ymax-a.ymin)/s)],l=new g(t,a,o,n);if(Object(p["l"])(this._loading)){if(this._loading.update(l))return;this._loading.destroy(),this._loading=null}!Object(p["k"])(this._flowDisplayObject.displayData)&&this._flowDisplayObject.displayData.update(l)||(l.load().then(()=>{this._flowDisplayObject.clear(),this._flowDisplayObject.displayData=this._loading,this._loading=null},e=>{Object(m["m"])(e)||(P.error("A resource failed to load.",e),this._loading=null)}),this._loading=l)}_clear(){this._flowDisplayObject.clear(),Object(p["l"])(this._loading)&&(this._loading.destroy(),this._loading=null)}};Object(r["a"])([Object(n["b"])()],R.prototype,"_loading",void 0),Object(r["a"])([Object(n["b"])()],R.prototype,"flowContainer",void 0),Object(r["a"])([Object(n["b"])()],R.prototype,"updating",null),R=Object(r["a"])([Object(a["a"])("esri.views.2d.engine.flow.FlowStrategy")],R);const S=R;function M(e,t){const i=new y["a"]({x:(e.xmax+e.xmin)/2,y:(e.ymax+e.ymin)/2,spatialReference:e.spatialReference}),r=e.xmax-e.xmin,s=e.ymax-e.ymin,n=Math.abs(Math.cos(Object(f["h"])(t))),a=Math.abs(Math.sin(Object(f["h"])(t))),o=n*r+a*s,l=a*r+n*s,c=new O["a"]({xmin:i.x-o/2,ymin:i.y-l/2,xmax:i.x+o/2,ymax:i.y+l/2,spatialReference:e.spatialReference});return c.centerAt(i),c}var I=i("a915");function T(e){const t=Object(I["g"])(e.lineWidth),i=2*t,r=Math.round(Object(I["g"])(e.lineLength)/i)+1,s=t,n=10,a=e.lineColor.toRgba(),o=[a[0]/255,a[1]/255,a[2]/255,a[3]],{lineSpeed:l,fadeDuration:c,density:h}=e;return{lineRenderWidth:t,segmentLength:i,verticesPerLine:r,lineCollisionWidth:s,lineSpacing:n,lineColor:o,lineSpeed:l,fadeDuration:c,density:h,smoothing:Object(I["g"])(e.smoothing),velocityScale:1,minWeightThreshold:.001,minSpeedThreshold:.001,maxTurnAngle:1,mergeLines:!0,interpolate:!0,profile:!1}}var k=i("7ce4"),C=(i("d267"),i("1956"),i("d17d"),i("9f8b"),i("a1ff"),i("0fa6"));class V{constructor(e,t){this._vertexData=e,this._indexData=t}prepareForRendering(e,t,i){const r=k["a"].createVertex(e,35044,this._vertexData),s=k["a"].createIndex(e,35044,this._indexData),n=new C["a"](e,t,i,{geometry:r},s);this.vertexBuffer=r,this.indexBuffer=s,this.vertexArray=n,this._vertexData=null,this._indexData=null}detach(){this.vertexArray.dispose(),this.vertexBuffer.dispose(),this.indexBuffer.dispose()}}class D{constructor(e,t,i){this._loadImagery=e,this._createStreamlinesMesh=t,this._rendererSettings=T(i)}get animated(){return this._rendererSettings.lineSpeed>0}get renderSettings(){return this._rendererSettings}areResourcesCompatible(e){let t=!0;return t=t&&e._loadImagery===this._loadImagery,t=t&&e._createStreamlinesMesh===this._createStreamlinesMesh,t=t&&e._rendererSettings.verticesPerLine===this._rendererSettings.verticesPerLine,t=t&&e._rendererSettings.segmentLength===this._rendererSettings.segmentLength,t=t&&e._rendererSettings.lineSpacing===this._rendererSettings.lineSpacing,t=t&&e._rendererSettings.density===this._rendererSettings.density,t=t&&e._rendererSettings.smoothing===this._rendererSettings.smoothing,t=t&&e._rendererSettings.velocityScale===this._rendererSettings.velocityScale,t=t&&e._rendererSettings.minWeightThreshold===this._rendererSettings.minWeightThreshold,t=t&&e._rendererSettings.minSpeedThreshold===this._rendererSettings.minSpeedThreshold,t=t&&e._rendererSettings.mergeLines===this._rendererSettings.mergeLines,t=t&&e._rendererSettings.interpolate===this._rendererSettings.interpolate,t&&this._rendererSettings.mergeLines&&(t=e._rendererSettings.lineCollisionWidth===this._rendererSettings.lineCollisionWidth),!!t}async loadResources(e,t){const{extent:i,size:r}=e;Object(m["w"])(t);const s=await this._loadImagery(i,r[0],r[1],t),{vertexData:n,indexData:a}=await this._createStreamlinesMesh(this._rendererSettings,s,t);return new V(n,a)}}let z=class extends s["a"]{constructor(){super(...arguments),this._loadImagery=(e,t,i,r)=>Object(o["b"])(this.layer,e,t,i,r),this._createStreamlinesMesh=(e,t,i)=>this.layer.createStreamlinesMesh({flowData:t,rendererSettings:e},{signal:i}),this.container=null,this.layer=null,this.type="rasterAnimatedFlow",this.redrawOrRefetch=async()=>{this._rendererChanged()}}get updating(){return!this._strategy||this._strategy.updating}update(e){e.stationary?this._strategy.update(e):this.layerView.requestUpdate()}install(e){this.container=new u,e.addChild(this.container),this._strategy=new S({flowContainer:this.container}),this._rendererChanged()}uninstall(){this._strategy.destroy(),this.container.removeAllChildren(),this.container.remove()}moveEnd(){}async doRefresh(){}attach(){}_rendererChanged(){if("animated-flow"!==this.layer.renderer.type)return;const e=new D(this._loadImagery,this._createStreamlinesMesh,this.layer.renderer);this.container.flowStyle=e,this.layerView.requestUpdate()}};Object(r["a"])([Object(n["b"])()],z.prototype,"_strategy",void 0),Object(r["a"])([Object(n["b"])()],z.prototype,"container",void 0),Object(r["a"])([Object(n["b"])()],z.prototype,"layer",void 0),Object(r["a"])([Object(n["b"])()],z.prototype,"layerView",void 0),Object(r["a"])([Object(n["b"])()],z.prototype,"type",void 0),Object(r["a"])([Object(n["b"])()],z.prototype,"updating",null),z=Object(r["a"])([Object(a["a"])("esri.views.2d.engine.flow.AnimatedFlowView2D")],z);const L=z}}]);
//# sourceMappingURL=chunk-54645729.180e0a58.js.map
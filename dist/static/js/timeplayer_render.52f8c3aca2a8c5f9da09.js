(window.webpackJsonp=window.webpackJsonp||[]).push([[55,17],{DjmO:function(t,e,r){"use strict";r.r(e);var n=r("EBC7"),s=r("M7pi"),i=r("70Dg"),a=r("XaGS"),c=r.n(a),a=r("zT9C"),o=r.n(a),a=r("wd/R"),p=r.n(a);function u(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)),n}function l(n){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach(function(t){var e,r;e=n,t=a[r=t],r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(a,t))})}return n}n={mixins:[n.default],data:function(){return{currentProps:o()(this.renderProps),timeParams:{lastIndex:0},playState:!1,eventList:[]}},computed:{currentDataCache:function(){var t=this.defaultParams.props.controledDatas;return this.$store.getters.getDataCache(t&&t[0])},getControlData:function(){var t=this.currentDataCache||{},e=t.dataInfo||{};return{start:e.start,end:e.end,step:e.step,timing:t.timing,currentProps:this.renderProps}},uuid:function(){for(var t in this.$store.getters.getAllDataCacheByHashId(this.component.componentId))return t;return null},triggers:function(){return this.$store.getters.getActionsByComponentId(this.component.componentId)}},watch:{getControlData:{handler:function(t,e){var r,n,a,o;c()(t,e)||(r=(a=this.getControlData).start,n=a.end,o=a.step,t=a.timing,a=a.currentProps,e=e&&e.timing,o=this.getData(r,n,o),e!==t&&t&&(this.timeParams.lastIndex=0<o.length?o.length-1:0),a=Object.assign({},a,{data:o,currentIndex:this.timeParams.lastIndex}),t=-1===(e=this.timeParams.lastIndex)?-1:e+1<=o.length?e+1:e,delete a.duration,this.currentProps=a,o=this.currentProps.data?parseInt(this.currentProps.data[e]+"000"):"",(a.controledDatas&&a.controledDatas.length||a.data&&a.data.length)&&this.timePlayer&&this.timePlayer.$emit("timeplayerchanged",{currentTimeStamp:o,lastIndex:e,nextIndex:t}))},deep:!0,immediate:!0},"currentProps.autoPlay":function(){this.playState=this.currentProps.autoPlay},"renderProps.formatter":{handler:function(t){var e=this.currentProps.data;this.currentProps.label=this.getLabel(e)},immediate:!0},"renderProps.data":{handler:function(t){var e=this.currentProps.data;this.currentProps.label=this.getLabel(e)},immediate:!0},triggers:{handler:function(t,e){this.handleTriggers(t),this.timePlayer&&this.timePlayer.$emit("timeplayerchanged",this.timeParams)},deep:!0}},methods:{timeFormatter:function(t,e,r,n){r=s.a.timestamp2Date(e||t[r]);return"auto"!==n&&p()(r,"YYYY-MM--DD HH:mm:ss").isValid()?p()(r,"YYYY-MM--DD HH:mm:ss").format(n):r},getLabel:function(r){var n=this,t=this.currentProps,a=t.formatter;return l({formatter:function(t,e){return n.timeFormatter(r,t,e,a)}},t.labelStyle||{})},timePlayerplaychanged:function(t){this.playState=t},getData:function(t,e,r){var n=[];if(t&&e&&r&&r.value)for(var a=s.a.getSecondsByStep(r),o=parseInt(t);o<=parseInt(e);)n.push(o),o+=a;return n},initTriggers:function(){var t=this;this.timePlayer=this.$refs.timePlayer,this.triggers&&this.handleTriggers(this.triggers),setTimeout(function(){return t.timePlayer.$emit("timeplayerchanged",t.timeParams)},3e3)},handleTriggers:function(e){var s=this;if(this.eventList.length&&this.timePlayer&&this.eventList.forEach(function(t){var e=t.eventName,t=t.listenerName;s[t]&&(s.timePlayer.$off(e,s[t]),s[t]=null)}),this.eventList=[],e&&this.timePlayer)for(var t in e)!function(a){var t=i.b[a].events||[],o=e[a];t.forEach(function(t){var e="handleTrigger".concat(t.replace(t[0],t[0].toUpperCase()));s[e]=function(r){var n=[];o.forEach(function(t){var e=i.b[a].callback(r,t,s);n.push(l({actionId:t.actionId},e))}),s.$store.dispatch("UPDATE_ACTION",{componentId:s.component.componentId,type:a,datas:n,status:"active"})},s.timePlayer.$on(t,s[e]),s.eventList.push({eventName:t,listenerName:e})})}(t)}}},r=r("KHd+"),n=Object(r.a)(n,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{style:t.background},[e(t.componentId,t._b({ref:"timePlayer",tag:"component",style:t.defaultParams.style,on:{timeplayerplaychanged:t.timePlayerplaychanged,"hook:mounted":t.initTriggers}},"component",t.currentProps,!1))],1)},[],!1,null,null,null);e.default=n.exports},EBC7:function(t,e,r){"use strict";r.r(e);var n=r("oCYn"),a=r("3Dh3"),o=r("zT9C"),s=r.n(o),o=r("XaGS"),i=r.n(o),c=r("GSdF"),p=r("FuRH"),o={props:{component:{type:Object,required:!0},defaultParams:{type:Object}},data:function(){return{componentId:null,renderProps:null}},computed:{background:function(){return-1!==this.excludeComponentsBackground.indexOf(this.component.componentType)?{}:Object(c.a)(this.component.propDatas)},subComponentList:function(){var t=this.$store.getters.components;return Object.values(t.mapSubComponent).map(function(t){return t.type})},excludeComponentsBackground:function(){return this.subComponentList.concat("Container")},mapsOnScreen:function(){return this.$store.getters.mapsOnScreen()},firstMapTarget:function(){return(this.$store.getters.mapsOnScreen()[0]||{}).value}},watch:{component:{handler:function(){var t=Object(a.d)(this.component.uri);this.componentId=n.default.component(t)?t:null},deep:!0,immediate:!0},"defaultParams.props":{handler:function(t,e){i()(t,e)||(this.renderProps=s()(this.defaultParams.props),-1===this.excludeComponentsBackground.indexOf(this.component.componentType)&&(this.renderProps.background=""),-1!==["LiquidFill","TimeRange"].indexOf(this.component.componentType)&&(this.renderProps.backgroundColor=this.renderProps.backgroundColorReplacer,delete this.renderProps.backgroundColorReplacer))},immediate:!0},mapsOnScreen:function(t,e){i()(t,e)||this.renderProps.mapTarget&&!p.a.$options.getMap(this.renderProps.mapTarget)&&(this.renderProps.mapTarget=this.firstMapTarget)}},created:function(){this.setDefaultMapTarget()},methods:{setDefaultMapTarget:function(){this.renderProps&&this.renderProps.hasOwnProperty("mapTarget")&&!this.renderProps.mapTarget&&(this.renderProps.mapTarget=this.getRelatedMapTarget())},getRelatedMapTarget:function(){var t=this.$store.getters,e=t.componentsOnScreen,r=t.gridLayout.content,t=t.activeComponentId;return Object(a.h)(e,r||[],t)}}},r=r("KHd+"),o=Object(r.a)(o,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{style:t.background},[e(t.componentId,t._b({tag:"component",style:t.defaultParams.style,attrs:{componentId:t.component.componentId}},"component",t.renderProps,!1))],1)},[],!1,null,null,null);e.default=o.exports}}]);
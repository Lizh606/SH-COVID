(window.webpackJsonp=window.webpackJsonp||[]).push([[53,17],{"4hvM":function(t,e,n){"use strict";n.r(e);var r=n("EBC7"),s=n("M7pi"),i=n("LQw+"),a=n("XaGS"),o=n.n(a),a=n("zT9C"),c=n.n(a),a=n("wd/R"),p=n.n(a);function u(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function d(r){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach(function(t){var e,n;e=r,t=a[n=t],n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(a,t))})}return r}r={mixins:[r.default],data:function(){return{currentProps:c()(this.renderProps),timeParams:{startValue:0,endValue:1},eventList:[]}},computed:{currentDataCache:function(){var t=this.renderProps.controledDatas;return this.$store.getters.getDataCache(t&&t[0])},getControlData:function(){var t=this.currentDataCache,t=t&&t.dataInfo||{};return{start:t.start,end:t.end,step:t.step,currentProps:this.renderProps}},triggers:function(){return this.$store.getters.getActionsByComponentId(this.component.componentId)}},watch:{getControlData:{handler:function(t,e){var n,r;o()(t,e)||(n=(r=this.getControlData).start,t=r.end,e=r.step,r=r.currentProps,r=Object.assign({},r,d({data:this.getData(n,t,e)},this.timeParams)),((this.currentProps=r).controledDatas&&r.controledDatas.length||r.data&&r.data.length)&&this.timeRange&&this.timeRange.$emit("datazoom",this.timeParams))},deep:!0,immediate:!0},triggers:{handler:function(t,e){this.handleTriggers(t),this.timeRange&&this.timeRange.$emit("datazoom",this.timeParams)},deep:!0},"renderProps.formatter":{handler:function(t){var e=this.currentProps.data,n=t||"auto",e=e.concat([]);"auto"!==n&&(e=e.map(function(t){return p()(t,"YYYY-MM-DD HH:mm:ss").isValid()?p()(t,"YYYY-MM-DD HH:mm:ss").format(n):t})),this.currentProps.data=e.map(function(t){return t.replace(" ","\n")})},immediate:!0}},methods:{dataZoomChanged:function(t){this.timeParams=t},getData:function(t,e,n){var r=[];if(t&&e&&n)for(var a=s.a.getSecondsByStep(n),o=parseInt(e);o>=parseInt(t);)r.unshift(s.a.timestamp2Date(o)),o-=a;return r},initTriggers:function(){var t=this;this.timeRange=this.$refs.timeRange,this.triggers&&this.handleTriggers(this.triggers),setTimeout(function(){return t.timeRange.$emit("datazoom",t.timeParams)},3e3)},handleTriggers:function(e){var s=this;if(this.eventList.length&&this.timeRange&&this.eventList.forEach(function(t){var e=t.eventName,t=t.listenerName;s[t]&&(s.timeRange.$off(e,s[t]),s[t]=null)}),this.eventList=[],e&&this.timeRange)for(var t in e)!function(a){var t=i.b[a].events||[],o=e[a];t.forEach(function(t){var e="handleTrigger".concat(t.replace(t[0],t[0].toUpperCase()));s[e]=function(n){var r=[];o.forEach(function(t){var e=i.b[a].callback(n,t,s);r.push(d({actionId:t.actionId},e))}),s.$store.dispatch("UPDATE_ACTION",{componentId:s.component.componentId,type:a,datas:r,status:"active"})},s.timeRange.$on(t,s[e]),s.eventList.push({eventName:t,listenerName:e})})}(t)}}},n=n("KHd+"),r=Object(n.a)(r,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{style:t.background},[e(t.componentId,t._b({ref:"timeRange",tag:"component",style:t.defaultParams.style,on:{datazoom:t.dataZoomChanged,"hook:mounted":t.initTriggers}},"component",t.currentProps,!1))],1)},[],!1,null,null,null);e.default=r.exports},EBC7:function(t,e,n){"use strict";n.r(e);var r=n("oCYn"),a=n("3Dh3"),o=n("zT9C"),s=n.n(o),o=n("XaGS"),i=n.n(o),c=n("GSdF"),p=n("FuRH"),o={props:{component:{type:Object,required:!0},defaultParams:{type:Object}},data:function(){return{componentId:null,renderProps:null}},computed:{background:function(){return-1!==this.excludeComponentsBackground.indexOf(this.component.componentType)?{}:Object(c.a)(this.component.propDatas)},subComponentList:function(){var t=this.$store.getters.components;return Object.values(t.mapSubComponent).map(function(t){return t.type})},excludeComponentsBackground:function(){return this.subComponentList.concat("Container")},mapsOnScreen:function(){return this.$store.getters.mapsOnScreen()},firstMapTarget:function(){return(this.$store.getters.mapsOnScreen()[0]||{}).value}},watch:{component:{handler:function(){var t=Object(a.d)(this.component.uri);this.componentId=r.default.component(t)?t:null},deep:!0,immediate:!0},"defaultParams.props":{handler:function(t,e){i()(t,e)||(this.renderProps=s()(this.defaultParams.props),-1===this.excludeComponentsBackground.indexOf(this.component.componentType)&&(this.renderProps.background=""),-1!==["LiquidFill","TimeRange"].indexOf(this.component.componentType)&&(this.renderProps.backgroundColor=this.renderProps.backgroundColorReplacer,delete this.renderProps.backgroundColorReplacer))},immediate:!0},mapsOnScreen:function(t,e){i()(t,e)||this.renderProps.mapTarget&&!p.a.$options.getMap(this.renderProps.mapTarget)&&(this.renderProps.mapTarget=this.firstMapTarget)}},created:function(){this.setDefaultMapTarget()},methods:{setDefaultMapTarget:function(){this.renderProps&&this.renderProps.hasOwnProperty("mapTarget")&&!this.renderProps.mapTarget&&(this.renderProps.mapTarget=this.getRelatedMapTarget())},getRelatedMapTarget:function(){var t=this.$store.getters,e=t.componentsOnScreen,n=t.gridLayout.content,t=t.activeComponentId;return Object(a.h)(e,n||[],t)}}},n=n("KHd+"),o=Object(n.a)(o,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{style:t.background},[e(t.componentId,t._b({tag:"component",style:t.defaultParams.style,attrs:{componentId:t.component.componentId}},"component",t.renderProps,!1))],1)},[],!1,null,null,null);e.default=o.exports}}]);
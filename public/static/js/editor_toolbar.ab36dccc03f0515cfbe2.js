(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"26Tb":function(t,e,o){"use strict";o("Vk72")},RXf9:function(t,e,o){"use strict";o.r(e);var a=o("QCDS"),i={props:{activeRootStyle:Object,isContainer:Boolean,dragEnable:{type:Boolean,default:!0},layoutEnable:{type:Boolean,default:!0},layerOrderEnable:{type:Boolean,default:!0},deleteEnable:{type:Boolean,default:!0},lockEnable:{type:Boolean,default:!0}},data:function(){return{isShow:!1,gap:10,layoutStyle:{},menuPlacement:void 0,layoutMenuVisible:!1,layerMenuVisible:!1}},computed:{component:function(){return this.$store.getters.getComponentsByID(this.activeComponentId)},activeGridName:function(){return this.$store.getters.activeGridName},activeComponentId:function(){return this.$store.getters.activeComponentId},isMobileWihCustom:function(){return"mobile"===this.$store.getters.mode&&"custom"===this.$store.getters.editMode},isDrillMapComponent:function(){return this.activeComponentId&&-1!==this.activeComponentId.indexOf("DrillMap")},isWebMapComponent:function(){return this.activeComponentId&&-1!==this.activeComponentId.indexOf("WebMap")},mapId:function(){if(this.isWebMapComponent)return this.component.propDatas.mapId;if(this.isDrillMapComponent){var t=this.component.propDatas.data||[];return t&&t[0]&&t[0].mapId}return!1},isIportalUrl:function(){if(this.isDrillMapComponent){var t=this.component.propDatas.data||[];return t&&t[0]&&t[0].serverUrl===Object(a.g)()}return!!this.isWebMapComponent&&this.component.propDatas.serverUrl===Object(a.g)()}},watch:{activeRootStyle:{handler:function(){this.rootPanel||(this.rootPanel=document.querySelector(".rootPanel")),this.setLayoutStyle()},immediate:!0},layoutMenuVisible:function(t){t&&(this.layerMenuVisible=!1)},layerMenuVisible:function(t){t&&(this.layoutMenuVisible=!1)}},mounted:function(){this.$parent.$el.addEventListener("keyup",this.handleDelKey)},beforeDestroy:function(){this.$parent.$el.removeEventListener("keyup",this.handleDelKey)},methods:{handleDelKey:function(t){46===t.keyCode&&this.handleDelete()},setLayoutStyle:function(){var t,e,o,a,i,n=this.activeRootStyle,s=n.left,l=n.top,r=n.width,c=n.height,n=this.gap;this.isContainer?(o="column",a=(e=this.isWebMapComponent||this.isDrillMapComponent?192:160)+n<(this.isMobileWihCustom?this.rootPanel.scrollHeight:this.rootPanel.offsetHeight)-l?0:c-e-n,i=r+n,this.rootPanel.offsetWidth-s-r<(t=32)+n&&(i=r-t-n,a?i-=25:c-e<n+25?(a=n,i-=25):a=n+25)):(o="row",i=(t=160)<=r||t<=s?r-t:0,a=-((e=32)+n),l<e+n&&(a=3*e<=c?(i?i-=n+25:i=n,n):c+n)),this.layoutStyle={width:"".concat(t,"px"),height:"".concat(e,"px"),flexDirection:o,top:"".concat(a,"px"),left:"".concat(i,"px")}},handleMenuVisible:function(t){t&&this.isContainer&&(t=this.$el.offsetWidth+this.gap,t=this.rootPanel.offsetWidth-this.activeRootStyle.width-this.activeRootStyle.left-t,this.menuPlacement=t<180?"bottomRight":"bottomLeft")},resetMenuVisible:function(){this.layoutMenuVisible=!1,this.layerMenuVisible=!1},handleLayoutType:function(t){t=t.key;this.layoutEnable&&this.$store.dispatch("CHANGE_GRID_LAYOUT",t)},handleLayerSort:function(t){t=t.key;this.layerOrderEnable&&this.$store.dispatch("CHANGE_GRID_INDEX",{name:this.activeGridName,type:t})},handleDelete:function(){var t=this;this.resetMenuVisible(),this.deleteEnable&&this.$confirm({title:this.$t("warning.wetherDeleteComponent"),okText:this.$t("setting.common.ok"),cancelText:this.$t("setting.common.cancel"),okButtonProps:{props:{size:"small"}},cancelButtonProps:{props:{size:"small"}},onOk:function(){t.$store.dispatch("DELETE_GRID_LAYOUT",{name:t.activeGridName,componentId:t.activeComponentId})}})},handleJumpToDataviz:function(){window.open(Object(a.f)(this.mapId))},handleCopyAndPasteGridLayout:function(){var e=this;this.resetMenuVisible(),this.$confirm({title:this.$t("warning.comfirmCopyTip"),okText:this.$t("setting.common.ok"),cancelText:this.$t("setting.common.cancel"),okButtonProps:{props:{size:"small"}},cancelButtonProps:{props:{size:"small"}},onOk:function(){var t=e.$store.getters.activeGridName;t&&e.$store.dispatch("COPY_SAME_GRIDLAYOUT",t)}})},toggleLockStatus:function(){this.resetMenuVisible(),this.$emit("lockchanged",!this.lockEnable)}}},o=(o("26Tb"),o("KHd+")),i=Object(o.a)(i,function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"sm-setting-toolbar",style:e.layoutStyle},[e.isWebMapComponent||e.isDrillMapComponent?t("span",{staticClass:"sm-setting-toolbar_nodrag",attrs:{title:e.lockEnable?e.$t("toolBar.lock"):e.$t("toolBar.unlock")},on:{click:e.toggleLockStatus}},[t("i",{class:e.lockEnable?"sm-mapdashboard-icon-lock":"sm-mapdashboard-icon-unlock"})]):e._e(),e._v(" "),t("span",{staticClass:"sm-setting-toolbar_item sm-setting-toolbar_move",attrs:{title:e.$t("toolBar.move")},on:{click:e.resetMenuVisible}},[t("i",{staticClass:"sm-mapdashboard-icon-move"})]),e._v(" "),t("sm-dropdown",{class:{"sm-setting-toolbar_item":!0,"sm-setting-toolbar_nodrag":!0,"sm-setting-toolbar_layout":e.isContainer,"sm-setting-toolbar_disable":!e.layoutEnable},attrs:{trigger:["click"],placement:e.menuPlacement,getPopupContainer:function(t){return t},overlayClassName:"sm-setting-toolbar_nodrag"},on:{visibleChange:e.handleMenuVisible},model:{value:e.layoutMenuVisible,callback:function(t){e.layoutMenuVisible=t},expression:"layoutMenuVisible"}},[t("span",{attrs:{title:e.$t("toolBar.layout")}},[t("i",{staticClass:"sm-mapdashboard-icon-quanping"})]),e._v(" "),t("sm-menu",{attrs:{slot:"overlay"},on:{click:e.handleLayoutType},slot:"overlay"},[t("sm-menu-item",{key:"WIDTH"},[t("i",{staticClass:"sm-mapdashboard-icon-width"}),e._v("\n        "+e._s(e.$t("toolBar.spreadByWidth"))+"\n      ")]),e._v(" "),t("sm-menu-item",{key:"HEIGHT"},[t("i",{staticClass:"sm-mapdashboard-icon-height"}),e._v("\n        "+e._s(e.$t("toolBar.spreadByHeight"))+"\n      ")]),e._v(" "),t("sm-menu-item",{key:"FULL"},[t("i",{staticClass:"sm-mapdashboard-icon-max"}),e._v("\n        "+e._s(e.$t("toolBar.fullScreen"))+"\n      ")])],1)],1),e._v(" "),t("sm-dropdown",{class:{"sm-setting-toolbar_nodrag":!0,"sm-setting-toolbar_layer":e.isContainer,"sm-setting-toolbar_disable":!e.layerOrderEnable},attrs:{trigger:["click"],placement:e.menuPlacement,getPopupContainer:function(t){return t},overlayClassName:"sm-setting-toolbar_nodrag"},on:{visibleChange:e.handleMenuVisible},model:{value:e.layerMenuVisible,callback:function(t){e.layerMenuVisible=t},expression:"layerMenuVisible"}},[t("span",{attrs:{title:e.$t("toolBar.layerOrder")}},[t("i",{staticClass:"sm-mapdashboard-icon-tucengliebiao"})]),e._v(" "),t("sm-menu",{attrs:{slot:"overlay"},on:{click:e.handleLayerSort},slot:"overlay"},[t("sm-menu-item",{key:"TOP"},[t("i",{staticClass:"sm-mapdashboard-icon-zhiding"}),e._v("\n        "+e._s(e.$t("toolBar.setTop"))+"\n      ")]),e._v(" "),t("sm-menu-item",{key:"UP"},[t("i",{staticClass:"sm-mapdashboard-icon-shangyi"}),e._v("\n        "+e._s(e.$t("toolBar.moveTop"))+"\n      ")]),e._v(" "),t("sm-menu-item",{key:"DOWN"},[t("i",{staticClass:"sm-mapdashboard-icon-xiayiyiceng"}),e._v("\n        "+e._s(e.$t("toolBar.moveBottom"))+"\n      ")]),e._v(" "),t("sm-menu-item",{key:"BOTTOM"},[t("i",{staticClass:"sm-mapdashboard-icon-zhidi"}),e._v("\n        "+e._s(e.$t("toolBar.setBottom"))+"\n      ")])],1)],1),e._v(" "),e.mapId&&e.isIportalUrl?t("span",{staticClass:"sm-setting-toolbar_nodrag",attrs:{title:e.$t("toolBar.makeMapOnline")},on:{click:e.handleJumpToDataviz}},[t("i",{staticClass:"sm-mapdashboard-icon-edit"})]):e._e(),e._v(" "),e.activeComponentId.includes("DashboardSwitch")?e._e():t("span",{staticClass:"sm-setting-toolbar_nodrag",attrs:{title:e.$t("toolBar.copyAndPaste")},on:{click:e.handleCopyAndPasteGridLayout}},[t("i",{staticClass:"sm-mapdashboard-icon-copy"})]),e._v(" "),t("span",{class:["sm-setting-toolbar_nodrag",!e.deleteEnable&&"sm-setting-toolbar_disable"],attrs:{title:e.$t("toolBar.delete")},on:{click:e.handleDelete}},[t("i",{staticClass:"sm-mapdashboard-icon-delete"})])],1)},[],!1,null,"301722da",null);e.default=i.exports},Vk72:function(t,e,o){}}]);
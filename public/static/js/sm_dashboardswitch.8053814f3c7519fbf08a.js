(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{JweC:function(t,e,n){},ZQCr:function(t,e,n){"use strict";n("JweC")},uO9G:function(t,e,n){"use strict";n.r(e);var g=n("QCDS"),a=n("egfl"),o=n("MT78"),r=n.n(o),i=[{label:"themeG-W",title:"绿色渐变",themeStyle:{theme:"blackTheme",chart:{title:"#ffffff",body:["#9AEAF4","#3097AB","#1F717F","#165A65","#064049"],heighLight:"#A8CFFF",normal:[{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#F0FEFF"},{offset:1,color:"#9AEAF4"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#BAFAFF"},{offset:1,color:"#3097AB"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#C1FFFB"},{offset:1,color:"#1F717F"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#AAFAF9"},{offset:1,color:"#165A65"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#71E2E3"},{offset:1,color:"#064049"}])}],emphasis:{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#9BF1FF"},{offset:1,color:"#9BF1FF"}])}},text:"#ffffff",indicator:{title:"#ffffff",body:"#286069"},textList:{title:"#353535",body:"#3FB1E3"}}},{label:"themeB-W",title:"蓝色渐变",themeStyle:{theme:"blackTheme",chart:{title:"#ffffff",body:["#00CDF1","#338FFF","#1C55FF","#243BCC","#0C75FF"],heighLight:"#A8CFFF",normal:[{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#CDFFFD"},{offset:1,color:"#00CDF1"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#C2EBFF"},{offset:1,color:"#338FFF"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#B4DEFF"},{offset:1,color:"#1C55FF"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#C0DDFF"},{offset:1,color:"#243BCC"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#8AF5FD"},{offset:1,color:"#0C75FF"}])}],emphasis:{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#A8CFFF"},{offset:1,color:"#A8CFFF"}])}},text:"#ffffff",indicator:{title:"#ffffff",body:"#499BFF"},textList:{title:"#ffffff",body:"#286069"}}},{label:"themeR-Y",title:"橙红渐变",themeStyle:{theme:"blackTheme",chart:{title:"#ffffff",body:["#FF8417","#F05940","#BE3144","#882241","#770000"],heighLight:"#A8CFFF",normal:[{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#FFE97F"},{offset:1,color:"#FF8418"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#FDD163"},{offset:1,color:"#F05940"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#FF8484"},{offset:1,color:"#BE3144"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#FF7979"},{offset:1,color:"#882241"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#FF7948"},{offset:1,color:"#770000"}])}],emphasis:{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#FFFAE3"},{offset:1,color:"#FFFAE3"}])}},text:"#ffffff",indicator:{title:"#ffffff",body:"#BE3144"},textList:{title:"#ffffff",body:"#499BFF"}}},{label:"themeP-W",title:"紫色渐变",themeStyle:{theme:"blackTheme",chart:{title:"#ffffff",body:["#7B6CF5","#5432D3","#2F2AA4","#8B3B86","#9740B1"],heighLight:"#A8CFFF",normal:[{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#EFDBFF"},{offset:1,color:"#7B6CF6"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#D1A8FF"},{offset:1,color:"#5432D3"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#B7C3FF"},{offset:1,color:"#2F2AA4"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#E5D4E2"},{offset:1,color:"#8B3B86"}])},{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#F9D8FF"},{offset:1,color:"#9740B1"}])}],emphasis:{color:new r.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#BEB6FF"},{offset:1,color:"#BEB6FF"}])}},text:"#ffffff",indicator:{title:"#ffffff",body:"#7B6CF6"},textList:{title:"#ffffff",body:"#499BFF"}}},{label:"themeA",title:"经典黑色",themeStyle:{theme:"blackTheme",chart:{title:"#ffffff",body:["#15D1F2","#499BFF","#2C61FF","#243BCC","#67A9FF"],heighLight:"#A8CFFF"},text:"#ffffff",indicator:{title:"#ffffff",body:"#499BFF"},textList:{title:"#ffffff",body:"#ffffff"}}},{label:"themeB",title:"抹红黑色",themeStyle:{theme:"blackTheme",chart:{title:"#ffffff",body:["#E69D87","#759AA0","#DD6B66","#8EC1A8","#EEDD78"],heighLight:"#E9E9E9"},text:"#ffffff",indicator:{title:"#ffffff",body:"#DD6B66"},textList:{title:"#ffffff",body:"#499BFF"}}},{label:"themeC",title:"墨绿黑色",themeStyle:{theme:"blackTheme",chart:{title:"#ffffff",body:["#BCE4E9","#7AC2D0","#53A8B6","#2D808D","#F1FDFF"],heighLight:"#9BF1FF"},text:"#ffffff",indicator:{title:"#ffffff",body:"#2D808D"},textList:{title:"#ffffff",body:"#DD6B66"}}},{label:"themeD",title:"浅蓝黑色",themeStyle:{theme:"blackTheme",chart:{title:"#BBE7FF",body:["#00E9FF","#BBE7FF","#6AE5C1","#46ABFF","#363EFF"],heighLight:"#759CFF"},text:"#BBE7FF",indicator:{title:"#BBE7FF",body:"#3690FF"},textList:{title:"#ffffff",body:"#2D808D"}}},{label:"themeE",title:"浅灰黑色",themeStyle:{theme:"blackTheme",chart:{title:"#ffffff",body:["#D3DDE8","#BACBDB","#8894A0","#52606D","#F2F5F8"],heighLight:"#FFFFFF"},text:"#F2F5F8",indicator:{title:"#F2F5F8",body:"#BACBDB"},textList:{title:"#BBE7FF",body:"#3690FF"}}},{label:"themeF",title:"深紫黑色",themeStyle:{theme:"blackTheme",chart:{title:"#ffffff",body:["#7B6CF6","#5432D3","#241F92","#8B3B86","#E6A5FF"],heighLight:"#BEB6FF"},text:"#ffffff",indicator:{title:"#ffffff",body:"#7B6CF6"},textList:{title:"#F2F5F8",body:"#BACBDB"}}},{label:"themeG",title:"深蓝白色",themeStyle:{theme:"whiteTheme",chart:{title:"#353535",body:["#243BCC","#2C61FF","#499BFF","#15D1F2","#67A9FF"],heighLight:"#A8CFFF"},text:"#353535",indicator:{title:"#353535",body:"#499BFF"},textList:{title:"#ffffff",body:"#ffffff"}}},{label:"themeH",title:"浅青白色",themeStyle:{theme:"whiteTheme",chart:{title:"#353535",body:["#3FB1E3","#6CE6C1","#626C91","#A0A7E6","#97DEE8"],heighLight:"#83E4FF"},text:"#353535",indicator:{title:"#353535",body:"#3FB1E3"},textList:{title:"#353535",body:"#499BFF"}}},{label:"themeI",title:"深红白色",themeStyle:{theme:"whiteTheme",chart:{title:"#770000",body:["#F05940","#BE3144","#882241","#770000","#FF8418"],heighLight:"#FF9789"},text:"#770000",indicator:{title:"#770000",body:"#BE3144"},textList:{title:"#353535",body:"#3FB1E3"}}}],o=n("vDqi"),c=n.n(o),r=n("9csQ"),s=n.n(r),o=n("rn/G"),l=n.n(o);function f(e,t){var n,a=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)),a}function p(a){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?f(Object(o),!0).forEach(function(t){var e,n;e=a,t=o[n=t],n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):f(Object(o)).forEach(function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(o,t))})}return a}function d(t,e,n,a,o,r,i){try{var c=t[r](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(a,o)}function h(c){return function(){var t=this,i=arguments;return new Promise(function(e,n){var a=c.apply(t,i);function o(t){d(a,e,n,o,r,"next",t)}function r(t){d(a,e,n,o,r,"throw",t)}o(void 0)})}}function u(){return m.apply(this,arguments)}function m(){return(m=h(regeneratorRuntime.mark(function t(o){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={name:"",setting:{},components:[],gridLayout:{base:{},content:[]}},o.content="string"==typeof o.content?JSON.parse(o.content):o.content,r.name=o.name,r.setting=(n=o.content.baseSetting,void 0,(a={theme:{},background:""}).theme=function(t,e){e={title:"",label:"",textColor:"",background:e,colorGroup:[]},t=function(t,e){for(var n=0;n<t.length;n++)if(t[n].label===e)return t[n];return{}}(i,t);return e.title=t.title,e.label=t.themeStyle.theme.replace(/Theme/,""),e.textColor=t.themeStyle.text,e.colorGroup=t.themeStyle.chart.body,e}(n.themeId,n.widgetBackground),a.background=n.background,a),r.gridLayout=(e=o.content,a=n=void 0,n={base:{},content:[]},a=e.baseSetting,e=e.components,n.base=function(t,e){return{width:parseInt(t.replace(/px/,"")),height:parseInt(e.replace(/px/,""))}}(a.width,a.height),n.content=function(t){var o=[];return t.forEach(function(t,e){var n=I(t),a={x:0,y:0,w:0,h:0,componentId:"components_0",children:"WebMap"===n.componentType?[]:null};a.x=parseInt(t.style.left.replace(/px/,"")),a.y=parseInt(t.style.top.replace(/px/,"")),a.w=parseInt(t.style.width.replace(/px/,"")),a.h=parseInt(t.style.height.replace(/px/,"")),t.id=s()(),a.componentId="components_".concat(n.componentType,"_").concat(t.id),o.push(a)}),o}(e),n),t.next=7,function(){return y.apply(this,arguments)}(o.content.components,o.content.baseSetting.widgetBackground,r);case 7:return r.components=t.sent,t.abrupt("return",r);case 9:case"end":return t.stop()}var e,n,a},t)}))).apply(this,arguments)}function y(){return(y=h(regeneratorRuntime.mark(function t(e,n,a){var o,r,i,c,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o=[],r=0;case 2:if(!(r<e.length)){t.next=20;break}if(i=e[r],c=I(i),s=c.componentType,l=void 0,"DashboardSwitch"===s)return t.next=10,b[s](i,a);t.next=13;break;case 10:l=t.sent,t.next=16;break;case 13:return t.next=15,b[s](i,c);case 15:l=t.sent;case 16:l&&(l.propDatas&&"Container"!==l.componentType&&(l.propDatas.background=n),o.push(l));case 17:r++,t.next=2;break;case 20:return t.abrupt("return",o);case 21:case"end":return t.stop()}},t)}))).apply(this,arguments)}var b={Indicator:function(t){return t=(e=t).field||[],{componentType:"Indicator",componentName:"指标",propDatas:{dataType:e.dataSource,title:e.title,titleField:"",unit:e.unit,unitField:"",num:e.num,numField:"static"===e.dataSource?"":t[t.length-1],textColor:"#fff",indicatorColor:e.fontColor,fontSize:e.fontSize.replace(/px/,""),separator:",",startTiming:!1,url:e.url,mode:"vertical",fontWeight:"bolder",frequency:2,duration:1e3},componentId:"components_Indicator_".concat(e.id),uri:"common/indicator/Indicator"};var e},Chart:function(t,e){var n,a=Object.assign({},t.option,{legend:function(t,e){t.show="close"!==e;return t}(t.option.legend,t.chartParam.legendPosition)}),o=!1;delete a.backgroundColor,delete a.color;var r="annular"===e.seriesType?"pie":e.seriesType,i=function(t){var e=(t.url+"").replace(/{LOCATION}/,Object(g.g)()),t={maxFeatures:"全部"===t.showDataNum?"":t.showDataNum,url:e.replace(/\/content.json/,""),name:t.dataName,type:"data"===t.dataSource?"iPortal":"",withCredentials:!0,preferContent:!0};"string"==typeof t.url&&-1<t.url.indexOf("../../../utils")&&(t=null);return t}(t.chartParam);if("Chart"===e.componentType){if(delete a.legend.textStyle,delete a.title.textStyle.color,"radar"===r?(delete a.radar.axisLine,delete a.radar.splitLine):(i&&delete a.xAxis.data,delete a.xAxis.axisLine,delete a.xAxis.splitLine,delete a.yAxis.axisLine,delete a.yAxis.splitLine),a.series){var c;o=!!t.defaultColor.normal,n=o?((c=t.defaultColor.normal).forEach(function(t,e){c[e]=p({},t.color)}),c):t.option.color;for(var s=0;s<a.series.length;s++)delete a.series[s].emphasis,delete a.series[s].itemStyle}"pie"!==r&&"radar"!==r||(delete a.xAxis,delete a.yAxis),"bar"!==r&&"line"!==r||!a.yAxis||(a.yAxis.splitArea={show:!1}),"xbar"===r&&a.xAxis&&(a.xAxis.splitArea={show:!1})}return{componentType:"Chart",componentName:F[r],propDatas:{colorGroup:n,seriesType:r,dataset:i||{maxFeatures:20,url:"",type:""},datasetOptions:function(t,e){for(var n=[],a=t.YAxisField,o=0;o<a.length;o++){var r={isStastic:!0,seriesType:"xbar"===e?"bar":e,xField:t.xAxisField,yField:a[o]};n.push(r)}-1!==["bar","line","xbar"].indexOf(e)&&1===n.length&&(n[0].sort=t.sortType);return n}(t.chartParam,e.seriesType),options:a,frequency:t.chartParam.frequency,headerName:null,iconClass:null,startTiming:t.chartParam.startTiming,textColor:"#fff",autoPlay:t.chartParam.autoPlay,isGradient:o},componentId:"components_Chart_".concat(t.id),uri:"mapboxgl/chart/Chart"}},Text:function(t){return{componentType:"Text",componentName:"文本",propDatas:{title:(t=t).title,textColor:t.color,fontStyle:{fontSize:t.fontSize.replace(/px/,""),lineHeight:parseInt(t.lineHeight.replace(/px/,"")),fontWeight:t.fontWeight,justifyContent:{center:"center",left:"flex-start",verticalCenter:"center",right:"flex-end"}[t.textAlign],textIndent:parseInt(t.textIndent.replace(/px/,"")),fontFamily:t.fontFamily}},componentId:"components_Text_".concat(t.id),uri:"common/text/Text"}},TextList:function(t){return{componentName:"TextList",propDatas:{textColor:(t=t).fontColor,fontSize:parseFloat(t.fontSize),content:t.textListParam.content,header:t.textListParam.headTitle,rows:t.textListParam.dataRows,fields:t.textListParam.dataColumn,autoRolling:-1!==["Detailed Rolling","逐条滚动"].indexOf(t.textListParam.refreshMethod),background:l()(t.listColor.contentBackgroundColor[0],"rgb"),colorGroup:[l()(t.listColor.headBackgroundColor,"rgb")]},componentId:"components_TextList_".concat(t.id),componentType:"TextList",uri:"mapboxgl/text-list/TextList"}},TimeText:function(t){return{componentName:"时间",propDatas:{fontStyle:{fontSize:(t=t).param.fontStyle.fontSize.replace(/px/,""),fontFamily:t.param.fontStyle.fontFamily},textColor:t.color,timeType:t.param.timeType.replace("data","date")},componentId:"components_TimeText_".concat(t.id),componentType:"TimeText",uri:"common/time-text/TimeText"}},WebMap:function(t){return function(){return x.apply(this,arguments)}(t)},Container:function(t){return e=t.attr,n=e.backgroundColor,a=e.colorType,e=e.directions,{componentType:"Container",componentName:"容器",uri:"Container",propDatas:{type:"Container",background:n,isGradient:"gradient"===a,gradientDirection:e,border:{type:""}},componentId:"components_Container_".concat(t.id)};var e,n,a},Image:function(t){return{componentName:"图片",propDatas:{background:"rgba(0,0,0,0)",src:t.imageSrc,repeat:"noRepeat"},componentId:"components_Image_".concat(t.id),componentType:"Image",uri:"common/image/Image"}},DashboardSwitch:function(t,e){var o=[];o.push({appId:1,name:e.name,thumbImg:t.attr.imageSrc,url:""}),t.attr.changeMD&&t.attr.changeMD.forEach(function(t){var e=t.dataId,n=t.imageSrc,a=t.label,t=t.value;o.push({appId:e,thumbImg:n,name:a,config:t,url:""})});return{componentType:"DashboardSwitch",componentName:"DashboardSwitch",componentId:"components_DashboardSwitch_".concat(t.id),propDatas:{templates:o},uri:"DashboardSwitch"}},Scene:function(t){return n=(e=t).sceneUrl,a=t.positopn,o=t.scanEffect,r=t.title,e=t.id,{componentName:"场景",propDatas:{sceneUrl:n,options:{position:a,scanEffect:{status:o.status,type:o.type,centerPostion:o.centerPostion,period:o._period,speed:o.speed}},name:r},componentId:"components_Scene_".concat(e),componentType:"WebScene",uri:"mapboxgl/web-scene/WebScene"};var e,n,a,o,r}};var F={pie:"环形图",bar:"柱状图",xbar:"条形图",line:"折线图",radar:"雷达图"};function x(){return(x=h(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.mapId,t.t0)return t.next=4,function(t,e,n){e=t+"/web/maps/"+e+"/map.json";return c.a.get(e).then(function(t){return"EPSG:3857"===t.data.projection?function(t){for(var e=180/Math.PI,n=Math.exp(-t[1]/6378137),a=Math.PI/2-2*Math.atan(n),o=0,r=.1;o<15&&1e-7<Math.abs(r);o++)r=Math.PI/2-2*Math.atan(+n)-a,a+=r;return[t[0]*e/6378137,a*e]}(n):n}).catch(function(t){return t})}(Object(g.g)(),e.mapId,e.center);t.next=5;break;case 4:t.t0=t.sent;case 5:return n=t.t0,n={componentName:"地图",propDatas:{mapId:e.mapId,name:e.title,serverUrl:Object(g.g)(),target:"map",withCredentials:!0,zoomControl:{show:!1,position:"top-left",showZoomSlider:!1},scaleControl:{show:e.scaleLine,position:"bottom-left"},panControl:{show:!1,position:"top-left"},miniMapControl:{show:e.overviewMap,position:"bottom-right",collapsed:!0},layerListControl:{show:!1,position:"top-right",collapsed:!0},measureControl:{show:!1,position:"top-right",showUnitSelect:!0,distanceDefaultUnit:"kilometers",areaDefaultUnit:"kilometers",collapsed:!0},legendControl:{show:!1,position:"bottom-left",headerName:"",layerNames:[],isShowTitle:!1,isShowField:!1,mode:"simple",collapsed:!0},queryControl:{show:!1,position:"top-right",collapsed:!0,restMap:null,restData:null,iportalData:null,headerName:"查询",layerStyle:{line:{paint:{"line-width":3,"line-color":"#409eff","line-opacity":1}},circle:{paint:{"circle-color":"#409eff","circle-opacity":.6,"circle-radius":8,"circle-stroke-width":2,"circle-stroke-color":"#409eff","circle-stroke-opacity":1}},fill:{paint:{"fill-color":"#409eff","fill-opacity":.6,"fill-outline-color":"#409eff"}},stokeLine:{paint:{"line-width":3,"line-color":"#409eff","line-opacity":1}}}},searchControl:{show:!1,position:"top-right",maxFeatures:8,layerNames:null,addressMatch:null,restMap:null,restData:null,iportalData:null,onlineLocalSearch:{enable:!0,city:"北京市"},collapsed:!0},mapOptions:{center:n,zoom:e.zoom}},componentId:"components_WebMap_".concat(e.id),children:[],componentType:"WebMap",uri:"mapboxgl/web-map/WebMap"},t.abrupt("return",n);case 8:case"end":return t.stop()}},t)}))).apply(this,arguments)}function I(t){return t.chartType?"annular"===t.chartType?{componentType:"Chart",seriesType:"pie"}:{componentType:"Chart",seriesType:t.chartType}:"Text"===t.type&&"commonChar"===t.nls?{componentType:"Text"}:"time"===t.nls?{componentType:"TimeText"}:"BackgroundBlock"===t.type||"BackgroundBlock"===t.type?{componentType:"Container"}:"Map"===t.type?{componentType:"WebMap"}:"LargeScreenSwitch"===t.type?{componentType:"DashboardSwitch"}:{componentType:t.type}}var S=n("3Dh3"),D=n("wyqS"),r=n("tpcZ"),T=n.n(r);function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(e,t){var n,a=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)),a}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach(function(t){E(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function E(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var O=["searchControl","queryControl","layers"],L=["NcpMap","WebMap","Search","Query","Chart","Progress","LiquidFill","Text","TextList","Indicator"];function B(t,a){var o,e=t.version,p=t.components,n=t.gridLayout,r=t.setting,d=t.datas,i=w({},t);e&&!T.a.compare("".concat(e),"2.1.1","<")||(o=t.datas||{},a=a||"self",!t.datas&&Array.isArray(p)&&(p=p.map(function(t){var e=t.propDatas,n=t.componentType;return-1!==L.indexOf(n)&&("WebMap"===n&&Object(D.f)(e),(e=function(t){var e,n=Object.keys(t);if(-1!==n.indexOf("restMap")||-1!==n.indexOf("restData")||-1!==n.indexOf("iportalData")||-1!==n.indexOf("addressMatch"))return N(t);if(-1!==n.indexOf("layers")||-1!==n.indexOf("searchControl")||-1!==n.indexOf("queryControl"))return function(n){var r=[];return["layers","searchControl","queryControl"].forEach(function(t){var o,e=n[t];e&&("layers"===t?e.map(function(t){var e=t.dataset,n=t.propDatas,a=t.type;e&&"{}"!==JSON.stringify(e)&&(o=M(e,n),n.maxFeatures=e.maxFeatures,n.attributeFilter=e.attributeFilter,r.push(o)),t.componentType=a,delete t.dataset}):(o=N(e),r=r.concat(o)))}),r}(t);-1!==n.indexOf("dataset")&&(e=t.dataset,t.dataset={maxFeatures:t.dataset.maxFeatures});-1!==n.indexOf("url")&&((e=JSON.parse(JSON.stringify(t))).type="rest");t=e&&M(e,t);return t?[t]:null}(e))&&(o=function(r,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"self";return t&&t.forEach(function(t){var e,n,a=r[t.hashId],o=t.dataInfo;o&&(t.MDIds=t.MDIds||[],t.MDIds.push(i),o.id||(o.id=t.hashId)),a?(e=!a.timing&&o.timing,n=!a.proxy&&o.proxy,e&&(a.timing=o.timing,a.frequency=o.frequency),n&&(a.proxy=o.proxy)):r[t.hashId]=t}),r}(o,e,a)),function(t){var n,e=t.componentType,a=t.propDatas;"WebMap"===e?(n={},O.forEach(function(e){a[e]&&("layers"===e?a[e].forEach(function(t){n[e+"_"+t.ref]=t.propDatas.dataIds||[],delete t.propDatas.dataIds}):(n[e]=a[e].dataIds||[],delete a[e].dataIds))})):(n=a.dataIds,delete a.dataIds);t.dataIds=n}(t)),t})),-1!==Object.keys(t.gridLayout).indexOf("base")&&(n={pc:t.gridLayout,pad:{mode:"auto",base:{width:0,height:0},content:[]},mobile:{mode:"auto",base:{width:0,height:0},content:[]}}),Array.isArray(t.components)&&(p={pc:t.components,pad:[],mobile:[]}),i=w(w({},t),{},{datas:o,gridLayout:n,components:p}));var c,n=r.background;if(r.theme&&!r.theme.style&&(r.theme.style="dark"),"string"==typeof n&&(i.setting.background={backgroundColor:n,backgroundGradient:!1,gradientDirection:"left",backgroundImage:"",backgroundRepeat:"noRepeat"}),!e||T.a.compare("".concat(e),"2.1.4","<")){var s,h=[],l=function(t){var e,n,r,a,i,c,s,l,f=p[t];f&&(e=P(f),a=P(f,["TimePlayer","TimeRange"]),n=A(e,"time"),t=A(a),r=function(a,o,r){var i,c={};for(i in r)"mapComponent"===r[i].type&&function(){var t,e=r[i].target,n=a.find(function(t){t=t.propDatas;return e===t.target});!n||(t=o.find(function(t){t=t.propDatas;return"customizeMap"===t.timeType&&n.propDatas.target===t.mapTarget}))&&(c[i]={dataId:i,mapComponentId:n.componentId,componentId:t.componentId})}();return c}(f,e,d),c=d,s={},l=[],f.forEach(function(t){var e=-1<t.componentType.indexOf("DataSwitcher"),n=-1<t.componentType.indexOf("TimeLine")&&"customize"===t.propDatas.timeType;if(e||n){var a,n=t.propDatas.options||t.propDatas.data,o=n&&n[0]&&(n[0].value||t.dataIds&&t.dataIds[0]);for(a in c)c[a].hashId!==t.componentId&&c[a].dataInfo.id!==t.componentId||(s[a]={dataId:o,componentId:t.componentId},l.push(a))}}),i=(a={dataSwitcher:s,delDatas:l}).dataSwitcher,h=h.concat(a.delDatas),i=w(w(w({},i),n),t),function(t){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"md-data-label";t.forEach(function(t){var t=t.actions,n=t&&t.dataSelection;n&&n.forEach(function(t,e){"label"===t.config.dataField&&(n[e].config.dataField=a),t.config.sourceData&&"label"===t.config.sourceData.field&&(n[e].config.sourceData.field=a)})})}(e),f.forEach(function(t){var e=t.componentType,n=t.dataIds,a=t.componentId;if(-1!==e.indexOf("Map"))for(var o in!function(o,r,i){var t,c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"";for(t in r)!function(t){var e=r[t],n=e.dataId,a=e.componentId,t=e.mapComponentId;o===t&&((t=(e=i.find(function(t){return t.componentId===a})).actions)&&t.dataSelection&&(e.actions.mapSelection=t.dataSelection,delete t.dataSelection),k(i,a,{targetId:o,sourceDataId:n,targetDataId:c,targetAction:"switchMap",triggerType:"mapSelection"}))}(t)}(a,r,f),n)n[o]=_(n[o],a,e,i,f,o);else _(n,a,e,i,f)}))};for(s in p)l(s);!function(t,e){for(var n in e)-1!==t.indexOf(n)&&delete e[n]}(h,d)}for(c in d){var f=d[c];if(f&&f.mapDatas)if(f.mapStatus)d[c].mapStatus=f.mapStatus.map(function(t){return{key:t.key,status:!1}});else{var u,f=f.mapDatas;for(u in d[c].mapStatus=[],f)d[c].mapStatus.push({key:u,status:!1})}}function m(e){var t=p[e],r={};t&&(t.forEach(function(t){-1<t.componentType.indexOf("Map")&&(r[t.propDatas.target]=t.componentId,y[e].push(t)),-1!==["TimeLine","TimeRange","TimePlayer","DataSwitcher"].indexOf(t.componentType)&&b[e].push(t)}),t.forEach(function(t){var e=t.componentType,n=t.propDatas,a=t.dataIds,o=t.actions;"Chart"===e&&n.associatedMap&&n.mapTarget&&(a={targetId:r[n.mapTarget],targetAction:"addToMap",config:{sourceData:{dataId:a&&a[0]},targetData:{dataId:a&&a[0]}}},t.actions=o||{featureSelection:[]},t.actions.featureSelection=t.actions.featureSelection||[],t.actions.featureSelection.push(a),delete n.associatedMap,delete n.mapTarget),-1!==e.indexOf("Map")&&o&&(t.actions=function(a){if(a){for(var t in a){t=function(n){if("boundsChange"===n){var t=a[n];return t&&t.map(function(t,e){"addToMap"===t.targetAction&&a[n].splice(e)}),{v:a}}}(t);if("object"===v(t))return t.v}return a}}(o))}),"pc"===e&&t.forEach(function(t){var e=t.componentType,n=t.propDatas;-1!==["WebMap","NcpMap"].indexOf(e)&&n.hasOwnProperty("controlComponents")&&((e=Object.keys(n.controlComponents)).length&&e.forEach(function(t){n[t]&&(n[t].show=!0)}),delete n.controlComponents)}))}var g,y={mobile:[],pc:[],pad:[]},b={mobile:[],pc:[],pad:[]};for(g in p)m(g);if(!e||T.a.compare("".concat(e),"2.1.5","<")){var F,x;for(F in b)!function(i){var n=b[i];n.forEach(function(t,e){t=(t.actions||{}).dataSelection;t&&(n[e].actions.dataSelection=t.map(function(t){var n,e=t.config||{},a=e.targetData,o=e.sourceData,r=a.dataId;return r&&-1!==r.indexOf("self_layers_")&&(t.config.targetData.dataId=r.replace("self_layers_",""),y[i]=y[i].map(function(t){var e=t.propDatas.layersIdField;return n=e[r],t.associateAction={dataId:r,sourceDataId:o&&o.dataId},t}),t.config.targetData.mergeField=n),t}))})}(F);for(x in y)y[x]=y[x].map(function(t){var e,n;return t.associateAction&&(e=(n=t.associateAction).dataId,n=n.sourceDataId,t.propDatas.layersIdField[e]="",t.dataIds[e]&&-1!==t.dataIds[e].indexOf(n)&&delete t.dataIds[e],delete t.associateAction),t})}return i.components=p,i}function A(t,n){var a={};return t.forEach(function(e){n&&e.propDatas.timeType!==n||e.propDatas.controledDatas.forEach(function(t){a[t]={dataId:t,componentId:e.componentId}})}),a}function k(t,e,n){var a=n.targetId,o=n.sourceDataId,r=n.targetDataId,i=n.targetAction,n=n.triggerType,n=void 0===n?"dataSelection":n,r={targetId:a,targetAction:void 0===i?"switchDataSource":i,config:{sourceData:{dataId:o},targetData:{dataId:r}}},t=t.find(function(t){return t.componentId===e});t.actions=t.actions||E({},n,[]),t.actions[n]=t.actions[n]||[],t.actions[n].push(r)}function _(a,o,t,r,i,e,n){var c=5<arguments.length&&void 0!==e?e:"",n=6<arguments.length&&void 0!==n?n:["TimeLine"];if(a&&"{}"!==JSON.stringify(r)&&-1===n.indexOf(t))return a&&a.forEach&&a.forEach(function(t,e){var n=r[t]||{},t=n.dataId,n=n.componentId;n&&(a.splice(e,1,t),"trackLayers"===c&&1!==e&&(e=i.find(function(t){return t.componentId===o}).propDatas.trackLayers[e],c=e&&e.ref),k(i,n,{targetId:o,sourceDataId:t,targetDataId:c}))}),a}function P(t,e){var n=1<arguments.length&&void 0!==e?e:["TimeLine"],a=[];return t.forEach(function(t){-1!==n.indexOf(t.componentType)&&a.push(t)}),a}function N(n){var a=[];return["restMap","restData","iportalData","addressMatch"].forEach(function(e){(n[e]||[]).forEach(function(t){a.push(M(t,n,e))})}),a}function M(t,e,n){var a,o,r,i,c,s,l,f,p,d,h,u,m;return"iPortal"===(n=t.type||n)&&(a=e,r=(d=t).url,o=d.type,i=d.id,c=d.name,s=d.dataItemServices,l=d.updateTime,f=d.withCredentials,p=d.epsgCode,m=d.proxy,u=a.startTiming,h=a.frequency,d=(i||r.substring(r.lastIndexOf("/")+1,r.length)).toString(),a.dataIds?a.dataIds.push(d):a.dataIds=[d],r=function(t,e){if(t&&e)return Object(g.k)(t,"/web/datas/",e)}(r,i||d),delete a.startTiming,delete a.frequency,a={dataInfo:{url:r,type:o,id:i,name:c,dataItemServices:s,updateTime:l,withCredentials:f,epsgCode:p},hashId:d,frequency:h,timing:u,proxy:Boolean(m)}),"rest"===n&&(a=j(t,e)),"iServer"===n&&(r=e,i=(o=t).url,c=o.type,s=o.name,l=o.withCredentials,f=o.proxy,p=o.dataName,d=o.layerName,h=o.epsgCode,u=r.startTiming,m=r.frequency,o=i+s,h={url:i,type:c,name:s,withCredentials:l,epsgCode:h},p&&(h.dataName=p),d&&(h.layerName=d),r.dataIds?r.dataIds.push(o):r.dataIds=[o],delete r.startTiming,delete r.frequency,a={dataInfo:h,hashId:o,frequency:m,timing:u,proxy:Boolean(f)}),a="addressMatch"===n?j(t,e,"addressMatch"):a}function j(t,e,n){var a,o=2<arguments.length&&void 0!==n?n:"rest",r=t.url,i=t.proxy,c=e.startTiming,n=e.frequency;return r&&(t=(a=r).lastIndexOf("/"),t="rest"===o?r.substring(t+1,r.length):"addressMatch",o={url:r,name:t,withCredentials:!1,type:o},e.dataIds?e.dataIds.push(a):e.dataIds=[a],a={dataInfo:o,hashId:a,frequency:n,timing:c,proxy:i}),delete e.url,delete e.startTiming,delete e.frequency,delete e.proxy,a}var o=n("QZgE"),r=n("wd/R"),G=n.n(r),R=n("M7pi"),o={name:"DashboardSwitch",mixins:[o.a],inheritAttrs:!1,props:{templates:{type:Array},currnetDashboardId:{type:[String,Number]},arrangement:{type:String,default:"horizontal"},timerSwitchType:{type:String},pollingTime:{type:Number},btnType:{type:String},fontStyle:{type:Object},colorStyle:{type:Object}},data:function(){return{templateIndex:0,appId:"",timer:null,bgSizeMap:{all:"100% 100%",contain:"contain",cover:"cover"}}},computed:{otherDashboardConfig:function(){return this.$store.getters.otherDashboardConfig},templateWithImg:function(){return this.templates.filter(function(t){return t.thumbImg})},templateNoImg:function(){return this.templates.filter(function(t){return!t.thumbImg})},getScreenIndex:function(){return this.$store.getters.getScreenIndex},isPreview:function(){return"preview"===this.$store.getters.getAction},dataCache:function(){return this.$store.getters.dataCache},createStyle:function(){return{"font-weight":this.fontStyle.fontWeight,"font-family":this.fontStyle.fontFamily,"font-size":this.fontStyle.fontSize,color:this.colorStyle.color,background:this.colorStyle.background,"border-color":this.colorStyle.borderColor}},activeStyle:function(){return{background:this.colorStyle.activeBackground,color:this.colorStyle.activeColor,"border-color":this.colorStyle.activeBorderColor}},btnWrapStyle:function(){return function(t){return{margin:"".concat(+t.yGap,"% 0 0 ").concat(+t.xGap,"%"),"text-align":"".concat(t.textAlign)}}}},created:function(){var e=this;this.$watch(function(){return{pollingTime:this.pollingTime,templates:this.templates,timerSwitchType:this.timerSwitchType}},function(t){"none"===t.timerSwitchType&&e.timer&&clearInterval(e.timer),e.isPreview&&("polling"===t.timerSwitchType?e.handlePollingDashboard():"timing"===t.timerSwitchType&&e.handleTimingDashboard())},{immediate:!0})},mounted:function(){window.DashboardSwtich={changePrevScreen:this.changePrevScreen.bind(this),changeNextScreen:this.changeNextScreen.bind(this)}},beforeDestroy:function(){this.timer&&clearInterval(this.timer),this.$store.dispatch("SET_SCREEN_INDEX",1),this.$store.dispatch("CLEAR_OTHER_TEMPLATE")},methods:{changePrevScreen:function(){var e=this,t=this.templateNoImg.findIndex(function(t){return t.appId===e.getScreenIndex}),t=Math.max(0,t);--t<0&&(t=this.templateNoImg.length-1),this.templateNoImg[t]&&this.changeScreen(this.templateNoImg[t])},changeNextScreen:function(){var e=this,t=this.templateNoImg.findIndex(function(t){return t.appId===e.getScreenIndex}),t=Math.max(0,t);++t>=this.templateNoImg.length&&(t=0),this.templateNoImg[t]&&this.changeScreen(this.templateNoImg[t])},changeScreen:function(n){var t,a=this;1===n.appId?this.$store.dispatch("SET_SCREEN_INDEX",1):(this.$store.dispatch("DEACTIVATE_GRID"),this.$store.dispatch("DEACTIVATE_COMPONENT"),(n.url||n.config)&&(this.otherDashboardConfig&&this.otherDashboardConfig[n.appId]?this.$store.dispatch("SET_SCREEN_INDEX",n.appId):n.config?Object(S.i)(n.config)?this.transformToTemplate(JSON.parse(n.config),n):(n.content=n.config,u(n).then(function(t){t=a.filterOtherDashboardSwitch(t),a.transformToTemplate(t,n)})):(t=n.url,Object(g.a)(t,{},"get",!0,!1).then(function(t){var e;t&&t.content&&(Object(S.i)(t.content)?(e=a.fixDataCacheSameUUID(t.content),e=a.filterOtherDashboardSwitch(e),a.transformToTemplate(e,n)):u(t).then(function(t){t=a.filterOtherDashboardSwitch(t),a.transformToTemplate(t,n)}))}))))},transformToTemplate:function(t,e){this.appId=e.appId,(t=B(t,this.appId)).gridLayout=Object(a.a)(t.gridLayout,this.GLOBAL.pixels),this.handleTemplateDataCache({template:t,appId:this.appId})},fixDataCacheSameUUID:function(t){var e=JSON.parse(t),n=Object.keys(e.datas),a=Object.keys(this.dataCache);if(a.length&&n.length){for(var o=0;o<a.length;o++)for(var r=0;r<n.length;r++)if(a[o]===n[r]){var i=R.a.uuid();t=t.replaceAll(n[r],i);break}return e=JSON.parse(t)}return e},initTemplate:function(t){t={components:t.components||[],gridLayout:t.gridLayout||{},background:t.setting.background,theme:t.setting.theme,gestureControl:t.setting.gestureControl,gestureControlVideoShow:t.setting.gestureControlVideoShow,name:t.name,tags:t.tags||[],description:t.description||"",maps:t.maps||[],tdtKey:t.tdtKey||"",version:t.version};this.$store.dispatch("ADD_OTHER_TEMPLATE",{template:t,index:this.appId}),this.$store.dispatch("SET_SCREEN_INDEX",this.appId),this.$store.dispatch("SET_MAP_KEEP_BOUNDS",{keepBounds:!0})},filterOtherDashboardSwitch:function(n){if(T.a.compare("".concat(n.version),"2.1.1","<")){var t=n.components.findIndex(function(t){return"DashboardSwitch"===t.componentType});-1!==t&&n.components.splice(t,1);t=n.gridLayout.content.findIndex(function(t){return-1!==t.componentId.indexOf("DashboardSwitch")});return-1!==t&&n.gridLayout.content.splice(t,1),n}return Object.keys(n.components).forEach(function(t){var e=n.components[t].findIndex(function(t){return"DashboardSwitch"===t.componentType});-1!==e&&n.components[t].splice(e,1)}),Object.keys(n.gridLayout).forEach(function(t){var e=n.gridLayout[t].content.findIndex(function(t){return-1!==t.componentId.indexOf("DashboardSwitch")});-1!==e&&n.gridLayout[t].content.splice(e,1)}),n},handlePollingDashboard:function(){var t=this;this.timer&&clearInterval(this.timer),this.templates.length<=1||0===this.pollingTime||(this.timer=setInterval(function(){1<=t.templates.length&&(t.templateIndex>=t.templates.length-1?t.templateIndex=0:t.templateIndex++,t.changeScreen(t.templates[t.templateIndex]))},1e3*this.pollingTime))},handleTimingDashboard:function(){var a,o=this;this.timer&&clearInterval(this.timer),this.timer=setInterval(function(){var t=G()().hour(),e=G()().minute(),n=G()().second(),t=o.concatTime(t),e=o.concatTime(e),n=o.concatTime(n);a="".concat(t,":").concat(e,":").concat(n);n=o.templates.find(function(t){return a===t.timing});n&&o.changeScreen(n)},1e3)},concatTime:function(t){return t<10?"".concat(t).padStart(2,"0"):t}}},n=(n("ZQCr"),n("KHd+")),o=Object(n.a)(o,function(){var n=this,t=n.$createElement,a=n._self._c||t;return a("div",{staticClass:"sm-dashboard-switch",style:{"flex-direction":"horizontal"===n.arrangement?"row":"column"}},[n._l(n.templates,function(e){return[e.thumbImg?a("a-card",{key:e.appId,staticClass:"sm-dashboard-switch__board",style:{display:"inline-block","vertical-align":"top",margin:+e.yGap+"% 0 0 "+ +e.xGap+"%"},on:{click:function(t){return n.changeScreen(e)}}},[a("div",{staticClass:"sm-dashboard-switch__image",style:{"background-image":n.getScreenIndex===e.appId&&e.selectThumbImg?"url("+e.selectThumbImg+")":"url("+e.thumbImg+")","background-size":n.bgSizeMap[e.imgSizeType]||"100% 100%","background-position":""+e.textAlign},attrs:{slot:"cover",title:e.name},slot:"cover"})]):a("div",{key:e.appId,staticClass:"sm-dashboard-switch__board",style:n.btnWrapStyle(e)},[a("button",{class:["dashboard-btn","dashboard-btn__"+n.btnType,n.getScreenIndex===e.appId?"dashboard-btn__active-"+n.btnType:""],style:[n.createStyle,n.getScreenIndex===e.appId?n.activeStyle:""],on:{click:function(t){return n.changeScreen(e)}}},[a("span",[n._v(n._s(e.name))])])])]})],2)},[],!1,null,null,null);e.default=o.exports}}]);
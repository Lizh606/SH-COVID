(window.webpackJsonp=window.webpackJsonp||[]).push([[52,17],{"+0mY":function(t,e,n){},"3TvT":function(t,e,n){"use strict";n.r(e);var r=n("EBC7"),a=n("GAzf"),o=n("l6bU"),i=n("vC+N"),d=n("2jOV"),f=n("4zwu"),s=n("XaGS"),l=n.n(s),s=n("9csQ"),c=n.n(s),s=n("zT9C"),m=n.n(s);function u(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function O(r){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach(function(t){var e,n;e=r,t=a[n=t],n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(a,t))})}return r}var p=["highlight","flyTo"],o={mixins:[r.default,a.a,o.a],data:function(){return{filterActionData:{},eventList:[],repeatOption:{center:{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain"},noRepeat:{backgroundSize:"100% 100%",backgroundRepeat:"no-repeat"},repeatX:{backgroundRepeat:"repeat-x",backgroundSize:"auto 100%"},repeatY:{backgroundRepeat:"repeat-Y",backgroundSize:"100% auto"},repeatXY:{backgroundRepeat:"repeat",backgroundSize:"auto"}}}},computed:{currentProps:function(){var t,e=this.renderProps,n=Object.assign({},e.dataset,this.getDatasetProps(e));for(t in e=Object.assign({},e,{dataset:n}),this.filterActionData)this.filterActionData[t]&&(e[t]&&e[t]instanceof Object?e[t]=Object.assign({},O({},e[t]),O({},this.filterActionData[t])):this.$set(e,t,this.filterActionData[t]));return e.background="",this.dealWithSlot(e),e},dataId:function(){return this.dataIds[0]},currentDataCache:function(){var t=this.$store.getters.getDataCache(this.dataId)||{};return Object.assign({},t,this.filterActionData.dataInfo||{})},triggers:function(){return this.$store.getters.getActionsByComponentId(this.component.componentId)},listeners:function(){var t=this.component.componentId;return this.$store.getters.getListensByComponentId(t)},resetTrigger:function(){return this.$store.getters.getResetActionByComponentId(this.component.componentId)},resetTriggerActionIds:function(){return this.resetTrigger.map(function(t){return t.actionId})},isClearHighlight:function(){var e=this;return!this.resetTrigger.some(function(t){return t.fromComponentId===e.component.componentId})},slotConfigs:function(){var e=[];return this.currentProps.columns.forEach(function(t){"text"!==t.slotConfig.type&&e.push({slotName:t.slots.customRender,slotConfig:t.slotConfig})}),e}},watch:{listeners:function(t,e){var n;t?t&&!l()(t,e)&&(n=this.getDatasetProps(),this.getActionsData(e,t,n&&n.geoJSON)):this.filterActionData={}},resetTriggerActionIds:{handler:function(t,e){t&&t.length&&!l()(t,e)&&this.reset()},immediate:!0},triggers:{handler:function(t){this.handleTriggers(t)},deep:!0}},methods:{getDatasetProps:function(t){return this.dataId?this.updateDataPropsHandler(t):{}},updateDataPropsHandler:function(){var t=this.getDatasetFeatures();return Object(i.j)(t)},getFeatures:function(t){var e=this.$store.getters.getDataCache(t),t=this.getFeatureId(t),t=e&&e.type&&-1!==e.type.indexOf("time")&&this.currentProps.filterCategoryValue?f.a.$options.getDataByCategory(e,[this.currentProps.filterCategoryValue],this.labelConfig)||{}:f.a.$options.getData(t)||{};return t.features.features},getDatasetFeatures:function(){var t;return this.currentDataCache&&this.currentDataCache.type&&-1!==this.currentDataCache.type.indexOf("time")?f.a.$options.getDataByCategory(this.currentDataCache).features:(t=this.currentDataCache.data,(f.a.$options.getData(t)||{}).features||[])},reset:function(){var e=this;this.triggerEvent=Array.from(new Set(this.triggerEvent)),this.triggerEvent.forEach(function(t){e.$store.dispatch("UPDATE_ACTION",{componentId:e.component.componentId,type:t,datas:[]})}),this.isClearHighlight&&this.clearHighlightOptions()},clearHighlightOptions:function(){this.$delete(this.filterActionData,"highlightOptions")},getTriggerDatas:function(n,t,r,a){var o,i=this,s=(n=n||{}).dataIndex,c=[],e=a&&a[s],u=f.a.$options.updateFeature(e,"".concat(this.component.componentId,"-").concat(r));return t.forEach(function(t){var e=Object.assign({},n.target,{dataIndex:s,features:a}),e=d.c[r].callback(O({},e),t,i);o=e.passingActionInfo,e&&("featureSelection"===r&&e.highlightOptions&&(i.oldHighlightOptions=m()(e.highlightOptions),delete e.highlightOptions.properties),i.$set(i.filterActionData,"highlightOptions",e.highlightOptions)),c.push({actionId:t.actionId,data:e&&e.data,featureId:-1!==p.indexOf(t.targetAction)&&u})}),{datas:c,passingActionInfo:o}},handleTriggers:function(n){var i=this;this.eventList.length&&this.eventList.forEach(function(t){var e=t.eventName,t=t.listenerName;i.$refs.textList.$off(e,i[t]),i[t]=null}),this.triggerEvent=[],this.eventList=[],this.$nextTick(function(){if(n&&Object.keys(n).length)for(var t in n)!function(a){var t=d.c[a].events||[],o=n[a],e=i.currentProps.dataset.geoJSON&&i.currentProps.dataset.geoJSON.features||[];i.triggerEvent.push(a),i.monitorEventLinkage(d.c,a,o,e,p),t.forEach(function(t){var e="handleTrigger".concat(t.replace(t[0],t[0].toUpperCase()));i[e]=function(t,e,n){var r=i.currentProps.dataset.geoJSON&&i.currentProps.dataset.geoJSON.features||[],t=i.getTriggerDatas({features:r,dataIndex:e,item:t},o,a,r),r=t.datas,t=t.passingActionInfo;i.$store.dispatch("UPDATE_ACTION",{componentId:i.component.componentId,type:a,status:"active",datas:r,passingActionInfo:t})},i.$refs.textList.$on(t,i[e]),i.eventList.push({eventName:t,listenerName:e})})}(t)})},getActionsData:function(u,t,p){var h=this,g={};return this.listeners&&this.listeners.find(function(t){return d.b[t.type].reset})&&(u&&u.find(function(t){return d.b[t.type].reset})||this.triggerEvent&&this.triggerEvent.forEach(function(t){h.$store.dispatch("UPDATE_ACTION",{componentId:h.component.componentId,type:t,status:"reset",datas:[]})})),t.forEach(function(t){var a,e,n=t.type,r=t.targetData,o=t.actionId,i=t.timestamp,s=t.blockEventLinkage,c=r&&r.dataId,r=u&&u.find(function(t){return t.actionId===o});r&&r.timestamp===i||s||(s=(Boolean(g.dataset&&g.dataset.geoJSON.features)?g.dataset.geoJSON:p||{}).features,t=d.b[t.type].callback(O(O({},t),{},{feature:f.a.$options.getData(t.featureId)}),s,h),"filter"===n&&!h.isFilterFirst&&h.oldHighlightOptions&&0<h.oldHighlightOptions.length&&(s=t.dataset&&t.dataset.geoJSON.features||[],a=[],s.forEach(function(n,r){h.oldHighlightOptions.forEach(function(t,e){t&&n&&l()(t.properties,n.properties)&&a.push(r)})}),t.highlightOptions=a),"highlight"===n&&(h.oldHighlightOptions=m()(t.highlightOptions),t.highlightOptions&&t.highlightOptions.length&&t.highlightOptions.forEach(function(t){delete t.properties}),t&&t.highlightOptions&&0<t.highlightOptions.length&&(e=[],t.highlightOptions.forEach(function(t){t.hasOwnProperty("dataIndex")&&e.push(t.dataIndex)}),t.highlightOptions=e)),g=Object.assign(g,t),h.emitEventLinkage(n,o,c,t))}),this.filterActionData=O(O({},this.filterActionData),g),this.filterActionData},dealWithSlot:function(t){var e=[].concat(t.columns);e.forEach(function(t){var e;"text"!==t.slotConfig.type&&(e=c()(),e=t.slotConfig.type+e,t.slots={customRender:e})}),t.columns=e}}},n=(n("LRCc"),n("KHd+")),o=Object(n.a)(o,function(){var r=this,t=r.$createElement,a=r._self._c||t;return a("div",{style:r.background},[a(r.componentId,r._b({ref:"textList",tag:"component",style:r.defaultParams.style,attrs:{componentId:r.component.componentId},on:{"hook:mounted":function(t){return r.handleTriggers(r.triggers)}},scopedSlots:r._u([r._l(r.slotConfigs,function(e,n){return{key:e.slotName,fn:function(t){t=t.text;return["link"===e.slotConfig.type?a("a",{key:n,staticClass:"textList_link",attrs:{title:e.slotConfig.linkTitle||t,href:t,target:e.slotConfig.linkTarget}},[r._v("\n        "+r._s(e.slotConfig.linkTitle||t)+"\n      ")]):a("div",{key:n,style:Object.assign({},{minWidth:"70%",height:"100%",backgroundImage:"url("+t+")"},r.repeatOption[e.slotConfig.imageRepeat])})]}}})],null,!0)},"component",r.currentProps,!1))],1)},[],!1,null,null,null);e.default=o.exports},EBC7:function(t,e,n){"use strict";n.r(e);var r=n("oCYn"),a=n("3Dh3"),o=n("zT9C"),i=n.n(o),o=n("XaGS"),s=n.n(o),c=n("GSdF"),u=n("FuRH"),o={props:{component:{type:Object,required:!0},defaultParams:{type:Object}},data:function(){return{componentId:null,renderProps:null}},computed:{background:function(){return-1!==this.excludeComponentsBackground.indexOf(this.component.componentType)?{}:Object(c.a)(this.component.propDatas)},subComponentList:function(){var t=this.$store.getters.components;return Object.values(t.mapSubComponent).map(function(t){return t.type})},excludeComponentsBackground:function(){return this.subComponentList.concat("Container")},mapsOnScreen:function(){return this.$store.getters.mapsOnScreen()},firstMapTarget:function(){return(this.$store.getters.mapsOnScreen()[0]||{}).value}},watch:{component:{handler:function(){var t=Object(a.d)(this.component.uri);this.componentId=r.default.component(t)?t:null},deep:!0,immediate:!0},"defaultParams.props":{handler:function(t,e){s()(t,e)||(this.renderProps=i()(this.defaultParams.props),-1===this.excludeComponentsBackground.indexOf(this.component.componentType)&&(this.renderProps.background=""),-1!==["LiquidFill","TimeRange"].indexOf(this.component.componentType)&&(this.renderProps.backgroundColor=this.renderProps.backgroundColorReplacer,delete this.renderProps.backgroundColorReplacer))},immediate:!0},mapsOnScreen:function(t,e){s()(t,e)||this.renderProps.mapTarget&&!u.a.$options.getMap(this.renderProps.mapTarget)&&(this.renderProps.mapTarget=this.firstMapTarget)}},created:function(){this.setDefaultMapTarget()},methods:{setDefaultMapTarget:function(){this.renderProps&&this.renderProps.hasOwnProperty("mapTarget")&&!this.renderProps.mapTarget&&(this.renderProps.mapTarget=this.getRelatedMapTarget())},getRelatedMapTarget:function(){var t=this.$store.getters,e=t.componentsOnScreen,n=t.gridLayout.content,t=t.activeComponentId;return Object(a.h)(e,n||[],t)}}},n=n("KHd+"),o=Object(n.a)(o,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{style:t.background},[e(t.componentId,t._b({tag:"component",style:t.defaultParams.style,attrs:{componentId:t.component.componentId}},"component",t.renderProps,!1))],1)},[],!1,null,null,null);e.default=o.exports},GAzf:function(t,e,n){"use strict";var r=n("4zwu"),a=n("FuRH"),o=n("3Dh3"),i=n("+NyJ");e.a={data:function(){return{listenMapLoad:!1}},computed:{dataIds:function(){return this.component.dataIds||[]},dataId:function(){return this.dataIds[0]},currentDataCache:function(){return this.$store.getters.getDataCache(this.dataId)},components:function(){return this.$store.getters.components},componentType:function(){return this.component.componentType},mapTarget:function(){return this.component.propDatas.mapTarget},currentProps:function(){var t,e;return"server"===(t=this.renderProps).dataType&&0<this.dataIds.length&&(e=this.getValueProps(t),Object.assign(t,e)),t},labelConfig:function(){return Object(i.f)(this.component.componentId,this.dataId)}},beforeCreate:function(){this.watcher=[]},mounted:function(){this.listenMapLoad&&a.a.$on("load-map",this.loadMapSucceed)},beforeDestroy:function(){this.listenMapLoad&&a.a.$off("load-map",this.loadMapSucceed)},methods:{cleanWatcher:function(){this.watcher.forEach(function(t){t()}),this.watcher=[]},loadMapSucceed:function(t,e){e===this.mapTarget&&this.loadMap(e)},loadMap:function(){},getValueProps:function(t){var e=this.getFeatureId(this.dataId),e=this.currentDataCache&&this.currentDataCache.type&&-1!==this.currentDataCache.type.indexOf("time")&&t.filterCategoryValue?r.a.$options.getDataByCategory(this.currentDataCache,[t.filterCategoryValue])||{}:r.a.$options.getData(e)||{};return this.updateDataPropsHandler(t,{features:e})},getValueByField:function(t,e){var n=this.currentDataCache&&this.currentDataCache.type&&-1!==this.currentDataCache.type.indexOf("time"),t=t&&t.features&&t.features.features,n=n?t&&t.length-1:0,e=t&&0<=n&&t[n]&&t[n].properties[e];return e||0===e?e.toString():""},hasField:function(t,e){return t&&t.features&&t.features.features[0]&&t.features.features[0].properties.hasOwnProperty(e)},getFeatureId:function(t){return Object(o.f)(this.$store.getters.getDataCache,t)}}}},LRCc:function(t,e,n){"use strict";n("+0mY")},Lb6U:function(t,e,n){"use strict";e.a={highlight:"featureSelection"}},l6bU:function(t,e,n){"use strict";var a=n("Lb6U"),f=n("4zwu"),r=n("zT9C"),l=n.n(r);function o(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function m(r){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach(function(t){var e,n;e=r,t=a[n=t],n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(a,t))})}return r}r={data:function(){return{}},methods:{monitorEventLinkage:function(n,r,a,o,i){var s=this,t="linkage-".concat(r);this.$off("actionEventLinkage".concat(r),this[t]),this[t]=function(t){var e;r===t.triggerType&&(t=(e=s._getEventLinkageData(t,a,n,r,o,i)).datas,e=e.passingActionInfo,s.$store.dispatch("UPDATE_ACTION",{componentId:s.component.componentId,type:r,status:"active",datas:t,passingActionInfo:e}))},this.$on("actionEventLinkage".concat(r),this[t])},emitEventLinkage:function(t,e,n,r){t=a.a[t];!t||4<arguments.length&&void 0!==arguments[4]&&!arguments[4]||(e=this.$store.getters.getPassingActionInfoByActionId(e,t),this.$emit("actionEventLinkage".concat(t),{triggerType:t,dataId:n,data:r,from:e}))},getUpdateCondition:function(t,e,n){var r=this.$store.getters.getTargetIdBySourceId(this.component.componentId,e.actionId,t,e.targetAction);return!(n&&r&&n.find(function(t){return t.componentId===r}))},_getEventLinkageData:function(o,i,s,c,u,p){for(var h,g=this,t=this.$store.getters.getTriggerEventByComponentIdAndType(this.component.componentId,c)||{},d=(d=l()(t.datas)||[]).map(function(t){return t.blockEventLinkage=!0,t}),e=0;e<i.length;e++)(function(t){var e=i[t];if(e.config.sourceData.dataId!==o.dataId)return;var n=s[c].callback({features:u,actionEventParams:o},e,g),r=f.a.$options.updateFeature(n.feature,"".concat(g.component.componentId,"-").concat(c)),a=g.getUpdateCondition(c,e,n.passingActionInfo);h=n.passingActionInfo,delete n.feature,delete n.passingActionInfo,delete n.highlightOptions,a&&(a=-1<(t=d.findIndex(function(t){return t.actionId===e.actionId}))?1:0,t=-1<t?t:0,r=m(m({actionId:e.actionId},n),{},{featureId:(!p||-1!==p.indexOf(e.targetAction))&&r}),d.splice(t,a,r))})(e);return{datas:d,passingActionInfo:h}}}},n=n("KHd+"),r=Object(n.a)(r,void 0,void 0,!1,null,null,null);e.a=r.exports}}]);
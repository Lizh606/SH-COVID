(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{xKWM:function(t,e){function Th(t){var e=r[t];if(void 0!==e)return e.exports;e=r[t]={exports:{}};return n[t].call(e.exports,e,e.exports,Th),e.exports}var n,r;n={937:function(v){!function(t){"use strict";var l,n,r,o,i;function a(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function s(t){return t="string"!=typeof t?String(t):t}function u(e){this.map={},e instanceof u?e.forEach(function(t,e){this.append(e,t)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function c(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function f(n){return new Promise(function(t,e){n.onload=function(){t(n.result)},n.onerror=function(){e(n.error)}})}function e(t){var e=new FileReader;return e.readAsArrayBuffer(t),f(e)}function h(){return this.bodyUsed=!1,this._initBody=function(t,e){if("string"==typeof(this._bodyInit=t))this._bodyText=t;else if(l&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t,this._options=e;else if(n&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(t){if(!r||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText=""},l?(this.blob=function(){var t=c(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(e)},this.text=function(){var t,e,n,r=c(this);if(r)return r;if(this._bodyBlob)return n=this._bodyBlob,e=this._options,t=new FileReader,r=e.headers.map["content-type"]?e.headers.map["content-type"].toString():"",e=n.type.match(e=/charset\=[0-9a-zA-Z\-\_]*;?/)||r.match(e),n=[n],e&&n.push(e[0].replace(/^charset\=/,"").replace(/;$/,"")),t.readAsText.apply(t,n),f(t);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){return c(this)||Promise.resolve(this._bodyText)},n&&(this.formData=function(){return this.text().then(y)}),this.json=function(){return this.text().then(JSON.parse)},this}function p(t,e){var n,r=(e=e||{}).body;if(p.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new u(t.headers)),this.method=t.method,this.mode=t.mode,r||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new u(e.headers)),this.method=(t=(n=e.method||this.method||"GET").toUpperCase(),-1<o.indexOf(t)?t:n),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r,e)}function y(t){var n=new FormData;return t.trim().split("&").forEach(function(t){var e;t&&(t=(e=t.split("=")).shift().replace(/\+/g," "),e=e.join("=").replace(/\+/g," "),n.append(decodeURIComponent(t),decodeURIComponent(e)))}),n}function d(t,e){this._initBody(t,e=e||{}),this.type="default",this.status=e.status,this.ok=200<=this.status&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof u?e.headers:new u(e.headers),this.url=e.url||""}!t.__disableNativeFetch&&t.fetch||(u.prototype.append=function(t,e){t=a(t),e=s(e);var n=this.map[t];n||(this.map[t]=n=[]),n.push(e)},u.prototype.delete=function(t){delete this.map[a(t)]},u.prototype.get=function(t){t=this.map[a(t)];return t?t[0]:null},u.prototype.getAll=function(t){return this.map[a(t)]||[]},u.prototype.has=function(t){return this.map.hasOwnProperty(a(t))},u.prototype.set=function(t,e){this.map[a(t)]=[s(e)]},u.prototype.forEach=function(n,r){Object.getOwnPropertyNames(this.map).forEach(function(e){this.map[e].forEach(function(t){n.call(r,t,e,this)},this)},this)},l="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),n="FormData"in t,r="ArrayBuffer"in t,o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],p.prototype.clone=function(){return new p(this)},h.call(p.prototype),h.call(d.prototype),d.prototype.clone=function(){return new d(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},d.error=function(){var t=new d(null,{status:0,statusText:""});return t.type="error",t},i=[301,302,303,307,308],d.redirect=function(t,e){if(-1===i.indexOf(e))throw new RangeError("Invalid status code");return new d(null,{status:e,headers:{location:t}})},t.Headers=u,t.Request=p,t.Response=d,t.fetch=function(n,s){return new Promise(function(r,o){var t=p.prototype.isPrototypeOf(n)&&!s?n:new p(n,s),i=new XMLHttpRequest,a=!1;function e(){if(4===i.readyState){var t=1223===i.status?204:i.status;if(t<100||599<t)return a?void 0:(a=!0,void o(new TypeError("Network request failed")));t={status:t,statusText:i.statusText,headers:(e=i,n=new u,e.getAllResponseHeaders().trim().split("\n").forEach(function(t){var e=t.trim().split(":"),t=e.shift().trim(),e=e.join(":").trim();n.append(t,e)}),n),url:"responseURL"in i?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):void 0},e="response"in i?i.response:i.responseText;a||(a=!0,r(new d(e,t)))}var e,n}i.onreadystatechange=e,i.onload=e,i.onerror=function(){a||(a=!0,o(new TypeError("Network request failed")))},i.open(t.method,t.url,!0);try{"include"===t.credentials&&("withCredentials"in i?i.withCredentials=!0:console&&console.warn&&console.warn("withCredentials is not supported, you can ignore this warning"))}catch(t){console&&console.warn&&console.warn("set withCredentials error:"+t)}"responseType"in i&&l&&(i.responseType="blob"),t.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.send(void 0===t._bodyInit?null:t._bodyInit)})},t.fetch.polyfill=!0,v.exports&&(v.exports=t.fetch))}("undefined"!=typeof self?self:this)},238:function(t,e){var n;void 0===(n="function"==typeof(n=function(t,e){"use strict";var n=5e3,r="callback";function f(e){try{delete window[e]}catch(t){window[e]=void 0}}function h(t){t=document.getElementById(t);t&&document.getElementsByTagName("head")[0].removeChild(t)}e.exports=function(i){var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=i,l=a.timeout||n,u=a.jsonpCallback||r,c=void 0;return new Promise(function(e,t){var n=a.jsonpCallbackFunction||"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),r=u+"_"+n;window[n]=function(t){e({ok:!0,json:function(){return Promise.resolve(t)}}),c&&clearTimeout(c),h(r),f(n)},s+=-1===s.indexOf("?")?"?":"&";var o=document.createElement("script");o.setAttribute("src",""+s+u+"="+n),a.charset&&o.setAttribute("charset",a.charset),o.id=r,document.getElementsByTagName("head")[0].appendChild(o),c=setTimeout(function(){t(new Error("JSONP request to "+i+" timed out")),f(n),h(r),window[n]=function(){f(n)}},l),o.onerror=function(){t(new Error("JSONP request to "+i+" failed")),f(n),h(r),c&&clearTimeout(c)}})}})?n.apply(e,[e,t]):n)||(t.exports=n)},957:function(t,e,h){var n;function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n=function(){"use strict";function t(e){var n=this.constructor;return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){return n.reject(t)})})}function e(n){return new this(function(o,t){if(!n||void 0===n.length)return t(new TypeError(p(n)+" "+n+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var i=Array.prototype.slice.call(n);if(0===i.length)return o([]);var a=i.length;for(var e=0;e<i.length;e++)!function e(n,t){if(t&&("object"===p(t)||"function"==typeof t)){var r=t.then;if("function"==typeof r)return r.call(t,function(t){e(n,t)},function(t){i[n]={status:"rejected",reason:t},0==--a&&o(i)}),0}i[n]={status:"fulfilled",value:t},0==--a&&o(i)}(e,i[e])})}var n=setTimeout;function l(t){return Boolean(t&&void 0!==t.length)}function o(){}function i(t){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(t,this)}function a(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var t,e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){try{t=e(n._value)}catch(t){return void u(r.promise,t)}s(r.promise,t)}else(1===n._state?s:u)(r.promise,n._value)})):n._deferreds.push(r)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===p(e)||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void f((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){u(t,e)}var r,o}function u(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&i._immediateFn(function(){t._handled||i._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function f(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,u(e,t))})}catch(t){if(n)return;n=!0,u(e,t)}}i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(r,t){var e=new this.constructor(o);return a(this,new function(t,e,n){this.onFulfilled="function"==typeof r?r:null,this.onRejected="function"==typeof e?e:null,this.promise=n}(0,t,e)),e},i.prototype.finally=t,i.all=function(e){return new i(function(o,i){if(!l(e))return i(new TypeError("Promise.all accepts an array"));var a=Array.prototype.slice.call(e);if(0===a.length)return o([]);var s=a.length;for(var t=0;t<a.length;t++)!function e(n,t){try{if(t&&("object"===p(t)||"function"==typeof t)){var r=t.then;if("function"==typeof r)return r.call(t,function(t){e(n,t)},i),0}a[n]=t,0==--s&&o(a)}catch(n){i(n)}}(t,a[t])})},i.allSettled=e,i.resolve=function(e){return e&&"object"===p(e)&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(n){return new i(function(t,e){e(n)})},i.race=function(o){return new i(function(t,e){if(!l(o))return e(new TypeError("Promise.race accepts an array"));for(var n=0,r=o.length;n<r;n++)i.resolve(o[n]).then(t,e)})},i._immediateFn="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){n(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==h.g)return h.g;throw new Error("unable to locate global object")}();"function"!=typeof r.Promise?r.Promise=i:r.Promise.prototype.finally?r.Promise.allSettled||(r.Promise.allSettled=e):r.Promise.prototype.finally=t},"object"===p(e)?n():void 0===(n="function"==typeof(n=n)?n.call(e,h,e,t):n)||(t.exports=n)}},r={},Th.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return Th.d(e,{a:e}),e},Th.d=function(t,e){for(var n in e)Th.o(e,n)&&!Th.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},Th.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),Th.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){"use strict";var c=window.SuperMap=window.SuperMap||{};c.Components=window.SuperMap.Components||{},c.inherit=function(t,e){function n(){}var r,o,i;for(n.prototype=e.prototype,t.prototype=new n,r=2,o=arguments.length;r<o;r++)"function"==typeof(i=arguments[r])&&(i=i.prototype),c.Util.extend(t.prototype,i)},c.mixin=function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];for(var n=function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);for(var n=0;n<r.length;n++)a(this,new r[n](t))},o=0;o<r.length;o++){var i=r[o];a(n,i),a(n.prototype,i.prototype),a(n.prototype,new i)}return n;function a(t,e){var n=Object.getOwnPropertyNames(e);Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(e)));for(var r=0;r<n.length;r++){var o,i=n[r];"constructor"!==i&&"prototype"!==i&&"name"!==i&&"length"!==i&&(o=Object.getOwnPropertyDescriptor(e,i),window.ActiveXObject?Object.defineProperty(t,i,o||{}):Object.defineProperty(t,i,o))}}};var a=c.String={startsWith:function(t,e){return 0==t.indexOf(e)},contains:function(t,e){return-1!=t.indexOf(e)},trim:function(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(t){for(var e=t.split("-"),n=e[0],r=1,o=e.length;r<o;r++){var i=e[r];n+=i.charAt(0).toUpperCase()+i.substring(1)}return n},format:function(t,i,a){return i=i||window,t.replace(c.String.tokenRegEx,function(t,e){for(var n,r=e.split(/\.+/),o=0;o<r.length;o++)n=(n=0==o?i:n)[r[o]];return void 0===(n="function"==typeof n?a?n.apply(null,a):n():n)?"undefined":n})},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(t){return c.String.numberRegEx.test(t)},numericIf:function(t){return c.String.isNumeric(t)?parseFloat(t):t}},e=c.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(t,e){var n=0;return n=0<e?parseFloat(t.toPrecision(e)):n},format:function(t,e,n,r){n=void 0!==n?n:c.Number.thousandsSeparator,r=void 0!==r?r:c.Number.decimalSeparator;t=(t=null!=(e=void 0!==e?e:0)?parseFloat(t.toFixed(e)):t).toString().split(".");1===t.length&&null==e&&(e=0);var o=t[0];if(n)for(var i=/(-?[0-9]+)([0-9]{3})/;i.test(o);)o=o.replace(i,"$1"+n+"$2");return 0==e?o:(t=1<t.length?t[1]:"0",null!=e&&(t+=new Array(e-t.length+1).join("0")),o+r+t)}};Number.prototype.limitSigDigs||(Number.prototype.limitSigDigs=function(t){return e.limitSigDigs(this,t)});var o=c.Function={bind:function(e,n){var r=Array.prototype.slice.apply(arguments,[2]);return function(){var t=r.concat(Array.prototype.slice.apply(arguments,[0]));return e.apply(n,t)}},bindAsEventListener:function(e,n){return function(t){return e.call(n,t||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}};function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}c.Array={filter:function(t,e,n){var r=[];if(Array.prototype.filter)r=t.filter(e,n);else{var o=t.length;if("function"!=typeof e)throw new TypeError;for(var i,a=0;a<o;a++)a in t&&(i=t[a],e.call(n,i,a,t)&&r.push(i))}return r}};var t,B=c.Util=c.Util||{};c.Util.extend=function(t,e){if(t=t||{},e){for(var n in e){var r=e[n];void 0!==r&&(t[n]=r)}"function"==typeof window.Event&&e instanceof window.Event||!e.hasOwnProperty||!e.hasOwnProperty("toString")||(t.toString=e.toString)}return t},c.Util.copy=function(t,e){var n;if(t=t||{},e)for(var r in t)void 0!==(n=e[r])&&(t[r]=n)},c.Util.reset=function(t){for(var e in t=t||{})if(t.hasOwnProperty(e)){if("object"===f(t[e])&&t[e]instanceof Array){for(var n in t[e])t[e][n].destroy&&t[e][n].destroy();t[e].length=0}else"object"===f(t[e])&&t[e]instanceof Object&&t[e].destroy&&t[e].destroy();t[e]=null}},c.Util.getElement=function(){for(var t=[],e=0,n=arguments.length;e<n;e++){var r=arguments[e];if("string"==typeof r&&(r=document.getElementById(r)),1===arguments.length)return r;t.push(r)}return t},c.Util.isElement=function(t){return!(!t||1!==t.nodeType)},c.Util.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},c.Util.removeItem=function(t,e){for(var n=t.length-1;0<=n;n--)t[n]===e&&t.splice(n,1);return t},c.Util.indexOf=function(t,e){if(null==t)return-1;if("function"==typeof t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},c.Util.modifyDOMElement=function(t,e,n,r,o,i,a,s){e&&(t.id=e),n&&(t.style.left=n.x+"px",t.style.top=n.y+"px"),r&&(t.style.width=r.w+"px",t.style.height=r.h+"px"),o&&(t.style.position=o),i&&(t.style.border=i),a&&(t.style.overflow=a),0<=parseFloat(s)&&parseFloat(s)<1?(t.style.filter="alpha(opacity="+100*s+")",t.style.opacity=s):1===parseFloat(s)&&(t.style.filter="",t.style.opacity="")},c.Util.applyDefaults=function(t,e){t=t||{};var n,r="function"==typeof window.Event&&e instanceof window.Event;for(n in e)(void 0===t[n]||!r&&e.hasOwnProperty&&e.hasOwnProperty(n)&&!t.hasOwnProperty(n))&&(t[n]=e[n]);return!r&&e&&e.hasOwnProperty&&e.hasOwnProperty("toString")&&!t.hasOwnProperty("toString")&&(t.toString=e.toString),t},c.Util.getParameterString=function(t){var e,n=[];for(e in t){var r=t[e];null!=r&&"function"!=typeof r&&(r=Array.isArray(r)||"[object Object]"===r.toString()?encodeURIComponent(JSON.stringify(r)):encodeURIComponent(r),n.push(encodeURIComponent(e)+"="+r))}return n.join("&")},c.Util.urlAppend=function(t,e){var n=t;return e&&(0===e.indexOf("?")&&(e=e.substring(1)),n+=" "===(t=(t+" ").split(/[?&]/)).pop()?e:t.length?"&"+e:"?"+e),n},c.Util.urlPathAppend=function(t,e){var n=t;if(!e)return n;0===e.indexOf("/")&&(e=e.substring(1));t=t.split("?");return t[0].indexOf("/",t[0].length-1)<0&&(t[0]+="/"),"".concat(t[0]).concat(e).concat(1<t.length?"?".concat(t[1]):"")},c.Util.DEFAULT_PRECISION=14,c.Util.toFloat=function(t,e){return null==e&&(e=c.Util.DEFAULT_PRECISION),"number"!=typeof t&&(t=parseFloat(t)),0===e?t:parseFloat(t.toPrecision(e))},c.Util.rad=function(t){return t*Math.PI/180},c.Util.getParameters=function(t){t=null==t?window.location.href:t;var e,n,r="";c.String.contains(t,"?")&&(e=t.indexOf("?")+1,n=c.String.contains(t,"#")?t.indexOf("#"):t.length,r=t.substring(e,n));for(var o={},i=r.split(/[&;]/),a=0,s=i.length;a<s;++a){var l=i[a].split("=");if(l[0]){var u=l[0];try{u=decodeURIComponent(u)}catch(t){u=unescape(u)}l=(l[1]||"").replace(/\+/g," ");try{l=decodeURIComponent(l)}catch(t){l=unescape(l)}1==(l=l.split(",")).length&&(l=l[0]),o[u]=l}}return o},c.Util.lastSeqID=0,c.Util.createUniqueID=function(t){return null==t&&(t="id_"),c.Util.lastSeqID+=1,t+c.Util.lastSeqID},c.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36},c.INCHES_PER_UNIT.in=c.INCHES_PER_UNIT.inches,c.INCHES_PER_UNIT.degrees=c.INCHES_PER_UNIT.dd,c.INCHES_PER_UNIT.nmi=1852*c.INCHES_PER_UNIT.m,c.METERS_PER_INCH=.0254000508001016,c.Util.extend(c.INCHES_PER_UNIT,{Inch:c.INCHES_PER_UNIT.inches,Meter:1/c.METERS_PER_INCH,Foot:.3048006096012192/c.METERS_PER_INCH,IFoot:.3048/c.METERS_PER_INCH,ClarkeFoot:.3047972651151/c.METERS_PER_INCH,SearsFoot:.30479947153867626/c.METERS_PER_INCH,GoldCoastFoot:.3047997101815088/c.METERS_PER_INCH,IInch:.0254/c.METERS_PER_INCH,MicroInch:254e-7/c.METERS_PER_INCH,Mil:2.54e-8/c.METERS_PER_INCH,Centimeter:.01/c.METERS_PER_INCH,Kilometer:1e3/c.METERS_PER_INCH,Yard:.9144018288036576/c.METERS_PER_INCH,SearsYard:.914398414616029/c.METERS_PER_INCH,IndianYard:.9143985307444408/c.METERS_PER_INCH,IndianYd37:.91439523/c.METERS_PER_INCH,IndianYd62:.9143988/c.METERS_PER_INCH,IndianYd75:.9143985/c.METERS_PER_INCH,IndianFoot:.30479951/c.METERS_PER_INCH,IndianFt37:.30479841/c.METERS_PER_INCH,IndianFt62:.3047996/c.METERS_PER_INCH,IndianFt75:.3047995/c.METERS_PER_INCH,Mile:1609.3472186944373/c.METERS_PER_INCH,IYard:.9144/c.METERS_PER_INCH,IMile:1609.344/c.METERS_PER_INCH,NautM:1852/c.METERS_PER_INCH,"Lat-66":110943.31648893273/c.METERS_PER_INCH,"Lat-83":110946.25736872235/c.METERS_PER_INCH,Decimeter:.1/c.METERS_PER_INCH,Millimeter:.001/c.METERS_PER_INCH,Dekameter:10/c.METERS_PER_INCH,Decameter:10/c.METERS_PER_INCH,Hectometer:100/c.METERS_PER_INCH,GermanMeter:1.0000135965/c.METERS_PER_INCH,CaGrid:.999738/c.METERS_PER_INCH,ClarkeChain:20.1166194976/c.METERS_PER_INCH,GunterChain:20.11684023368047/c.METERS_PER_INCH,BenoitChain:20.116782494375872/c.METERS_PER_INCH,SearsChain:20.11676512155/c.METERS_PER_INCH,ClarkeLink:.201166194976/c.METERS_PER_INCH,GunterLink:.2011684023368047/c.METERS_PER_INCH,BenoitLink:.20116782494375873/c.METERS_PER_INCH,SearsLink:.2011676512155/c.METERS_PER_INCH,Rod:5.02921005842012/c.METERS_PER_INCH,IntnlChain:20.1168/c.METERS_PER_INCH,IntnlLink:.201168/c.METERS_PER_INCH,Perch:5.02921005842012/c.METERS_PER_INCH,Pole:5.02921005842012/c.METERS_PER_INCH,Furlong:201.1684023368046/c.METERS_PER_INCH,Rood:3.778266898/c.METERS_PER_INCH,CapeFoot:.3047972615/c.METERS_PER_INCH,Brealey:375/c.METERS_PER_INCH,ModAmFt:.304812252984506/c.METERS_PER_INCH,Fathom:1.8288/c.METERS_PER_INCH,"NautM-UK":1853.184/c.METERS_PER_INCH,"50kilometers":5e4/c.METERS_PER_INCH,"150kilometers":15e4/c.METERS_PER_INCH}),c.Util.extend(c.INCHES_PER_UNIT,{mm:c.INCHES_PER_UNIT.Meter/1e3,cm:c.INCHES_PER_UNIT.Meter/100,dm:100*c.INCHES_PER_UNIT.Meter,km:1e3*c.INCHES_PER_UNIT.Meter,kmi:c.INCHES_PER_UNIT.nmi,fath:c.INCHES_PER_UNIT.Fathom,ch:c.INCHES_PER_UNIT.IntnlChain,link:c.INCHES_PER_UNIT.IntnlLink,"us-in":c.INCHES_PER_UNIT.inches,"us-ft":c.INCHES_PER_UNIT.Foot,"us-yd":c.INCHES_PER_UNIT.Yard,"us-ch":c.INCHES_PER_UNIT.GunterChain,"us-mi":c.INCHES_PER_UNIT.Mile,"ind-yd":c.INCHES_PER_UNIT.IndianYd37,"ind-ft":c.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/c.METERS_PER_INCH}),c.DOTS_PER_INCH=96,c.Util.normalizeScale=function(t){return 1<t?1/t:t},c.Util.getResolutionFromScale=function(t,e){var n;return t&&(null==e&&(e="degrees"),n=1/(c.Util.normalizeScale(t)*c.INCHES_PER_UNIT[e]*c.DOTS_PER_INCH)),n},c.Util.getScaleFromResolution=function(t,e){return t*c.INCHES_PER_UNIT[e=null==e?"degrees":e]*c.DOTS_PER_INCH},c.IS_GECKO=-1===(Za=navigator.userAgent.toLowerCase()).indexOf("webkit")&&-1!==Za.indexOf("gecko"),c.Browser=(St=yt="",ss="pc",-1<(R=navigator.userAgent.toLowerCase()).indexOf("msie")||-1<R.indexOf("trident")&&-1<R.indexOf("rv")?(yt="msie",t=R.match(/msie ([\d.]+)/)||R.match(/rv:([\d.]+)/)):-1<R.indexOf("chrome")?(yt="chrome",t=R.match(/chrome\/([\d.]+)/)):-1<R.indexOf("firefox")?(yt="firefox",t=R.match(/firefox\/([\d.]+)/)):-1<R.indexOf("opera")?(yt="opera",t=R.match(/version\/([\d.]+)/)):-1<R.indexOf("safari")&&(yt="safari",t=R.match(/version\/([\d.]+)/)),St=t?t[1]:"",-1<R.indexOf("ipad")||-1<R.indexOf("ipod")||-1<R.indexOf("iphone")?ss="apple":-1<R.indexOf("android")&&(St=(t=R.match(/version\/([\d.]+)/))?t[1]:"",ss="android"),{name:yt,version:St,device:ss}),c.Util.getBrowser=function(){return c.Browser},c.Util.isSupportCanvas=(ps=!0,cs=c.Util.getBrowser(),document.createElement("canvas").getContext?("firefox"===cs.name&&parseFloat(cs.version)<5&&(ps=!1),"safari"===cs.name&&parseFloat(cs.version)<4&&(ps=!1),"opera"===cs.name&&parseFloat(cs.version)<10&&(ps=!1),"msie"===cs.name&&parseFloat(cs.version)<9&&(ps=!1)):ps=!1,ps),c.Util.supportCanvas=function(){return c.Util.isSupportCanvas},c.INCHES_PER_UNIT.degree=c.INCHES_PER_UNIT.dd,c.INCHES_PER_UNIT.meter=c.INCHES_PER_UNIT.m,c.INCHES_PER_UNIT.foot=c.INCHES_PER_UNIT.ft,c.INCHES_PER_UNIT.inch=c.INCHES_PER_UNIT.inches,c.INCHES_PER_UNIT.mile=c.INCHES_PER_UNIT.mi,c.INCHES_PER_UNIT.kilometer=c.INCHES_PER_UNIT.km,c.INCHES_PER_UNIT.yard=c.INCHES_PER_UNIT.yd,c.Util.isInTheSameDomain=function(t){if(!t)return!0;var e=t.indexOf("//"),n=document.location.toString(),r=n.indexOf("//");if(-1===e)return!0;var o,i=o=t.substring(0,e),a=n.substring(r+2),r=a.indexOf("/"),n=a.indexOf(":"),a=a.substring(0,r),r=document.location.protocol;if(-1!==n||(a+=":"+("http:"===r.toLowerCase()?80:443)),r.toLowerCase()!==i.toLowerCase())return!1;var s,r=(i=t.substring(e+2)).indexOf(":"),e=i.indexOf("/"),t=i.substring(0,e);return-1!==r?s=i.substring(0,r):(s=i.substring(0,e),t+=":"+("http:"===o.toLowerCase()?80:443)),s===document.domain&&t===a},c.Util.calculateDpi=function(t,e,n,r,o){if(t&&e&&n){var i=t.getWidth(),a=t.getHeight(),t=e.w,e=e.h;return o=o||6378137,"degree"===(r=r||"degrees").toLowerCase()||"degrees"===r.toLowerCase()||"dd"===r.toLowerCase()?254/((a=a/e)<(e=i/t)?e:a)/n/(2*Math.PI*o/360)/1e4:254/(i/t)/n/1e4}},c.Util.toJSON=function(t){var e=t;if(null==e)return null;switch(e.constructor){case String:return(e=(e=(e=(e=(e=(e='"'+e.replace(/(["\\])/g,"\\$1")+'"').replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace("<","&lt;")).replace(">","&gt;")).replace(/%/g,"%25")).replace(/&/g,"%26");case Array:for(var n=[],r=0,o=e.length;r<o;r++)n.push(c.Util.toJSON(e[r]));return"["+n.join(",")+"]";case Number:return isFinite(e)?String(e):null;case Boolean:return String(e);case Date:return"{'__type':\"System.DateTime\",'Year':"+e.getFullYear()+",'Month':"+(e.getMonth()+1)+",'Day':"+e.getDate()+",'Hour':"+e.getHours()+",'Minute':"+e.getMinutes()+",'Second':"+e.getSeconds()+",'Millisecond':"+e.getMilliseconds()+",'TimezoneOffset':"+e.getTimezoneOffset()+"}";default:if(null!=e.toJSON&&"function"==typeof e.toJSON)return e.toJSON();if("object"!==f(e))return e.toString();if(e.length){for(var i=[],a=0,s=e.length;a<s;a++)i.push(c.Util.toJSON(e[a]));return"["+i.join(",")+"]"}var l,u=[];for(l in e)"function"!=typeof e[l]&&"CLASS_NAME"!==l&&"parent"!==l&&u.push("'"+l+"':"+c.Util.toJSON(e[l]));return 0<u.length?"{"+u.join(",")+"}":"{}"}},c.Util.getResolutionFromScaleDpi=function(t,e,n,r){return r=r||6378137,n=n||"",0<t&&0<e?(t=c.Util.normalizeScale(t),"degree"===n.toLowerCase()||"degrees"===n.toLowerCase()||"dd"===n.toLowerCase()?254/e/t/(2*Math.PI*r/360)/1e4:254/e/t/1e4):-1},c.Util.getScaleFromResolutionDpi=function(t,e,n,r){return r=r||6378137,n=n||"",0<t&&0<e?"degree"===n.toLowerCase()||"degrees"===n.toLowerCase()||"dd"===n.toLowerCase()?254/e/t/(2*Math.PI*r/360)/1e4:254/e/t/1e4:-1},c.Util.transformResult=function(t){return t=t.responseText&&"string"==typeof t.responseText?JSON.parse(t.responseText):t},c.Util.copyAttributes=function(t,e){if(t=t||{},e)for(var n in e){var r=e[n];void 0!==r&&"CLASS_NAME"!==n&&"function"!=typeof r&&(t[n]=r)}return t},c.Util.copyAttributesWithClip=function(t,e,n){if(t=t||{},e)for(var r in e){var o,i=!1;if(n&&n.length)for(var a=0,s=n.length;a<s;a++)if(r===n[a]){i=!0;break}!0===i||void 0!==(o=e[r])&&"CLASS_NAME"!==r&&"function"!=typeof o&&(t[r]=o)}return t},c.Util.cloneObject=function(t){if(null===t||"object"!==f(t))return t;if(t instanceof Date){var e=new Date;return e.setTime(t.getTime()),e}if(t instanceof Array)return t.slice(0);if(t instanceof Object){var n,r={};for(n in t)t.hasOwnProperty(n)&&(r[n]=c.Util.cloneObject(t[n]));return r}throw new Error("Unable to copy obj! Its type isn't supported.")},c.Util.lineIntersection=function(t,e,n,r){var o,i,a=(r.x-n.x)*(t.y-n.y)-(r.y-n.y)*(t.x-n.x),s=(e.x-t.x)*(t.y-n.y)-(e.y-t.y)*(t.x-n.x),l=(r.y-n.y)*(e.x-t.x)-(r.x-n.x)*(e.y-t.y);return 0!=l?(o=s/l,0<=(i=a/l)&&o<=1&&i<=1&&0<=o?new c.Geometry.Point(t.x+i*(e.x-t.x),t.y+i*(e.y-t.y)):"No Intersection"):0==a&&0==s?(i=Math.max(t.y,e.y),a=Math.min(t.y,e.y),s=Math.max(t.x,e.x),e=Math.min(t.x,e.x),(n.y>=a&&n.y<=i||r.y>=a&&r.y<=i)&&n.x>=e&&n.x<=s||r.x>=e&&r.x<=s?"Coincident":"Parallel"):"Parallel"},c.Util.getTextBounds=function(t,e,n){document.body.appendChild(n),n.style.width="auto",n.style.height="auto",t.fontSize&&(n.style.fontSize=t.fontSize),t.fontFamily&&(n.style.fontFamily=t.fontFamily),t.fontWeight&&(n.style.fontWeight=t.fontWeight),n.style.position="relative",n.style.visibility="hidden",n.style.display="inline-block",n.innerHTML=e;t=n.clientWidth,e=n.clientHeight;return document.body.removeChild(n),{textWidth:t,textHeight:e}};var s=c.DataFormat={GEOJSON:"GEOJSON",ISERVER:"ISERVER"},r=c.ServerType={ISERVER:"ISERVER",IPORTAL:"IPORTAL",ONLINE:"ONLINE"},x=c.GeometryType={LINE:"LINE",LINEM:"LINEM",POINT:"POINT",REGION:"REGION",POINTEPS:"POINTEPS",LINEEPS:"LINEEPS",REGIONEPS:"REGIONEPS",ELLIPSE:"ELLIPSE",CIRCLE:"CIRCLE",TEXT:"TEXT",RECTANGLE:"RECTANGLE",UNKNOWN:"UNKNOWN",GEOCOMPOUND:"GEOCOMPOUND"},n=c.QueryOption={ATTRIBUTE:"ATTRIBUTE",ATTRIBUTEANDGEOMETRY:"ATTRIBUTEANDGEOMETRY",GEOMETRY:"GEOMETRY"},l=(c.JoinType={INNERJOIN:"INNERJOIN",LEFTJOIN:"LEFTJOIN"},c.SpatialQueryMode={CONTAIN:"CONTAIN",CROSS:"CROSS",DISJOINT:"DISJOINT",IDENTITY:"IDENTITY",INTERSECT:"INTERSECT",NONE:"NONE",OVERLAP:"OVERLAP",TOUCH:"TOUCH",WITHIN:"WITHIN"}),h=(c.SpatialRelationType={CONTAIN:"CONTAIN",INTERSECT:"INTERSECT",WITHIN:"WITHIN"},c.MeasureMode={DISTANCE:"DISTANCE",AREA:"AREA"},c.Unit={METER:"METER",KILOMETER:"KILOMETER",MILE:"MILE",YARD:"YARD",DEGREE:"DEGREE",MILLIMETER:"MILLIMETER",CENTIMETER:"CENTIMETER",INCH:"INCH",DECIMETER:"DECIMETER",FOOT:"FOOT",SECOND:"SECOND",MINUTE:"MINUTE",RADIAN:"RADIAN"}),u=(c.BufferRadiusUnit={CENTIMETER:"CENTIMETER",DECIMETER:"DECIMETER",FOOT:"FOOT",INCH:"INCH",KILOMETER:"KILOMETER",METER:"METER",MILE:"MILE",MILLIMETER:"MILLIMETER",YARD:"YARD"},c.EngineType={IMAGEPLUGINS:"IMAGEPLUGINS",OGC:"OGC",ORACLEPLUS:"ORACLEPLUS",SDBPLUS:"SDBPLUS",SQLPLUS:"SQLPLUS",UDB:"UDB"},c.ThemeGraphTextFormat={CAPTION:"CAPTION",CAPTION_PERCENT:"CAPTION_PERCENT",CAPTION_VALUE:"CAPTION_VALUE",PERCENT:"PERCENT",VALUE:"VALUE"},c.ThemeGraphType={AREA:"AREA",BAR:"BAR",BAR3D:"BAR3D",LINE:"LINE",PIE:"PIE",PIE3D:"PIE3D",POINT:"POINT",RING:"RING",ROSE:"ROSE",ROSE3D:"ROSE3D",STACK_BAR:"STACK_BAR",STACK_BAR3D:"STACK_BAR3D",STEP:"STEP"},c.GraphAxesTextDisplayMode={ALL:"ALL",NONE:"NONE",YAXES:"YAXES"},c.GraduatedMode={CONSTANT:"CONSTANT",LOGARITHM:"LOGARITHM",SQUAREROOT:"SQUAREROOT"},c.RangeMode={CUSTOMINTERVAL:"CUSTOMINTERVAL",EQUALINTERVAL:"EQUALINTERVAL",LOGARITHM:"LOGARITHM",QUANTILE:"QUANTILE",SQUAREROOT:"SQUAREROOT",STDDEVIATION:"STDDEVIATION"},c.ThemeType={DOTDENSITY:"DOTDENSITY",GRADUATEDSYMBOL:"GRADUATEDSYMBOL",GRAPH:"GRAPH",LABEL:"LABEL",RANGE:"RANGE",UNIQUE:"UNIQUE"},c.ColorGradientType={BLACK_WHITE:"BLACKWHITE",BLUE_BLACK:"BLUEBLACK",BLUE_RED:"BLUERED",BLUE_WHITE:"BLUEWHITE",CYAN_BLACK:"CYANBLACK",CYAN_BLUE:"CYANBLUE",CYAN_GREEN:"CYANGREEN",CYAN_WHITE:"CYANWHITE",GREEN_BLACK:"GREENBLACK",GREEN_BLUE:"GREENBLUE",GREEN_ORANGE_VIOLET:"GREENORANGEVIOLET",GREEN_RED:"GREENRED",GREEN_WHITE:"GREENWHITE",PINK_BLACK:"PINKBLACK",PINK_BLUE:"PINKBLUE",PINK_RED:"PINKRED",PINK_WHITE:"PINKWHITE",RAIN_BOW:"RAINBOW",RED_BLACK:"REDBLACK",RED_WHITE:"REDWHITE",SPECTRUM:"SPECTRUM",TERRAIN:"TERRAIN",YELLOW_BLACK:"YELLOWBLACK",YELLOW_BLUE:"YELLOWBLUE",YELLOW_GREEN:"YELLOWGREEN",YELLOW_RED:"YELLOWRED",YELLOW_WHITE:"YELLOWWHITE"},c.TextAlignment={TOPLEFT:"TOPLEFT",TOPCENTER:"TOPCENTER",TOPRIGHT:"TOPRIGHT",BASELINELEFT:"BASELINELEFT",BASELINECENTER:"BASELINECENTER",BASELINERIGHT:"BASELINERIGHT",BOTTOMLEFT:"BOTTOMLEFT",BOTTOMCENTER:"BOTTOMCENTER",BOTTOMRIGHT:"BOTTOMRIGHT",MIDDLELEFT:"MIDDLELEFT",MIDDLECENTER:"MIDDLECENTER",MIDDLERIGHT:"MIDDLERIGHT"},c.FillGradientMode={NONE:"NONE",LINEAR:"LINEAR",RADIAL:"RADIAL",CONICAL:"CONICAL",SQUARE:"SQUARE"},c.AlongLineDirection={NORMAL:"ALONG_LINE_NORMAL",LB_TO_RT:"LEFT_BOTTOM_TO_RIGHT_TOP",LT_TO_RB:"LEFT_TOP_TO_RIGHT_BOTTOM",RB_TO_LT:"RIGHT_BOTTOM_TO_LEFT_TOP",RT_TO_LB:"RIGHT_TOP_TO_LEFT_BOTTOM"},c.LabelBackShape={DIAMOND:"DIAMOND",ELLIPSE:"ELLIPSE",MARKER:"MARKER",NONE:"NONE",RECT:"RECT",ROUNDRECT:"ROUNDRECT",TRIANGLE:"TRIANGLE"},c.LabelOverLengthMode={NEWLINE:"NEWLINE",NONE:"NONE",OMIT:"OMIT"},c.DirectionType={EAST:"EAST",NONE:"NONE",NORTH:"NORTH",SOURTH:"SOURTH",WEST:"WEST"},c.SideType={LEFT:"LEFT",MIDDLE:"MIDDLE",NONE:"NONE",RIGHT:"RIGHT"},c.SupplyCenterType={FIXEDCENTER:"FIXEDCENTER",NULL:"NULL",OPTIONALCENTER:"OPTIONALCENTER"},c.TurnType={AHEAD:"AHEAD",BACK:"BACK",END:"END",LEFT:"LEFT",NONE:"NONE",RIGHT:"RIGHT"},c.BufferEndType={FLAT:"FLAT",ROUND:"ROUND"},c.OverlayOperationType={CLIP:"CLIP",ERASE:"ERASE",IDENTITY:"IDENTITY",INTERSECT:"INTERSECT",UNION:"UNION",UPDATE:"UPDATE",XOR:"XOR"},c.OutputType={INDEXEDHDFS:"INDEXEDHDFS",UDB:"UDB",MONGODB:"MONGODB",PG:"PG"},c.SmoothMethod={BSPLINE:"BSPLINE",POLISH:"POLISH"},c.SurfaceAnalystMethod={ISOLINE:"ISOLINE",ISOREGION:"ISOREGION"},c.DataReturnMode={DATASET_AND_RECORDSET:"DATASET_AND_RECORDSET",DATASET_ONLY:"DATASET_ONLY",RECORDSET_ONLY:"RECORDSET_ONLY"},c.EditType={ADD:"add",UPDATE:"update",DELETE:"delete"}),i=(c.TransferTactic={LESS_TIME:"LESS_TIME",LESS_TRANSFER:"LESS_TRANSFER",LESS_WALK:"LESS_WALK",MIN_DISTANCE:"MIN_DISTANCE"},c.TransferPreference={BUS:"BUS",SUBWAY:"SUBWAY",NO_SUBWAY:"NO_SUBWAY",NONE:"NONE"},c.GridType={CROSS:"CROSS",GRID:"GRID",POINT:"POINT"},c.ColorSpaceType={CMYK:"CMYK",RGB:"RGB"},c.LayerType={UGC:"UGC",WMS:"WMS",WFS:"WFS",CUSTOM:"CUSTOM"},c.UGCLayerType={THEME:"THEME",VECTOR:"VECTOR",GRID:"GRID",IMAGE:"IMAGE"},c.StatisticMode={AVERAGE:"AVERAGE",MAX:"MAX",MIN:"MIN",STDDEVIATION:"STDDEVIATION",SUM:"SUM",VARIANCE:"VARIANCE"},c.PixelFormat={BIT16:"BIT16",BIT32:"BIT32",BIT64:"BIT64",SINGLE:"SINGLE",DOUBLE:"DOUBLE",UBIT1:"UBIT1",UBIT4:"UBIT4",UBIT8:"UBIT8",UBIT24:"UBIT24",UBIT32:"UBIT32"},c.SearchMode={KDTREE_FIXED_COUNT:"KDTREE_FIXED_COUNT",KDTREE_FIXED_RADIUS:"KDTREE_FIXED_RADIUS",NONE:"NONE",QUADTREE:"QUADTREE"},c.InterpolationAlgorithmType={KRIGING:"KRIGING",SimpleKriging:"SimpleKriging",UniversalKriging:"UniversalKriging"},c.VariogramMode={EXPONENTIAL:"EXPONENTIAL",GAUSSIAN:"GAUSSIAN",SPHERICAL:"SPHERICAL"},c.Exponent={EXP1:"EXP1",EXP2:"EXP2"},c.ClientType={IP:"IP",REFERER:"Referer",REQUESTIP:"RequestIP",NONE:"NONE",SERVER:"SERVER",WEB:"WEB"});function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.ChartType={BAR:"Bar",BAR3D:"Bar3D",CIRCLE:"Circle",PIE:"Pie",POINT:"Point",LINE:"Line",RING:"Ring"},c.ClipAnalystMode={CLIP:"clip",INTERSECT:"intersect"},c.AnalystAreaUnit={SQUAREMETER:"SquareMeter",SQUAREKILOMETER:"SquareKiloMeter",HECTARE:"Hectare",ARE:"Are",ACRE:"Acre",SQUAREFOOT:"SquareFoot",SQUAREYARD:"SquareYard",SQUAREMILE:"SquareMile"},c.AnalystSizeUnit={METER:"Meter",KILOMETER:"Kilometer",YARD:"Yard",FOOT:"Foot",MILE:"Mile"},c.StatisticAnalystMode={MAX:"max",MIN:"min",AVERAGE:"average",SUM:"sum",VARIANCE:"variance",STDDEVIATION:"stdDeviation"},c.SummaryType={SUMMARYMESH:"SUMMARYMESH",SUMMARYREGION:"SUMMARYREGION"},c.TopologyValidatorRule={REGIONNOOVERLAP:"REGIONNOOVERLAP",REGIONNOOVERLAPWITH:"REGIONNOOVERLAPWITH",REGIONCONTAINEDBYREGION:"REGIONCONTAINEDBYREGION",REGIONCOVEREDBYREGION:"REGIONCOVEREDBYREGION",LINENOOVERLAP:"LINENOOVERLAP",LINENOOVERLAPWITH:"LINENOOVERLAPWITH",POINTNOIDENTICAL:"POINTNOIDENTICAL"},c.BucketAggType={GEOHASH_GRID:"geohash_grid"},c.MetricsAggType={AVG:"avg",MAX:"max",MIN:"min",SUM:"sum"},c.GetFeatureMode={BOUNDS:"BOUNDS",BUFFER:"BUFFER",ID:"ID",SPATIAL:"SPATIAL",SQL:"SQL"},c.RasterFunctionType={NDVI:"NDVI",HILLSHADE:"HILLSHADE"},c.ResourceType={MAP:"MAP",SERVICE:"SERVICE",SCENE:"SCENE",DATA:"DATA",INSIGHTS_WORKSPACE:"INSIGHTS_WORKSPACE",MAP_DASHBOARD:"MAP_DASHBOARD"},c.OrderBy={UPDATETIME:"UPDATETIME",HEATLEVEL:"HEATLEVEL",RELEVANCE:"RELEVANCE"},c.OrderType={ASC:"ASC",DESC:"DESC"},c.SearchType={PUBLIC:"PUBLIC",MY_RES:"MY_RES",MYGROUP_RES:"MYGROUP_RES",MYDEPARTMENT_RES:"MYDEPARTMENT_RES",SHARETOME_RES:"SHARETOME_RES"},c.AggregationTypes={TAG:"TAG",TYPE:"TYPE"},c.PermissionType={SEARCH:"SEARCH",READ:"READ",READWRITE:"READWRITE",DELETE:"DELETE",DOWNLOAD:"DOWNLOAD"},c.EntityType={DEPARTMENT:"DEPARTMENT",GROUP:"GROUP",IPORTALGROUP:"IPORTALGROUP",ROLE:"ROLE",USER:"USER"},c.DataItemType={WORKSPACE:"WORKSPACE",UDB:"UDB",SHP:"SHP",EXCEL:"EXCEL",CSV:"CSV",GEOJSON:"GEOJSON",SMTILES:"SMTILES",SVTILES:"SVTILES",MBTILES:"MBTILES",TPK:"TPK",UGCV5:"UGCV5",UGCV5_MVT:"UGCV5_MVT",JSON:"JSON"},c.WebExportFormatType={PNG:"PNG",PDF:"PDF"},c.WebScaleOrientationType={HORIZONTALLABELSBELOW:"HORIZONTALLABELSBELOW",HORIZONTALLABELSABOVE:"HORIZONTALLABELSABOVE",VERTICALLABELSLEFT:"VERTICALLABELSLEFT",VERTICALLABELSRIGHT:"VERTICALLABELSRIGHT"},c.WebScaleType={LINE:"LINE",BAR:"BAR",BAR_SUB:"BAR_SUB"},c.WebScaleUnit={METER:"METER",FOOT:"FOOT",DEGREES:"DEGREES"};var y=(p(d.prototype,[{key:"toJSON",value:function(){return{name:this.name,serviceIds:this.serviceIds,clientType:this.clientType,limitation:this.limitation}}}]),d);function d(t){!function(t){if(!(t instanceof d))throw new TypeError("Cannot call a class as a function")}(this),this.name=null,this.serviceIds=null,this.clientType=i.SERVER,this.limitation=null,B.extend(this,t),this.CLASS_NAME="SuperMap.KeyServiceParameter"}c.KeyServiceParameter=y,Th(957),Th(937);var v=Th(238),g=Th.n(v),m=window.fetch,b=(c.setCORS=function(t){c.CORS=t},c.isCORS=function(){return null!=c.CORS?c.CORS:window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest}),S=(c.setRequestTimeout=function(t){return c.RequestTimeout=t},c.getRequestTimeout=function(){return c.RequestTimeout||45e3}),_=c.FetchRequest={commit:function(t,e,n,r){switch(t=t&&t.toUpperCase()){case"GET":return this.get(e,n,r);case"POST":return this.post(e,n,r);case"PUT":return this.put(e,n,r);case"DELETE":return this.delete(e,n,r);default:return this.get(e,n,r)}},supportDirectRequest:function(t,e){return!!B.isInTheSameDomain(t)||(null!=e.crossOrigin?e.crossOrigin:b()||e.proxy)},get:function(t,e,n){if(n=n||{},t=B.urlAppend(t,this._getParameterString(e||{})),t=this._processUrl(t,n),this.supportDirectRequest(t,n))return this.urlIsLong(t)?this._postSimulatie("GET",t.substring(0,t.indexOf("?")-1),e,n):this._fetch(t,e,n,"GET");e={url:t=t.replace(".json",".jsonp"),data:e};return c.Util.RequestJSONPPromise.GET(e)},delete:function(t,e,n){if(n=n||{},t=B.urlAppend(t,this._getParameterString(e||{})),t=this._processUrl(t,n),this.supportDirectRequest(t,n))return this.urlIsLong(t)?this._postSimulatie("DELETE",t.substring(0,t.indexOf("?")-1),e,n):this._fetch(t,e,n,"DELETE");t=t.replace(".json",".jsonp");e={url:t+="&_method=DELETE",data:e};return c.Util.RequestJSONPPromise.DELETE(e)},post:function(t,e,n){if(this.supportDirectRequest(t,n=n||{}))return this._fetch(this._processUrl(t,n),e,n,"POST");t=t.replace(".json",".jsonp");e={url:t+="&_method=POST",data:e};return c.Util.RequestJSONPPromise.POST(e)},put:function(t,e,n){if(t=this._processUrl(t,n=n||{}),this.supportDirectRequest(t,n))return this._fetch(t,e,n,"PUT");t=t.replace(".json",".jsonp");e={url:t+="&_method=PUT",data:e};return c.Util.RequestJSONPPromise.PUT(e)},urlIsLong:function(t){for(var e,n=0,r=0,o=t.length;r<o;r++)(e=t.charCodeAt(r))<127?n++:128<=e&&e<=2047?n+=2:2048<=e&&e<=65535&&(n+=3);return!(n<2e3)},_postSimulatie:function(t,e,n,r){return e+=(-1<e.indexOf("?")?"&":"?")+"_method="+t,"string"!=typeof n&&(n=JSON.stringify(n)),this.post(e,n,r)},_processUrl:function(t,e){return this._isMVTRequest(t)?t:(-1!==t.indexOf(".json")||e.withoutFormatSuffix||(t.indexOf("?")<0?t+=".json":2===(n=t.split("?")).length&&(t=n[0]+".json?"+n[1])),e&&e.proxy?"function"==typeof e.proxy?e.proxy(t):(t=decodeURIComponent(t),e.proxy+encodeURIComponent(t)):t);var n},_fetch:function(t,e,n,r){return(n=n||{}).headers=n.headers||{},n.headers["Content-Type"]||FormData.prototype.isPrototypeOf(e)||(n.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"),n.timeout?this._timeout(n.timeout,m(t,{method:r,headers:n.headers,body:"PUT"===r||"POST"===r?e:void 0,credentials:this._getWithCredentials(n),mode:"cors",timeout:S()}).then(function(t){return t})):m(t,{method:r,body:"PUT"===r||"POST"===r?e:void 0,headers:n.headers,credentials:this._getWithCredentials(n),mode:"cors",timeout:S()}).then(function(t){return t})},_getWithCredentials:function(t){return!0===t.withCredentials?"include":!1===t.withCredentials?"omit":"same-origin"},_fetchJsonp:function(t,e){return e=e||{},g()(t,{method:"GET",timeout:e.timeout}).then(function(t){return t})},_timeout:function(n,r){return new Promise(function(t,e){setTimeout(function(){e(new Error("timeout"))},n),r.then(t,e)})},_getParameterString:function(t){var e,n=[];for(e in t){var r=t[e];null!=r&&"function"!=typeof r&&(r=Array.isArray(r)||"[object Object]"===r.toString()?encodeURIComponent(JSON.stringify(r)):encodeURIComponent(r),n.push(encodeURIComponent(e)+"="+r))}return n.join("&")},_isMVTRequest:function(t){return-1<t.indexOf(".mvt")||-1<t.indexOf(".pbf")}};function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Util.RequestJSONPPromise={limitLength:1500,queryKeys:[],queryValues:[],supermap_callbacks:{},addQueryStrings:function(t){for(var e in t){this.queryKeys.push(e),"string"!=typeof t[e]&&(t[e]=c.Util.toJSON(t[e]));e=encodeURIComponent(t[e]);this.queryValues.push(e)}},issue:function(t){for(var n=this,r=n.getUid(),e=t.url,o=[],i=new Promise(function(e){n.supermap_callbacks[r]=function(t){delete n.supermap_callbacks[r],e(t)}}),a=e,s=0,l=n.queryKeys?n.queryKeys.length:0,u=0;u<l;u++)if(a.length+n.queryKeys[u].length+2>=n.limitLength){if(0==s)return!1;o.push(a),a=e,s=0,u--}else if(a.length+n.queryKeys[u].length+2+n.queryValues[u].length>n.limitLength)for(var c=n.queryValues[u];0<c.length;){var f=n.limitLength-a.length-n.queryKeys[u].length-2;-1<a.indexOf("?")?a+="&":a+="?";var h=c.substring(0,f);"%"===h.substring(f-1,f)?(--f,h=c.substring(0,f)):"%"===h.substring(f-2,f-1)&&(f-=2,h=c.substring(0,f)),a+=n.queryKeys[u]+"="+h,c=c.substring(f),0<h.length&&(o.push(a),a=e,s=0)}else s++,-1<a.indexOf("?")?a+="&":a+="?",a+=n.queryKeys[u]+"="+n.queryValues[u];return o.push(a),n.send(o,"SuperMap.Util.RequestJSONPPromise.supermap_callbacks["+r+"]",t&&t.proxy),i},getUid:function(){return 1e3*(new Date).getTime()+Math.floor(1e17*Math.random())},send:function(t,e,n){var r=t.length;if(0<r)for(var o=(new Date).getTime(),i=0;i<r;i++){var a=t[i];-1<a.indexOf("?")?a+="&":a+="?",a+="sectionCount="+r,a+="&sectionIndex="+i,a+="&jsonpUserID="+o,n&&(a=decodeURIComponent(a),a=n+encodeURIComponent(a)),g()(a,{jsonpCallbackFunction:e,timeout:3e4})}},GET:function(t){return this.queryKeys.length=0,this.queryValues.length=0,this.addQueryStrings(t.params),this.issue(t)},POST:function(t){return this.queryKeys.length=0,this.queryValues.length=0,this.addQueryStrings({requestEntity:t.data}),this.issue(t)},PUT:function(t){return this.queryKeys.length=0,this.queryValues.length=0,this.addQueryStrings({requestEntity:t.data}),this.issue(t)},DELETE:function(t){return this.queryKeys.length=0,this.queryValues.length=0,this.addQueryStrings({requestEntity:t.data}),this.issue(t)}};var O=(w(E.prototype,[{key:"getUrlParameters",value:function(){return this.name+"="+this.value}},{key:"getValue",value:function(){return this.value}},{key:"destroy",value:function(){this.value=null,this.name=null}}]),E);function E(t,e){!function(t){if(!(t instanceof E))throw new TypeError("Cannot call a class as a function")}(this),this.value=t||"",this.name=e||"token",this.CLASS_NAME="SuperMap.Credential"}function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}O.CREDENTIAL=null,c.Credential=O;var C=(Ga=k,Za=[{key:"generateToken",value:function(t,e){t=this.servers[t];if(t)return _.post(t.tokenServiceUrl,JSON.stringify(e.toJSON())).then(function(t){return t.text()})}},{key:"registerServers",value:function(t){this.servers=this.servers||{},B.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=t[e];this.servers[n.server]=n}}},{key:"registerToken",value:function(t,e){this.tokens=this.tokens||{},t&&e&&(t=this._getTokenStorageKey(t),this.tokens[t]=e)}},{key:"registerKey",value:function(t,e){if(this.keys=this.keys||{},t&&!(t.length<1)&&e){t=B.isArray(t)?t:[t];for(var n=0;n<t.length;n++){var r=this._getUrlRestString(t[0])||t[0];this.keys[r]=e}}}},{key:"getServerInfo",value:function(t){return this.servers=this.servers||{},this.servers[t]}},{key:"getToken",value:function(t){if(t){this.tokens=this.tokens||{};t=this._getTokenStorageKey(t);return this.tokens[t]}}},{key:"getKey",value:function(t){this.keys=this.keys||{};t=this._getUrlRestString(t)||t;return this.keys[t]}},{key:"loginiServer",value:function(t,e,n,r){t=B.urlPathAppend(t,"services/security/login");r={username:e&&e.toString(),password:n&&n.toString(),rememberme:r},r=JSON.stringify(r);return _.post(t,r,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){return t.json()})}},{key:"logoutiServer",value:function(t){return t=B.urlPathAppend(t,"services/security/logout"),_.get(t,"",{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withoutFormatSuffix:!0}).then(function(){return!0}).catch(function(){return!1})}},{key:"loginOnline",value:function(t,e){this._open(k.SSO+"/login?service="+t,e)}},{key:"loginiPortal",value:function(t,e,n){t=B.urlPathAppend(t,"web/login");n={username:e&&e.toString(),password:n&&n.toString()},n=JSON.stringify(n);return _.post(t,n,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withCredentials:!0}).then(function(t){return t.json()})}},{key:"logoutiPortal",value:function(t){return t=B.urlPathAppend(t,"services/security/logout"),_.get(t,"",{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withCredentials:!0,withoutFormatSuffix:!0}).then(function(){return!0}).catch(function(){return!1})}},{key:"loginManager",value:function(t,e,n){if(B.isInTheSameDomain(t)){var r=B.urlPathAppend(t,"icloud/security/tokens"),e=e||{},e={username:e.userName&&e.userName.toString(),password:e.password&&e.password.toString()},e=JSON.stringify(e),o=this;return _.post(r,e,{headers:{Accept:"*/*","Content-Type":"application/json"}}).then(function(t){t.text().then(function(t){return o.imanagerToken=t})})}n=!n||n.isNewTab;this._open(t,n)}},{key:"destroyAllCredentials",value:function(){this.keys=null,this.tokens=null,this.servers=null}},{key:"destroyToken",value:function(t){t&&(t=this._getTokenStorageKey(t),this.tokens=this.tokens||{},this.tokens[t]&&delete this.tokens[t])}},{key:"destroyKey",value:function(t){t&&(this.keys=this.keys||{},t=this._getUrlRestString(t)||t,this.keys[t]&&delete this.keys[t])}},{key:"appendCredential",value:function(t){var e=t,n=this.getToken(t),r=n?new O(n,"token"):null;return e=(r=r||((n=this.getKey(t))?new O(n,"key"):null))?B.urlAppend(e,r.getUrlParameters()):e}},{key:"_open",value:function(t,e){e=null==e||e;var n=window.screen.availWidth/2-this.INNER_WINDOW_WIDTH/2,r=window.screen.availHeight/2-this.INNER_WINDOW_HEIGHT/2,n="height="+this.INNER_WINDOW_HEIGHT+", width="+this.INNER_WINDOW_WIDTH+",top="+r+", left="+n+",toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no";e?window.open(t,"login"):window.open(t,"login",n)}},{key:"_getTokenStorageKey",value:function(t){var e=t.match(/(.*?):\/\/([^\/]+)/i);return e?e[0]:t}},{key:"_getUrlRestString",value:function(t){if(!t)return t;var e=t.match(/(http|https):\/\/(.*\/rest)/i);return e?e[0]:t}}],null&&P(Ga.prototype,null),P(Ga,Za),k);function k(){!function(t){if(!(t instanceof k))throw new TypeError("Cannot call a class as a function")}(this)}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}C.INNER_WINDOW_WIDTH=600,C.INNER_WINDOW_HEIGHT=600,C.SSO="https://sso.supermap.com",C.ONLINE="https://www.supermapol.com",c.SecurityManager=C,c.ServerInfo=function e(t,n){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.type=t,this.server=null,this.tokenServiceUrl=null,this.keyServiceUrl=null,B.extend(this,n),this.CLASS_NAME="SuperMap.ServerInfo",this.type=this.type||r.ISERVER,this.server||console.error("server url require is not  undefined");n="/services/security/tokens";this.type===r.ISERVER&&this.server.indexOf("iserver")<0&&(n="/iserver"+n),this.tokenServiceUrl||(this.tokenServiceUrl=B.urlPathAppend(this.server,n)),this.keyServiceUrl||(this.type===r.IPORTAL?this.keyServiceUrl=B.urlPathAppend(this.server,"/web/mycontent/keys/register"):this.type===r.ONLINE&&(this.keyServiceUrl=B.urlPathAppend(this.server,"/web/mycontent/keys")))};var R=(T(A.prototype,[{key:"toJSON",value:function(){return{userName:this.userName,password:this.password,clientType:this.clientType,ip:this.ip,referer:this.referer,expiration:this.expiration}}}]),A);function A(t){!function(t){if(!(t instanceof A))throw new TypeError("Cannot call a class as a function")}(this),this.userName=null,this.password=null,this.clientType=i.NONE,this.ip=null,this.referer=null,this.expiration=60,B.extend(this,t),this.CLASS_NAME="SuperMap.TokenServiceParameter"}function L(t,e,n,r){var o=!(1<arguments.length&&void 0!==e)||e,i=!(2<arguments.length&&void 0!==n)||n,e=3<arguments.length&&void 0!==r?r:[-180,180],n=e[1],r=e[0],e=n-r;return t===n&&o||t===r&&i?t:0==((t-r)%e+e)%e&&o?n:((t-r)%e+e)%e+r}function I(t){var e=parseInt(t),n=parseInt(60*(t-e)),t=parseInt(60*(60*(t-e)-n)),n=0===parseInt(n/10)?"0".concat(n):n,t=0===parseInt(t/10)?"0".concat(t):t;return"".concat(e,"°").concat(n,"'").concat(t)}function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.TokenServiceParameter=R;var j=(N(M.prototype,[{key:"toString",value:function(){return"x="+this.x+",y="+this.y}},{key:"clone",value:function(){return new M(this.x,this.y,this.mode)}},{key:"equals",value:function(t){var e=!1;return e=null!=t?this.x==t.x&&this.y==t.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(t.x)&&isNaN(t.y):e}},{key:"distanceTo",value:function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}},{key:"add",value:function(t,e){if(null==t||null==e)throw new TypeError("Pixel.add cannot receive null values");return new M(this.x+t,this.y+e)}},{key:"offset",value:function(t){var e=this.clone();return e=t?this.add(t.x,t.y):e}},{key:"destroy",value:function(){this.x=null,this.y=null,this.mode=null}}]),M);function M(t,e,n){!function(t){if(!(t instanceof M))throw new TypeError("Cannot call a class as a function")}(this),this.x=t?parseFloat(t):0,this.y=e?parseFloat(e):0,this.mode=n,this.CLASS_NAME="SuperMap.Pixel",c.Pixel.Mode={LeftTop:"lefttop",RightTop:"righttop",RightBottom:"rightbottom",LeftBottom:"leftbottom"}}c.Pixel=j;var D=c.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(t){return t.target||t.srcElement},isSingleTouch:function(t){return t.touches&&1===t.touches.length},isMultiTouch:function(t){return t.touches&&1<t.touches.length},isLeftClick:function(t){return t.which&&1===t.which||t.button&&1===t.button},isRightClick:function(t){return t.which&&3===t.which||t.button&&2===t.button},stop:function(t,e){e||(t.preventDefault?t.preventDefault():t.returnValue=!1),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},findElement:function(t,e){for(var n=c.Event.element(t);n.parentNode&&(!n.tagName||n.tagName.toUpperCase()!=e.toUpperCase());)n=n.parentNode;return n},observe:function(t,e,n,r){t=B.getElement(t);r=r||!1,"keypress"===e&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||t.attachEvent)&&(e="keydown"),this.observers||(this.observers={}),t._eventCacheID||(o="eventCacheID_",t.id&&(o=t.id+"_"+o),t._eventCacheID=B.createUniqueID(o));var o=t._eventCacheID;this.observers[o]||(this.observers[o]=[]),this.observers[o].push({element:t,name:e,observer:n,useCapture:r}),t.addEventListener?"mousewheel"===e?t.addEventListener(e,n,{useCapture:r,passive:!1}):t.addEventListener(e,n,r):t.attachEvent&&t.attachEvent("on"+e,n)},stopObservingElement:function(t){t=B.getElement(t)._eventCacheID;this._removeElementObservers(c.Event.observers[t])},_removeElementObservers:function(t){if(t)for(var e=t.length-1;0<=e;e--){var n=t[e],n=new Array(n.element,n.name,n.observer,n.useCapture);c.Event.stopObserving.apply(this,n)}},stopObserving:function(t,e,n,r){r=r||!1;var t=B.getElement(t),o=t._eventCacheID;"keypress"===e&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||t.detachEvent)&&(e="keydown");var i=!1,a=c.Event.observers[o];if(a)for(var s=0;!i&&s<a.length;){var l=a[s];if(l.name===e&&l.observer===n&&l.useCapture===r){a.splice(s,1),0==a.length&&delete c.Event.observers[o],i=!0;break}s++}return i&&(t.removeEventListener?t.removeEventListener(e,n,r):t&&t.detachEvent&&t.detachEvent("on"+e,n)),i},unloadCache:function(){if(c.Event&&c.Event.observers){for(var t in c.Event.observers){t=c.Event.observers[t];c.Event._removeElementObservers.apply(this,[t])}c.Event.observers=!1}},CLASS_NAME:"SuperMap.Event"};function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Event=D,c.Event.observe(window,"unload",c.Event.unloadCache,!1);var H=(U(G.prototype,[{key:"destroy",value:function(){for(var t in this.extensions)"boolean"!=typeof this.extensions[t]&&this.extensions[t].destroy();this.extensions=null,this.element&&(D.stopObservingElement(this.element),this.element.hasScrollEvent&&D.stopObserving(window,"scroll",this.clearMouseListener)),this.element=null,this.listeners=null,this.object=null,this.eventTypes=null,this.fallThrough=null,this.eventHandler=null}},{key:"addEventType",value:function(t){this.listeners[t]||(this.eventTypes.push(t),this.listeners[t]=[])}},{key:"attachToElement",value:function(t){this.element?D.stopObservingElement(this.element):(this.eventHandler=o.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=o.bind(this.clearMouseCache,this)),this.element=t;for(var e=0,n=this.BROWSER_EVENTS.length;e<n;e++){var r=this.BROWSER_EVENTS[e];this.addEventType(r),D.observe(t,r,this.eventHandler)}D.observe(t,"dragstart",D.stop)}},{key:"on",value:function(t){for(var e in t)"scope"!==e&&t.hasOwnProperty(e)&&this.register(e,t.scope,t[e])}},{key:"register",value:function(t,e,n,r){var o;t in G&&!this.extensions[t]&&(this.extensions[t]=new G[t](this)),null!=n&&-1!==B.indexOf(this.eventTypes,t)&&(null==e&&(e=this.object),(o=this.listeners[t])||(this.listeners[t]=o=[],this.extensionCount[t]=0),n={obj:e,func:n},r?(o.splice(this.extensionCount[t],0,n),"object"===F(r)&&r.extension&&this.extensionCount[t]++):o.push(n))}},{key:"registerPriority",value:function(t,e,n){this.register(t,e,n,!0)}},{key:"un",value:function(t){for(var e in t)"scope"!==e&&t.hasOwnProperty(e)&&this.unregister(e,t.scope,t[e])}},{key:"unregister",value:function(t,e,n){null==e&&(e=this.object);var r=this.listeners[t];if(null!=r)for(var o=0,i=r.length;o<i;o++)if(r[o].obj===e&&r[o].func===n){r.splice(o,1);break}}},{key:"remove",value:function(t){null!=this.listeners[t]&&(this.listeners[t]=[])}},{key:"triggerEvent",value:function(t,e){var n,r=this.listeners[t];if(r&&0!=r.length){(e=null==e?{}:e).object=this.object,e.element=this.element,e.type||(e.type=t);for(var o=0,i=(r=r.slice()).length;o<i;o++){var a=r[o];if(null!=(n=a.func.apply(a.obj,[e]))&&!1===n)break}return this.fallThrough||D.stop(e,!0),n}}},{key:"handleBrowserEvent",value:function(t){var e=t.type,n=this.listeners[e];if(n&&0!=n.length){var r=t.touches;if(r&&r[0]){for(var o,i=0,a=0,s=r.length,l=0;l<s;++l)i+=(o=r[l]).clientX,a+=o.clientY;t.clientX=i/s,t.clientY=a/s}this.includeXY&&(t.xy=this.getMousePosition(t)),this.triggerEvent(e,t)}}},{key:"clearMouseCache",value:function(){this.element.scrolls=null,this.element.lefttop=null;var t=document.body;t&&(0==t.scrollTop&&0==t.scrollLeft||!navigator.userAgent.match(/iPhone/i))&&(this.element.offsets=null)}},{key:"getMousePosition",value:function(t){var e;return this.includeXY?this.element.hasScrollEvent||(D.observe(window,"scroll",this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache(),this.element.scrolls||(e=B.getViewportElement(),this.element.scrolls=[e.scrollLeft,e.scrollTop]),this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]),this.element.offsets||(this.element.offsets=B.pagePosition(this.element)),new j(t.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],t.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])}}]),G);function G(t,e,n,r,o){if(function(t){if(!(t instanceof G))throw new TypeError("Cannot call a class as a function")}(this),this.BROWSER_EVENTS=["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown","MSPointerDown","MSPointerUp","pointerdown","pointerup","MSGestureStart","MSGestureChange","MSGestureEnd","contextmenu"],this.listeners={},this.object=t,this.element=null,this.eventTypes=[],this.eventHandler=null,this.fallThrough=r,this.includeXY=!1,this.extensions={},this.extensionCount={},this.clearMouseListener=null,B.extend(this,o),null!=n)for(var i=0,a=n.length;i<a;i++)this.addEventType(n[i]);null!=e&&this.attachToElement(e),this.CLASS_NAME="SuperMap.Events"}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Events=H,c.Events.prototype.BROWSER_EVENTS=["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown","MSPointerDown","MSPointerUp","pointerdown","pointerup","MSGestureStart","MSGestureChange","MSGestureEnd","contextmenu"];var V=(W(z.prototype,[{key:"destroy",value:function(){}},{key:"read",value:function(t){}},{key:"write",value:function(t){}}]),z);function z(t){!function(t){if(!(t instanceof z))throw new TypeError("Cannot call a class as a function")}(this),this.data=null,this.keepData=!1,B.extend(this,t),this.options=t,this.CLASS_NAME="SuperMap.Format"}function Y(t){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function X(t,e){return(X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function J(t){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Format=c.Format||V;var Q=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),X(t,e)}(o,V);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=J(n);return function(t,e){if(e&&("object"===Y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=J(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).indent="    ",t.space=" ",t.newline="\n",t.level=0,t.pretty=!1,t.nativeJSON=!(!window.JSON||"function"!=typeof JSON.parse||"function"!=typeof JSON.stringify),t.CLASS_NAME="SuperMap.Format.JSON",t.serialize={object:function(t){if(null==t)return"null";if(t.constructor===Date)return this.serialize.date.apply(this,[t]);if(t.constructor===Array)return this.serialize.array.apply(this,[t]);var e,n,r,o=["{"];this.level+=1;var i=!1;for(e in t)t.hasOwnProperty(e)&&(n=this.write.apply(this,[e,this.pretty]),r=this.write.apply(this,[t[e],this.pretty]),null!=n&&null!=r&&(i&&o.push(","),o.push(this.writeNewline(),this.writeIndent(),n,":",this.writeSpace(),r),i=!0));return--this.level,o.push(this.writeNewline(),this.writeIndent(),"}"),o.join("")},array:function(t){var e,n=["["];this.level+=1;for(var r=0,o=t.length;r<o;++r)null!=(e=this.write.apply(this,[t[r],this.pretty]))&&(0<r&&n.push(","),n.push(this.writeNewline(),this.writeIndent(),e));return--this.level,n.push(this.writeNewline(),this.writeIndent(),"]"),n.join("")},string:function(t){var r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(t)?'"'+t.replace(/([\x00-\x1f\\"])/g,function(t,e){var n;return(n=r[e])||(n=e.charCodeAt(),"\\u00"+Math.floor(n/16).toString(16)+(n%16).toString(16))})+'"':'"'+t+'"'},number:function(t){return isFinite(t)?String(t):"null"},boolean:function(t){return String(t)},date:function(t){function e(t){return t<10?"0"+t:t}return'"'+t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+"T"+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+'"'}},t}return q(o.prototype,[{key:"read",value:function(t,e){var n;if(this.nativeJSON)try{n=JSON.parse(t,e)}catch(t){}return this.keepData&&(this.data=n),n}},{key:"write",value:function(t,e){this.pretty=!!e;var n=null,e=Y(t);if(this.serialize[e])try{n=!this.pretty&&this.nativeJSON?JSON.stringify(t):this.serialize[e].apply(this,[t])}catch(t){}return n}},{key:"writeIndent",value:function(){var t=[];if(this.pretty)for(var e=0;e<this.level;++e)t.push(this.indent);return t.join("")}},{key:"writeNewline",value:function(){return this.pretty?this.newline:""}},{key:"writeSpace",value:function(){return this.pretty?this.space:""}}]),o}();function K(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Format.JSON=Q;var Z=(K($.prototype,[{key:"destroy",value:function(){var t=this;B.isArray(t.urls)&&(t.urls=null,t.index=null,t.length=null,t.totalTimes=null),t.url=null,t.options=null,t._processSuccess=null,t._processFailed=null,t.isInTheSameDomain=null,t.EVENT_TYPES=null,t.events&&(t.events.destroy(),t.events=null),t.eventListeners&&(t.eventListeners=null)}},{key:"request",value:function(t){var e=this;t.url=t.url||e.url,t.proxy=t.proxy||e.proxy,t.withCredentials=(null!=t.withCredentials?t:e).withCredentials,t.crossOrigin=(null!=t.crossOrigin?t:e).crossOrigin,t.headers=t.headers||e.headers,t.isInTheSameDomain=e.isInTheSameDomain,t.url=C.appendCredential(t.url),e.calculatePollingTimes(),e._processSuccess=t.success,e._processFailed=t.failure,t.scope=e,t.success=e.getUrlCompleted,t.failure=e.getUrlFailed,e.options=t,e._commit(e.options)}},{key:"getUrlCompleted",value:function(t){this._processSuccess(t)}},{key:"getUrlFailed",value:function(t){0<this.totalTimes?(this.totalTimes--,this.ajaxPolling()):this._processFailed(t)}},{key:"ajaxPolling",value:function(){var t=this,e=t.options.url,n=/^http:\/\/([a-z]{9}|(\d+\.){3}\d+):\d{0,4}/;t.index=parseInt(Math.random()*t.length),t.url=t.urls[t.index],e=e.replace(n,n.exec(t.url)[0]),t.options.url=e,t.options.isInTheSameDomain=B.isInTheSameDomain(e),t._commit(t.options)}},{key:"calculatePollingTimes",value:function(){var t=this;t.times?t.totalTimes>t.POLLING_TIMES?t.times>t.POLLING_TIMES?t.totalTimes=t.POLLING_TIMES:t.totalTimes=t.times:t.times<t.totalTimes&&(t.totalTimes=t.times):t.totalTimes>t.POLLING_TIMES&&(t.totalTimes=t.POLLING_TIMES),t.totalTimes--}},{key:"isServiceSupportPolling",value:function(){return!("SuperMap.REST.ThemeService"===this.CLASS_NAME||"SuperMap.REST.EditFeaturesService"===this.CLASS_NAME)}},{key:"serviceProcessCompleted",value:function(t){t=B.transformResult(t),this.events.triggerEvent("processCompleted",{result:t})}},{key:"serviceProcessFailed",value:function(t){t=(t=B.transformResult(t)).error||t;this.events.triggerEvent("processFailed",{error:t})}},{key:"_commit",value:function(e){"POST"!==e.method&&"PUT"!==e.method||(e.params&&(e.url=B.urlAppend(e.url,B.getParameterString(e.params||{}))),e.params=e.data),_.commit(e.method,e.url,e.params,{headers:e.headers,withCredentials:e.withCredentials,crossOrigin:e.crossOrigin,timeout:e.async?0:null,proxy:e.proxy}).then(function(t){return t.text?t.text():t.json?t.json():t}).then(function(t){var e=t;return e=!(e="string"==typeof t?(new Q).read(t):e)||e.error||300<=e.code&&304!==e.code?e&&e.error?{error:e.error}:{error:e}:e}).catch(function(t){(e.scope?o.bind(e.failure,e.scope):e.failure)(t)}).then(function(t){t.error?(e.scope?o.bind(e.failure,e.scope):e.failure)(t):(t.succeed=null==t.succeed||t.succeed,(e.scope?o.bind(e.success,e.scope):e.success)(t))})}}]),$);function $(t,e){!function(t){if(!(t instanceof $))throw new TypeError("Cannot call a class as a function")}(this);var n=this;this.EVENT_TYPES=["processCompleted","processFailed"],this.events=null,this.eventListeners=null,this.url=null,this.urls=null,this.proxy=null,this.index=null,this.length=null,this.options=null,this.totalTimes=null,this.POLLING_TIMES=3,this._processSuccess=null,this._processFailed=null,this.isInTheSameDomain=null,this.withCredentials=!1,B.isArray(t)?(n.urls=t,n.length=t.length,n.totalTimes=n.length,1===n.length?n.url=t[0]:(n.index=parseInt(Math.random()*n.length),n.url=t[n.index])):(n.totalTimes=1,n.url=t),B.isArray(t)&&!n.isServiceSupportPolling()&&(n.url=t[0],n.totalTimes=1),this.crossOrigin=(e=e||{}).crossOrigin,this.headers=e.headers,B.extend(this,e),n.isInTheSameDomain=B.isInTheSameDomain(n.url),n.events=new H(n,null,n.EVENT_TYPES,!0),n.eventListeners instanceof Object&&n.events.on(n.eventListeners),this.CLASS_NAME="SuperMap.CommonServiceBase"}function tt(t){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nt(t,e,n){return(nt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=it(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function rt(t,e){return(rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ot(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function it(t){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.CommonServiceBase=Z;var at=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rt(t,e)}(i,Z);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=it(n);return function(t,e){if(e&&("object"===tt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ot(t)}(this,r?(t=it(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){var n;!function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(n=o.call(this,t,e)).projection=null,n.CLASS_NAME="SuperMap.MapService",e&&B.extend(ot(n),e);t=ot(n);return!t.projection||(e=t.projection.split(":"))instanceof Array&&(2===e.length&&(t.url=B.urlAppend(t.url,"prjCoordSys=".concat(encodeURIComponent('{"epsgCode":"'.concat(e[1],'"}'))))),1===e.length&&(t.url=B.urlAppend(t.url,"prjCoordSys=".concat(encodeURIComponent('{"epsgCode":"'.concat(e[0],'"}')))))),n}return et(i.prototype,[{key:"destroy",value:function(){nt(it(i.prototype),"destroy",this).call(this);var t=this;t.events&&(t.events.un(t.eventListeners),t.events.listeners=null,t.events.destroy(),t.events=null,t.eventListeners=null)}},{key:"processAsync",value:function(){this.request({method:"GET",scope:this,success:this.serviceProcessCompleted,failure:this.serviceProcessFailed})}},{key:"serviceProcessCompleted",value:function(t){var e=200<=(t=B.transformResult(t)).code&&t.code<300||0==t.code||304===t.code,e=t.code&&e;!t.code||e?this.events&&this.events.triggerEvent("processCompleted",{result:t}):this.events.triggerEvent("processFailed",{error:t})}}]),i}();function st(t){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ut(t,e,n){return(ut="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ft(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function ct(t,e){return(ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ft(t){return(ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.MapService=at;var ht=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ct(t,e)}(i,Z);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=ft(n);return function(t,e){if(e&&("object"===st(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=ft(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t,e)).CLASS_NAME="SuperMap.TilesetsService",e}return lt(i.prototype,[{key:"destroy",value:function(){ut(ft(i.prototype),"destroy",this).call(this)}},{key:"processAsync",value:function(){var t;this.url&&((t=this).url=B.urlPathAppend(t.url,"tilesets"),t.request({method:"GET",scope:t,success:t.serviceProcessCompleted,failure:t.serviceProcessFailed}))}}]),i}();function pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.TilesetsService=ht;var yt=(pt(dt.prototype,[{key:"destroy",value:function(){this.foreignTableName=null,this.joinFilter=null,this.joinType=null}},{key:"toServerJSONObject",value:function(){return B.copyAttributes({},this)}}]),dt);function dt(t){!function(t){if(!(t instanceof dt))throw new TypeError("Cannot call a class as a function")}(this),this.foreignTableName=null,this.joinFilter=null,this.joinType=null,t&&B.extend(this,t),this.CLASS_NAME="SuperMap.JoinItem"}function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.JoinItem=yt;var gt=(vt(mt.prototype,[{key:"destroy",value:function(){var t=this;t.alias=null,t.connect=null,t.dataBase=null,t.driver=null,t.engineType=null,t.exclusive=null,t.OpenLinkTable=null,t.password=null,t.readOnly=null,t.server=null,t.user=null}}]),mt);function mt(t){!function(t){if(!(t instanceof mt))throw new TypeError("Cannot call a class as a function")}(this),this.alias=null,this.connect=null,this.dataBase=null,this.driver=null,this.engineType=null,this.exclusive=null,this.OpenLinkTable=null,this.password=null,this.readOnly=null,this.server=null,this.user=null,t&&B.extend(this,t),this.CLASS_NAME="SuperMap.DatasourceConnectionInfo"}function bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.DatasourceConnectionInfo=gt;var St=(bt(_t.prototype,[{key:"destroy",value:function(){var t=this;t.datasourceConnectionInfo instanceof gt&&(t.datasourceConnectionInfo.destroy(),t.datasourceConnectionInfo=null),t.foreignKeys=null,t.foreignTable=null,t.linkFields=null,t.linkFilter=null,t.name=null,t.primaryKeys=null}}]),_t);function _t(t){!function(t){if(!(t instanceof _t))throw new TypeError("Cannot call a class as a function")}(this),this.datasourceConnectionInfo=null,this.foreignKeys=null,this.foreignTable=null,this.linkFields=null,this.linkFilter=null,this.name=null,this.primaryKeys=null,t&&B.extend(this,t),this.CLASS_NAME="SuperMap.LinkItem"}function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.LinkItem=St;var Ot=(wt(Et.prototype,[{key:"destroy",value:function(){var t=this;if(t.attributeFilter=null,t.name=null,t.joinItems){for(var e=0,n=t.joinItems,r=n.length;e<r;e++)n[e].destroy();t.joinItems=null}if(t.linkItems){for(var o=0,i=t.linkItems,a=i.length;o<a;o++)i[o].destroy();t.linkItems=null}t.ids=null,t.orderBy=null,t.groupBy=null,t.fields=null}}]),Et);function Et(t){!function(t){if(!(t instanceof Et))throw new TypeError("Cannot call a class as a function")}(this),this.attributeFilter=null,this.name=null,this.joinItems=null,this.linkItems=null,this.ids=null,this.orderBy=null,this.groupBy=null,this.fields=null,t&&B.extend(this,t),this.CLASS_NAME="SuperMap.FilterParameter"}function xt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.FilterParameter=Ot;var Pt=(xt(Ct.prototype,[{key:"destroy",value:function(){var t=this;if(t.customParams=null,t.expectCount=null,t.networkType=null,t.queryOption=null,t.queryParams){for(var e=0,n=t.queryParams,r=n.length;e<r;e++)n[e].destroy();t.queryParams=null}t.startRecord=null,t.holdTime=null,t.returnCustomResult=null,t.prjCoordSys=null}}]),Ct);function Ct(t){!function(t){if(!(t instanceof Ct))throw new TypeError("Cannot call a class as a function")}(this),t&&(this.customParams=null,this.prjCoordSys=null,this.expectCount=1e5,this.networkType=x.LINE,this.queryOption=n.ATTRIBUTEANDGEOMETRY,this.queryParams=null,this.startRecord=0,this.holdTime=10,this.returnCustomResult=!1,this.returnFeatureWithFieldCaption=!1,B.extend(this,t),this.CLASS_NAME="SuperMap.QueryParameters")}function kt(t){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rt(t,e,n){return(Rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=It(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function At(t,e){return(At=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Lt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function It(t){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.QueryParameters=Pt;var Nt=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&At(t,e)}(i,Pt);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=It(n);return function(t,e){if(e&&("object"===kt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Lt(t)}(this,r?(t=It(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t=t||{})).returnContent=!0,e.bounds=null,B.extend(Lt(e),t),e.CLASS_NAME="SuperMap.QueryByBoundsParameters",e}return Tt(i.prototype,[{key:"destroy",value:function(){Rt(It(i.prototype),"destroy",this).call(this),this.returnContent=null,this.bounds&&(this.bounds=null)}}]),i}();function jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.QueryByBoundsParameters=Nt;var Mt=(jt(Bt.prototype,[{key:"destroy",value:function(){this.id=null,this.lonlat=null,this.data=null}}]),Bt);function Bt(t,e,n){!function(t){if(!(t instanceof Bt))throw new TypeError("Cannot call a class as a function")}(this),this.CLASS_NAME="SuperMap.Feature",this.layer=t,this.id=B.createUniqueID(this.CLASS_NAME+"_"),this.lonlat=e,this.data=null!=n?n:{}}function Dt(t){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ut(t,e,n){return(Ut="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gt(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Ht(t,e){return(Ht=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gt(t){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature=Mt;var Wt=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Ht(t,e)}(i,Mt);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Gt(n);return function(t,e){if(e&&("object"===Dt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Gt(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e,n){var r;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(r=o.call(this,null,null,e)).fid=null,r.geometry=t||null,r.attributes={},e&&(r.attributes=B.extend(r.attributes,e)),r.bounds=null,r.state=null,r.style=n||null,r.url=null,r.lonlat=null,r.CLASS_NAME="SuperMap.Feature.Vector",c.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"},i.style={default:{fillColor:"#ee9900",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:.2,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"default",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},delete:{display:"none"}},r}return Ft(i.prototype,[{key:"destroy",value:function(){this.layer&&(this.layer.removeFeatures(this),this.layer=null),this.geometry=null,Ut(Gt(i.prototype),"destroy",this).call(this)}},{key:"clone",value:function(){return new i(this.geometry?this.geometry.clone():null,this.attributes,this.style)}},{key:"toState",value:function(t){if(t===c.State.UPDATE)switch(this.state){case c.State.UNKNOWN:case c.State.DELETE:this.state=t;break;case c.State.UPDATE:case c.State.INSERT:}else if(t===c.State.INSERT)this.state===c.State.UNKNOWN||(this.state=t);else if(t===c.State.DELETE)switch(this.state){case c.State.INSERT:case c.State.DELETE:break;case c.State.UNKNOWN:case c.State.UPDATE:this.state=t}else t===c.State.UNKNOWN&&(this.state=t)}}]),i}();function Vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Feature.Vector=Wt;var zt=(Vt(Yt.prototype,[{key:"toString",value:function(){return"w="+this.w+",h="+this.h}},{key:"clone",value:function(){return new Yt(this.w,this.h)}},{key:"equals",value:function(t){var e=!1;return e=null!=t?this.w===t.w&&this.h===t.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(t.w)&&isNaN(t.h):e}},{key:"destroy",value:function(){this.w=null,this.h=null}}]),Yt);function Yt(t,e){!function(t){if(!(t instanceof Yt))throw new TypeError("Cannot call a class as a function")}(this),this.w=t?parseFloat(t):0,this.h=t?parseFloat(e):0,this.CLASS_NAME="SuperMap.Size"}function qt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Size=zt;var Xt=(ss=[{key:"fromString",value:function(t){t=t.split(",");return new Jt(t[0],t[1])}},{key:"fromArray",value:function(t){var e=B.isArray(t);return new Jt(e&&t[0],e&&t[1])}}],qt((cs=Jt).prototype,[{key:"toString",value:function(){return"lon="+this.lon+",lat="+this.lat}},{key:"toShortString",value:function(){return this.lon+","+this.lat}},{key:"clone",value:function(){return new Jt(this.lon,this.lat)}},{key:"add",value:function(t,e){if(null==t||null==e)throw new TypeError("LonLat.add cannot receive null values");return new Jt(this.lon+B.toFloat(t),this.lat+B.toFloat(e))}},{key:"equals",value:function(t){var e=!1;return e=null!=t?this.lon===t.lon&&this.lat===t.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(t.lon)&&isNaN(t.lat):e}},{key:"wrapDateLine",value:function(t){var e=this.clone();if(t){for(;e.lon<t.left;)e.lon+=t.getWidth();for(;e.lon>t.right;)e.lon-=t.getWidth()}return e}},{key:"destroy",value:function(){this.lon=null,this.lat=null}}]),qt(cs,ss),Jt);function Jt(t,e){!function(t){if(!(t instanceof Jt))throw new TypeError("Cannot call a class as a function")}(this),B.isArray(t)&&(e=t[1],t=t[0]),this.lon=t?B.toFloat(t):0,this.lat=e?B.toFloat(e):0,this.CLASS_NAME="SuperMap.LonLat"}function Qt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Kt=(ps=[{key:"fromString",value:function(t,e){t=t.split(",");return Zt.fromArray(t,e)}},{key:"fromArray",value:function(t,e){return!0===e?new Zt(t[1],t[0],t[3],t[2]):new Zt(t[0],t[1],t[2],t[3])}},{key:"fromSize",value:function(t){return new Zt(0,t.h,t.w,0)}},{key:"oppositeQuadrant",value:function(t){var e="";return(e+="t"===t.charAt(0)?"b":"t")+("l"===t.charAt(1)?"r":"l")}}],Qt((y=Zt).prototype,[{key:"clone",value:function(){return new Zt(this.left,this.bottom,this.right,this.top)}},{key:"equals",value:function(t){var e=!1;return e=null!=t?this.left===t.left&&this.right===t.right&&this.top===t.top&&this.bottom===t.bottom:e}},{key:"toString",value:function(){return[this.left,this.bottom,this.right,this.top].join(",")}},{key:"toArray",value:function(t){return!0===t?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]}},{key:"toBBOX",value:function(t,e){null==t&&(t=6);var n=Math.pow(10,t),r=Math.round(this.left*n)/n,o=Math.round(this.bottom*n)/n,t=Math.round(this.right*n)/n,n=Math.round(this.top*n)/n;return!0===e?o+","+r+","+n+","+t:r+","+o+","+t+","+n}},{key:"getWidth",value:function(){return this.right-this.left}},{key:"getHeight",value:function(){return this.top-this.bottom}},{key:"getSize",value:function(){return new zt(this.getWidth(),this.getHeight())}},{key:"getCenterPixel",value:function(){return new j((this.left+this.right)/2,(this.bottom+this.top)/2)}},{key:"getCenterLonLat",value:function(){return this.centerLonLat||(this.centerLonLat=new Xt((this.left+this.right)/2,(this.bottom+this.top)/2)),this.centerLonLat}},{key:"scale",value:function(t,e){var n;return t=t||1,e="SuperMap.LonLat"===(e=null==e?this.getCenterLonLat():e).CLASS_NAME?(n=e.lon,e.lat):(n=e.x,e.y),new Zt((this.left-n)*t+n,(this.bottom-e)*t+e,(this.right-n)*t+n,(this.top-e)*t+e)}},{key:"add",value:function(t,e){if(null==t||null==e)throw new TypeError("Bounds.add cannot receive null values");return new Zt(this.left+t,this.bottom+e,this.right+t,this.top+e)}},{key:"extend",value:function(t){var e=null;if(t){switch(t.CLASS_NAME){case"SuperMap.LonLat":e=new Zt(t.lon,t.lat,t.lon,t.lat);break;case"SuperMap.Geometry.Point":e=new Zt(t.x,t.y,t.x,t.y);break;case"SuperMap.Bounds":e=t}e&&(((this.centerLonLat=null)==this.left||e.left<this.left)&&(this.left=e.left),(null==this.bottom||e.bottom<this.bottom)&&(this.bottom=e.bottom),(null==this.right||e.right>this.right)&&(this.right=e.right),(null==this.top||e.top>this.top)&&(this.top=e.top))}}},{key:"containsLonLat",value:function(t,e){var n,r=this.contains(t.lon,t.lat,(e=(e="boolean"==typeof e?{inclusive:e}:e)||{}).inclusive),o=e.worldBounds;return o&&!r&&(n=o.getWidth(),o=(o.left+o.right)/2,o=Math.round((t.lon-o)/n),r=this.containsLonLat({lon:t.lon-o*n,lat:t.lat},{inclusive:e.inclusive})),r}},{key:"containsPixel",value:function(t,e){return this.contains(t.x,t.y,e)}},{key:"contains",value:function(t,e,n){if(null==t||null==e)return!1;return(n=null==n?!0:n)?t>=this.left&&t<=this.right&&e>=this.bottom&&e<=this.top:t>this.left&&t<this.right&&e>this.bottom&&e<this.top}},{key:"intersectsBounds",value:function(t,e){var n;(e=(e="boolean"==typeof e?{inclusive:e}:e)||{}).worldBounds?(n=this.wrapDateLine(e.worldBounds),t=t.wrapDateLine(e.worldBounds)):n=this,null==e.inclusive&&(e.inclusive=!0);var r,o,i,a=!1,s=n.left===t.right||n.right===t.left||n.top===t.bottom||n.bottom===t.top;return!e.inclusive&&s||(s=t.bottom>=n.bottom&&t.bottom<=n.top||n.bottom>=t.bottom&&n.bottom<=t.top,i=t.top>=n.bottom&&t.top<=n.top||n.top>t.bottom&&n.top<t.top,r=t.left>=n.left&&t.left<=n.right||n.left>=t.left&&n.left<=t.right,o=t.right>=n.left&&t.right<=n.right||n.right>=t.left&&n.right<=t.right,a=(s||i)&&(r||o)),e.worldBounds&&!a&&(r=(i=e.worldBounds).getWidth(),o=!i.containsBounds(n),i=!i.containsBounds(t),o&&!i?(t=t.add(-r,0),a=n.intersectsBounds(t,{inclusive:e.inclusive})):i&&!o&&(n=n.add(-r,0),a=t.intersectsBounds(n,{inclusive:e.inclusive}))),a}},{key:"containsBounds",value:function(t,e,n){null==e&&(e=!1);var r=this.contains(t.left,t.bottom,n=null==n?!0:n),o=this.contains(t.right,t.bottom,n),i=this.contains(t.left,t.top,n),n=this.contains(t.right,t.top,n);return e?r||o||i||n:r&&o&&i&&n}},{key:"determineQuadrant",value:function(t){var e="",n=this.getCenterLonLat();return(e+=t.lat<n.lat?"b":"t")+(t.lon<n.lon?"l":"r")}},{key:"wrapDateLine",value:function(t,e){var n=(e=e||{}).leftTolerance||0,r=e.rightTolerance||0,o=this.clone();if(t){for(var i=t.getWidth();o.left<t.left&&o.right-r<=t.left;)o=o.add(i,0);for(;o.left+n>=t.right&&o.right>t.right;)o=o.add(-i,0);e=o.left+n;e<t.right&&e>t.left&&o.right-r>t.right&&(o=o.add(-i,0))}return o}},{key:"toServerJSONObject",value:function(){return{rightTop:{x:this.right,y:this.top},leftBottom:{x:this.left,y:this.bottom},left:this.left,right:this.right,top:this.top,bottom:this.bottom}}},{key:"destroy",value:function(){this.left=null,this.right=null,this.top=null,this.bottom=null,this.centerLonLat=null}}]),Qt(y,ps),Zt);function Zt(t,e,n,r){!function(t){if(!(t instanceof Zt))throw new TypeError("Cannot call a class as a function")}(this),B.isArray(t)&&(r=t[3],n=t[2],e=t[1],t=t[0]),this.left=null!=t?B.toFloat(t):this.left,this.bottom=null!=e?B.toFloat(e):this.bottom,this.right=null!=n?B.toFloat(n):this.right,this.top=null!=r?B.toFloat(r):this.top,this.centerLonLat=null,this.CLASS_NAME="SuperMap.Bounds"}function $t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Bounds=Kt;var te=($t(ee.prototype,[{key:"destroy",value:function(){this.id=null,this.bounds=null,this.SRID=null}},{key:"clone",value:function(){return new ee}},{key:"setBounds",value:function(t){t&&(this.bounds=t.clone())}},{key:"clearBounds",value:function(){this.bounds=null,this.parent&&this.parent.clearBounds()}},{key:"extendBounds",value:function(t){this.getBounds()?this.bounds.extend(t):this.setBounds(t)}},{key:"getBounds",value:function(){return null==this.bounds&&this.calculateBounds(),this.bounds}},{key:"calculateBounds",value:function(){}},{key:"getVertices",value:function(t){}},{key:"getArea",value:function(){return 0}}]),ee);function ee(){!function(t){if(!(t instanceof ee))throw new TypeError("Cannot call a class as a function")}(this),this.CLASS_NAME="SuperMap.Geometry",this.id=B.createUniqueID(this.CLASS_NAME+"_"),this.parent=null,this.bounds=null,this.SRID=null}function ne(t){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function re(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oe(t,e,n){return(oe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ae(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function ie(t,e){return(ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ae(t){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Geometry=te;var se=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),ie(t,e)}(i,te);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=ae(n);return function(t,e){if(e&&("object"===ne(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=ae(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this)).components=[],(e.componentTypes=null)!=t&&e.addComponents(t),e.CLASS_NAME="SuperMap.Geometry.Collection",e.geometryType="Collection",e}return re(i.prototype,[{key:"destroy",value:function(){this.components.length=0,this.components=null,oe(ae(i.prototype),"destroy",this).call(this)}},{key:"clone",value:function(){for(var t=new i,e=0,n=this.components.length;e<n;e++)t.addComponent(this.components[e].clone());return B.applyDefaults(t,this),t}},{key:"getComponentsString",value:function(){for(var t=[],e=0,n=this.components.length;e<n;e++)t.push(this.components[e].toShortString());return t.join(",")}},{key:"calculateBounds",value:function(){this.bounds=null;var t=new Kt,e=this.components;if(e)for(var n=0,r=e.length;n<r;n++)t.extend(e[n].getBounds());null!=t.left&&null!=t.bottom&&null!=t.right&&null!=t.top&&this.setBounds(t)}},{key:"addComponents",value:function(t){for(var e=0,n=(t=!B.isArray(t)?[t]:t).length;e<n;e++)this.addComponent(t[e])}},{key:"addComponent",value:function(t,e){var n,r=!1;return t&&(null==this.componentTypes||-1<B.indexOf(this.componentTypes,t.CLASS_NAME))&&(null!=e&&e<this.components.length?(n=this.components.slice(0,e),e=this.components.slice(e,this.components.length),n.push(t),this.components=n.concat(e)):this.components.push(t),(t.parent=this).clearBounds(),r=!0),r}},{key:"removeComponents",value:function(t){for(var e=!1,n=(t=!B.isArray(t)?[t]:t).length-1;0<=n;--n)e=this.removeComponent(t[n])||e;return e}},{key:"removeComponent",value:function(t){return B.removeItem(this.components,t),this.clearBounds(),!0}},{key:"getArea",value:function(){for(var t=0,e=0,n=this.components.length;e<n;e++)t+=this.components[e].getArea();return t}},{key:"equals",value:function(t){var e=!0;if(t&&t.CLASS_NAME&&this.CLASS_NAME===t.CLASS_NAME)if(B.isArray(t.components)&&t.components.length===this.components.length){for(var n=0,r=this.components.length;n<r;++n)if(!this.components[n].equals(t.components[n])){e=!1;break}}else e=!1;else e=!1;return e}},{key:"getVertices",value:function(t){for(var e=[],n=0,r=this.components.length;n<r;++n)Array.prototype.push.apply(e,this.components[n].getVertices(t));return e}}]),i}();function le(t){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ue(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ce(t,e,n){return(ce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=he(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function fe(t,e){return(fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function he(t){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Geometry.Collection=se;var pe=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),fe(t,e)}(a,te);var n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=he(n);return function(t,e){if(e&&("object"===le(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=he(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function a(t,e,n,r){var o;return function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),(o=i.call(this,t,e,n,r)).x=parseFloat(t),o.y=parseFloat(e),o.tag=r||0==r?parseFloat(r):null,o.type=n||"Point",o.CLASS_NAME="SuperMap.Geometry.Point",o.geometryType="Point",o}return ue(a.prototype,[{key:"clone",value:function(t){return null==t&&(t=new a(this.x,this.y)),B.applyDefaults(t,this),t}},{key:"calculateBounds",value:function(){this.bounds=new Kt(this.x,this.y,this.x,this.y)}},{key:"equals",value:function(t){var e=!1;return e=null!=t?this.x===t.x&&this.y===t.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(t.x)&&isNaN(t.y):e}},{key:"move",value:function(t,e){this.x=this.x+t,this.y=this.y+e,this.clearBounds()}},{key:"toShortString",value:function(){return this.x+", "+this.y}},{key:"destroy",value:function(){this.x=null,this.y=null,this.tag=null,ce(he(a.prototype),"destroy",this).call(this)}},{key:"getVertices",value:function(t){return[this]}}]),a}();function ye(t){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function de(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ve(t,e){return(ve=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ge(t){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Geometry.Point=pe;var me=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ve(t,e)}(o,se);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=ge(n);return function(t,e){if(e&&("object"===ye(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=ge(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).componentTypes=["SuperMap.Geometry.Point"],t.CLASS_NAME="SuperMap.Geometry.MultiPoint",t.geometryType="MultiPoint",t}return de(o.prototype,[{key:"addPoint",value:function(t,e){this.addComponent(t,e)}},{key:"removePoint",value:function(t){this.removeComponent(t)}}]),o}();function be(t){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Se(t,e){return(Se=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _e(t){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Geometry.MultiPoint=me;var we=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Se(t,e)}(o,me);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=_e(n);return function(t,e){if(e&&("object"===be(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=_e(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).componentTypes=["SuperMap.Geometry.Point","SuperMap.PointWithMeasure"],t.CLASS_NAME="SuperMap.Geometry.Curve",t.geometryType="Curve",t}return o}();function Oe(t){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ee(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xe(t,e,n){return(xe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ce(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Pe(t,e){return(Pe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ce(t){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Geometry.Curve=we;var ke=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pe(t,e)}(s,we);var t,e,n,r,o=(n=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Ce(n);return function(t,e){if(e&&("object"===Oe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Ce(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function s(t){return function(t){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t)).CLASS_NAME="SuperMap.Geometry.LineString",t.geometryType="LineString",t}return e=[{key:"calculateCircle",value:function(t){if(t.length<3)return t;var e,n={},r=t[0],o=t[1],i=t[2],a=!0,s=0,l=0,u=[],c=(i.y-r.y)/(i.x-r.x),f=i.y-c*i.x;if(i.x!=r.x&&i.y!=r.y&&o.y==c*o.x+f||i.x==r.x&&o.x==r.x||i.y==r.y&&o.y==r.y||i.x==r.x&&i.y==r.y||i.x==o.x&&i.y==o.y||r.x==o.x&&r.y==o.y)u.push(r),u.push(o),u.push(i);else{var h=(o.x*o.x+o.y*o.y-(r.x*r.x+r.y*r.y))*(2*(i.y-r.y))-(i.x*i.x+i.y*i.y-(r.x*r.x+r.y*r.y))*(2*(o.y-r.y)),p=2*(o.x-r.x)*(i.x*i.x+i.y*i.y-(r.x*r.x+r.y*r.y))-2*(i.x-r.x)*(o.x*o.x+o.y*o.y-(r.x*r.x+r.y*r.y)),t=4*((o.x-r.x)*(i.y-r.y)-(i.x-r.x)*(o.y-r.y));n.x=h/t,n.y=p/t;var t=(t=1<=(t=(2*(e=Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)))*e-((r.x-i.x)*(r.x-i.x)+(r.y-i.y)*(r.y-i.y)))/(2*e*e))?1:t)<=-1?-1:t,l=180*Math.acos(t)/Math.PI,y=(l=i.x==r.x?n.x>r.x&&o.x>r.x||n.x<r.x&&o.x<r.x?360-l:l:n.y>c*n.x+f&&o.y>c*o.x+f||n.y<c*n.x+f&&o.y<c*o.x+f?360-l:l)/72;i.y!=r.y?i.x==r.x?i.y>r.y?o.x<r.x&&(a=!1):o.x>r.x&&(a=!1):i.x<r.x?o.y<c*o.x+f&&(a=!1):o.y>c*o.x+f&&(a=!1):i.x>r.x?o.y>r.y&&(a=!1):o.y<r.y&&(a=!1);var d=(r.y-n.y)/(r.x-n.x),v=0<=d?180*Math.atan(d)/Math.PI:Math.abs(180*Math.atan(d)/Math.PI)+90,o=Math.abs(n.y);r.y==o&&o==i.y&&r.x<i.x&&(v+=180);var g=r.y-n.y;u.push(r);for(var m=1;m<72;m++){S=y*m,s=v,a?0<=g?0<=d?s+=S:s=180-(s-90)+S:s=0<d?s-180+S:90-s+S:0<=g?0<=d?s-=S:s=180-(s-90)-S:s=0<=d?s-180-S:90-s-S;var s=s*Math.PI/180,b=n.x+e*Math.cos(s),S=n.y+e*Math.sin(s);u.push(new pe(b,S))}u.push(i)}return u}},{key:"createLineEPS",value:function(t){var e=[],n=t.length;if(n<2)return t;for(var r,o=0;o<n;)"LTypeArc"==t[o].type?(e=(r=s.createLineArc(e,o,n,t))[0],o=r[1]):(e.push(t[o]),o++);return e}},{key:"createLineArc",value:function(t,e,n,r){var o;return 0==e?(o=s.addPointEPS(r,e,n,"LTypeArc"),Array.prototype.push.apply(t,o[0]),e=o[1]+1):e==n-1?(o=[r[e-1],r[e]],o=s.calculateCircle(o),Array.prototype.push.apply(t,o),e++):(n=s.addPointEPS(r,e,n,"LTypeArc"),t.pop(),Array.prototype.push.apply(t,n[0]),e=n[1]+1),[t,e]}},{key:"addPointEPS",value:function(t,e,n,r){var o,i=[],a=e+1;return 0==e?Array.prototype.push.apply(i,[t[e],t[e+1]]):e==n-1?Array.prototype.push.apply(i,[t[e-1],t[e]]):Array.prototype.push.apply(i,[t[e-1],t[e],t[e+1]]),"LTypeCurve"==r?o=s.calculatePointsFBZN(i):"LTypeArc"==r&&(o=s.calculateCircle(i)),[o,a]}}],Ee((t=s).prototype,[{key:"removeComponent",value:function(t){var e=this.components&&2<this.components.length;return e&&xe(Ce(s.prototype),"removeComponent",this).apply(this,arguments),e}},{key:"getSortedSegments",value:function(){for(var t,e,n=this.components.length-1,r=new Array(n),o=0;o<n;++o)t=this.components[o],e=this.components[o+1],t.x<e.x?r[o]={x1:t.x,y1:t.y,x2:e.x,y2:e.y}:r[o]={x1:e.x,y1:e.y,x2:t.x,y2:t.y};return r.sort(function(t,e){return t.x1-e.x1})}},{key:"getVertices",value:function(t){return!0===t?[this.components[0],this.components[this.components.length-1]]:!1===t?this.components.slice(1,this.components.length-1):this.components.slice()}}]),Ee(t,e),s}();function Te(t){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Re(t,e){return(Re=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ae(t){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Geometry.LineString=ke;var Le=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Re(t,e)}(o,se);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Ae(n);return function(t,e){if(e&&("object"===Te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Ae(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).componentTypes=["SuperMap.Geometry.LineString"],t.CLASS_NAME="SuperMap.Geometry.MultiLineString",t.geometryType="MultiLineString",t}return o}();function Ie(t){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function je(t,e,n){return(je="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Be(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Me(t,e){return(Me=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Be(t){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Geometry.MultiLineString=Le;var De=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Me(t,e)}(o,ke);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Be(n);return function(t,e){if(e&&("object"===Ie(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Be(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).componentTypes=["SuperMap.Geometry.Point"],t.CLASS_NAME="SuperMap.Geometry.LinearRing",t.geometryType="LinearRing",t}return Ne(o.prototype,[{key:"addComponent",value:function(t,e){var n=!1,r=this.components.pop();null==e&&t.equals(r)||(n=je(Be(o.prototype),"addComponent",this).apply(this,arguments));r=this.components[0];return je(Be(o.prototype),"addComponent",this).apply(this,[r]),n}},{key:"removeComponent",value:function(t){var e,n=this.components&&3<this.components.length;return n&&(this.components.pop(),je(Be(o.prototype),"removeComponent",this).apply(this,arguments),e=this.components[0],je(Be(o.prototype),"addComponent",this).apply(this,[e])),n}},{key:"getArea",value:function(){var t=0;if(this.components&&2<this.components.length){for(var e=0,n=0,r=this.components.length;n<r-1;n++){var o=this.components[n],i=this.components[n+1];e+=(o.x+i.x)*(i.y-o.y)}t=-e/2}return t}},{key:"getVertices",value:function(t){return!0===t?[]:this.components.slice(0,this.components.length-1)}}]),o}();function Fe(t){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ue(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function He(t,e){return(He=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ge(t){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Geometry.LinearRing=De;var We=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&He(t,e)}(o,se);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Ge(n);return function(t,e){if(e&&("object"===Fe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Ge(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).componentTypes=["SuperMap.Geometry.LinearRing"],t.CLASS_NAME="SuperMap.Geometry.Polygon",t.geometryType="Polygon",t}return Ue(o.prototype,[{key:"getArea",value:function(){var t=0;if(this.components&&0<this.components.length){t+=Math.abs(this.components[0].getArea());for(var e=1,n=this.components.length;e<n;e++)t-=Math.abs(this.components[e].getArea())}return t}}]),o}();function Ve(t){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ze(t,e){return(ze=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ye(t){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Geometry.Polygon=We;var qe=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ze(t,e)}(o,se);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Ye(n);return function(t,e){if(e&&("object"===Ve(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Ye(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).componentTypes=["SuperMap.Geometry.Polygon"],t.CLASS_NAME="SuperMap.Geometry.MultiPolygon",t.geometryType="MultiPolygon",t}return o}();function Xe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Geometry.MultiPolygon=qe;var Je=(v=[{key:"fromJson",value:function(t){if(t){var e=new Qe,n=255;null!==t.red&&(n=Number(t.red)),e.red=n;n=0;null!==t.green&&(n=Number(t.green)),e.green=n;n=0;return null!==t.blue&&(n=Number(t.blue)),e.blue=n,e}}}],Xe((Ga=Qe).prototype,[{key:"destroy",value:function(){this.red=null,this.green=null,this.blue=null}}]),Xe(Ga,v),Qe);function Qe(t,e,n){!function(t){if(!(t instanceof Qe))throw new TypeError("Cannot call a class as a function")}(this),this.red=t||0==t?t:255,this.green=e||0,this.blue=n||0,this.CLASS_NAME="SuperMap.ServerColor"}function Ke(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.ServerColor=Je;var Ze=(Za=[{key:"fromJson",value:function(t){if(t)return new $e({fillBackColor:Je.fromJson(t.fillBackColor),fillBackOpaque:t.fillBackOpaque,fillForeColor:Je.fromJson(t.fillForeColor),fillGradientMode:t.fillGradientMode,fillGradientAngle:t.fillGradientAngle,fillGradientOffsetRatioX:t.fillGradientOffsetRatioX,fillGradientOffsetRatioY:t.fillGradientOffsetRatioY,fillOpaqueRate:t.fillOpaqueRate,fillSymbolID:t.fillSymbolID,lineColor:Je.fromJson(t.lineColor),lineSymbolID:t.lineSymbolID,lineWidth:t.lineWidth,markerAngle:t.markerAngle,markerSize:t.markerSize,markerSymbolID:t.markerSymbolID})}}],Ke((R=$e).prototype,[{key:"destroy",value:function(){var t=this;t.fillBackColor&&(t.fillBackColor.destroy(),t.fillBackColor=null),t.fillBackOpaque=null,t.fillForeColor&&(t.fillForeColor.destroy(),t.fillForeColor=null),t.fillGradientMode=null,t.fillGradientAngle=null,t.fillGradientOffsetRatioX=null,t.fillGradientOffsetRatioY=null,t.fillOpaqueRate=null,t.fillSymbolID=null,t.lineColor&&(t.lineColor.destroy(),t.lineColor=null),t.lineSymbolID=null,t.lineWidth=null,t.markerAngle=null,t.markerSize=null,t.markerSymbolID=null}},{key:"toServerJSONObject",value:function(){return B.copyAttributes({},this)}}]),Ke(R,Za),$e);function $e(t){!function(t){if(!(t instanceof $e))throw new TypeError("Cannot call a class as a function")}(this),this.fillBackColor=new Je(255,255,255),this.fillBackOpaque=!1,this.fillForeColor=new Je(255,0,0),this.fillGradientMode=null,this.fillGradientAngle=0,this.fillGradientOffsetRatioX=0,this.fillGradientOffsetRatioY=0,this.fillOpaqueRate=100,this.fillSymbolID=0,this.lineColor=new Je(0,0,0),this.lineSymbolID=0,this.lineWidth=1,this.markerAngle=0,this.markerSize=1,this.markerSymbolID=-1,t&&B.extend(this,t),this.CLASS_NAME="SuperMap.ServerStyle"}function tn(t){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function en(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nn(t,e){return(nn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function on(t){return(on=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.ServerStyle=Ze;var an=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nn(t,e)}(i,pe);var t,e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=on(n);return function(t,e){if(e&&("object"===tn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rn(t)}(this,r?(t=on(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t)).measure=null,t&&B.extend(rn(e),t),e.CLASS_NAME="SuperMap.PointWithMeasure",e}return e=[{key:"fromJson",value:function(t){if(t)return new i({x:t.x,y:t.y,measure:t.measure})}}],en((t=i).prototype,[{key:"equals",value:function(t){var e,n,r=!1;return null!=t&&(e=this.x===t.x&&this.y===t.y&&this.measure===t.measure,n=isNaN(this.x)&&isNaN(this.y)&&isNaN(this.measure),t=isNaN(t.x)&&isNaN(t.y)&&isNaN(t.measure),r=e||n&&t),r}},{key:"toJson",value:function(){var t="{";return null!=this.measure&&null!=this.measure&&(t+='"measure":'+this.measure+","),t+='"x":'+this.x+",",(t+='"y":'+this.y)+"}"}},{key:"destroy",value:function(){this.measure=null,this.x=null,this.y=null}}]),en(t,e),i}();function sn(t){return(sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ln(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function un(t,e){return(un=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function cn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fn(t){return(fn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.PointWithMeasure=an;var hn=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&un(t,e)}(u,se);var t,e,n,r,o=(n=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=fn(n);return function(t,e){if(e&&("object"===sn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return cn(t)}(this,r?(t=fn(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function u(t,e){return function(t){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t,e)).id=null,t.center=null,t.style=null,t.length=null,t.maxM=null,t.minM=null,t.parts=null,t.points=null,t.type=null,t.componentTypes=["SuperMap.Geometry.LinearRing","SuperMap.Geometry.LineString"],e&&B.extend(cn(t),e),t.CLASS_NAME="SuperMap.Route",t.geometryType="LINEM",t}return e=[{key:"fromJson",value:function(t){if(t){var e=t.parts||[],n=t.points||[],r=e.length,o=[];if(!(0<r))return null;for(var i=0,a=0,s=[];i<r;i++){for(var l=0;l<e[i];l++)s.push(an.fromJson(n[a+l]));a+=e[i],s[0].equals(s[e[i]-1])?o.push(new De(s)):o.push(new ke(s)),s=[]}return new u(o,{id:t.id,center:t.center,style:t.style,length:t.length,maxM:t.maxM,minM:t.minM,type:t.type,parts:t.parts})}}}],ln((t=u).prototype,[{key:"toJson",value:function(){var t="{";if(null!=this.id&&null!=this.id&&(t+='"id":'+this.id+","),null!=this.center&&null!=this.center&&(t+='"center":'+this.center+","),null!=this.style&&null!=this.style&&(t+='"style":'+this.style+","),null!=this.length&&null!=this.length&&(t+='"length":'+this.length+","),null!=this.maxM&&null!=this.maxM&&(t+='"maxM":'+this.maxM+","),null!=this.minM&&null!=this.minM&&(t+='"minM":'+this.minM+","),null!=this.type&&null!=this.type&&(t+='"type":"'+this.type+'",'),null!=this.parts&&null!=this.parts){t+='"parts":['+this.parts[0];for(var e=1;e<this.parts.length;e++)t+=","+this.parts[e];t+="],"}if(null!=this.components&&0<this.components.length){t+='"points":[';for(var n=0,r=this.components.length;n<r;n++)for(var o=0,i=this.components[n].components.length;o<i;o++)t+=this.components[n].components[o].toJson()+",";t=t.replace(/,$/g,""),t+="]"}return(t=t.replace(/,$/g,""))+"}"}},{key:"destroy",value:function(){var t=this;t.id=null,t.center=null,t.style=null,t.length=null,t.maxM=null,t.minM=null,t.type=null,t.parts=null,t.components.length=0,t.components=null,t.componentTypes=null}}]),ln(t,e),u}();function pn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Route=hn;var yn=(yt=[{key:"fromJson",value:function(t){if(t)return new dn({id:t.id,style:Ze.fromJson(t.style),parts:t.parts,partTopo:t.partTopo,points:t.points,center:t.center,length:t.length,maxM:t.maxM,minM:t.minM,type:t.type})}},{key:"fromGeometry",value:function(t){if(t){var e=0,n=[],r=[],o=null,i=t.components,a=t.CLASS_NAME,s={epsgCode:t.SRID};if(isNaN(t.id)||(e=t.id),"SuperMap.Geometry.LinearRing"!=a&&"SuperMap.Geometry.LineString"!=a&&(t instanceof me||t instanceof Le)){for(var l=i.length,u=0;u<l;u++){var c=i[u].getVertices().length;n.push(c);for(var f=0;f<c;f++)r.push(new pe(i[u].getVertices()[f].x,i[u].getVertices()[f].y))}o="SuperMap.Geometry.MultiPoint"==a?x.POINT:x.LINE}else if(t instanceof qe){for(var h=i.length,p=0;p<h;p++)for(var y=i[p].components,d=y.length,v=0;v<d;v++){var g=y[v].getVertices().length+1;n.push(g);for(var m=0;m<g-1;m++)r.push(new pe(y[v].getVertices()[m].x,y[v].getVertices()[m].y));r.push(new pe(y[v].getVertices()[0].x,y[v].getVertices()[0].y))}o=x.REGION}else if(t instanceof We){for(var b=i.length,S=0;S<b;S++){var _=i[S].getVertices().length+1;n.push(_);for(var w=0;w<_-1;w++)r.push(new pe(i[S].getVertices()[w].x,i[S].getVertices()[w].y));r.push(new pe(i[S].getVertices()[0].x,i[S].getVertices()[0].y))}o=x.REGION}else{for(var O=t.getVertices().length,E=0;E<O;E++)r.push(new pe(t.getVertices()[E].x,t.getVertices()[E].y));t instanceof De&&(r.push(new pe(t.getVertices()[0].x,t.getVertices()[0].y)),O++),n.push(O),o=t instanceof pe?x.POINT:x.LINE}return new dn({id:e,style:null,parts:n,points:r,type:o,prjCoordSys:s})}}},{key:"IsClockWise",value:function(t){var e=t.length;if(e<3)return 0;var n=t[0].y*(t[e-1].x-t[1].x);t.push(t[0]);for(var r=1;r<e;r++)n+=t[r].y*(t[r-1].x-t[r+1].x);return.5*n}},{key:"bubbleSort",value:function(t,e,n,r){for(var o,i,a=0;a<t.length;a++)for(var s=0;s<t.length;s++)t[a]>t[s]&&(o=t[s],t[s]=t[a],t[a]=o,o=e[s],e[s]=e[a],e[a]=o,n&&0<n.length&&(i=n[s],n[s]=n[a],n[a]=i),r&&0<r.length&&(i=r[s],r[s]=r[a],r[a]=i))}}],pn((St=dn).prototype,[{key:"destroy",value:function(){var t=this;t.id=null,t.style=null,t.parts=null,t.partTopo=null,t.points=null,t.type=null,t.prjCoordSys=null}},{key:"toGeometry",value:function(){var t=this;switch(t.type.toUpperCase()){case x.POINT:return t.toGeoPoint();case x.LINE:return t.toGeoLine();case x.LINEM:return t.toGeoLinem();case x.REGION:return t.toGeoRegion();case x.POINTEPS:return t.toGeoPoint();case x.LINEEPS:return t.toGeoLineEPS();case x.REGIONEPS:return t.toGeoRegionEPS();case x.GEOCOMPOUND:return t.transformGeoCompound()}}},{key:"toGeoPoint",value:function(){var t=this.parts||[],e=this.points||[],n=t.length;if(0<n){if(1===n)return new pe(e[0].x,e[0].y);for(var r=[],o=0;o<n;o++)r.push(new pe(e[o].x,e[o].y));return new me(r)}return null}},{key:"toGeoLine",value:function(){var t=this.parts||[],e=this.points||[],n=t.length;if(0<n){if(1===n){for(var r=[],o=0;o<t[0];o++)r.push(new pe(e[o].x,e[o].y));return new(r[0].equals(r[t[0]-1])?De:ke)(r)}for(var i=[],a=0;a<n;a++){for(var s=[],l=0;l<t[a];l++)s.push(new pe(e[l].x,e[l].y));i.push(new ke(s)),e.splice(0,t[a])}return new Le(i)}return null}},{key:"toGeoLineEPS",value:function(){var t,e,n,r,o,i=this.parts||[],a=this.points||[],s=i.length;if(0<s){if(1===s){for(t=0,n=[];t<i[0];t++)n.push(new pe(a[t].x,a[t].y,a[t].type));return n[0].equals(n[i[0]-1])?(o=ke.createLineEPS(n),new De(o)):(o=ke.createLineEPS(n),new ke(o))}for(t=0,r=[];t<s;t++){for(e=0,n=[];e<i[t];e++)n.push(new pe(a[e].x,a[e].y));o=ke.createLineEPS(n),r.push(new ke(o)),a.splice(0,i[t])}return new Le(r)}return null}},{key:"toGeoLinem",value:function(){return hn.fromJson(this)}},{key:"toGeoRegion",value:function(){var t=this.parts||[],e=this.partTopo||[],n=this.points||[],r=t.length;if(r<=0)return null;var o=[],i=[];if(1==r){for(var a=0;a<n.length;a++)i.push(new pe(n[a].x,n[a].y));return o.push(new We([new De(i)])),new qe(o)}for(var s=[],l=[],u=[],c=[],f=[],h=0,p=0;h<r;h++){for(var y=0;y<t[h];y++)i.push(new pe(n[p+y].x,n[p+y].y));p+=t[h];var d=new We([new De(i)]),i=[];u.push(d),0===e.length&&c.push(d.getBounds()),f.push(1),l.push(d.getArea())}if(0===e.length){dn.bubbleSort(l,u,e,c);for(var v=[],g=1;g<u.length;g++)for(var m=g-1;0<=m;m--)if(v[g]=-1,c[m].containsBounds(c[g])){f[g]=-1*f[m],f[g]<0&&(v[g]=m);break}for(var b=0;b<u.length;b++)0<f[b]?o.push(u[b]):(o[v[b]].components=o[v[b]].components.concat(u[b].components),o.push(""))}else for(var o=new Array,S=0;S<u.length;S++)if(e[S]&&-1==e[S]?s=s.concat(u[S].components):(0<s.length&&0<o.length&&(o[o.length-1].components=o[o.length-1].components.concat(s),s=[]),o.push(u[S])),S==r-1){var _=o.length;if(_)o[_-1].components=o[_-1].components.concat(s);else for(var w=0,O=s.length;w<O;w++)o.push(new We(s))}return new qe(o)}},{key:"toGeoRegionEPS",value:function(){var t=this.parts||[],e=this.partTopo||[],n=this.points||[],r=t.length;if(r<=0)return null;var o=[],i=[];if(1==r){for(var a=0;a<n.length;a++)i.push(new pe(n[a].x,n[a].y));return d=ke.createLineEPS(i),o.push(new We([new De(d)])),new qe(o)}for(var s=[],l=[],u=[],c=[],f=[],h=0,p=0;h<r;h++){for(var y=0;y<t[h];y++)i.push(new pe(n[p+y].x,n[p+y].y));p+=t[h];var d=ke.createLineEPS(i),v=new We([new De(d)]),i=[];u.push(v),0===e.length&&c.push(v.getBounds()),f.push(1),l.push(v.getArea())}if(0===e.length){dn.bubbleSort(l,u,e,c);for(var g=[],m=1;m<u.length;m++)for(var b=m-1;0<=b;b--)if(g[m]=-1,c[b].containsBounds(c[m])){f[m]=-1*f[b],f[m]<0&&(g[m]=b);break}for(var S=0;S<u.length;S++)0<f[S]?o.push(u[S]):(o[g[S]].components=o[g[S]].components.concat(u[S].components),o.push(""))}else for(var o=new Array,_=0;_<u.length;_++)if(e[_]&&-1==e[_]?s=s.concat(u[_].components):(0<s.length&&0<o.length&&(o[o.length-1].components=o[o.length-1].components.concat(s),s=[]),o.push(u[_])),_==r-1){var w=o.length;if(w)o[w-1].components=o[w-1].components.concat(s);else for(var O=0,E=s.length;O<E;O++)o.push(new We(s))}return new qe(o)}},{key:"transformGeoCompound",value:function(){var t=this.geoParts||[],e=t.length;if(e<=0)return null;for(var n=[],r=0;r<e;r++){var o=t[r];n.push(new dn(o).toGeometry())}return new se(n)}}]),pn(St,yt),dn);function dn(t){!function(t){if(!(t instanceof dn))throw new TypeError("Cannot call a class as a function")}(this),this.id=0,this.style=null,this.parts=null,this.points=null,this.type=null,this.prjCoordSys=null,t&&B.extend(this,t),this.CLASS_NAME="SuperMap.ServerGeometry"}function vn(t){return(vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mn(t,e,n){return(mn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sn(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function bn(t,e){return(bn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Sn(t){return(Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.ServerGeometry=yn;var _n=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bn(t,e)}(l,Q);var n,r,e=(n=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Sn(n);return function(t,e){if(e&&("object"===vn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Sn(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function l(t){return function(t){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).ignoreExtraDims=!0,t.CLASS_NAME="SuperMap.Format.GeoJSON",t.parseCoords={point:function(t){if(!1===this.ignoreExtraDims&&2!=t.length)throw"Only 2D points are supported: "+t;return new pe(t[0],t[1])},multipoint:function(t){for(var e=[],n=null,r=0,o=t.length;r<o;++r){try{n=this.parseCoords.point.apply(this,[t[r]])}catch(t){throw t}e.push(n)}return new me(e)},linestring:function(t){for(var e=[],n=null,r=0,o=t.length;r<o;++r){try{n=this.parseCoords.point.apply(this,[t[r]])}catch(t){throw t}e.push(n)}return new ke(e)},multilinestring:function(t){for(var e=[],n=null,r=0,o=t.length;r<o;++r){try{n=this.parseCoords.linestring.apply(this,[t[r]])}catch(t){throw t}e.push(n)}return new Le(e)},polygon:function(t){for(var e,n,r=[],o=0,i=t.length;o<i;++o){try{n=this.parseCoords.linestring.apply(this,[t[o]])}catch(t){throw t}e=new De(n.components),r.push(e)}return new We(r)},multipolygon:function(t){for(var e=[],n=null,r=0,o=t.length;r<o;++r){try{n=this.parseCoords.polygon.apply(this,[t[r]])}catch(t){throw t}e.push(n)}return new qe(e)},box:function(t){if(2!=t.length)throw"GeoJSON box coordinates must have 2 elements";return new We([new De([new pe(t[0][0],t[0][1]),new pe(t[1][0],t[0][1]),new pe(t[1][0],t[1][1]),new pe(t[0][0],t[1][1]),new pe(t[0][0],t[0][1])])])}},t.extract={feature:function(t){var e=this.extract.geometry.apply(this,[t.geometry]),e={type:"Feature",properties:this.createAttributes(t),geometry:e};return t.geometry&&"TEXT"===t.geometry.type&&(e.properties.texts=t.geometry.texts,e.properties.textStyle=t.geometry.textStyle),t.fid&&(e.id=t.fid),t.ID&&(e.id=t.ID),e},geometry:function(t){if(null==t)return null;!t.parts&&t.points&&(t.parts=[t.points.length]);var e=!t.hasOwnProperty("geometryType")&&new yn(t).toGeometry()||t,t=e.geometryType||e.type,e=this.extract[(t="LINEM"===(t="LinearRing"===t?"LineString":t)?"MultiLineString":t).toLowerCase()].apply(this,[e]);return"Collection"===(t="TEXT"===t?"Point":t)?{type:"GeometryCollection",geometries:e}:{type:t,coordinates:e}},point:function(t){var e,n=[t.x,t.y];for(e in t)"x"===e||"y"===e||null===t[e]||isNaN(t[e])||n.push(t[e]);return n},text:function(t){return[t.points[0].x,t.points[0].y]},multipoint:function(t){for(var e=[],n=0,r=t.components.length;n<r;++n)e.push(this.extract.point.apply(this,[t.components[n]]));return e},linestring:function(t){for(var e=[],n=0,r=t.components.length;n<r;++n)e.push(this.extract.point.apply(this,[t.components[n]]));return e},multilinestring:function(t){for(var e=[],n=0,r=t.components.length;n<r;++n)e.push(this.extract.linestring.apply(this,[t.components[n]]));return e},polygon:function(t){for(var e=[],n=0,r=t.components.length;n<r;++n)e.push(this.extract.linestring.apply(this,[t.components[n]]));return e},multipolygon:function(t){for(var e=[],n=0,r=t.components.length;n<r;++n)e.push(this.extract.polygon.apply(this,[t.components[n]]));return e},collection:function(t){for(var e=t.components.length,n=new Array(e),r=0;r<e;++r)n[r]=this.extract.geometry.apply(this,[t.components[r]]);return n}},t}return gn(l.prototype,[{key:"read",value:function(t,e,n){e=e||"FeatureCollection";var r,o=null;if((r="string"==typeof t?mn(Sn(l.prototype),"read",this).call(this,t,n):t)&&"string"==typeof r.type&&this.isValidType(r,e))switch(e){case"Geometry":try{o=this.parseGeometry(r)}catch(t){}break;case"Feature":try{(o=this.parseFeature(r)).type="Feature"}catch(t){}break;case"FeatureCollection":switch(o=[],r.type){case"Feature":try{o.push(this.parseFeature(r))}catch(t){o=null}break;case"FeatureCollection":for(var i=0,a=r.features.length;i<a;++i)try{o.push(this.parseFeature(r.features[i]))}catch(t){o=null}break;default:try{var s=this.parseGeometry(r);o.push(new Wt(s))}catch(t){o=null}}}return o}},{key:"write",value:function(t,e){return mn(Sn(l.prototype),"write",this).call(this,this.toGeoJSON(t),e)}},{key:"fromGeoJSON",value:function(t,e,n){var r=this,n=this.read(t,e,n);return B.isArray(n)?n.map(function(t){return r._toiSevrerFeature(t)}):this._toiSevrerFeature(n)}},{key:"toGeoJSON",value:function(t){var e,n={type:null};if(B.isArray(t)){n.type="FeatureCollection";var r=t.length;n.features=new Array(r);for(var o=0;o<r;++o){var i,a=t[o];s(a)?((i={}).geometry=a,n.features[o]=this.extract.feature.apply(this,[i])):n.features[o]=this.extract.feature.apply(this,[a])}}else n=s(t)?((e={}).geometry=t,this.extract.feature.apply(this,[e])):this.extract.feature.apply(this,[t]);function s(t){return t.hasOwnProperty("parts")&&t.hasOwnProperty("points")||t.hasOwnProperty("geoParts")}return n}},{key:"isValidType",value:function(t,e){var n=!1;switch(e){case"Geometry":-1==B.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],t.type)||(n=!0);break;case"FeatureCollection":n=!0;break;default:t.type==e&&(n=!0)}return n}},{key:"parseFeature",value:function(t){var e,n=t.properties||{},r=t.geometry&&t.geometry.bbox||t.bbox;try{e=this.parseGeometry(t.geometry)}catch(t){throw t}return n=new Wt(e,n),r&&(n.bounds=Kt.fromArray(r)),t.id&&(n.fid=t.id),n}},{key:"parseGeometry",value:function(t){if(null==t)return null;var e;if("GeometryCollection"==t.type){if(!B.isArray(t.geometries))throw"GeometryCollection must have geometries array: "+t;for(var n=t.geometries.length,r=new Array(n),o=0;o<n;++o)r[o]=this.parseGeometry.apply(this,[t.geometries[o]]);e=new se(r)}else{if(!B.isArray(t.coordinates))throw"Geometry must have coordinates array: "+t;if(!this.parseCoords[t.type.toLowerCase()])throw"Unsupported geometry type: "+t.type;try{e=this.parseCoords[t.type.toLowerCase()].apply(this,[t.coordinates])}catch(t){throw t}}return e}},{key:"createCRSObject",value:function(t){var e=t.layer.projection.toString(),t={};return t=e.match(/epsg:/i)?4326==(e=parseInt(e.substring(e.indexOf(":")+1)))?{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:{type:"name",properties:{name:"EPSG:"+e}}:t}},{key:"_toiSevrerFeature",value:function(t){var e,n=t.attributes,r=[],o=[];for(e in n)r.push(e),o.push(n[e]);var i={fieldNames:r,fieldValues:o,geometry:yn.fromGeometry(t.geometry)};return i.geometry.id=t.fid,i}},{key:"createAttributes",value:function(t){if(!t)return null;var e={};!function(t,e){if(t.hasOwnProperty("fieldNames")&&t.hasOwnProperty("fieldValues")){var n,r=t.fieldNames,o=t.fieldValues;for(n in r)e[r[n]]=o[n]}}(t,e);var n,r=["fieldNames","fieldValues","geometry","stringID","ID"];for(n in t)-1<r.indexOf(n)||(e[n]=t[n]);return e}}]),l}();function wn(t){return(wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function On(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function En(t,e,n){return(En="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=kn(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function xn(t,e){return(xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pn(t,e){if(e&&("object"===wn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Cn(t)}function Cn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kn(t){return(kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Format.GeoJSON=_n;var Tn=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xn(t,e)}(i,Z);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=kn(n);return Pn(this,r?(t=kn(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t,e)).returnContent=!1,t.format=s.GEOJSON,t.returnFeatureWithFieldCaption=!1,e&&B.extend(Cn(t),e),t.CLASS_NAME="SuperMap.QueryService",t.url?(e&&e.format&&(t.format=e.format.toUpperCase()),t.url=B.urlPathAppend(t.url,"queryResults"),t):Pn(t)}return On(i.prototype,[{key:"destroy",value:function(){En(kn(i.prototype),"destroy",this).call(this),this.returnContent=null,this.format=null}},{key:"processAsync",value:function(t){var e,n,r;t instanceof Pt&&(r=null,(n=this).returnContent=t.returnContent,e=n.getJsonParameters(t),n.returnContent?n.url=B.urlAppend(n.url,"returnContent="+n.returnContent):(r=t.returnCustomResult)&&(n.url=B.urlAppend(n.url,"returnCustomResult="+r)),n.returnFeatureWithFieldCaption=t.returnFeatureWithFieldCaption,n.request({method:"POST",data:e,scope:n,success:n.serviceProcessCompleted,failure:n.serviceProcessFailed}))}},{key:"serviceProcessCompleted",value:function(t){t=B.transformResult(t);var e=new _n;if(t&&t.recordsets)for(var n=0,r=t.recordsets,o=r.length;n<o;n++)r[n].features&&(!0===this.returnFeatureWithFieldCaption&&r[n].features.map(function(t){return t.fieldNames=r[n].fieldCaptions,t}),this.format===s.GEOJSON&&(r[n].features=e.toGeoJSON(r[n].features)));this.events.triggerEvent("processCompleted",{result:t})}},{key:"getQueryParameters",value:function(t){return new Pt({customParams:t.customParams,expectCount:t.expectCount,networkType:t.networkType,queryOption:t.queryOption,queryParams:t.queryParams,startRecord:t.startRecord,prjCoordSys:t.prjCoordSys,holdTime:t.holdTime})}}]),i}();function Rn(t){return(Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function An(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ln(t,e,n){return(Ln="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Nn(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function In(t,e){return(In=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Nn(t){return(Nn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.QueryService=Tn;var jn=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&In(t,e)}(i,Tn);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Nn(n);return function(t,e){if(e&&("object"===Rn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Nn(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t,e)).CLASS_NAME="SuperMap.QueryByBoundsService",e}return An(i.prototype,[{key:"destroy",value:function(){Ln(Nn(i.prototype),"destroy",this).call(this)}},{key:"getJsonParameters",value:function(t){if(!(t instanceof Nt))return null;var e="",n=t.bounds,t=this.getQueryParameters(t);return e+="'queryMode':'BoundsQuery','queryParameters':","{"+(e+=B.toJSON(t))+(",'bounds': {'rightTop':{'y':"+n.top+",'x':"+n.right+"},'leftBottom':{'y':"+n.bottom+",'x':"+n.left)+"}}}"}}]),i}();function Mn(t){return(Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Dn(t,e,n){return(Dn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hn(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Fn(t,e){return(Fn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Un(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hn(t){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.QueryByBoundsService=jn;var Gn=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fn(t,e)}(i,Pt);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Hn(n);return function(t,e){if(e&&("object"===Mn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Un(t)}(this,r?(t=Hn(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t=t||{})).distance=0,e.geometry=null,e.isNearest=null,e.returnContent=!0,B.extend(Un(e),t),e.CLASS_NAME="SuperMap.QueryByDistanceParameters",e}return Bn(i.prototype,[{key:"destroy",value:function(){Dn(Hn(i.prototype),"destroy",this).call(this);var t=this;t.returnContent=null,t.distance=null,t.isNearest=null,t.geometry&&(t.geometry.destroy(),t.geometry=null)}}]),i}();function Wn(t){return(Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zn(t,e,n){return(zn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qn(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Yn(t,e){return(Yn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function qn(t){return(qn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.QueryByDistanceParameters=Gn;var Xn=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yn(t,e)}(i,Tn);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=qn(n);return function(t,e){if(e&&("object"===Wn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=qn(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t,e)).CLASS_NAME="SuperMap.QueryByDistanceService",e}return Vn(i.prototype,[{key:"destroy",value:function(){zn(qn(i.prototype),"destroy",this).call(this)}},{key:"getJsonParameters",value:function(t){if(t instanceof Gn){var e="",n=this.getQueryParameters(t),r=yn.fromGeometry(t.geometry);return e+=t.isNearest?"'queryMode':'FindNearest','queryParameters':":"'queryMode':'DistanceQuery','queryParameters':","{"+(e+=B.toJSON(n))+(",'geometry':"+B.toJSON(r)+",'distance':"+t.distance)+"}"}}}]),i}();function Jn(t){return(Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kn(t,e,n){return(Kn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tr(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Zn(t,e){return(Zn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $n(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tr(t){return(tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.QueryByDistanceService=Xn;var er=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zn(t,e)}(i,Pt);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=tr(n);return function(t,e){if(e&&("object"===Jn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return $n(t)}(this,r?(t=tr(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t=t||{})).returnContent=!0,e.geometry=null,e.spatialQueryMode=l.INTERSECT,B.extend($n(e),t),e.CLASS_NAME="SuperMap.QueryByGeometryParameters",e}return Qn(i.prototype,[{key:"destroy",value:function(){Kn(tr(i.prototype),"destroy",this).call(this),this.returnContent=null,this.geometry=null,this.spatialQueryMode=null}}]),i}();function nr(t){return(nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function or(t,e,n){return(or="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ar(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function ir(t,e){return(ir=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ar(t){return(ar=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.QueryByGeometryParameters=er;var sr=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ir(t,e)}(i,Tn);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=ar(n);return function(t,e){if(e&&("object"===nr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=ar(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t,e)).CLASS_NAME="SuperMap.QueryByGeometryService",e}return rr(i.prototype,[{key:"destroy",value:function(){or(ar(i.prototype),"destroy",this).call(this)}},{key:"getJsonParameters",value:function(t){if(t instanceof er){var e="",n=t.geometry,r=yn.fromGeometry(n),n=this.getQueryParameters(t);return"{"+(e+="'queryMode':'SpatialQuery','queryParameters':")+(B.toJSON(n)+",'geometry':"+B.toJSON(r)+",'spatialQueryMode':"+B.toJSON(t.spatialQueryMode))+"}"}}}]),i}();function lr(t){return(lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ur(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cr(t,e,n){return(cr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=pr(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function fr(t,e){return(fr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pr(t){return(pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.QueryByGeometryService=sr;var yr=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fr(t,e)}(i,Pt);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=pr(n);return function(t,e){if(e&&("object"===lr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return hr(t)}(this,r?(t=pr(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t=t||{})).returnContent=!0,B.extend(hr(e),t),e.CLASS_NAME="SuperMap.QueryBySQLParameters",e}return ur(i.prototype,[{key:"destroy",value:function(){cr(pr(i.prototype),"destroy",this).call(this),this.returnContent=null}}]),i}();function dr(t){return(dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gr(t,e,n){return(gr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=br(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function mr(t,e){return(mr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function br(t){return(br=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.QueryBySQLParameters=yr;var Sr=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mr(t,e)}(i,Tn);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=br(n);return function(t,e){if(e&&("object"===dr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=br(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t,e)).CLASS_NAME="SuperMap.QueryBySQLService",e}return vr(i.prototype,[{key:"destroy",value:function(){gr(br(i.prototype),"destroy",this).call(this)}},{key:"getJsonParameters",value:function(t){if(t instanceof yr){var e="",t=this.getQueryParameters(t);return"{"+((e+="'queryMode':'SqlQuery','queryParameters':")+B.toJSON(t))+"}"}}}]),i}();function _r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.QueryBySQLService=Sr;var wr=(_r(Or.prototype,[{key:"destroy",value:function(){var t=this;t.datasetNames=null,t.returnContent=null,t.fromIndex=null,t.toIndex=null,t.hasGeometry=null,t.maxFeatures=null,t.targetEpsgCode=null,t.targetPrj=null,t.aggregation&&(t.aggregation=null)}}]),Or);function Or(t){!function(t){if(!(t instanceof Or))throw new TypeError("Cannot call a class as a function")}(this),this.datasetNames=null,this.targetEpsgCode=null,this.targetPrj=null,this.returnContent=!0,this.fromIndex=0,this.toIndex=19,this.returnCountOnly=!1,this.maxFeatures=null,this.hasGeometry=!0,this.aggregations=null,B.extend(this,t),this.CLASS_NAME="SuperMap.GetFeaturesParametersBase"}function Er(t){return(Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pr(t,e,n){return(Pr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Tr(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Cr(t,e){return(Cr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tr(t){return(Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.GetFeaturesParametersBase=wr;var Rr=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Cr(t,e)}(i,wr);var t,e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Tr(n);return function(t,e){if(e&&("object"===Er(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return kr(t)}(this,r?(t=Tr(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t)).getFeatureMode=i.getFeatureMode.BOUNDS,e.bounds=null,e.fields=null,e.attributeFilter=null,e.spatialQueryMode=l.CONTAIN,B.extend(kr(e),t),e.CLASS_NAME="SuperMap.GetFeaturesByBoundsParameters",e}return e=[{key:"toJsonParameters",value:function(t){var e={leftBottom:{x:t.bounds.left,y:t.bounds.bottom},rightTop:{x:t.bounds.right,y:t.bounds.top}},n={datasetNames:t.datasetNames,getFeatureMode:i.getFeatureMode.BOUNDS,bounds:e,spatialQueryMode:t.spatialQueryMode};return t.fields&&((e=new Ot).name=t.datasetNames,e.fields=t.fields,n.queryParameter=e),t.attributeFilter&&(n.attributeFilter=t.attributeFilter,n.getFeatureMode=i.getFeatureMode.BOUNDS_ATTRIBUTEFILTER),t.maxFeatures&&!isNaN(t.maxFeatures)&&(n.maxFeatures=t.maxFeatures),"boolean"==typeof t.hasGeometry&&(n.hasGeometry=t.hasGeometry),t.targetEpsgCode&&(n.targetEpsgCode=t.targetEpsgCode),!t.targetEpsgCode&&t.targetPrj&&(n.targetPrj=t.targetPrj),t.aggregations&&(n.aggregations=t.aggregations),B.toJSON(n)}}],xr((t=i).prototype,[{key:"destroy",value:function(){Pr(Tr(i.prototype),"destroy",this).call(this);var t=this;if(t.bounds&&(t.bounds.destroy(),t.bounds=null),t.fields){for(;0<t.fields.length;)t.fields.pop();t.fields=null}t.attributeFilter=null,t.spatialQueryMode=null,t.getFeatureMode=null}}]),xr(t,e),i}();function Ar(t){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ir(t,e,n){return(Ir="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Mr(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Nr(t,e){return(Nr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Mr(t){return(Mr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Rr.getFeatureMode={BOUNDS:"BOUNDS",BOUNDS_ATTRIBUTEFILTER:"BOUNDS_ATTRIBUTEFILTER"},c.GetFeaturesByBoundsParameters=Rr;var Br=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nr(t,e)}(i,Z);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Mr(n);return function(t,e){if(e&&("object"===Ar(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return jr(t)}(this,r?(t=Mr(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),t=o.call(this,t,e),e=e||{},t.returnContent=!0,t.fromIndex=0,t.toIndex=19,t.hasGeometry=!0,t.maxFeatures=null,t.format=s.GEOJSON,B.extend(jr(t),e),t.url=B.urlPathAppend(t.url,"featureResults"),t.CLASS_NAME="SuperMap.GetFeaturesServiceBase",t}return Lr(i.prototype,[{key:"destroy",value:function(){Ir(Mr(i.prototype),"destroy",this).call(this);var t=this;t.returnContent=null,t.fromIndex=null,t.toIndex=null,t.maxFeatures=null,t.format=null,t.hasGeometry=null}},{key:"processAsync",value:function(t){var e,n;t&&(n=!0,(e=this).returnContent=t.returnContent,e.fromIndex=t.fromIndex,e.toIndex=t.toIndex,e.maxFeatures=t.maxFeatures,e.hasGeometry=t.hasGeometry,e.returnContent&&(e.url=B.urlAppend(e.url,"returnContent="+e.returnContent),n=!1),null!=e.fromIndex&&null!=e.toIndex&&!isNaN(e.fromIndex)&&!isNaN(e.toIndex)&&0<=e.fromIndex&&0<=e.toIndex&&!n&&(e.url=B.urlAppend(e.url,"fromIndex=".concat(e.fromIndex,"&toIndex=").concat(e.toIndex))),t.returnCountOnly&&(e.url=B.urlAppend(e.url,"&returnCountOnly="+t.returnContent)),t=e.getJsonParameters(t),e.request({method:"POST",data:t,scope:e,success:e.serviceProcessCompleted,failure:e.serviceProcessFailed}))}},{key:"serviceProcessCompleted",value:function(t){var e;t=B.transformResult(t),this.format===s.GEOJSON&&t.features&&(e=new _n,t.features=e.toGeoJSON(t.features)),this.events.triggerEvent("processCompleted",{result:t})}}]),i}();function Dr(t){return(Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ur(t,e,n){return(Ur="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gr(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Hr(t,e){return(Hr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gr(t){return(Gr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.GetFeaturesServiceBase=Br;var Wr=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hr(t,e)}(i,Br);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Gr(n);return function(t,e){if(e&&("object"===Dr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Gr(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t,e)).CLASS_NAME="SuperMap.GetFeaturesByBoundsService",e}return Fr(i.prototype,[{key:"destroy",value:function(){Ur(Gr(i.prototype),"destroy",this).call(this)}},{key:"getJsonParameters",value:function(t){return Rr.toJsonParameters(t)}}]),i}();function Vr(t){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yr(t,e,n){return(Yr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Jr(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function qr(t,e){return(qr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Xr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jr(t){return(Jr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.GetFeaturesByBoundsService=Wr;var Qr=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),qr(t,e)}(i,wr);var t,e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Jr(n);return function(t,e){if(e&&("object"===Vr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Xr(t)}(this,r?(t=Jr(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t)).bufferDistance=null,e.attributeFilter=null,e.geometry=null,e.fields=null,B.extend(Xr(e),t),e.CLASS_NAME="SuperMap.GetFeaturesByBufferParameters",e}return e=[{key:"toJsonParameters",value:function(t){var e=yn.fromGeometry(t.geometry),n={datasetNames:t.datasetNames,getFeatureMode:"BUFFER",bufferDistance:t.bufferDistance,geometry:e};return t.fields&&((e=new Ot).name=t.datasetNames,e.fields=t.fields,n.queryParameter=e),t.attributeFilter&&(n.attributeFilter=t.attributeFilter,n.getFeatureMode="BUFFER_ATTRIBUTEFILTER"),t.maxFeatures&&!isNaN(t.maxFeatures)&&(n.maxFeatures=t.maxFeatures),"boolean"==typeof t.hasGeometry&&(n.hasGeometry=t.hasGeometry),t.targetEpsgCode&&(n.targetEpsgCode=t.targetEpsgCode),!t.targetEpsgCode&&t.targetPrj&&(n.targetPrj=t.targetPrj),B.toJSON(n)}}],zr((t=i).prototype,[{key:"destroy",value:function(){Yr(Jr(i.prototype),"destroy",this).call(this);if(this.bufferDistance=null,this.attributeFilter=null,this.fields){for(;0<this.fields.length;)this.fields.pop();this.fields=null}this.geometry&&(this.geometry.destroy(),this.geometry=null)}}]),zr(t,e),i}();function Kr(t){return(Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $r(t,e,n){return($r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=eo(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function to(t,e){return(to=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function eo(t){return(eo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.GetFeaturesByBufferParameters=Qr;var no=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&to(t,e)}(i,Br);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=eo(n);return function(t,e){if(e&&("object"===Kr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=eo(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t,e)).CLASS_NAME="SuperMap.GetFeaturesByBufferService",e}return Zr(i.prototype,[{key:"destroy",value:function(){$r(eo(i.prototype),"destroy",this).call(this)}},{key:"getJsonParameters",value:function(t){if(t instanceof Qr)return c.GetFeaturesByBufferParameters.toJsonParameters(t)}}]),i}();function ro(t){return(ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function io(t,e,n){return(io="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=lo(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function ao(t,e){return(ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function so(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lo(t){return(lo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.GetFeaturesByBufferService=no;var uo=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),ao(t,e)}(i,wr);var t,e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=lo(n);return function(t,e){if(e&&("object"===ro(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return so(t)}(this,r?(t=lo(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t)).getFeatureMode="SPATIAL",e.geometry=null,e.fields=null,e.attributeFilter=null,e.spatialQueryMode=l.CONTAIN,B.extend(so(e),t),e.CLASS_NAME="SuperMap.GetFeaturesByGeometryParameters",e}return e=[{key:"toJsonParameters",value:function(t){var e=yn.fromGeometry(t.geometry),n={datasetNames:t.datasetNames,getFeatureMode:"SPATIAL",geometry:e,spatialQueryMode:t.spatialQueryMode};return t.fields&&((e=new Ot).name=t.datasetNames,e.fields=t.fields,n.queryParameter=e),t.attributeFilter&&(n.attributeFilter=t.attributeFilter,n.getFeatureMode="SPATIAL_ATTRIBUTEFILTER"),t.maxFeatures&&!isNaN(t.maxFeatures)&&(n.maxFeatures=t.maxFeatures),"boolean"==typeof t.hasGeometry&&(n.hasGeometry=t.hasGeometry),t.targetEpsgCode&&(n.targetEpsgCode=t.targetEpsgCode),!t.targetEpsgCode&&t.targetPrj&&(n.targetPrj=t.targetPrj),t.aggregations&&(n.aggregations=t.aggregations),B.toJSON(n)}}],oo((t=i).prototype,[{key:"destroy",value:function(){io(lo(i.prototype),"destroy",this).call(this);var t=this;if(t.geometry&&(t.geometry.destroy(),t.geometry=null),t.fields){for(;0<t.fields.length;)t.fields.pop();t.fields=null}t.attributeFilter=null,t.spatialQueryMode=null,t.getFeatureMode=null}}]),oo(t,e),i}();function co(t){return(co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ho(t,e,n){return(ho="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=yo(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function po(t,e){return(po=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function yo(t){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.GetFeaturesByGeometryParameters=uo;var vo=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&po(t,e)}(i,Br);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=yo(n);return function(t,e){if(e&&("object"===co(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=yo(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t,e)).CLASS_NAME="SuperMap.GetFeaturesByGeometryService",e}return fo(i.prototype,[{key:"destroy",value:function(){ho(yo(i.prototype),"destroy",this).call(this)}},{key:"getJsonParameters",value:function(t){return uo.toJsonParameters(t)}}]),i}();function go(t){return(go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bo(t,e,n){return(bo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wo(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function So(t,e){return(So=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wo(t){return(wo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.GetFeaturesByGeometryService=vo;var Oo=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),So(t,e)}(i,wr);var t,e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=wo(n);return function(t,e){if(e&&("object"===go(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _o(t)}(this,r?(t=wo(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t)).getFeatureMode="ID",e.IDs=null,e.fields=null,B.extend(_o(e),t),e.CLASS_NAME="SuperMap.GetFeaturesByIDsParameters",e}return e=[{key:"toJsonParameters",value:function(t){var e,n={datasetNames:t.datasetNames,getFeatureMode:"ID",ids:t.IDs};return t.fields&&((e=new Ot).name=t.datasetNames,e.fields=t.fields,n.queryParameter=e),t.targetEpsgCode&&(n.targetEpsgCode=t.targetEpsgCode),"boolean"==typeof t.hasGeometry&&(n.hasGeometry=t.hasGeometry),!t.targetEpsgCode&&t.targetPrj&&(n.targetPrj=t.targetPrj),t.aggregations&&(n.aggregations=t.aggregations),B.toJSON(n)}}],mo((t=i).prototype,[{key:"destroy",value:function(){bo(wo(i.prototype),"destroy",this).call(this);if(this.IDs=null,this.getFeatureMode=null,this.fields){for(;0<this.fields.length;)this.fields.pop();this.fields=null}}}]),mo(t,e),i}();function Eo(t){return(Eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Po(t,e,n){return(Po="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ko(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Co(t,e){return(Co=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ko(t){return(ko=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.GetFeaturesByIDsParameters=Oo;var To=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Co(t,e)}(i,Br);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=ko(n);return function(t,e){if(e&&("object"===Eo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=ko(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t,e)).CLASS_NAME="SuperMap.GetFeaturesByIDsService",e}return xo(i.prototype,[{key:"destroy",value:function(){Po(ko(i.prototype),"destroy",this).call(this)}},{key:"getJsonParameters",value:function(t){return Oo.toJsonParameters(t)}}]),i}();function Ro(t){return(Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ao(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Lo(t,e,n){return(Lo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jo(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Io(t,e){return(Io=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function No(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jo(t){return(jo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.GetFeaturesByIDsService=To;var Mo=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Io(t,e)}(i,wr);var t,e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=jo(n);return function(t,e){if(e&&("object"===Ro(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return No(t)}(this,r?(t=jo(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t)).getFeatureMode="SQL",e.queryParameter=null,B.extend(No(e),t),e.CLASS_NAME="SuperMap.GetFeaturesBySQLParameters",e}return e=[{key:"toJsonParameters",value:function(t){var e={datasetNames:t.datasetNames,getFeatureMode:"SQL",queryParameter:t.queryParameter};return t.maxFeatures&&!isNaN(t.maxFeatures)&&(e.maxFeatures=t.maxFeatures),"boolean"==typeof t.hasGeometry&&(e.hasGeometry=t.hasGeometry),t.aggregations&&(e.aggregations=t.aggregations),t.targetEpsgCode&&(e.targetEpsgCode=t.targetEpsgCode),!t.targetEpsgCode&&t.targetPrj&&(e.targetPrj=t.targetPrj),t.aggregations&&(e.aggregations=t.aggregations),B.toJSON(e)}}],Ao((t=i).prototype,[{key:"destroy",value:function(){Lo(jo(i.prototype),"destroy",this).call(this),this.getFeatureMode=null,this.queryParameter&&(this.queryParameter.destroy(),this.queryParameter=null)}}]),Ao(t,e),i}();function Bo(t){return(Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Do(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Fo(t,e,n){return(Fo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ho(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Uo(t,e){return(Uo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ho(t){return(Ho=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.GetFeaturesBySQLParameters=Mo;var Go=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Uo(t,e)}(i,Br);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Ho(n);return function(t,e){if(e&&("object"===Bo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Ho(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t,e)).CLASS_NAME="SuperMap.GetFeaturesBySQLService",e}return Do(i.prototype,[{key:"destroy",value:function(){Fo(Ho(i.prototype),"destroy",this).call(this)}},{key:"getJsonParameters",value:function(t){return Mo.toJsonParameters(t)}}]),i}();function Wo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.GetFeaturesBySQLService=Go;var Vo=(cs=[{key:"toJsonParameters",value:function(t){var e,n;if(t.editType===u.DELETE){if(null===t.IDs)return;n={ids:t.IDs}}else if(n=[],t.features)for(var r=t.features.length,o=0;o<r;o++)(e=t.features[o]).geometry=yn.fromGeometry(e.geometry),n.push(e);return B.toJSON(n)}}],Wo((ss=zo).prototype,[{key:"destroy",value:function(){this.dataSourceName=null,this.dataSetName=null,this.features=null,this.editType=null,this.IDs=null,this.returnContent=null}}]),Wo(ss,cs),zo);function zo(t){!function(t){if(!(t instanceof zo))throw new TypeError("Cannot call a class as a function")}(this),this.dataSourceName=null,this.dataSetName=null,this.features=null,this.editType=u.ADD,this.IDs=null,this.returnContent=!1,this.isUseBatch=!1,B.extend(this,t),this.CLASS_NAME="SuperMap.EditFeaturesParameters"}function Yo(t){return(Yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xo(t,e,n){return(Xo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ko(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Jo(t,e){return(Jo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ko(t){return(Ko=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.EditFeaturesParameters=Vo;var Zo=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jo(t,e)}(i,Z);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Ko(n);return function(t,e){if(e&&("object"===Yo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Qo(t)}(this,r?(t=Ko(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t,e)).returnContent=!1,t.isUseBatch=!1,e&&B.extend(Qo(t),e),t.url=B.urlPathAppend(t.url,"features"),t.CLASS_NAME="SuperMap.EditFeaturesService",t}return qo(i.prototype,[{key:"destroy",value:function(){Xo(Ko(i.prototype),"destroy",this).call(this),this.returnContent=null,this.isUseBatch=null,this.fromIndex=null,this.toIndex=null}},{key:"processAsync",value:function(t){var e,n,r,o,i;t instanceof Vo&&(n="POST",r="",o=t.editType,i=null,(e=this).returnContent=t.returnContent,e.isUseBatch=t.isUseBatch,i=Vo.toJsonParameters(t),o===u.DELETE?(r=B.toJSON(t.IDs),e.url=B.urlAppend(e.url,"ids="+r),n="DELETE",i=r):o===u.UPDATE?n="PUT":(e.isUseBatch&&(e.url=B.urlAppend(e.url,"isUseBatch=".concat(e.isUseBatch)),e.returnContent=!1),e.returnContent&&(e.url=B.urlAppend(e.url,"returnContent=true"),n="POST")),e.request({method:n,data:i,scope:e,success:e.serviceProcessCompleted,failure:e.serviceProcessFailed}))}}]),i}();function $o(t){return($o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ti(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ei(t,e){return(ei=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ni(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ri(t){return(ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.EditFeaturesService=Zo;var oi=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ei(t,e)}(i,Z);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=ri(n);return function(t,e){if(e&&("object"===$o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ni(t)}(this,r?(t=ri(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=e||{}).EVENT_TYPES=["broadcastSocketConnected","broadcastSocketError","broadcastFailed","broadcastSucceeded","subscribeSocketConnected","subscribeSocketError","messageSucceeded","setFilterParamSucceeded"],(t=o.call(this,t,e)).geometry=null,t.prjCoordSys=null,t.excludeField=null,B.extend(ni(t),e),t.CLASS_NAME="SuperMap.DataFlowService",t}return ti(i.prototype,[{key:"initBroadcast",value:function(){var e=this;return this.broadcastWebSocket=this._connect(B.urlPathAppend(e.url,"broadcast")),this.broadcastWebSocket.onopen=function(t){e.broadcastWebSocket.isOpen=!0,t.eventType="broadcastSocketConnected",e.events.triggerEvent("broadcastSocketConnected",t)},this.broadcastWebSocket.onclose=function(t){e.broadcastWebSocket.isOpen=!1,t.eventType="broadcastSocketConnected",e.events.triggerEvent("broadcastSocketConnected",t)},this.broadcastWebSocket.onerror=function(t){t.eventType="broadcastSocketError",e.events.triggerEvent("broadcastSocketError",t)},this}},{key:"broadcast",value:function(t){this.broadcastWebSocket&&this.broadcastWebSocket.isOpen?(this.broadcastWebSocket.send(JSON.stringify(t)),this.events.triggerEvent("broadcastSucceeded")):this.events.triggerEvent("broadcastFailed")}},{key:"initSubscribe",value:function(){var e=this;return this.subscribeWebSocket=this._connect(B.urlPathAppend(e.url,"subscribe")),this.subscribeWebSocket.onopen=function(t){e.subscribeWebSocket.send(e._getFilterParams()),t.eventType="subscribeSocketConnected",e.events.triggerEvent("subscribeSocketConnected",t)},this.subscribeWebSocket.onerror=function(t){t.eventType="subscribeSocketError",e.events.triggerEvent("subscribeSocketError",t)},this.subscribeWebSocket.onmessage=function(t){e._onMessage(t)},this}},{key:"setExcludeField",value:function(t){return this.excludeField=t,this.subscribeWebSocket.send(this._getFilterParams()),this}},{key:"setGeometry",value:function(t){return this.geometry=t,this.subscribeWebSocket.send(this._getFilterParams()),this}},{key:"unSubscribe",value:function(){this.subscribeWebSocket&&(this.subscribeWebSocket.close(),this.subscribeWebSocket=null)}},{key:"unBroadcast",value:function(){this.broadcastWebSocket&&(this.broadcastWebSocket.close(),this.broadcastWebSocket=null)}},{key:"destroy",value:function(){Z.prototype.destroy.apply(this,arguments),this.geometry=null,this.prjCoordSys=null,this.excludeField=null,this.unBroadcast(),this.unSubscribe()}},{key:"_getFilterParams",value:function(){var t={filterParam:{prjCoordSys:this.prjCoordSys,excludeField:this.excludeField,geometry:this.geometry}};return B.toJSON(t)}},{key:"_onMessage",value:function(t){if(t.data&&0<=t.data.indexOf("filterParam")){var e=JSON.parse(t.data);return t.filterParam=e,t.eventType="setFilterParamSucceeded",void this.events.triggerEvent("setFilterParamSucceeded",t)}e=JSON.parse(t.data);t.featureResult=e,t.eventType="messageSucceeded",this.events.triggerEvent("messageSucceeded",t)}},{key:"_connect",value:function(t){return t=C.appendCredential(t),"WebSocket"in window?new WebSocket(t):"MozWebSocket"in window?new window.MozWebSocket(t):(console.log("no WebSocket"),null)}}]),i}();function ii(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.DataFlowService=oi;var ai=(ii(si.prototype,[{key:"destroy",value:function(){this.address=null,this.fromIndex=null,this.toIndex=null,this.filters=null,this.prjCoordSys=null,this.maxReturn=null}}]),si);function si(t){!function(t){if(!(t instanceof si))throw new TypeError("Cannot call a class as a function")}(this),t.filters&&"string"==typeof t.filters&&(t.filters=t.filters.split(",")),this.address=null,this.fromIndex=null,this.toIndex=null,this.filters=null,this.prjCoordSys=null,this.maxReturn=null,B.extend(this,t)}function li(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.GeoCodingParameter=ai;var ui=(li(ci.prototype,[{key:"destroy",value:function(){this.x=null,this.y=null,this.fromIndex=null,this.toIndex=null,this.filters=null,this.prjCoordSys=null,this.maxReturn=null,this.geoDecodingRadius=null}}]),ci);function ci(t){!function(t){if(!(t instanceof ci))throw new TypeError("Cannot call a class as a function")}(this),t.filters&&(t.filters=t.filters.split(",")),this.x=null,this.y=null,this.fromIndex=null,this.toIndex=null,this.filters=null,this.prjCoordSys=null,this.maxReturn=null,this.geoDecodingRadius=null,B.extend(this,t)}function fi(t){return(fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pi(t,e,n){return(pi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=di(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function yi(t,e){return(yi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function di(t){return(di=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.GeoDecodingParameter=ui;var vi=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yi(t,e)}(i,Z);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=di(n);return function(t,e){if(e&&("object"===fi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=di(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t,e)).options=e||{},t.CLASS_NAME="SuperMap.AddressMatchService",t}return hi(i.prototype,[{key:"destroy",value:function(){pi(di(i.prototype),"destroy",this).call(this)}},{key:"code",value:function(t,e){e instanceof ai&&this.processAsync(t,e)}},{key:"decode",value:function(t,e){e instanceof ui&&this.processAsync(t,e)}},{key:"processAsync",value:function(t,e){this.request({method:"GET",url:t,params:e,scope:this,success:this.serviceProcessCompleted,failure:this.serviceProcessFailed})}},{key:"serviceProcessCompleted",value:function(t){t.succeed&&delete t.succeed,pi(di(i.prototype),"serviceProcessCompleted",this).call(this,t)}},{key:"serviceProcessFailed",value:function(t){pi(di(i.prototype),"serviceProcessFailed",this).call(this,t)}}]),i}();function gi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.AddressMatchService=vi;var mi=(y=[{key:"fromJson",value:function(t){var e=null;if(t)return(e=t.geometry)&&(e=yn.fromJson(e)),new bi({fieldNames:t.fieldNames,fieldValues:t.fieldValues,geometry:e})}}],gi((ps=bi).prototype,[{key:"destroy",value:function(){this.fieldNames=null,this.fieldValues=null,this.geometry&&(this.geometry.destroy(),this.geometry=null)}},{key:"toFeature",value:function(){var t,e,n={},r=this.fieldNames,o=this.fieldValues;for(e in r)n[r[e]]=o[e];return this.geometry&&(t=this.geometry.toGeometry()),t=new Wt(t,n),this.geometry&&this.geometry.id&&(t.fid=this.geometry.id),t}}]),gi(ps,y),bi);function bi(t){!function(t){if(!(t instanceof bi))throw new TypeError("Cannot call a class as a function")}(this),this.fieldNames=null,this.fieldValues=null,this.geometry=null,t&&B.extend(this,t),this.CLASS_NAME="SuperMap.ServerFeature"}function Si(t){return(Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wi(t,e,n){return(wi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ei(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Oi(t,e){return(Oi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ei(t){return(Ei=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.ServerFeature=mi;var xi=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Oi(t,e)}(i,te);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Ei(n);return function(t,e){if(e&&("object"===Si(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Ei(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e,n){var r;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(r=o.call(this,t,e,n)).x=parseFloat(t),r.y=parseFloat(e),r.text=n.toString(),r.bsInfo={h:null,w:null},r.element=document.createElement("span"),r.CLASS_NAME="SuperMap.Geometry.GeoText",r.geometryType="GeoText",r}return _i(i.prototype,[{key:"destroy",value:function(){wi(Ei(i.prototype),"destroy",this).call(this),this.x=null,this.y=null,this.text=null}},{key:"getCentroid",value:function(){return new pe(this.x,this.y)}},{key:"clone",value:function(t){return null==t&&(t=new i(this.x,this.y,this.text)),B.applyDefaults(t,this),t}},{key:"calculateBounds",value:function(){this.bounds=new Kt(this.x,this.y,this.x,this.y)}},{key:"getLabelPxBoundsByLabel",value:function(t,e,n,r){var o,i=B.cloneObject(t),a=(r.label||this.text).split("\n").length;if(e=parseFloat(e),n=parseFloat(n),1<a&&(n=parseFloat(n)*a),r.labelAlign&&"cm"!==r.labelAlign)switch(r.labelAlign){case"lt":i.x+=e/2,i.y+=n/2;break;case"lm":i.x+=e/2;break;case"lb":i.x+=e/2,i.y-=n/2;break;case"ct":i.y+=n/2;break;case"cb":i.y-=n/2;break;case"rt":i.x-=e/2,i.y+=n/2;break;case"rm":i.x-=e/2;break;case"rb":i.x-=e/2,i.y-=n/2}return this.bsInfo.h=n,this.bsInfo.w=e,o=i.x-parseFloat(e)/2,t=i.y+parseFloat(n)/2,a=i.x+parseFloat(e)/2,r=i.y-parseFloat(n)/2,new Kt(o,t,a,r)}},{key:"getLabelPxBoundsByText",value:function(t,e){var n,r,o=this.getLabelPxSize(e),i=B.cloneObject(t);if(e.labelAlign&&"cm"!==e.labelAlign)switch(e.labelAlign){case"lt":i.x+=o.w/2,i.y+=o.h/2;break;case"lm":i.x+=o.w/2;break;case"lb":i.x+=o.w/2,i.y-=o.h/2;break;case"ct":i.y+=o.h/2;break;case"cb":i.y-=o.h/2;break;case"rt":i.x-=o.w/2,i.y+=o.h/2;break;case"rm":i.x-=o.w/2;break;case"rb":i.x-=o.w/2,i.y-=o.h/2}return this.bsInfo.h=o.h,this.bsInfo.w=o.w,n=i.x-o.w/2,r=i.y+o.h/2,t=e.fontStyle&&"italic"===e.fontStyle?i.x+o.w/2+parseInt(parseFloat(e.fontSize)/2):i.x+o.w/2,e=i.y-o.h/2,new Kt(n,r,t,e)}},{key:"getLabelPxSize",value:function(t){var e=parseFloat(t.strokeWidth),n=t.label||this.text,r=t.fontSize?parseFloat(t.fontSize):parseFloat("12px"),o=n.split("\n"),i=o.length,n=1<i?r*i+i+e+.2*r:r+e+.2*r+1,a=0;this.labelWTmp&&a<this.labelWTmp&&(a=this.labelWTmp);for(var s=0;s<i;s++){var l=this.getTextCount(o[s]),l=this.labelWTmp=B.getTextBounds(t,o[s],this.element).textWidth+ +l.textC+e;a<l&&(a=l)}r=new Object;return r.h=n,r.w=a,r}},{key:"getTextCount",value:function(t){for(var e={},n=0,r=0,o=0;o<t.length;o++)255<t.charCodeAt(o)?n++:r++;return e.cnC=n,e.enC=r,e.textC=t.length,e}}]),i}();function Pi(t){return(Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ci(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ki(t,e){return(ki=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ti(t){return(Ti=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Geometry.GeoText=xi;var Ri=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),ki(t,e)}(a,te);var n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Ti(n);return function(t,e){if(e&&("object"===Pi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Ti(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function a(t,e,n,r){var o;return function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),(o=i.call(this,t,e,n,r)).x=t,o.y=e,o.width=n,o.height=r,o.CLASS_NAME="SuperMap.Geometry.Rectangle",o.geometryType="Rectangle",o}return Ci(a.prototype,[{key:"calculateBounds",value:function(){this.bounds=new Kt(this.x,this.y,this.x+this.width,this.y+this.height)}},{key:"getArea",value:function(){return this.width*this.height}}]),a}();function Ai(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Geometry.Rectangle=Ri,c.Date={toISOString:function(){if("toISOString"in Date.prototype)return function(t){return t.toISOString()};function e(t,e){for(var n=t+"";n.length<e;)n="0"+n;return n}return function(t){return isNaN(t.getTime())?"Invalid Date":t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1,2)+"-"+e(t.getUTCDate(),2)+"T"+e(t.getUTCHours(),2)+":"+e(t.getUTCMinutes(),2)+":"+e(t.getUTCSeconds(),2)+"."+e(t.getUTCMilliseconds(),3)+"Z"}}(),parse:function(t){var e,n,r,o,i,a=t.match(/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/);return a&&(a[1]||a[7])?(n=parseInt(a[1],10)||0,o=parseInt(a[2],10)-1||0,r=parseInt(a[3],10)||1,i=new Date(Date.UTC(n,o,r)),(e=a[7])&&(t=parseInt(a[4],10),n=parseInt(a[5],10),r=0|(o=parseFloat(a[6])),o=Math.round(1e3*(o-r)),i.setUTCHours(t,n,r,o),"Z"!==e&&(a=-1e3*(60*parseInt(e,10)*60+60*(parseInt(a[8],10)||0)),i=new Date(i.getTime()+a)))):i=new Date("invalid"),i}};var Li=(Ai(Ii.prototype,[{key:"destroy",value:function(){this.refOriginalPosition=null,this.refDataID=null,this.isHoverByRefDataID=null,this.refDataHoverGroup=null,this.dataInfo=null,this.clickable=null,this.hoverable=null,this.style=null,this.highlightStyle=null}}]),Ii);function Ii(){!function(t){if(!(t instanceof Ii))throw new TypeError("Cannot call a class as a function")}(this),this.refOriginalPosition=[0,0],this.refDataID=null,this.isHoverByRefDataID=!1,this.refDataHoverGroup=null,this.dataInfo=null,this.clickable=!0,this.hoverable=!0,this.style=null,this.highlightStyle={},this.CLASS_NAME="SuperMap.Feature.ShapeParameters"}function Ni(t){return(Ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ji(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mi(t,e,n){return(Mi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Di(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Bi(t,e){return(Bi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Di(t){return(Di=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature=c.Feature||{},c.Feature.ShapeParameters=Li;var Fi=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Bi(t,e)}(i,Li);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Di(n);return function(t,e){if(e&&("object"===Ni(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Di(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){var n;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(n=o.call(this,t,e)).x=isNaN(t)?0:t,n.y=isNaN(e)?0:e,n.r=6,n.CLASS_NAME="SuperMap.Feature.ShapeParameters.Point",n}return ji(i.prototype,[{key:"destroy",value:function(){this.x=null,this.y=null,this.r=null,Mi(Di(i.prototype),"destroy",this).call(this)}}]),i}();function Ui(t){return(Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gi(t,e,n){return(Gi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Vi(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Wi(t,e){return(Wi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vi(t){return(Vi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature=c.Feature||{},c.Feature.ShapeParameters.Point=Fi;var zi=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Wi(t,e)}(i,Li);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Vi(n);return function(t,e){if(e&&("object"===Ui(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Vi(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t)).pointList=t,e.CLASS_NAME="SuperMap.Feature.ShapeParameters.Line",e}return Hi(i.prototype,[{key:"destroy",value:function(){this.pointList=null,Gi(Vi(i.prototype),"destroy",this).call(this)}}]),i}();function Yi(t){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xi(t,e,n){return(Xi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qi(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Ji(t,e){return(Ji=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qi(t){return(Qi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature=c.Feature||{},c.Feature.ShapeParameters.Line=zi;var Ki=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Ji(t,e)}(i,Li);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Qi(n);return function(t,e){if(e&&("object"===Yi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Qi(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=o.call(this,t)).pointList=t,e.holePolygonPointLists=null,e.CLASS_NAME="SuperMap.Feature.ShapeParameters.Polygon",e}return qi(i.prototype,[{key:"destroy",value:function(){this.pointList=null,this.holePolygonPointLists=null,Xi(Qi(i.prototype),"destroy",this).call(this)}}]),i}();function Zi(t){return(Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ta(t,e,n){return(ta="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=na(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function ea(t,e){return(ea=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function na(t){return(na=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature=c.Feature||{},c.Feature.ShapeParameters.Polygon=Ki;var ra=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),ea(t,e)}(a,Li);var n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=na(n);return function(t,e){if(e&&("object"===Zi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=na(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function a(t,e,n,r){var o;return function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),(o=i.call(this,t,e,n,r)).x=isNaN(t)?0:t,o.y=isNaN(t)?0:e,o.width=isNaN(n)?0:n,o.height=isNaN(r)?0:r,o.CLASS_NAME="SuperMap.Feature.ShapeParameters.Rectangle",o}return $i(a.prototype,[{key:"destroy",value:function(){this.x=null,this.y=null,this.width=null,this.height=null,ta(na(a.prototype),"destroy",this).call(this)}}]),a}();function oa(t){return(oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ia(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function aa(t,e,n){return(aa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=la(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function sa(t,e){return(sa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function la(t){return(la=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature=c.Feature||{},c.Feature.ShapeParameters.Rectangle=ra;var ua=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),sa(t,e)}(u,Li);var n,r,l=(n=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=la(n);return function(t,e){if(e&&("object"===oa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=la(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function u(t,e,n,r,o,i,a){var s;return function(t){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}(this),(s=l.call(this,t,e,n,r,o,i,a)).x=isNaN(t)?0:t,s.y=isNaN(e)?0:e,s.r=isNaN(n)?0:n,s.startAngle=isNaN(r)?0:r,s.endAngle=isNaN(o)?0:o,s.r0=isNaN(i)?0:i,s.clockWise=a,s.CLASS_NAME="SuperMap.Feature.ShapeParameters.Sector",s}return ia(u.prototype,[{key:"destroy",value:function(){this.x=null,this.y=null,this.r=null,this.startAngle=null,this.endAngle=null,this.r0=null,this.clockWise=null,aa(la(u.prototype),"destroy",this).call(this)}}]),u}();function ca(t){return(ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ha(t,e,n){return(ha="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ya(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function pa(t,e){return(pa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ya(t){return(ya=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature=c.Feature||{},c.Feature.ShapeParameters.Sector=ua;var da=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),pa(t,e)}(i,Li);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=ya(n);return function(t,e){if(e&&("object"===ca(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=ya(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e,n){var r;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(r=o.call(this,t,e,n)).x=t,r.y=e,r.text=n,r.CLASS_NAME="SuperMap.Feature.ShapeParameters.Label",r}return fa(i.prototype,[{key:"destroy",value:function(){this.x=null,this.y=null,this.text=null,ha(ya(i.prototype),"destroy",this).call(this)}}]),i}();function va(t){return(va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ga(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ma(t,e,n){return(ma="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sa(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function ba(t,e){return(ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Sa(t){return(Sa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature=c.Feature||{},c.Feature.ShapeParameters.Label=da;var _a=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),ba(t,e)}(f,Li);var n,r,c=(n=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Sa(n);return function(t,e){if(e&&("object"===va(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Sa(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function f(t,e,n,r,o,i,a,s,l){var u;return function(t){if(!(t instanceof f))throw new TypeError("Cannot call a class as a function")}(this),(u=c.call(this,t,e,n,r,o,i,a,s,l)).x=t,u.y=e,u.image=n,u.width=r,u.height=o,u.sx=i,u.sy=a,u.sWidth=s,u.sHeight=l,u.CLASS_NAME="SuperMap.Feature.ShapeParameters.Image",u}return ga(f.prototype,[{key:"destroy",value:function(){this.x=null,this.y=null,this.image=null,this.width=null,this.height=null,this.sx=null,this.sy=null,this.sWidth=null,this.sHeight=null,ma(Sa(f.prototype),"destroy",this).call(this)}}]),f}();function wa(t){return(wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ea(t,e,n){return(Ea="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Pa(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function xa(t,e){return(xa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pa(t){return(Pa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature=c.Feature||{},c.Feature.ShapeParameters.Image=_a;var Ca=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),xa(t,e)}(i,Li);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Pa(n);return function(t,e){if(e&&("object"===wa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Pa(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e,n){var r;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(r=o.call(this,t,e,n)).x=isNaN(t)?0:t,r.y=isNaN(e)?0:e,r.r=isNaN(n)?0:n,r.CLASS_NAME="SuperMap.Feature.ShapeParameters.Circle",r}return Oa(i.prototype,[{key:"destroy",value:function(){this.x=null,this.y=null,this.r=null,Ea(Pa(i.prototype),"destroy",this).call(this)}}]),i}();function ka(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Feature=c.Feature||{},c.Feature.ShapeParameters.Circle=Ca;var Ta=(ka(Ra.prototype,[{key:"destroy",value:function(){this._handlers=null}},{key:"one",value:function(t,e,n){var r=this._handlers;return e&&t&&(r[t]||(r[t]=[]),r[t].push({h:e,one:!0,ctx:n||this})),this}},{key:"bind",value:function(t,e,n){var r=this._handlers;return e&&t&&(r[t]||(r[t]=[]),r[t].push({h:e,one:!1,ctx:n||this})),this}},{key:"unbind",value:function(t,e){var n=this._handlers;if(!t)return this._handlers={},this;if(e){if(n[t]){for(var r=[],o=0,i=n[t].length;o<i;o++)n[t][o].h!=e&&r.push(n[t][o]);n[t]=r}n[t]&&0===n[t].length&&delete n[t]}else delete n[t];return this}},{key:"dispatch",value:function(t){if(this._handlers[t]){var e=arguments,n=e.length;3<n&&(e=Array.prototype.slice.call(e,1));for(var r=this._handlers[t],o=r.length,i=0;i<o;){switch(n){case 1:r[i].h.call(r[i].ctx);break;case 2:r[i].h.call(r[i].ctx,e[1]);break;case 3:r[i].h.call(r[i].ctx,e[1],e[2]);break;default:r[i].h.apply(r[i].ctx,e)}r[i].one?(r.splice(i,1),o--):i++}}return this}},{key:"dispatchWithContext",value:function(t){if(this._handlers[t])for(var e=arguments,n=e.length,r=(e=4<n?Array.prototype.slice.call(e,1,e.length-1):e)[e.length-1],o=this._handlers[t],i=o.length,a=0;a<i;){switch(n){case 1:o[a].h.call(r);break;case 2:o[a].h.call(r,e[1]);break;case 3:o[a].h.call(r,e[1],e[2]);break;default:o[a].h.apply(r,e)}o[a].one?(o.splice(a,1),i--):a++}return this}}]),Ra);function Ra(){!function(t){if(!(t instanceof Ra))throw new TypeError("Cannot call a class as a function")}(this),this._handlers={},this.CLASS_NAME="SuperMap.LevelRenderer.Eventful"}function Aa(t){return(Aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function La(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ia=(La(Na.prototype,[{key:"clone",value:function(t){var e=this.BUILTIN_OBJECT;if("object"!=Aa(t)||null===t)return t;var n=t;if(t instanceof Array)for(var n=[],r=0,o=t.length;r<o;r++)n[r]=this.clone(t[r]);else if(!e[Object.prototype.toString.call(t)])for(var i in n={},t)t.hasOwnProperty(i)&&(n[i]=this.clone(t[i]));return n}},{key:"mergeItem",value:function(t,e,n,r){var o=this.BUILTIN_OBJECT;e.hasOwnProperty(n)&&("object"!=Aa(t[n])||o[Object.prototype.toString.call(t[n])]?!r&&n in t||(t[n]=e[n]):this.merge(t[n],e[n],r))}},{key:"merge",value:function(t,e,n){for(var r in e)this.mergeItem(t,e,r,n);return t}},{key:"getContext",value:function(){return this._ctx||(this._ctx=document.createElement("canvas").getContext("2d")),this._ctx}},{key:"getPixelContext",value:function(){return this._pixelCtx||(this._canvas=document.createElement("canvas"),this._width=this._canvas.width,this._height=this._canvas.height,this._pixelCtx=this._canvas.getContext("2d")),this._pixelCtx}},{key:"adjustCanvasSize",value:function(t,e){var n,r=this._canvas,o=this._pixelCtx,i=this._width,a=this._height,s=this._offsetX,l=this._offsetY;i<t+s&&(r.width=i=t+s+100,n=!0),a<e+l&&(r.height=a=e+l+100,n=!0),t<-s&&(i+=s=100*Math.ceil(-t/100),r.width=i,n=!0),e<-l&&(a+=l=100*Math.ceil(-e/100),r.height=a,n=!0),n&&o.translate(s,l)}},{key:"getPixelOffset",value:function(){return{x:this._offsetX,y:this._offsetY}}},{key:"indexOf",value:function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}},{key:"inherits",value:function(t,e){var n,r=t.prototype;function o(){}for(n in o.prototype=e.prototype,t.prototype=new o,r)t.prototype[n]=r[n];t.constructor=t}}]),Na);function Na(){!function(t){if(!(t instanceof Na))throw new TypeError("Cannot call a class as a function")}(this),this.BUILTIN_OBJECT={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1},this._ctx=null,this._canvas=null,this._pixelCtx=null,this._width=null,this._height=null,this._offsetX=0,this._offsetY=0,this.CLASS_NAME="SuperMap.LevelRenderer.Tool.Util"}function ja(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ma=(ja(Ba.prototype,[{key:"create",value:function(t,e){var n=new this.ArrayCtor(2);return n[0]=t||0,n[1]=e||0,n}},{key:"copy",value:function(t,e){return t[0]=e[0],t[1]=e[1],t}},{key:"set",value:function(t,e,n){return t[0]=e,t[1]=n,t}},{key:"add",value:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}},{key:"scaleAndAdd",value:function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}},{key:"sub",value:function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}},{key:"len",value:function(t){return Math.sqrt(this.lenSquare(t))}},{key:"lenSquare",value:function(t){return t[0]*t[0]+t[1]*t[1]}},{key:"mul",value:function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}},{key:"div",value:function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}},{key:"dot",value:function(t,e){return t[0]*e[0]+t[1]*e[1]}},{key:"scale",value:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}},{key:"normalize",value:function(t,e){var n=this.len(e);return 0===n?(t[0]=0,t[1]=0):(t[0]=e[0]/n,t[1]=e[1]/n),t}},{key:"distance",value:function(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}},{key:"distanceSquare",value:function(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}},{key:"negate",value:function(t,e){return t[0]=-e[0],t[1]=-e[1],t}},{key:"lerp",value:function(t,e,n,r){return t[0]=e[0]+r*(n[0]-e[0]),t[1]=e[1]+r*(n[1]-e[1]),t}},{key:"applyTransform",value:function(t,e,n){var r=e[0],e=e[1];return t[0]=n[0]*r+n[2]*e+n[4],t[1]=n[1]*r+n[3]*e+n[5],t}},{key:"min",value:function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}},{key:"max",value:function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}},{key:"length",value:function(t){return this.len(t)}},{key:"lengthSquare",value:function(t){return this.lenSquare(t)}},{key:"dist",value:function(t,e){return this.distance(t,e)}},{key:"distSquare",value:function(t,e){return this.distanceSquare(t,e)}}]),Ba);function Ba(){!function(t){if(!(t instanceof Ba))throw new TypeError("Cannot call a class as a function")}(this),this.ArrayCtor="undefined"==typeof Float32Array?Array:Float32Array,this.CLASS_NAME="SuperMap.LevelRenderer.Tool.Vector"}function Da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Fa=(Da(Ua.prototype,[{key:"isAroundZero",value:function(t){return t>-this.EPSILON&&t<this.EPSILON}},{key:"isNotAroundZero",value:function(t){return t>this.EPSILON||t<-this.EPSILON}},{key:"cubicAt",value:function(t,e,n,r,o){var i=1-o;return i*i*(i*t+3*o*e)+o*o*(o*r+3*i*n)}},{key:"cubicDerivativeAt",value:function(t,e,n,r,o){var i=1-o;return 3*(((e-t)*i+2*(n-e)*o)*i+(r-n)*o*o)}},{key:"cubicRootAt",value:function(t,e,n,r,o,i){var a,s,l,u,c=r+3*(e-n)-t,f=3*(n-2*e+t),r=3*(e-t),n=t-o,e=f*f-3*c*r,t=f*r-9*c*n,o=r*r-3*f*n,n=0;return this.isAroundZero(e)&&this.isAroundZero(t)?this.isAroundZero(f)?i[0]=0:0<=(a=-r/f)&&a<=1&&(i[n++]=a):this.isAroundZero(r=t*t-4*e*o)?(o=-(a=t/e)/2,0<=(a=-f/c+a)&&a<=1&&(i[n++]=a),0<=o&&o<=1&&(i[n++]=o)):0<r?(s=e*f+1.5*c*(-t-(l=Math.sqrt(r))),0<=(l=(-f-((u=(u=e*f+1.5*c*(-t+l))<0?-Math.pow(-u,this.ONE_THIRD):Math.pow(u,this.ONE_THIRD))+(s=s<0?-Math.pow(-s,this.ONE_THIRD):Math.pow(s,this.ONE_THIRD))))/(3*c))&&l<=1&&(i[n++]=l)):(u=(2*e*f-3*c*t)/(2*Math.sqrt(e*e*e)),s=Math.acos(u)/3,u=(-f-2*(l=Math.sqrt(e))*(t=Math.cos(s)))/(3*c),e=(-f+l*(t+this.THREE_SQRT*Math.sin(s)))/(3*c),c=(-f+l*(t-this.THREE_SQRT*Math.sin(s)))/(3*c),0<=u&&u<=1&&(i[n++]=u),0<=e&&e<=1&&(i[n++]=e),0<=c&&c<=1&&(i[n++]=c)),n}},{key:"cubicExtrema",value:function(t,e,n,r,o){var i,a=6*n-12*e+6*t,n=9*e+3*r-3*t-9*n,e=3*e-3*t,t=0;return this.isAroundZero(n)?!this.isNotAroundZero(a)||0<=(i=-e/a)&&i<=1&&(o[t++]=i):this.isAroundZero(i=a*a-4*n*e)?o[0]=-a/(2*n):0<i&&(i=(-a-(e=Math.sqrt(i)))/(2*n),0<=(n=(-a+e)/(2*n))&&n<=1&&(o[t++]=n),0<=i&&i<=1&&(o[t++]=i)),t}},{key:"cubicSubdivide",value:function(t,e,n,r,o,i){var a=(e-t)*o+t,s=(n-e)*o+e,e=(r-n)*o+n,n=(s-a)*o+a,s=(e-s)*o+s,o=(s-n)*o+n;i[0]=t,i[1]=a,i[2]=n,i[3]=o,i[4]=o,i[5]=s,i[6]=e,i[7]=r}},{key:"cubicProjectPoint",value:function(t,e,n,r,o,i,a,s,l,u,c){var f,h=this.vector.create(),p=this.vector.create(),y=this.vector.create(),d=.005,v=1/0;h[0]=l,h[1]=u;for(var g=0;g<1;g+=.05){p[0]=this.cubicAt(t,n,o,a,g),p[1]=this.cubicAt(e,r,i,s,g);var m=this.vector.distSquare(h,p);m<v&&(f=g,v=m)}for(var v=1/0,b=0;b<32&&!(d<this.EPSILON);b++){var S=f-d,_=f+d;p[0]=this.cubicAt(t,n,o,a,S),p[1]=this.cubicAt(e,r,i,s,S);var w=this.vector.distSquare(p,h);0<=S&&w<v?(f=S,v=w):(y[0]=this.cubicAt(t,n,o,a,_),y[1]=this.cubicAt(e,r,i,s,_),w=this.vector.distSquare(y,h),_<=1&&w<v?(f=_,v=w):d*=.5)}return c&&(c[0]=this.cubicAt(t,n,o,a,f),c[1]=this.cubicAt(e,r,i,s,f)),Math.sqrt(v)}},{key:"quadraticAt",value:function(t,e,n,r){var o=1-r;return o*(o*t+2*r*e)+r*r*n}},{key:"quadraticDerivativeAt",value:function(t,e,n,r){return 2*((1-r)*(e-t)+r*(n-e))}},{key:"quadraticRootAt",value:function(t,e,n,r,o){var i,a=t-2*e+n,n=2*(e-t),e=t-r,t=0;return this.isAroundZero(a)?!this.isNotAroundZero(n)||0<=(r=-e/n)&&r<=1&&(o[t++]=r):this.isAroundZero(e=n*n-4*a*e)?0<=(i=-n/(2*a))&&i<=1&&(o[t++]=i):0<e&&(e=(-n-(i=Math.sqrt(e)))/(2*a),0<=(a=(-n+i)/(2*a))&&a<=1&&(o[t++]=a),0<=e&&e<=1&&(o[t++]=e)),t}},{key:"quadraticExtremum",value:function(t,e,n){n=t+n-2*e;return 0==n?.5:(t-e)/n}},{key:"quadraticProjectPoint",value:function(t,e,n,r,o,i,a,s,l){var u,c=this.vector.create(),f=this.vector.create(),h=this.vector.create(),p=.005,y=1/0;c[0]=a,c[1]=s;for(var d=0;d<1;d+=.05){f[0]=this.quadraticAt(t,n,o,d),f[1]=this.quadraticAt(e,r,i,d);var v=this.vector.distSquare(c,f);v<y&&(u=d,y=v)}for(var y=1/0,g=0;g<32&&!(p<this.EPSILON);g++){var m=u-p,b=u+p;f[0]=this.quadraticAt(t,n,o,m),f[1]=this.quadraticAt(e,r,i,m);var S=this.vector.distSquare(f,c);0<=m&&S<y?(u=m,y=S):(h[0]=this.quadraticAt(t,n,o,b),h[1]=this.quadraticAt(e,r,i,b),S=this.vector.distSquare(h,c),b<=1&&S<y?(u=b,y=S):p*=.5)}return l&&(l[0]=this.quadraticAt(t,n,o,u),l[1]=this.quadraticAt(e,r,i,u)),Math.sqrt(y)}}]),Ua);function Ua(){!function(t){if(!(t instanceof Ua))throw new TypeError("Cannot call a class as a function")}(this),this.vector=new Ma,this.EPSILON=1e-4,this.THREE_SQRT=Math.sqrt(3),this.ONE_THIRD=1/3,this.CLASS_NAME="SuperMap.LevelRenderer.Tool.Curve"}function Ha(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ga=(Ha(Wa.prototype,[{key:"normalizeRadian",value:function(t){return(t%=this.PI2)<0&&(t+=this.PI2),t}},{key:"isInside",value:function(t,e,n,r){if(!e||!t)return!1;var o=t.type;this._ctx=this._ctx||this.util.getContext();var i=this._mathMethod(t,e,n,r);if(void 0!==i)return i;if(t.buildPath&&this._ctx.isPointInPath)return this._buildPathMethod(t,this._ctx,e,n,r);switch(o){case"ellipse":case"smicellipse":return!0;case"trochoid":var a="out"==e.location?e.r1+e.r2+e.d:e.r1-e.r2+e.d;return this.isInsideCircle(e,n,r,a);case"rose":return this.isInsideCircle(e,n,r,e.maxr);default:return!1}}},{key:"_mathMethod",value:function(t,e,n,r){switch(t.type){case"bezier-curve":return void 0===e.cpX2?this.isInsideQuadraticStroke(e.xStart,e.yStart,e.cpX1,e.cpY1,e.xEnd,e.yEnd,e.lineWidth,n,r):this.isInsideCubicStroke(e.xStart,e.yStart,e.cpX1,e.cpY1,e.cpX2,e.cpY2,e.xEnd,e.yEnd,e.lineWidth,n,r);case"line":return this.isInsideLine(e.xStart,e.yStart,e.xEnd,e.yEnd,e.lineWidth,n,r);case"broken-line":return this.isInsideBrokenLine(e.pointList,e.lineWidth,n,r);case"smicbroken-line":var o=n,i=r;return t.refOriginalPosition&&(o=n-t.refOriginalPosition[0],i=r-t.refOriginalPosition[1]),this.isInsideBrokenLine(e.pointList,e.lineWidth,o,i);case"ring":return this.isInsideRing(e.x,e.y,e.r0,e.r,n,r);case"smicring":var i=e.x,a=e.y;return t.refOriginalPosition&&(i=e.x+t.refOriginalPosition[0],a=e.y+t.refOriginalPosition[1]),this.isInsideRing(i,a,e.r0,e.r,n,r);case"circle":return this.isInsideCircle(e.x,e.y,e.r,n,r);case"smicpoint":var a=n,s=r;return t.refOriginalPosition&&(a=n-t.refOriginalPosition[0],s=r-t.refOriginalPosition[1]),this.isInsideCircle(e.x,e.y,e.r,a,s);case"sector":var l=e.startAngle*Math.PI/180,u=e.endAngle*Math.PI/180;return e.clockWise||(l=-l,u=-u),this.isInsideSector(e.x,e.y,e.r0,e.r,l,u,!e.clockWise,n,r);case"smicsector":var s=e.startAngle*Math.PI/180,c=e.endAngle*Math.PI/180;e.clockWise||(s=-s,c=-c);l=e.x,u=e.y;return t.refOriginalPosition&&(l=e.x+t.refOriginalPosition[0],u=e.y+t.refOriginalPosition[1]),this.isInsideSector(l,u,e.r0,e.r,s,c,!e.clockWise,n,r);case"path":return this.isInsidePath(e.pathArray,Math.max(e.lineWidth,5),e.brushType,n,r);case"polygon":case"star":case"smicstar":case"isogon":case"smicisogon":return this.isInsidePolygon(e.pointList,n,r);case"smicpolygon":var f=n,h=r;if(t.refOriginalPosition&&(f=n-t.refOriginalPosition[0],h=r-t.refOriginalPosition[1]),t.holePolygonPointLists&&0<t.holePolygonPointLists.length){for(var c=this.isInsidePolygon(e.pointList,f,h),p=t.holePolygonPointLists,y=!1,d=0,v=p.length;d<v;d++){var g=p[d];!0===this.isInsidePolygon(g,f,h)&&(y=!0)}return!0===c&&!1===y}return this.isInsidePolygon(e.pointList,f,h);case"text":var m=e.__rect||t.getRect(e);return this.isInsideRect(m.x,m.y,m.width,m.height,n,r);case"smictext":var b=t.getTextBackground(e);return this.isInsidePolygon(b,n,r);case"rectangle":case"image":return this.isInsideRect(e.x,e.y,e.width,e.height,n,r);case"smicimage":m=e.x,b=e.y;return t.refOriginalPosition&&(m=e.x+t.refOriginalPosition[0],b=e.y+t.refOriginalPosition[1]),this.isInsideRect(m,b,e.width,e.height,n,r)}}},{key:"_buildPathMethod",value:function(t,e,n,r,o){return e.beginPath(),t.buildPath(e,n),e.closePath(),e.isPointInPath(r,o)}},{key:"isOutside",value:function(t,e,n,r){return!this.isInside(t,e,n,r)}},{key:"isInsideLine",value:function(t,e,n,r,o,i,a){if(0===o)return!1;var s=Math.max(o,5);if(e+s<a&&r+s<a||a<e-s&&a<r-s||t+s<i&&n+s<i||i<t-s&&i<n-s)return!1;if(t===n)return Math.abs(i-t)<=s/2;n=(o=(e-r)/(t-n))*i-a+(t*r-n*e)/(t-n);return n*n/(o*o+1)<=s/2*s/2}},{key:"isInsideCubicStroke",value:function(t,e,n,r,o,i,a,s,l,u,c){if(0===l)return!1;l=Math.max(l,5);return!(e+l<c&&r+l<c&&i+l<c&&s+l<c||c<e-l&&c<r-l&&c<i-l&&c<s-l||t+l<u&&n+l<u&&o+l<u&&a+l<u||u<t-l&&u<n-l&&u<o-l&&u<a-l)&&this.curve.cubicProjectPoint(t,e,n,r,o,i,a,s,u,c,null)<=l/2}},{key:"isInsideQuadraticStroke",value:function(t,e,n,r,o,i,a,s,l){if(0===a)return!1;a=Math.max(a,5);return!(e+a<l&&r+a<l&&i+a<l||l<e-a&&l<r-a&&l<i-a||t+a<s&&n+a<s&&o+a<s||s<t-a&&s<n-a&&s<o-a)&&this.curve.quadraticProjectPoint(t,e,n,r,o,i,s,l,null)<=a/2}},{key:"isInsideArcStroke",value:function(t,e,n,r,o,i,a,s,l){var u=this.PI2;if(0===a)return!1;a=Math.max(a,5);s-=t,l-=e;e=Math.sqrt(s*s+l*l);if(n<e-a||e+a<n)return!1;if(Math.abs(r-o)>=u)return!0;(o=i?(i=r,r=this.normalizeRadian(o),this.normalizeRadian(i)):(r=this.normalizeRadian(r),this.normalizeRadian(o)))<r&&(o+=u);s=Math.atan2(l,s);return s<0&&(s+=u),r<=s&&s<=o||r<=s+u&&s+u<=o}},{key:"isInsideBrokenLine",value:function(t,e,n,r){for(var o=Math.max(e,10),i=0,a=t.length-1;i<a;i++){var s=t[i][0],l=t[i][1],u=t[i+1][0],c=t[i+1][1];if(this.isInsideLine(s,l,u,c,o,n,r))return!0}return!1}},{key:"isInsideRing",value:function(t,e,n,r,o,i){e=(o-t)*(o-t)+(i-e)*(i-e);return e<r*r&&n*n<e}},{key:"isInsideRect",value:function(t,e,n,r,o,i){return t<=o&&o<=t+n&&e<=i&&i<=e+r}},{key:"isInsideCircle",value:function(t,e,n,r,o){return(r-t)*(r-t)+(o-e)*(o-e)<n*n}},{key:"isInsideSector",value:function(t,e,n,r,o,i,a,s,l){return this.isInsideArcStroke(t,e,(n+r)/2,o,i,a,r-n,s,l)}},{key:"isInsidePolygon",value:function(t,e,n){for(var r=t.length,o=0,i=0,a=r-1;i<r;i++){var s=t[a][0],l=t[a][1],u=t[i][0],c=t[i][1];o+=this.windingLine(s,l,u,c,e,n),a=i}return 0!==o}},{key:"windingLine",value:function(t,e,n,r,o,i){return!(e<i&&r<i||i<e&&i<r)&&r!=e&&o<(i-e)/(r-e)*(n-t)+t?r<e?1:-1:0}},{key:"swapExtrema",value:function(){var t=this.extrema[0];this.extrema[0]=this.extrema[1],this.extrema[1]=t}},{key:"windingCubic",value:function(t,e,n,r,o,i,a,s,l,u){var c=this.curve,f=this.roots,h=this.extrema;if(e<u&&r<u&&i<u&&s<u||u<e&&u<r&&u<i&&u<s)return 0;var p=c.cubicRootAt(e,r,i,s,u,f);if(0===p)return 0;for(var y,d,v=0,g=-1,m=0;m<p;m++){var b=f[m];c.cubicAt(t,n,o,a,b)<l||(g<0&&(g=c.cubicExtrema(e,r,i,s,h),h[1]<h[0]&&1<g&&this.swapExtrema(),y=c.cubicAt(e,r,i,s,h[0]),1<g&&(d=c.cubicAt(e,r,i,s,h[1]))),2==g?b<h[0]?v+=y<e?1:-1:b<h[1]?v+=d<y?1:-1:v+=s<d?1:-1:b<h[0]?v+=y<e?1:-1:v+=s<y?1:-1)}return v}},{key:"windingQuadratic",value:function(t,e,n,r,o,i,a,s){var l=this.curve,u=this.roots;if(e<s&&r<s&&i<s||s<e&&s<r&&s<i)return 0;var c=l.quadraticRootAt(e,r,i,s,u);if(0===c)return 0;var f=l.quadraticExtremum(e,r,i);if(0<=f&&f<=1){for(var h=0,p=l.quadraticAt(e,r,i,f),y=0;y<c;y++)l.quadraticAt(t,n,o,u[y])>a||(u[y]<f?h+=p<e?1:-1:h+=i<p?1:-1);return h}return l.quadraticAt(t,n,o,u[0])>a?0:i<e?1:-1}},{key:"windingArc",value:function(t,e,n,r,o,i,a,s){var l=this.roots,u=this.PI2;if((s-=e)>n||s<-n)return 0;var n=Math.sqrt(n*n-s*s);if(l[0]=-n,l[1]=n,Math.abs(r-o)>=u)return o=u,a>=l[r=0]+t&&a<=l[1]+t?i?1:-1:0;(o=i?(n=r,r=this.normalizeRadian(o),this.normalizeRadian(n)):(r=this.normalizeRadian(r),this.normalizeRadian(o)))<r&&(o+=u);for(var c=0,f=0;f<2;f++){var h,p=l[f];a<p+t&&(h=i?1:-1,(r<=(p=(p=Math.atan2(s,p))<0?u+p:p)&&p<=o||r<=p+u&&p+u<=o)&&(c+=h=p>Math.PI/2&&p<1.5*Math.PI?-h:h))}return c}},{key:"isInsidePath",value:function(t,e,n,r,o){for(var i=0,a=0,s=0,l=0,u=0,c=!0,f=!0,h="stroke"===(n=n||"fill")||"both"===n,p="fill"===n||"both"===n,y=0;y<t.length;y++){var d=t[y],v=d.points;if(c||"M"===d.command){if(0<y&&(p&&(i+=this.windingLine(a,s,l,u,r,o)),0!==i))return!0;l=v[v.length-2],u=v[v.length-1],c=!1,f&&"A"!==d.command&&(f=!1,a=l,s=u)}switch(d.command){case"M":a=v[0],s=v[1];break;case"L":if(h&&this.isInsideLine(a,s,v[0],v[1],e,r,o))return!0;p&&(i+=this.windingLine(a,s,v[0],v[1],r,o)),a=v[0],s=v[1];break;case"C":if(h&&this.isInsideCubicStroke(a,s,v[0],v[1],v[2],v[3],v[4],v[5],e,r,o))return!0;p&&(i+=this.windingCubic(a,s,v[0],v[1],v[2],v[3],v[4],v[5],r,o)),a=v[4],s=v[5];break;case"Q":if(h&&this.isInsideQuadraticStroke(a,s,v[0],v[1],v[2],v[3],e,r,o))return!0;p&&(i+=this.windingQuadratic(a,s,v[0],v[1],v[2],v[3],r,o)),a=v[2],s=v[3];break;case"A":var g=v[0],m=v[1],b=v[2],S=v[3],_=v[4],w=v[5],O=Math.cos(_)*b+g,E=Math.sin(_)*S+m;f?(f=!1,l=O,u=E):i+=this.windingLine(a,s,O,E);E=(r-g)*S/b+g;if(h&&this.isInsideArcStroke(g,m,S,_,_+w,1-v[7],e,E,o))return!0;p&&(i+=this.windingArc(g,m,S,_,_+w,1-v[7],E,o)),a=Math.cos(_+w)*b+g,s=Math.sin(_+w)*S+m;break;case"z":if(h&&this.isInsideLine(a,s,l,u,e,r,o))return!0;c=!0}}return p&&(i+=this.windingLine(a,s,l,u,r,o)),0!==i}},{key:"getTextWidth",value:function(t,e){var n=t+":"+e;if(this._textWidthCache[n])return this._textWidthCache[n];this._ctx=this._ctx||this.util.getContext(),this._ctx.save(),e&&(this._ctx.font=e);for(var r=0,o=0,i=(t=(t+"").split("\n")).length;o<i;o++)r=Math.max(this._ctx.measureText(t[o]).width,r);return this._ctx.restore(),this._textWidthCache[n]=r,++this._textWidthCacheCounter>this.TEXT_CACHE_MAX&&(this._textWidthCacheCounter=0,this._textWidthCache={}),r}},{key:"getTextHeight",value:function(t,e){var n=t+":"+e;if(this._textHeightCache[n])return this._textHeightCache[n];this._ctx=this._ctx||this.util.getContext(),this._ctx.save(),e&&(this._ctx.font=e),t=(t+"").split("\n");t=(this._ctx.measureText("ZH").width+2)*t.length;return this._ctx.restore(),this._textHeightCache[n]=t,++this._textHeightCacheCounter>this.TEXT_CACHE_MAX&&(this._textHeightCacheCounter=0,this._textHeightCache={}),t}}]),Wa);function Wa(){!function(t){if(!(t instanceof Wa))throw new TypeError("Cannot call a class as a function")}(this),this.util=new Ia,this.curve=new Fa,this._ctx=null,this._textWidthCache={},this._textHeightCache={},this._textWidthCacheCounter=0,this._textHeightCacheCounter=0,this.TEXT_CACHE_MAX=5e3,this.PI2=2*Math.PI,this.roots=[-1,-1,-1],this.extrema=[-1,-1],this.CLASS_NAME="SuperMap.LevelRenderer.Tool.Area"}function Va(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var za=(Va(Ya.prototype,[{key:"customPalette",value:function(t){this.palette=t}},{key:"resetPalette",value:function(){this.palette=this._palette}},{key:"getColor",value:function(t,e){return(e=e||this.palette)[(t|=0)%e.length]}},{key:"customHighlight",value:function(t){this.highlightColor=t}},{key:"resetHighlight",value:function(){this.highlightColor=this._highlightColor}},{key:"getHighlightColor",value:function(){return this.highlightColor}},{key:"getRadialGradient",value:function(t,e,n,r,o,i,a){var s=this.util;this._ctx||(this._ctx=s.getContext());for(var l=this._ctx.createRadialGradient(t,e,n,r,o,i),u=0,c=a.length;u<c;u++)l.addColorStop(a[u][0],a[u][1]);return l.__nonRecursion=!0,l}},{key:"getLinearGradient",value:function(t,e,n,r,o){var i=this.util;this._ctx||(this._ctx=i.getContext());for(var a=this._ctx.createLinearGradient(t,e,n,r),s=0,l=o.length;s<l;s++)a.addColorStop(o[s][0],o[s][1]);return a.__nonRecursion=!0,a}},{key:"getStepColors",value:function(t,e,n){t=this.toRGBA(t),e=this.toRGBA(e),t=this.getData(t);for(var r=[],o=((e=this.getData(e))[0]-t[0])/n,i=(e[1]-t[1])/n,a=(e[2]-t[2])/n,s=(e[3]-t[3])/n,l=0,u=t[0],c=t[1],f=t[2],h=t[3];l<n;l++)r[l]=this.toColor([this.adjust(Math.floor(u),[0,255]),this.adjust(Math.floor(c),[0,255]),this.adjust(Math.floor(f),[0,255]),+h.toFixed(4)],"rgba"),u+=o,c+=i,f+=a,h+=s;return u=e[0],c=e[1],f=e[2],h=e[3],r[l]=this.toColor([u,c,f,h],"rgba"),r}},{key:"getGradientColors",value:function(t,e){var n=[],r=t.length;if(void 0===e&&(e=20),1===r)n=this.getStepColors(t[0],t[0],e);else if(1<r)for(var o=0,i=r-1;o<i;o++){var a=this.getStepColors(t[o],t[o+1],e);o<i-1&&a.pop(),n=n.concat(a)}return n}},{key:"toColor",value:function(t,e){var n;if(e=e||"rgb",t&&(3===t.length||4===t.length))return t=this.map(t,function(t){return 1<t?Math.ceil(t):t}),-1<e.indexOf("hex")?"#"+((1<<24)+(t[0]<<16)+(t[1]<<8)+ +t[2]).toString(16).slice(1):(-1<e.indexOf("hs")&&(n=this.map(t.slice(1,3),function(t){return t+"%"}),t[1]=n[0],t[2]=n[1]),-1<e.indexOf("a")?(3===t.length&&t.push(1),t[3]=this.adjust(t[3],[0,1]),e+"("+t.slice(0,4).join(",")+")"):e+"("+t.slice(0,3).join(",")+")")}},{key:"toArray",value:function(t){(t=this.trim(t)).indexOf("rgba")<0&&(t=this.toRGBA(t));var e=[],n=0;return t.replace(/[\d.]+/g,function(t){n<3?t|=0:t=+t,e[n++]=t}),e}},{key:"convert",value:function(t,e){if(!this.isCalculableColor(t))return t;var n=this.getData(t),r=n[3];return void 0===r&&(r=1),-1<t.indexOf("hsb")?n=this._HSV_2_RGB(n):-1<t.indexOf("hsl")&&(n=this._HSL_2_RGB(n)),-1<e.indexOf("hsb")||-1<e.indexOf("hsv")?n=this._RGB_2_HSB(n):-1<e.indexOf("hsl")&&(n=this._RGB_2_HSL(n)),n[3]=r,this.toColor(n,e)}},{key:"toRGBA",value:function(t){return this.convert(t,"rgba")}},{key:"toRGB",value:function(t){return this.convert(t,"rgb")}},{key:"toHex",value:function(t){return this.convert(t,"hex")}},{key:"toHSVA",value:function(t){return this.convert(t,"hsva")}},{key:"toHSV",value:function(t){return this.convert(t,"hsv")}},{key:"toHSBA",value:function(t){return this.convert(t,"hsba")}},{key:"toHSB",value:function(t){return this.convert(t,"hsb")}},{key:"toHSLA",value:function(t){return this.convert(t,"hsla")}},{key:"toHSL",value:function(t){return this.convert(t,"hsl")}},{key:"toName",value:function(t){for(var e in this._nameColors)if(this.toHex(this._nameColors[e])===this.toHex(t))return e;return null}},{key:"trim",value:function(t){return String(t).replace(/\s+/g,"")}},{key:"normalize",value:function(t){var e;return this._nameColors[t]&&(t=this._nameColors[t]),t=(t=this.trim(t)).replace(/hsv/i,"hsb"),t=/^#[\da-f]{3}$/i.test(t)?"#"+((1<<24)+((e=(3840&(t=parseInt(t.slice(1),16)))<<8)<<4)+e+((e=(240&t)<<4)<<4)+e+((e=15&t)<<4)+e).toString(16).slice(1):t}},{key:"lift",value:function(t,e){if(!this.isCalculableColor(t))return t;var n=0<e?1:-1;void 0===e&&(e=0),e=1<Math.abs(e)?1:Math.abs(e),t=this.toRGB(t);for(var r=this.getData(t),o=0;o<3;o++)r[o]=1==n?r[o]*(1-e)|0:(255-r[o])*e+r[o]|0;return"rgb("+r.join(",")+")"}},{key:"reverse",value:function(t){if(!this.isCalculableColor(t))return t;t=this.getData(this.toRGBA(t)),t=this.map(t,function(t){return 255-t});return this.toColor(t,"rgb")}},{key:"mix",value:function(t,e,n){if(!this.isCalculableColor(t)||!this.isCalculableColor(e))return t;for(var r=2*(n=1-this.adjust(n=void 0===n?.5:n,[0,1]))-1,o=this.getData(this.toRGBA(t)),i=this.getData(this.toRGBA(e)),e=o[3]-i[3],a=(1+(r*e==-1?r:(r+e)/(1+r*e)))/2,s=1-a,l=[],u=0;u<3;u++)l[u]=o[u]*a+i[u]*s;n=o[3]*n+i[3]*(1-n),n=Math.max(0,Math.min(1,n));return 1===o[3]&&1===i[3]?this.toColor(l,"rgb"):(l[3]=n,this.toColor(l,"rgba"))}},{key:"random",value:function(){return"#"+Math.random().toString(16).slice(2,8)}},{key:"getData",value:function(t){var e=(t=this.normalize(t)).match(this.colorRegExp);if(null===e)throw new Error("The color format error");var n,r,o,i,t=[];return e[2]?(i=[(r=e[2].replace("#","").split(""))[0]+r[1],r[2]+r[3],r[4]+r[5]],t=this.map(i,function(t){return Ya.prototype.adjust.call(this,parseInt(t,16),[0,255])})):e[4]?(n=(o=e[4].split(","))[3],i=o.slice(0,3),t=this.map(i,function(t){return t=Math.floor(0<t.indexOf("%")?2.55*parseInt(t,0):t),Ya.prototype.adjust.call(this,t,[0,255])}),void 0!==n&&t.push(this.adjust(parseFloat(n),[0,1]))):(e[5]||e[6])&&(r=(e[5]||e[6]).split(","),o=parseInt(r[0],0)/360,i=r[1],e=r[2],n=r[3],(t=this.map([i,e],function(t){return Ya.prototype.adjust.call(this,parseFloat(t)/100,[0,1])})).unshift(o),void 0!==n&&t.push(this.adjust(parseFloat(n),[0,1]))),t}},{key:"alpha",value:function(t,e){if(!this.isCalculableColor(t))return t;null===e&&(e=1);t=this.getData(this.toRGBA(t));return t[3]=this.adjust(Number(e).toFixed(4),[0,1]),this.toColor(t,"rgba")}},{key:"map",value:function(t,e){if("function"!=typeof e)throw new TypeError;for(var n=t?t.length:0,r=0;r<n;r++)t[r]=e(t[r]);return t}},{key:"adjust",value:function(t,e){return t<=e[0]?t=e[0]:t>=e[1]&&(t=e[1]),t}},{key:"isCalculableColor",value:function(t){return t instanceof Array||"string"==typeof t}},{key:"_HSV_2_RGB",value:function(t){var e,n,r,o,i,a,s=t[0],l=t[1],u=t[2];return a=0===l?i=o=255*u:(e=0|(a=6===(a=6*s)?0:a),n=u*(1-l),r=u*(1-l*(a-e)),t=u*(1-l*(1-(a-e))),a=(a=l=s=0)==e?(s=u,l=t,n):1==e?(s=r,l=u,n):2==e?(s=n,l=u,t):3==e?(s=n,l=r,u):4==e?(s=t,l=n,u):(s=u,l=n,r),o=255*s,i=255*l,255*a),[o,i,a]}},{key:"_HSL_2_RGB",value:function(t){var e,n,r=t[0],o=t[1],t=t[2];return r=0===o?n=e=255*t:(t=2*t-(o=t<.5?t*(1+o):t+o-o*t),e=255*this._HUE_2_RGB(t,o,r+1/3),n=255*this._HUE_2_RGB(t,o,r),255*this._HUE_2_RGB(t,o,r-1/3)),[e,n,r]}},{key:"_HUE_2_RGB",value:function(t,e,n){return n<0&&(n+=1),1<n&&--n,6*n<1?t+6*(e-t)*n:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}},{key:"_RGB_2_HSB",value:function(t){var e,n,r=t[0]/255,o=t[1]/255,i=t[2]/255,a=Math.min(r,o,i),s=Math.max(r,o,i),l=s-a,u=s;return 0==l?n=e=0:(n=l/s,t=((s-r)/6+l/2)/l,a=((s-o)/6+l/2)/l,l=((s-i)/6+l/2)/l,r===s?e=l-a:o===s?e=1/3+t-l:i===s&&(e=2/3+a-t),e<0&&(e+=1),1<e&&--e),[e*=360,n*=100,u*=100]}},{key:"_RGB_2_HSL",value:function(t){var e,n,r=t[0]/255,o=t[1]/255,i=t[2]/255,a=Math.min(r,o,i),s=Math.max(r,o,i),l=s-a,u=(s+a)/2;return 0==l?n=e=0:(n=u<.5?l/(s+a):l/(2-s-a),t=((s-r)/6+l/2)/l,a=((s-o)/6+l/2)/l,l=((s-i)/6+l/2)/l,r===s?e=l-a:o===s?e=1/3+t-l:i===s&&(e=2/3+a-t),e<0&&(e+=1),1<e&&--e),[e*=360,n*=100,u*=100]}}]),Ya);function Ya(){!function(t){if(!(t instanceof Ya))throw new TypeError("Cannot call a class as a function")}(this),this.util=new Ia,this._ctx=null,this.palette=["#ff9277"," #dddd00"," #ffc877"," #bbe3ff"," #d5ffbb","#bbbbff"," #ddb000"," #b0dd00"," #e2bbff"," #ffbbe3","#ff7777"," #ff9900"," #83dd00"," #77e3ff"," #778fff","#c877ff"," #ff77ab"," #ff6600"," #aa8800"," #77c7ff","#ad77ff"," #ff77ff"," #dd0083"," #777700"," #00aa00","#0088aa"," #8400dd"," #aa0088"," #dd0000"," #772e00"],this._palette=this.palette,this.highlightColor="rgba(0,0,255,1)",this._highlightColor=this.highlightColor,this.colorRegExp=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,this._nameColors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#0ff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000",blanchedalmond:"#ffebcd",blue:"#00f",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#f0f",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#0f0",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#f0f",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#f00",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#fff",whitesmoke:"#f5f5f5",yellow:"#ff0",yellowgreen:"#9acd32"},this.CLASS_NAME="SuperMap.LevelRenderer.Tool.Color"}function qa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}qa(Xa.prototype,[{key:"computeBoundingBox",value:function(t,e,n){if(0!==t.length){for(var r=t[0][0],o=t[0][0],i=t[0][1],a=t[0][1],s=1;s<t.length;s++){var l=t[s];l[0]<r&&(r=l[0]),l[0]>o&&(o=l[0]),l[1]<i&&(i=l[1]),l[1]>a&&(a=l[1])}e[0]=r,e[1]=i,n[0]=o,n[1]=a}}},{key:"cubeBezier",value:function(t,e,n,r,o,i){var a=new Fa,s=[];a.cubicExtrema(t[0],e[0],n[0],r[0],s);for(var l=0;l<s.length;l++)s[l]=a.cubicAt(t[0],e[0],n[0],r[0],s[l]);var u=[];a.cubicExtrema(t[1],e[1],n[1],r[1],u);for(var c=0;c<u.length;c++)u[c]=a.cubicAt(t[1],e[1],n[1],r[1],u[c]);s.push(t[0],r[0]),u.push(t[1],r[1]);var f=Math.min.apply(null,s),h=Math.max.apply(null,s),p=Math.min.apply(null,u),y=Math.max.apply(null,u);o[0]=f,o[1]=p,i[0]=h,i[1]=y}},{key:"quadraticBezier",value:function(t,e,n,r,o){var i=new Fa,a=i.quadraticExtremum(t[0],e[0],n[0]),s=i.quadraticExtremum(t[1],e[1],n[1]),l=1-(a=Math.max(Math.min(a,1),0)),u=1-(s=Math.max(Math.min(s,1),0)),i=l*l*t[0]+2*l*a*e[0]+a*a*n[0],l=l*l*t[1]+2*l*a*e[1]+a*a*n[1],a=u*u*t[0]+2*u*s*e[0]+s*s*n[0],s=u*u*t[1]+2*u*s*e[1]+s*s*n[1];r[0]=Math.min(t[0],n[0],i,a),r[1]=Math.min(t[1],n[1],l,s),o[0]=Math.max(t[0],n[0],i,a),o[1]=Math.max(t[1],n[1],l,s)}},{key:"arc",value:function(t,e,n,r,o,i,a,s){var l=new Ma,u=l.create(),c=l.create(),f=l.create();u[0]=Math.cos(r)*n+t,u[1]=Math.sin(r)*n+e,c[0]=Math.cos(o)*n+t,c[1]=Math.sin(o)*n+e,l.min(a,u,c),l.max(s,u,c),(r%=2*Math.PI)<0&&(r+=2*Math.PI),(o%=2*Math.PI)<0&&(o+=2*Math.PI),o<r&&!i?o+=2*Math.PI:r<o&&i&&(r+=2*Math.PI),i&&(i=o,o=r,r=i);for(var h=0;h<o;h+=Math.PI/2)r<h&&(f[0]=Math.cos(h)*n+t,f[1]=Math.sin(h)*n+e,l.min(a,f,a),l.max(s,f,s))}}]),v=Xa;function Xa(){!function(t){if(!(t instanceof Xa))throw new TypeError("Cannot call a class as a function")}(this),3===arguments.length&&this.computeBoundingBox(arguments),this.CLASS_NAME="SuperMap.LevelRenderer.Tool.ComputeBoundingBox"}function Ja(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Ja(Qa.prototype,[{key:"destory",value:function(){return!0}}]),R=Qa;function Qa(){!function(t){if(!(t instanceof Qa))throw new TypeError("Cannot call a class as a function")}(this),this.CLASS_NAME="SuperMap.LevelRenderer.Tool.Env";var t=navigator.userAgent,e=this.os={},n=this.browser={},r=t.match(/Web[kK]it[\/]{0,1}([\d.]+)/),o=t.match(/(Android);?[\s\/]+([\d.]+)?/),i=t.match(/(iPad).*OS\s([\d_]+)/),a=t.match(/(iPod)(.*OS\s([\d_]+))?/),s=!i&&t.match(/(iPhone\sOS)\s([\d_]+)/),l=t.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),u=l&&t.match(/TouchPad/),c=t.match(/Kindle\/([\d.]+)/),f=t.match(/Silk\/([\d._]+)/),h=t.match(/(BlackBerry).*Version\/([\d.]+)/),p=t.match(/(BB10).*Version\/([\d.]+)/),y=t.match(/(RIM\sTablet\sOS)\s([\d.]+)/),d=t.match(/PlayBook/),v=t.match(/Chrome\/([\d.]+)/)||t.match(/CriOS\/([\d.]+)/),g=t.match(/Firefox\/([\d.]+)/),m=t.match(/MSIE ([\d.]+)/),b=r&&t.match(/Mobile\//)&&!v,S=t.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/)&&!v;return(n.webkit=!!r)&&(n.version=r[1]),o&&(e.android=!0,e.version=o[2]),s&&!a&&(e.ios=e.iphone=!0,e.version=s[2].replace(/_/g,".")),i&&(e.ios=e.ipad=!0,e.version=i[2].replace(/_/g,".")),a&&(e.ios=e.ipod=!0,e.version=a[3]?a[3].replace(/_/g,"."):null),l&&(e.webos=!0,e.version=l[2]),u&&(e.touchpad=!0),h&&(e.blackberry=!0,e.version=h[2]),p&&(e.bb10=!0,e.version=p[2]),y&&(e.rimtabletos=!0,e.version=y[2]),d&&(n.playbook=!0),c&&(e.kindle=!0,e.version=c[1]),f&&(n.silk=!0,n.version=f[1]),!f&&e.android&&t.match(/Kindle Fire/)&&(n.silk=!0),v&&(n.chrome=!0,n.version=v[1]),g&&(n.firefox=!0,n.version=g[1]),m&&(n.ie=!0,n.version=m[1]),b&&(t.match(/Safari/)||e.ios)&&(n.safari=!0),S&&(n.webview=!0),m&&(n.ie=!0,n.version=m[1]),e.tablet=!!(i||d||o&&!t.match(/Mobile/)||g&&t.match(/Tablet/)||m&&!t.match(/Phone/)&&t.match(/Touch/)),e.phone=!(e.tablet||e.ipod||!(o||s||l||h||p||v&&t.match(/Android/)||v&&t.match(/CriOS\/([\d.]+)/)||g&&t.match(/Mobile/)||m&&t.match(/Touch/))),{browser:n,os:e,canvasSupported:!!document.createElement("canvas").getContext}}function Ka(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Za=(Ka($a.prototype,[{key:"getX",value:function(t){return void 0!==t.zrenderX&&t.zrenderX||void 0!==t.offsetX&&t.offsetX||void 0!==t.layerX&&t.layerX||void 0!==t.clientX&&t.clientX}},{key:"getY",value:function(t){return void 0!==t.zrenderY&&t.zrenderY||void 0!==t.offsetY&&t.offsetY||void 0!==t.layerY&&t.layerY||void 0!==t.clientY&&t.clientY}},{key:"getDelta",value:function(t){return void 0!==t.zrenderDelta&&t.zrenderDelta||void 0!==t.wheelDelta&&t.wheelDelta||void 0!==t.detail&&-t.detail}}]),$a);function $a(){!function(t){if(!(t instanceof $a))throw new TypeError("Cannot call a class as a function")}(this),this.stop="function"==typeof window.addEventListener?function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0}:function(t){t.returnValue=!1,t.cancelBubble=!0},this.CLASS_NAME="SuperMap.LevelRenderer.Tool.Event"}function ts(t){return(ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function es(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}es(ns.prototype,[{key:"get",value:function(t,e,n){var r;"object"===ts(t)&&(t=(r=t).url,e=r.onsuccess,n=r.onerror);var o=window.XMLHttpRequest?new XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");o.open("GET",t,!0),o.onreadystatechange=function(){4==o.readyState&&(200<=o.status&&o.status<300||304===o.status?e&&e(o.responseText):n&&n(),o.onreadystatechange=new Function,o=null)},o.send(null)}}]),St=ns;function ns(){!function(t){if(!(t instanceof ns))throw new TypeError("Cannot call a class as a function")}(this),this.CLASS_NAME="SuperMap.LevelRenderer.Tool.Http"}function rs(){!function(t){if(!(t instanceof rs))throw new TypeError("Cannot call a class as a function")}(this)}function os(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}rs.EVENT={RESIZE:"resize",CLICK:"click",DBLCLICK:"dblclick",MOUSEWHEEL:"mousewheel",MOUSEMOVE:"mousemove",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",GLOBALOUT:"globalout",DRAGSTART:"dragstart",DRAGEND:"dragend",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",touchClickDelay:300},rs.catchBrushException=!1,rs.debugMode=0;os(is.prototype,[{key:"destory",value:function(){return!0}}]),yt=is;function is(){return function(t){if(!(t instanceof is))throw new TypeError("Cannot call a class as a function")}(this),this.CLASS_NAME="SuperMap.LevelRenderer.Tool.Log",function(){if(0!==rs.debugMode)if(1===rs.debugMode)for(var t in arguments)throw new Error(arguments[t]);else if(1<rs.debugMode)for(var e in arguments)console.log(arguments[e])}}function as(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ss=(as(ls.prototype,[{key:"sin",value:function(t,e){return window.Math.sin(e?t*this._radians:t)}},{key:"cos",value:function(t,e){return window.Math.cos(e?t*this._radians:t)}},{key:"degreeToRadian",value:function(t){return t*this._radians}},{key:"radianToDegree",value:function(t){return t/this._radians}}]),ls);function ls(){!function(t){if(!(t instanceof ls))throw new TypeError("Cannot call a class as a function")}(this),this._radians=window.Math.PI/180,this.CLASS_NAME="SuperMap.LevelRenderer.Tool.Math"}function us(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var cs=(us(fs.prototype,[{key:"create",value:function(){var t=new this.ArrayCtor(6);return this.identity(t),t}},{key:"identity",value:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}},{key:"copy",value:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}},{key:"mul",value:function(t,e,n){return t[0]=e[0]*n[0]+e[2]*n[1],t[1]=e[1]*n[0]+e[3]*n[1],t[2]=e[0]*n[2]+e[2]*n[3],t[3]=e[1]*n[2]+e[3]*n[3],t[4]=e[0]*n[4]+e[2]*n[5]+e[4],t[5]=e[1]*n[4]+e[3]*n[5]+e[5],t}},{key:"translate",value:function(t,e,n){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+n[0],t[5]=e[5]+n[1],t}},{key:"rotate",value:function(t,e,n){var r=e[0],o=e[2],i=e[4],a=e[1],s=e[3],l=e[5],e=Math.sin(n),n=Math.cos(n);return t[0]=r*n+a*e,t[1]=-r*e+a*n,t[2]=o*n+s*e,t[3]=-o*e+n*s,t[4]=n*i+e*l,t[5]=n*l-e*i,t}},{key:"scale",value:function(t,e,n){var r=n[0],n=n[1];return t[0]=e[0]*r,t[1]=e[1]*n,t[2]=e[2]*r,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*n,t}},{key:"invert",value:function(t,e){var n=e[0],r=e[2],o=e[4],i=e[1],a=e[3],s=e[5],e=n*a-i*r;return e?(t[0]=a*(e=1/e),t[1]=-i*e,t[2]=-r*e,t[3]=n*e,t[4]=(r*s-a*o)*e,t[5]=(i*o-n*s)*e,t):null}},{key:"mulVector",value:function(t,e,n){var r=e[0],o=e[2],i=e[4],a=e[1],s=e[3],e=e[5];return t[0]=n[0]*r+n[1]*o+i,t[1]=n[0]*a+n[1]*s+e,t}}]),fs);function fs(){!function(t){if(!(t instanceof fs))throw new TypeError("Cannot call a class as a function")}(this),this.ArrayCtor="undefined"==typeof Float32Array?Array:Float32Array,this.CLASS_NAME="SuperMap.LevelRenderer.Tool.Matrix"}function hs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ps,ys=(ps=ds,y=[{key:"SUtil_smoothBezier",value:function(t,e,n,r,o){var i=o=!o||2!==o.length?[0,0]:o,a=[],s=[],l=[],u=[],c=!!r;if(c){for(var f=[1/0,1/0],h=[-1/0,-1/0],p=t.length,y=0;y<p;y++)ds.Util_vector.min(f,f,[t[y][0]+i[0],t[y][1]+i[1]]),ds.Util_vector.max(h,h,[t[y][0]+i[0],t[y][1]+i[1]]);ds.Util_vector.min(f,f,r[0]),ds.Util_vector.max(h,h,r[1])}for(var d=t.length,v=0;v<d;v++){var g=[t[v][0]+i[0],t[v][1]+i[1]],m=void 0,b=void 0;if(n)m=[t[v?v-1:d-1][0]+i[0],t[v?v-1:d-1][1]+i[1]],b=[t[(v+1)%d][0]+i[0],t[(v+1)%d][1]+i[1]];else{if(0===v||v===d-1){a.push([t[v][0]+i[0],t[v][1]+i[1]]);continue}m=[t[v-1][0]+i[0],t[v-1][1]+i[1]],b=[t[v+1][0]+i[0],t[v+1][1]+i[1]]}ds.Util_vector.sub(s,b,m),ds.Util_vector.scale(s,s,e);var S=ds.Util_vector.distance(g,m),m=ds.Util_vector.distance(g,b),b=S+m;0!==b&&(S/=b,m/=b),ds.Util_vector.scale(l,s,-S),ds.Util_vector.scale(u,s,m);m=ds.Util_vector.add([],g,l),g=ds.Util_vector.add([],g,u);c&&(ds.Util_vector.max(m,m,f),ds.Util_vector.min(m,m,h),ds.Util_vector.max(g,g,f),ds.Util_vector.min(g,g,h)),a.push(m),a.push(g)}return n&&a.push(a.shift()),a}},{key:"SUtil_smoothSpline",value:function(t,e,n,r){for(var o=r=!r||2!==r.length?[0,0]:r,i=t.length,a=[],s=0,l=1;l<i;l++)s+=ds.Util_vector.distance([t[l-1][0]+o[0],t[l-1][1]+o[1]],[t[l][0]+o[0],t[l][1]+o[1]]);for(var u=(u=s/5)<i?i:u,c=0;c<u;c++){var f=c/(u-1)*(e?i:i-1),h=Math.floor(f),p=f-h,y=void 0,d=[t[h%i][0]+o[0],t[h%i][1]+o[1]],v=void 0,g=void 0,g=e?(y=[t[(h-1+i)%i][0]+o[0],t[(h-1+i)%i][1]+o[1]],v=[t[(h+1)%i][0]+o[0],t[(h+1)%i][1]+o[1]],[t[(h+2)%i][0]+o[0],t[(h+2)%i][1]+o[1]]):(y=[t[0===h?h:h-1][0]+o[0],t[0===h?h:h-1][1]+o[1]],v=[t[i-2<h?i-1:h+1][0]+o[0],t[i-2<h?i-1:h+1][1]+o[1]],[t[i-3<h?i-1:h+2][0]+o[0],t[i-3<h?i-1:h+2][1]+o[1]]),f=p*p,h=p*f;a.push([m(y[0],d[0],v[0],g[0],p,f,h),m(y[1],d[1],v[1],g[1],p,f,h)])}return a;function m(t,e,n,r,o,i,a){t=.5*(n-t),r=.5*(r-e);return(2*(e-n)+t+r)*a+(-3*(e-n)-2*t-r)*i+t*o+e}}},{key:"SUtil_dashedLineTo",value:function(t,e,n,r,o,i,a){var s=[5,5];if(i="number"!=typeof i?5:i,t.setLineDash)return s[0]=i,s[1]=i,a&&a instanceof Array?t.setLineDash(a):t.setLineDash(s),t.moveTo(e,n),void t.lineTo(r,o);var l=r-e,u=o-n,c=Math.floor(Math.sqrt(l*l+u*u)/i);l/=c,u/=c;for(var f=!0,h=0;h<c;++h)f?t.moveTo(e,n):t.lineTo(e,n),f=!f,e+=l,n+=u;t.lineTo(r,o)}}],null&&hs(ps.prototype,null),hs(ps,y),ds);function ds(){!function(t){if(!(t instanceof ds))throw new TypeError("Cannot call a class as a function")}(this)}function vs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}ys.Util_area=new Ga,ys.Util_color=new za,ys.Util_computeBoundingBox=new v,ys.Util_curve=new Fa,ys.Util_env=new R,ys.Util_event=new Za,ys.Util_http=new St,ys.Util_log=new yt,ys.Util_math=new ss,ys.Util_matrix=new cs,ys.Util=new Ia,ys.Util_vector=new Ma;var gs=(vs(ms.prototype,[{key:"destroy",value:function(){this.position=null,this.rotation=null,this.scale=null,this.needLocalTransform=null,this.needTransform=null}},{key:"updateNeedTransform",value:function(){function t(t){return 5e-5<t||t<-5e-5}this.needLocalTransform=t(this.rotation[0])||t(this.position[0])||t(this.position[1])||t(this.scale[0]-1)||t(this.scale[1]-1)}},{key:"updateTransform",value:function(){var t,e,n;function r(t){return 5e-5<t||t<-5e-5}this.updateNeedTransform(),this.parent?this.needTransform=this.needLocalTransform||this.parent.needTransform:this.needTransform=this.needLocalTransform,this.needTransform&&(t=[0,0],e=this.transform||ys.Util_matrix.create(),ys.Util_matrix.identity(e),this.needLocalTransform&&((r(this.scale[0])||r(this.scale[1]))&&(t[0]=-this.scale[2]||0,t[1]=-this.scale[3]||0,(n=r(t[0])||r(t[1]))&&ys.Util_matrix.translate(e,e,t),ys.Util_matrix.scale(e,e,this.scale),n&&(t[0]=-t[0],t[1]=-t[1],ys.Util_matrix.translate(e,e,t))),this.rotation instanceof Array?0!==this.rotation[0]&&(t[0]=-this.rotation[1]||0,t[1]=-this.rotation[2]||0,(n=r(t[0])||r(t[1]))&&ys.Util_matrix.translate(e,e,t),ys.Util_matrix.rotate(e,e,this.rotation[0]),n&&(t[0]=-t[0],t[1]=-t[1],ys.Util_matrix.translate(e,e,t))):0!==this.rotation&&ys.Util_matrix.rotate(e,e,this.rotation),(r(this.position[0])||r(this.position[1]))&&ys.Util_matrix.translate(e,e,this.position)),this.transform=e,this.parent&&this.parent.needTransform&&(this.needLocalTransform?ys.Util_matrix.mul(this.transform,this.parent.transform,this.transform):ys.Util_matrix.copy(this.transform,this.parent.transform)))}},{key:"setTransform",value:function(t){var e;this.needTransform&&(e=this.transform,t.transform(e[0],e[1],e[2],e[3],e[4],e[5]))}},{key:"decomposeTransform",value:function(){var t,e,n,r,o,i;function a(t){return 5e-5<t||t<-5e-5}this.transform&&(e=(t=this.transform)[0]*t[0]+t[1]*t[1],n=this.position,r=this.scale,o=this.rotation,a(e-1)&&(e=Math.sqrt(e)),a((i=t[2]*t[2]+t[3]*t[3])-1)&&(i=Math.sqrt(i)),n[0]=t[4],n[1]=t[5],r[0]=e,r[1]=i,o[r[2]=r[3]=0]=Math.atan2(-t[1]/i,t[0]/e),o[1]=o[2]=0)}}]),ms);function ms(){var r;!function(t){if(!(t instanceof ms))throw new TypeError("Cannot call a class as a function")}(this),this.position=[0,0],this.rotation=[0,0,0],this.scale=[1,1,0,0],this.needLocalTransform=!1,this.needTransform=!1,this.CLASS_NAME="SuperMap.LevelRenderer.Transformable",this.lookAt=(r=ys.Util_vector.create(),function(t){this.transform||(this.transform=ys.Util_matrix.create());var e=this.transform;function n(t){return-5e-5<t&&t<5e-5}ys.Util_vector.sub(r,t,this.position),n(r[0])&&n(r[1])||(ys.Util_vector.normalize(r,r),e[2]=r[0]*this.scale[1],e[3]=r[1]*this.scale[1],e[0]=r[1]*this.scale[0],e[1]=-r[0]*this.scale[0],e[4]=this.position[0],e[5]=this.position[1],this.decomposeTransform())})}function bs(t){return(bs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ss(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _s(t,e,n){return(_s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Es(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function ws(t,e){return(ws=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Os(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Es(t){return(Es=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xs=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ws(t,e)}(m,c.mixin(Ta,gs));var t,e,n,r,o=(n=m,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Es(n);return function(t,e){if(e&&("object"===bs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Os(t)}(this,r?(t=Es(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function m(t){var e,r;return function(t){if(!(t instanceof m))throw new TypeError("Cannot call a class as a function")}(this),e=o.call(this,t),t=t||{},e.id=null,e.style={},e.highlightStyle=null,e.parent=null,e.__dirty=!0,e.__clipShapes=[],e.invisible=!1,e.ignore=!1,e.zlevel=0,e.draggable=!1,e.clickable=!1,e.hoverable=!0,e.z=0,e.refOriginalPosition=[0,0],e.refDataID=null,e.isHoverByRefDataID=!1,e.refDataHoverGroup=null,e.dataInfo=null,B.extend(Os(e),t),e.id=e.id||B.createUniqueID("smShape_"),e.CLASS_NAME="SuperMap.LevelRenderer.Shape",e.getTansform=(r=[],function(t,e){var n=[t,e];return this.needTransform&&this.transform&&(ys.Util_matrix.invert(r,this.transform),ys.Util_matrix.mulVector(n,r,[t,e,1]),t==n[0]&&e==n[1]&&this.updateNeedTransform()),n}),e}return e=[{key:"_fillText",value:function(t,e,n,r,o,i,a){o&&(t.font=o),t.textAlign=i,t.textBaseline=a;var s=m._getTextRect(e,n,r,o,i,a);e=(e+"").split("\n");var l=ys.Util_area.getTextHeight("ZH",o);switch(a){case"top":r=s.y;break;case"bottom":r=s.y+l;break;default:r=s.y+l/2}for(var u=0,c=e.length;u<c;u++)t.fillText(e[u],n,r),r+=l}},{key:"_getTextRect",value:function(t,e,n,r,o,i){var a=ys.Util_area.getTextWidth(t,r),s=ys.Util_area.getTextHeight("ZH",r);switch(t=(t+"").split("\n"),o){case"end":case"right":e-=a;break;case"center":e-=a/2}switch(i){case"top":break;case"bottom":n-=s*t.length;break;default:n-=s*t.length/2}return{x:e,y:n,width:a,height:s*t.length}}}],Ss((t=m).prototype,[{key:"destroy",value:function(){this.id=null,this.style=null,this.highlightStyle=null,this.parent=null,this.__dirty=null,this.__clipShapes=null,this.invisible=null,this.ignore=null,this.zlevel=null,this.draggable=null,this.clickable=null,this.hoverable=null,this.z=null,this.refOriginalPosition=null,this.refDataID=null,this.refDataHoverGroup=null,this.isHoverByRefDataID=null,this.dataInfo=null,_s(Es(m.prototype),"destroy",this).call(this)}},{key:"brush",value:function(t,e){var n=this.beforeBrush(t,e);switch(t.beginPath(),this.buildPath(t,n),n.brushType){case"both":this.setCtxGlobalAlpha(t,"fill",n),t.fill(),0<n.lineWidth&&(this.setCtxGlobalAlpha(t,"stroke",n),t.stroke()),this.setCtxGlobalAlpha(t,"reset",n);break;case"stroke":this.setCtxGlobalAlpha(t,"stroke",n),0<n.lineWidth&&t.stroke(),this.setCtxGlobalAlpha(t,"reset",n);break;default:this.setCtxGlobalAlpha(t,"fill",n),t.fill(),this.setCtxGlobalAlpha(t,"reset",n)}this.drawText(t,n,this.style),this.afterBrush(t)}},{key:"beforeBrush",value:function(t,e){var n=this.style;return this.brushTypeOnly&&(n.brushType=this.brushTypeOnly),e&&(n=this.getHighlightStyle(n,this.highlightStyle||{},this.brushTypeOnly)),"stroke"==this.brushTypeOnly&&(n.strokeColor=n.strokeColor||n.color),t.save(),this.doClip(t),this.setContext(t,n),this.setTransform(t),n}},{key:"afterBrush",value:function(t){t.restore()}},{key:"setContext",value:function(t,e){for(var n=[["color","fillStyle"],["strokeColor","strokeStyle"],["opacity","globalAlpha"],["lineCap","lineCap"],["lineJoin","lineJoin"],["miterLimit","miterLimit"],["lineWidth","lineWidth"],["shadowBlur","shadowBlur"],["shadowColor","shadowColor"],["shadowOffsetX","shadowOffsetX"],["shadowOffsetY","shadowOffsetY"]],r=0,o=n.length;r<o;r++){var i=e[n[r][0]],a=n[r][1];void 0!==i&&(t[a]=i)}}},{key:"doClip",value:function(t){var e=ys.Util_matrix.create();if(this.__clipShapes)for(var n=0;n<this.__clipShapes.length;n++){var r,o=this.__clipShapes[n];o.needTransform&&(r=o.transform,ys.Util_matrix.invert(e,r),t.transform(r[0],r[1],r[2],r[3],r[4],r[5])),t.beginPath(),o.buildPath(t,o.style),t.clip(),o.needTransform&&t.transform(e[0],e[1],e[2],e[3],e[4],e[5])}}},{key:"getHighlightStyle",value:function(t,e,n){var r,o={};for(r in t)o[r]=t[r];var i,a=ys.Util_color.getHighlightColor();for(i in"stroke"!=t.brushType?(o.strokeColor=a,o.lineWidth=t.lineWidth||1,o.brushType="both"):"stroke"!=n?(o.strokeColor=a,o.lineWidth=t.lineWidth||1):o.strokeColor=e.strokeColor||ys.Util_color.mix(t.strokeColor,ys.Util_color.toRGB(a)),e)void 0!==e[i]&&(o[i]=e[i]);return o}},{key:"getHighlightZoom",value:function(){return"text"!=this.type?6:2}},{key:"drift",value:function(t,e){this.position[0]+=t,this.position[1]+=e}},{key:"buildPath",value:function(t,e){ys.Util_log("buildPath not implemented in "+this.type)}},{key:"getRect",value:function(t){ys.Util_log("getRect not implemented in "+this.type)}},{key:"isCover",value:function(t,e){var n=this.getTansform(t,e);t=n[0],e=n[1];var n=this.style.__rect;return t>=(n=n||(this.style.__rect=this.getRect(this.style))).x&&t<=n.x+n.width&&e>=n.y&&e<=n.y+n.height&&ys.Util_area.isInside(this,this.style,t,e)}},{key:"drawText",value:function(t,e,n){if(void 0!==e.text&&!1!==e.text){var r=e.textColor||e.color||e.strokeColor;t.fillStyle=r;var o,i,a,s,l=10,u=e.textPosition||this.textPosition||"top",c=this.refOriginalPosition&&2===this.refOriginalPosition.length?this.refOriginalPosition:[0,0];switch(u){case"inside":case"top":case"bottom":case"left":case"right":if(this.getRect){var f=(n||e).__rect||this.getRect(n||e);switch(u){case"inside":a=f.x+f.width/2,s=f.y+f.height/2,o="center",i="middle","stroke"!=e.brushType&&r==e.color&&(t.fillStyle="#fff");break;case"left":a=f.x-l,s=f.y+f.height/2,o="end",i="middle";break;case"right":a=f.x+f.width+l,s=f.y+f.height/2,o="start",i="middle";break;case"top":a=f.x+f.width/2,s=f.y-l,o="center",i="bottom";break;case"bottom":a=f.x+f.width/2,s=f.y+f.height+l,o="center",i="top"}}break;case"start":case"end":var h=0,p=0,y=0,d=0;if(void 0!==e.pointList){var v=e.pointList;if(v.length<2)return;var g=v.length;switch(u){case"start":h=v[0][0]+c[0],p=v[1][0]+c[0],y=v[0][1]+c[1],d=v[1][1]+c[1];break;case"end":h=v[g-2][0]+c[0],p=v[g-1][0]+c[0],y=v[g-2][1]+c[1],d=v[g-1][1]+c[1]}}else h=e.xStart+c[0]||0,p=e.xEnd+c[0]||0,y=e.yStart+c[1]||0,d=e.yEnd+c[1]||0;switch(u){case"start":o=h<p?"end":"start",i=y<d?"bottom":"top",a=h,s=y;break;case"end":o=h<p?"start":"end",i=y<d?"top":"bottom",a=p,s=d}l-=4,h&&p&&h!=p?a-="end"==o?l:-l:o="center",y!=d?s-="bottom"==i?l:-l:i="middle";break;case"specific":a=e.textX||0,s=e.textY||0,o="start",i="middle"}e.labelXOffset&&!isNaN(e.labelXOffset)&&(a+=e.labelXOffset),e.labelYOffset&&!isNaN(e.labelYOffset)&&(s+=e.labelYOffset),null!=a&&null!=s&&m._fillText(t,e.text,a,s,e.textFont,e.textAlign||o,e.textBaseline||i)}}},{key:"modSelf",value:function(){this.__dirty=!0,this.style&&(this.style.__rect=null),this.highlightStyle&&(this.highlightStyle.__rect=null)}},{key:"isSilent",value:function(){return!(this.hoverable||this.draggable||this.clickable||this.onmousemove||this.onmouseover||this.onmouseout||this.onmousedown||this.onmouseup||this.onclick||this.ondragenter||this.ondragover||this.ondragleave||this.ondrop)}},{key:"setCtxGlobalAlpha",value:function(t,e,n){t.globalAlpha="fill"===e?void 0===n.fillOpacity?void 0===n.opacity?1:n.opacity:n.fillOpacity:"stroke"!==e||void 0===n.strokeOpacity?void 0===n.opacity?1:n.opacity:n.strokeOpacity}}]),Ss(t,e),m}();function Ps(t){return(Ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ks(t,e,n){return(ks="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Rs(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Ts(t,e){return(Ts=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Rs(t){return(Rs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var As=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ts(t,e)}(o,xs);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Rs(n);return function(t,e){if(e&&("object"===Ps(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Rs(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).type="smicpoint",t.refOriginalPosition&&2===t.refOriginalPosition.length||(t.refOriginalPosition=[0,0]),t.CLASS_NAME="SuperMap.LevelRenderer.Shape.SmicPoint",t}return Cs(o.prototype,[{key:"destroy",value:function(){this.type=null,ks(Rs(o.prototype),"destroy",this).call(this)}},{key:"buildPath",value:function(t,e){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var n=this.refOriginalPosition;t.arc(e.x+n[0],e.y+n[1],e.r,0,2*Math.PI,!0)}},{key:"getRect",value:function(t){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var e,n=this.refOriginalPosition;return t.__rect||(e="stroke"==t.brushType||"fill"==t.brushType?t.lineWidth||1:0,t.__rect={x:Math.round(t.x+n[0]-t.r-e/2),y:Math.round(t.y+n[1]-t.r-e/2),width:2*t.r+e,height:2*t.r+e},t.__rect)}}]),o}();function Ls(t){return(Ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Is(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ns(t,e,n){return(Ns="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ms(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function js(t,e){return(js=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ms(t){return(Ms=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bs=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&js(t,e)}(o,xs);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Ms(n);return function(t,e){if(e&&("object"===Ls(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Ms(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).type="smictext",t.refOriginalPosition&&2===t.refOriginalPosition.length||(t.refOriginalPosition=[0,0]),t.CLASS_NAME="SuperMap.LevelRenderer.Shape.SmicText",t}return Is(o.prototype,[{key:"destroy",value:function(){this.type=null,Ns(Ms(o.prototype),"destroy",this).call(this)}},{key:"brush",value:function(t,e){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var n=this.refOriginalPosition,r=this.style;if(void 0!==(r=e?this.getHighlightStyle(r,this.highlightStyle||{}):r).text&&!1!==r.text){t.save(),this.doClip(t),this.setContext(t,r),this.setTransform(t),r.textFont&&(t.font=r.textFont),t.textAlign=r.textAlign||"start",t.textBaseline=r.textBaseline||"middle";for(var o=(r.text+"").split("\n"),i=ys.Util_area.getTextHeight("ZH",r.textFont),a=this.getRectNoRotation(r),s=r.x+n[0],l="top"==r.textBaseline?a.y:"bottom"==r.textBaseline?a.y+i:a.y+i/2,u=r.x+n[0],c=r.y+n[1],f=0,h=o.length;f<h;f++){switch(r.labelRect&&(t.fillRect(a.x-2,a.y,a.width+4,a.height),t.fillStyle=r.strokeColor,t.strokeRect(a.x-2,a.y,a.width+4,a.height),t.fillStyle=r.textColor),r.brushType){case"stroke":this.setCtxGlobalAlpha(t,"stroke",r),r.textRotation&&0!==r.textRotation?(t.save(),t.translate(u,c),t.rotate(r.textRotation*Math.PI/180),"top"==r.textBaseline?r.maxWidth?t.strokeText(o[f],0,i*f,r.maxWidth):t.strokeText(o[f],0,i*f):"bottom"==r.textBaseline?r.maxWidth?t.strokeText(o[f],0,i*(f+1)-a.height,r.maxWidth):t.strokeText(o[f],0,i*(f+1)-a.height):r.maxWidth?t.strokeText(o[f],0,i*(f+1)-a.height/2-i/2,r.maxWidth):t.strokeText(o[f],0,i*(f+1)-a.height/2-i/2),t.restore()):r.maxWidth?t.strokeText(o[f],s,l,r.maxWidth):t.strokeText(o[f],s,l),this.setCtxGlobalAlpha(t,"reset",r);break;case"both":r.textRotation&&0!==r.textRotation?(t.save(),t.translate(u,c),t.rotate(r.textRotation*Math.PI/180),"top"==r.textBaseline?r.maxWidth?(this.setCtxGlobalAlpha(t,"fill",r),t.fillText(o[f],0,i*f,r.maxWidth),this.setCtxGlobalAlpha(t,"reset",r),this.setCtxGlobalAlpha(t,"stroke",r),t.strokeText(o[f],0,i*f,r.maxWidth)):(this.setCtxGlobalAlpha(t,"fill",r),t.fillText(o[f],0,i*f),this.setCtxGlobalAlpha(t,"reset",r),this.setCtxGlobalAlpha(t,"stroke",r),t.strokeText(o[f],0,i*f)):"bottom"==r.textBaseline?r.maxWidth?(this.setCtxGlobalAlpha(t,"fill",r),t.fillText(o[f],0,i*(f+1)-a.height,r.maxWidth),this.setCtxGlobalAlpha(t,"reset",r),this.setCtxGlobalAlpha(t,"stroke",r),t.strokeText(o[f],0,i*(f+1)-a.height,r.maxWidth)):(this.setCtxGlobalAlpha(t,"fill",r),t.fillText(o[f],0,i*(f+1)-a.height),this.setCtxGlobalAlpha(t,"reset",r),this.setCtxGlobalAlpha(t,"stroke",r),t.strokeText(o[f],0,i*(f+1)-a.height)):r.maxWidth?(this.setCtxGlobalAlpha(t,"fill",r),t.fillText(o[f],0,i*(f+1)-a.height/2-i/2,r.maxWidth),this.setCtxGlobalAlpha(t,"reset",r),this.setCtxGlobalAlpha(t,"stroke",r),t.strokeText(o[f],0,i*(f+1)-a.height/2-i/2,r.maxWidth)):(this.setCtxGlobalAlpha(t,"fill",r),t.fillText(o[f],0,i*(f+1)-a.height/2-i/2),this.setCtxGlobalAlpha(t,"reset",r),this.setCtxGlobalAlpha(t,"stroke",r),t.strokeText(o[f],0,i*(f+1)-a.height/2-i/2)),this.setCtxGlobalAlpha(t,"reset",r),t.restore()):(r.maxWidth?(this.setCtxGlobalAlpha(t,"fill",r),t.fillText(o[f],s,l,r.maxWidth),this.setCtxGlobalAlpha(t,"reset",r),this.setCtxGlobalAlpha(t,"stroke",r),t.strokeText(o[f],s,l,r.maxWidth)):(this.setCtxGlobalAlpha(t,"fill",r),t.fillText(o[f],s,l),this.setCtxGlobalAlpha(t,"reset",r),this.setCtxGlobalAlpha(t,"stroke",r),t.strokeText(o[f],s,l)),this.setCtxGlobalAlpha(t,"reset",r));break;default:this.setCtxGlobalAlpha(t,"fill",r),r.textRotation&&0!==r.textRotation?(t.save(),t.translate(u,c),t.rotate(r.textRotation*Math.PI/180),"top"==r.textBaseline?r.maxWidth?t.fillText(o[f],0,i*f,r.maxWidth):t.fillText(o[f],0,i*f):"bottom"==r.textBaseline?r.maxWidth?t.fillText(o[f],0,i*(f+1)-a.height,r.maxWidth):t.fillText(o[f],0,i*(f+1)-a.height):r.maxWidth?t.fillText(o[f],0,i*(f+1)-a.height/2-i/2,r.maxWidth):t.fillText(o[f],0,i*(f+1)-a.height/2-i/2),t.restore()):r.maxWidth?t.fillText(o[f],s,l,r.maxWidth):t.fillText(o[f],s,l),this.setCtxGlobalAlpha(t,"reset",r)}l+=i}t.restore()}}},{key:"getRect",value:function(t){if(t.__rect)return t.__rect;for(var e,n,r,o,i=this.getTextBackground(t,!0),a=0,s=i.length;a<s;a++){var l=i[a];0==a?(e=l[0],r=l[0],n=l[1],o=l[1]):(l[0]<e&&(e=l[0]),l[0]>r&&(r=l[0]),l[1]<n&&(n=l[1]),l[1]>o&&(o=l[1]))}return t.__rect={x:e,y:n,width:r-e,height:o-n},t.__rect}},{key:"getRectNoRotation",value:function(t){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var e=this.refOriginalPosition,n=ys.Util_area.getTextHeight("ZH",t.textFont),r=ys.Util_area.getTextWidth(t.text,t.textFont),o=ys.Util_area.getTextHeight(t.text,t.textFont),i=t.x+e[0];"end"==t.textAlign||"right"==t.textAlign?i-=r:"center"==t.textAlign&&(i-=r/2);var a,s,l="top"==t.textBaseline?t.y+e[1]:"bottom"==t.textBaseline?t.y+e[1]-o:t.y+e[1]-o/2,u=!1;return t.maxWidth&&((s=parseInt(t.maxWidth))<r&&(a=r,u=!0,r=s),i=t.x+e[0],"end"==t.textAlign||"right"==t.textAlign?i-=r:"center"==t.textAlign&&(i-=r/2)),t.textFont&&-1<t.textFont.toLowerCase().indexOf("italic")&&(r+=!0===u?n/3*(r/a):n/3),{x:i,y:l,width:r,height:o}}},{key:"getTextBackground",value:function(t,e){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var n=this.refOriginalPosition;if(!e&&t.__textBackground)return t.__textBackground;var r,o,i,a=this.getRectNoRotation(t),s=t.x+n[0],l=t.y+n[1],e=[];return t.textRotation&&0!==t.textRotation?(i=t.textRotation,n=this.getRotatedLocation(a.x,a.y,s,l,i),r=this.getRotatedLocation(a.x+a.width,a.y,s,l,i),o=this.getRotatedLocation(a.x+a.width,a.y+a.height,s,l,i),i=this.getRotatedLocation(a.x,a.y+a.height,s,l,i),e.push(n),e.push(r),e.push(o),e.push(i)):(r=[a.x,a.y],o=[a.x+a.width,a.y],i=[a.x+a.width,a.y+a.height],a=[a.x,a.y+a.height],e.push(r),e.push(o),e.push(i),e.push(a)),t.__textBackground=e,t.__textBackground}},{key:"getRotatedLocation",value:function(t,e,n,r,o){var i,a=new Array;return e=-e,r=-r,o=-o,i=(t-n)*Math.cos(o/180*Math.PI)-(e-r)*Math.sin(o/180*Math.PI)+n,r=(t-n)*Math.sin(o/180*Math.PI)+(e-r)*Math.cos(o/180*Math.PI)+r,a[0]=i,a[1]=-r,a}}]),o}();function Ds(t){return(Ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Us(t,e,n){return(Us="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gs(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Hs(t,e){return(Hs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gs(t){return(Gs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ws=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hs(t,e)}(o,xs);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Gs(n);return function(t,e){if(e&&("object"===Ds(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Gs(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).type="smiccircle",t.refOriginalPosition&&2===t.refOriginalPosition.length||(t.refOriginalPosition=[0,0]),t.CLASS_NAME="SuperMap.LevelRenderer.Shape.SmicCircle",t}return Fs(o.prototype,[{key:"destroy",value:function(){this.type=null,Us(Gs(o.prototype),"destroy",this).call(this)}},{key:"buildPath",value:function(t,e){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var n=this.refOriginalPosition,r=e.x+n[0],n=e.y+n[1];return t.moveTo(r+e.r,n),t.arc(r,n,e.r,0,2*Math.PI,!0),!0}},{key:"getRect",value:function(t){if(t.__rect)return t.__rect;this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var e=this.refOriginalPosition,n=t.x+e[0],r=t.y+e[1],o=t.r,e="stroke"==t.brushType||"fill"==t.brushType?t.lineWidth||1:0;return t.__rect={x:Math.round(n-o-e/2),y:Math.round(r-o-e/2),width:2*o+e,height:2*o+e},t.__rect}}]),o}();function Vs(t){return(Vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ys(t,e,n){return(Ys="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xs(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function qs(t,e){return(qs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Xs(t){return(Xs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Js=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qs(t,e)}(o,xs);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Xs(n);return function(t,e){if(e&&("object"===Vs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Xs(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).type="smicpolygon",t.holePolygonPointLists=null,t.refOriginalPosition&&2===t.refOriginalPosition.length||(t.refOriginalPosition=[0,0]),t.CLASS_NAME="SuperMap.LevelRenderer.Shape.SmicPolygon",t}return zs(o.prototype,[{key:"destroy",value:function(){this.type=null,this.holePolygonPointLists=null,Ys(Xs(o.prototype),"destroy",this).call(this)}},{key:"brush",value:function(t,e){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var n=this.style;e&&(n=this.getHighlightStyle(n,this.highlightStyle||{})),t.save(),this.setContext(t,n),this.setTransform(t);var r=!1;"fill"!=n.brushType&&"both"!=n.brushType&&void 0!==n.brushType||(t.beginPath(),"dashed"==n.lineType||"dotted"==n.lineType||"dot"==n.lineType||"dash"==n.lineType||"dashdot"==n.lineType||"longdash"==n.lineType||"longdashdot"==n.lineType?this.buildPath(t,{lineType:"solid",lineWidth:n.lineWidth,pointList:n.pointList}):(this.buildPath(t,n),r=!0),t.closePath(),this.setCtxGlobalAlpha(t,"fill",n),t.fill(),this.setCtxGlobalAlpha(t,"reset",n)),0<n.lineWidth&&("stroke"==n.brushType||"both"==n.brushType)&&(r||(t.beginPath(),this.buildPath(t,n)),this.setCtxGlobalAlpha(t,"stroke",n),t.stroke(),this.setCtxGlobalAlpha(t,"reset",n)),this.drawText(t,n,this.style);var o=B.cloneObject(n);if(o.pointList&&this.holePolygonPointLists&&0<this.holePolygonPointLists.length)for(var i=this.holePolygonPointLists,a=i.length,s=0;s<a;s++){var l=i[s];o.pointList=l,r=!(t.globalCompositeOperation="destination-out"),"fill"!=o.brushType&&"both"!=o.brushType&&void 0!==o.brushType||(t.beginPath(),"dashed"==o.lineType||"dotted"==o.lineType||"dot"==o.lineType||"dash"==o.lineType||"dashdot"==o.lineType||"longdash"==o.lineType||"longdashdot"==o.lineType?this.buildPath(t,{lineType:"solid",lineWidth:o.lineWidth,pointList:o.pointList}):(this.buildPath(t,o),r=!0),t.closePath(),this.setCtxGlobalAlpha(t,"fill",o),t.fill(),this.setCtxGlobalAlpha(t,"reset",o)),0<o.lineWidth&&("stroke"==o.brushType||"both"==o.brushType)?(r||(t.beginPath(),this.buildPath(t,o)),t.globalCompositeOperation="source-over",this.setCtxGlobalAlpha(t,"stroke",o),t.stroke(),this.setCtxGlobalAlpha(t,"reset",o)):t.globalCompositeOperation="source-over"}t.restore()}},{key:"buildPath",value:function(t,e){e.showShadow&&(t.shadowBlur=e.shadowBlur,t.shadowColor=e.shadowColor,t.shadowOffsetX=e.shadowOffsetX,t.shadowOffsetY=e.shadowOffsetY),this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var n=this.refOriginalPosition,r=e.pointList;if(!(r.length<2))if(e.smooth&&"spline"!==e.smooth){var o,i,a,s=ys.SUtil_smoothBezier(r,e.smooth,!0,e.smoothConstraint,n);t.moveTo(r[0][0]+n[0],r[0][1]+n[1]);for(var l=r.length,u=0;u<l;u++)o=s[2*u],i=s[2*u+1],a=[r[(u+1)%l][0]+n[0],r[(u+1)%l][1]+n[1]],t.bezierCurveTo(o[0],o[1],i[0],i[1],a[0],a[1])}else if("spline"===e.smooth&&(r=ys.SUtil_smoothSpline(r,!0,null,n)),e.lineType&&"solid"!=e.lineType){if("dashed"===e.lineType||"dotted"===e.lineType||"dot"===e.lineType||"dash"===e.lineType||"longdash"===e.lineType){var c=e._dashLength||(e.lineWidth||1)*("dashed"==e.lineType?5:1);e._dashLength=c;var f=e.lineWidth||1,h=f,p=f;"dashed"===e.lineType&&(h*=5,p*=5,e.lineCap&&"butt"!==e.lineCap&&(h-=f,p+=f)),"dotted"===e.lineType&&e.lineCap&&"butt"!==e.lineCap&&(h=1,p+=f),"dot"===e.lineType&&(p*=4,e.lineCap&&"butt"!==e.lineCap&&(h=1,p+=f)),"dash"===e.lineType&&(h*=4,p*=4,e.lineCap&&"butt"!==e.lineCap&&(h-=f,p+=f)),"longdash"===e.lineType&&(h*=8,p*=4,e.lineCap&&"butt"!==e.lineCap&&(h-=f,p+=f)),t.moveTo(r[0][0]+n[0],r[0][1]+n[1]);for(var y=1;y<r.length;y++)ys.SUtil_dashedLineTo(t,r[y-1][0]+n[0],r[y-1][1]+n[1],r[y][0]+n[0],r[y][1]+n[1],f,[h,p]);ys.SUtil_dashedLineTo(t,r[r.length-1][0]+n[0],r[r.length-1][1]+n[1],r[0][0]+n[0],r[0][1]+n[1],f,[h,p])}else if("dashdot"===e.lineType||"longdashdot"===e.lineType){c=e._dashLength||(e.lineWidth||1)*("dashed"==e.lineType?5:1);e._dashLength=c;var d=e.lineWidth||1,v=d,g=d,m=d,b=d;"dashdot"===e.lineType&&(v*=4,g*=4,b*=4,e.lineCap&&"butt"!==e.lineCap&&(v-=d,g+=d,m=1,b+=d)),"longdashdot"===e.lineType&&(v*=8,g*=4,b*=4,e.lineCap&&"butt"!==e.lineCap&&(v-=d,g+=d,m=1,b+=d)),t.moveTo(r[0][0]+n[0],r[0][1]+n[1]);for(var S=1;S<r.length;S++)ys.SUtil_dashedLineTo(t,r[S-1][0]+n[0],r[S-1][1]+n[1],r[S][0]+n[0],r[S][1]+n[1],d,[v,g,m,b]);ys.SUtil_dashedLineTo(t,r[r.length-1][0]+n[0],r[r.length-1][1]+n[1],r[0][0]+n[0],r[0][1]+n[1],d,[v,g,m,b])}}else{t.moveTo(r[0][0]+n[0],r[0][1]+n[1]);for(var _=1;_<r.length;_++)t.lineTo(r[_][0]+n[0],r[_][1]+n[1]);t.lineTo(r[0][0]+n[0],r[0][1]+n[1])}}},{key:"getRect",value:function(t,e){var n=e||(this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]),this.refOriginalPosition);if(t.__rect)return t.__rect;for(var r=Number.MAX_VALUE,o=Number.MIN_VALUE,i=Number.MAX_VALUE,a=Number.MIN_VALUE,s=t.pointList,l=0,u=s.length;l<u;l++)s[l][0]+n[0]<r&&(r=s[l][0]+n[0]),s[l][0]+n[0]>o&&(o=s[l][0]+n[0]),s[l][1]+n[1]<i&&(i=s[l][1]+n[1]),s[l][1]+n[1]>a&&(a=s[l][1]+n[1]);return e="stroke"==t.brushType||"fill"==t.brushType?t.lineWidth||1:0,t.__rect={x:Math.round(r-e/2),y:Math.round(i-e/2),width:o-r+e,height:a-i+e},t.__rect}}]),o}();function Qs(t){return(Qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ks(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zs(t,e,n){return(Zs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tl(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function $s(t,e){return($s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tl(t){return(tl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var el=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$s(t,e)}(o,xs);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=tl(n);return function(t,e){if(e&&("object"===Qs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=tl(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).brushTypeOnly="stroke",t.textPosition="end",t.type="smicbroken-line",t.refOriginalPosition&&2===t.refOriginalPosition.length||(t.refOriginalPosition=[0,0]),t.CLASS_NAME="SuperMap.LevelRenderer.Shape.SmicBrokenLine",t}return Ks(o.prototype,[{key:"destroy",value:function(){this.brushTypeOnly=null,this.textPosition=null,this.type=null,Zs(tl(o.prototype),"destroy",this).call(this)}},{key:"buildPath",value:function(t,e){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var n=this.refOriginalPosition,r=e.pointList;if(!(r.length<2)){var o=Math.min(e.pointList.length,Math.round(e.pointListLength||e.pointList.length));if(e.smooth&&"spline"!==e.smooth){var i,a,s,l=ys.SUtil_smoothBezier(r,e.smooth,!1,e.smoothConstraint,n);t.moveTo(r[0][0]+n[0],r[0][1]+n[1]);for(var u=0;u<o-1;u++)i=l[2*u],a=l[2*u+1],s=[r[u+1][0]+n[0],r[u+1][1]+n[1]],t.bezierCurveTo(i[0],i[1],a[0],a[1],s[0],s[1])}else if("spline"===e.smooth&&(o=(r=ys.SUtil_smoothSpline(r,null,null,n)).length),e.lineType&&"solid"!==e.lineType){if("dashed"===e.lineType||"dotted"===e.lineType||"dot"===e.lineType||"dash"===e.lineType||"longdash"===e.lineType){var c=e.lineWidth||1,f=c,h=c;"dashed"===e.lineType&&(f*=5,h*=5,e.lineCap&&"butt"!==e.lineCap&&(f-=c,h+=c)),"dotted"===e.lineType&&e.lineCap&&"butt"!==e.lineCap&&(f=1,h+=c),"dot"===e.lineType&&(h*=4,e.lineCap&&"butt"!==e.lineCap&&(f=1,h+=c)),"dash"===e.lineType&&(f*=4,h*=4,e.lineCap&&"butt"!==e.lineCap&&(f-=c,h+=c)),"longdash"===e.lineType&&(f*=8,h*=4,e.lineCap&&"butt"!==e.lineCap&&(f-=c,h+=c)),t.moveTo(r[0][0]+n[0],r[0][1]+n[1]);for(var p=1;p<o;p++)ys.SUtil_dashedLineTo(t,r[p-1][0]+n[0],r[p-1][1]+n[1],r[p][0]+n[0],r[p][1]+n[1],c,[f,h])}else if("dashdot"===e.lineType||"longdashdot"===e.lineType){var y=e.lineWidth||1,d=y,v=y,g=y,m=y;"dashdot"===e.lineType&&(d*=4,v*=4,m*=4,e.lineCap&&"butt"!==e.lineCap&&(d-=y,v+=y,g=1,m+=y)),"longdashdot"===e.lineType&&(d*=8,v*=4,m*=4,e.lineCap&&"butt"!==e.lineCap&&(d-=y,v+=y,g=1,m+=y)),y=(e.lineWidth||1)*("dashed"===e.lineType?5:1),t.moveTo(r[0][0]+n[0],r[0][1]+n[1]);for(var b=1;b<o;b++)ys.SUtil_dashedLineTo(t,r[b-1][0]+n[0],r[b-1][1]+n[1],r[b][0]+n[0],r[b][1]+n[1],y,[d,v,g,m])}}else{t.moveTo(r[0][0]+n[0],r[0][1]+n[1]);for(var S=1;S<o;S++)t.lineTo(r[S][0]+n[0],r[S][1]+n[1])}}}},{key:"getRect",value:function(t){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var e=this.refOriginalPosition;return Js.prototype.getRect.apply(this,[t,e])}}]),o}();function nl(t){return(nl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ol(t,e,n){return(ol="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=al(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function il(t,e){return(il=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function al(t){return(al=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var sl=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&il(t,e)}(h,xs);var n,r,e=(n=h,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=al(n);return function(t,e){if(e&&("object"===nl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=al(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function h(t){return function(t){if(!(t instanceof h))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).type="smicimage",t._imageCache={},t.refOriginalPosition&&2===t.refOriginalPosition.length||(t.refOriginalPosition=[0,0]),t.CLASS_NAME="SuperMap.LevelRenderer.Shape.SmicImage",t}return rl(h.prototype,[{key:"destroy",value:function(){this.type=null,this._imageCache=null,ol(al(h.prototype),"destroy",this).call(this)}},{key:"brush",value:function(t,e,n){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var r=this.refOriginalPosition,o=this.style||{},i=(o=e?this.getHighlightStyle(o,this.highlightStyle||{}):o).image,a=this;if("string"==typeof i&&(s=i,this._imageCache[s]?i=this._imageCache[s]:((i=new Image).onload=function(){i.onload=null,clearTimeout(h._refreshTimeout),h._needsRefresh.push(a),h._refreshTimeout=setTimeout(function(){n&&n(h._needsRefresh),h._needsRefresh=[]},10)},i.src=s,this._imageCache[s]=i)),i){if("IMG"==i.nodeName.toUpperCase())if(window.ActiveXObject){if("complete"!=i.readyState)return}else if(!i.complete)return;var s,l,u=o.width||i.width,c=o.height||i.height,f=o.x+r[0],e=o.y+r[1];i.width&&i.height&&(t.save(),this.doClip(t),this.setContext(t,o),this.setTransform(t),o.sWidth&&o.sHeight?(s=o.sx+r[0]||0,l=o.sy+r[1]||0,t.drawImage(i,s,l,o.sWidth,o.sHeight,f,e,u,c)):o.sx&&o.sy?(l=o.sx+r[0],r=o.sy+r[1],t.drawImage(i,l,r,u-l,c-r,f,e,u,c)):t.drawImage(i,f,e,u,c),o.width||(o.width=u),o.height||(o.height=c),this.style.width||(this.style.width=u),this.style.height||(this.style.height=c),this.drawText(t,o,this.style),t.restore())}}},{key:"getRect",value:function(t){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var e=this.refOriginalPosition;return{x:t.x+e[0],y:t.y+e[1],width:t.width,height:t.height}}},{key:"clearCache",value:function(){this._imageCache={}}}]),h}();function ll(t){return(ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ul(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cl(t,e,n){return(cl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=hl(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function fl(t,e){return(fl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hl(t){return(hl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}sl._needsRefresh=[],sl._refreshTimeout=null;var pl=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fl(t,e)}(o,xs);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=hl(n);return function(t,e){if(e&&("object"===ll(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=hl(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).type="smicrectangle",t.refOriginalPosition&&2===t.refOriginalPosition.length||(t.refOriginalPosition=[0,0]),t.CLASS_NAME="SuperMap.LevelRenderer.Shape.SmicRectangle",t}return ul(o.prototype,[{key:"destroy",value:function(){this.type=null,cl(hl(o.prototype),"destroy",this).call(this)}},{key:"_buildRadiusPath",value:function(t,e){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var n,r,o,i,a,s=this.refOriginalPosition,l=e.x+s[0],u=e.y+s[1],c=e.width,s=e.height,e=e.radius;"number"==typeof e?n=r=o=i=e:e instanceof Array?1===e.length?n=r=o=i=e[0]:2===e.length?(n=o=e[0],r=i=e[1]):3===e.length?(n=e[0],r=i=e[1],o=e[2]):(n=e[0],r=e[1],o=e[2],i=e[3]):n=r=o=i=0,c<n+r&&(n*=c/(a=n+r),r*=c/a),c<o+i&&(o*=c/(a=o+i),i*=c/a),s<r+o&&(r*=s/(a=r+o),o*=s/a),s<n+i&&(n*=s/(a=n+i),i*=s/a),t.moveTo(l+n,u),t.lineTo(l+c-r,u),0!==r&&t.quadraticCurveTo(l+c,u,l+c,u+r),t.lineTo(l+c,u+s-o),0!==o&&t.quadraticCurveTo(l+c,u+s,l+c-o,u+s),t.lineTo(l+i,u+s),0!==i&&t.quadraticCurveTo(l,u+s,l,u+s-i),t.lineTo(l,u+n),0!==n&&t.quadraticCurveTo(l,u,l+n,u)}},{key:"buildPath",value:function(t,e){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var n=this.refOriginalPosition;e.radius?this._buildRadiusPath(t,e):(t.moveTo(e.x+n[0],e.y+n[1]),t.lineTo(e.x+n[0]+e.width,e.y+n[1]),t.lineTo(e.x+n[0]+e.width,e.y+n[1]+e.height),t.lineTo(e.x+n[0],e.y+n[1]+e.height),t.lineTo(e.x+n[0],e.y+n[1])),t.closePath()}},{key:"getRect",value:function(t){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var e,n=this.refOriginalPosition;return t.__rect||(e="stroke"==t.brushType||"fill"==t.brushType?t.lineWidth||1:0,t.__rect={x:Math.round(t.x+n[0]-e/2),y:Math.round(t.y+n[1]-e/2),width:t.width+e,height:t.height+e},t.__rect)}}]),o}();function yl(t){return(yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vl(t,e,n){return(vl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ml(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function gl(t,e){return(gl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ml(t){return(ml=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bl=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gl(t,e)}(o,xs);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=ml(n);return function(t,e){if(e&&("object"===yl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=ml(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).type="smicsector",t.refOriginalPosition&&2===t.refOriginalPosition.length||(t.refOriginalPosition=[0,0]),t.CLASS_NAME="SuperMap.LevelRenderer.Shape.SmicSector",t}return dl(o.prototype,[{key:"destroy",value:function(){this.type=null,vl(ml(o.prototype),"destroy",this).call(this)}},{key:"buildPath",value:function(t,e){this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var n=this.refOriginalPosition,r=e.x+n[0],o=e.y+n[1],i=e.r0||0,a=e.r,s=e.startAngle,l=e.endAngle,u=e.clockWise||!1,s=ys.Util_math.degreeToRadian(s),l=ys.Util_math.degreeToRadian(l);u||(s=-s,l=-l);n=ys.Util_math.cos(s),e=ys.Util_math.sin(s);t.moveTo(n*i+r,e*i+o),t.lineTo(n*a+r,e*a+o),t.arc(r,o,a,s,l,!u),t.lineTo(ys.Util_math.cos(l)*i+r,ys.Util_math.sin(l)*i+o),0!==i&&t.arc(r,o,i,l,s,u),t.closePath()}},{key:"getRect",value:function(t){if(t.__rect)return t.__rect;this.refOriginalPosition&&2===this.refOriginalPosition.length||(this.refOriginalPosition=[0,0]);var e=this.refOriginalPosition,n=ys.Util_vector.create(),r=ys.Util_vector.create(),o=ys.Util_vector.create(),i=ys.Util_vector.create(),a=t.x+e[0],s=t.y+e[1],l=t.r0||0,u=t.r,c=ys.Util_math.degreeToRadian(t.startAngle),f=ys.Util_math.degreeToRadian(t.endAngle),e=t.clockWise;return e||(c=-c,f=-f),1<l?ys.Util_computeBoundingBox.arc(a,s,l,c,f,!e,n,o):(n[0]=o[0]=a,n[1]=o[1]=s),ys.Util_computeBoundingBox.arc(a,s,u,c,f,!e,r,i),ys.Util_vector.min(n,n,r),ys.Util_vector.max(o,o,i),t.__rect={x:n[0],y:n[1],width:o[0]-n[0],height:o[1]-n[1]},t.__rect}}]),o}();function Sl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _l=(ss=[{key:"transformStyle",value:function(t){var e,n={},r=["normal","normal","normal","12","arial,sans-serif"],o=[!0,!1];for(e in t)switch(e){case"fill":o[0]=t[e];break;case"fillColor":n.color=t[e];break;case"stroke":o[1]=t[e];break;case"strokeWidth":n.lineWidth=t[e];break;case"strokeLinecap":n.lineCap=t[e];break;case"strokeLineJoin":n.lineJoin=t[e];break;case"strokeDashstyle":n.lineType=t[e];break;case"pointRadius":n.r=t[e];break;case"label":n.text=t[e];break;case"labelRect":n.labelRect=t[e];break;case"fontColor":n.textColor=t[e];break;case"fontStyle":r[0]=t[e];break;case"fontVariant":r[1]=t[e];break;case"fontWeight":r[2]=t[e];break;case"fontSize":var i="";t[e]&&t[e].toString().indexOf("px")<0&&(i="px"),r[3]=t[e]+i;break;case"fontFamily":r[4]=t[e];break;case"fontOpacity":n.opacity=t[e];break;case"labelPosition":n.textPosition=t[e];break;case"labelAlign":n.textAlign=t[e];break;case"labelBaseline":n.textBaseline=t[e];break;case"labelRotation":n.textRotation=t[e];break;default:n[e]=t[e]}return n.textFont=r.join(" "),!0===o[0]&&!1===o[1]?n.brushType="fill":!1===o[0]&&!0===o[1]?n.brushType="stroke":!0===o[0]&&!0===o[1]?n.brushType="both":n.brushType="fill",null==n.lineWidth&&(n.lineWidth=1),n}},{key:"Background",value:function(t,e,n){n=n||{},e=new ra(e[0],e[3],Math.abs(e[2]-e[0]),Math.abs(e[3]-e[1]));return e.style={fillColor:"#f3f3f3"},n.backgroundStyle&&B.copyAttributesWithClip(e.style,n.backgroundStyle),n.backgroundRadius&&(e.style.radius=n.backgroundRadius),e.clickable=!1,e.hoverable=!1,t.createShape(e)}},{key:"GraphAxis",value:function(t,e,n,r){var o=e,i=n||{},a=[],s=[],l=!!i.useXReferenceLine&&i.useXReferenceLine,u=i.axisYTick&&!isNaN(i.axisYTick)?i.axisYTick:0,e=[],c=[];if(0==u)c.push([o[0],o[3]-5]),c.push([o[0],o[1]]),i.axis3DParameter&&!isNaN(i.axis3DParameter)&&15<=i.axis3DParameter&&(n=parseInt(i.axis3DParameter),n=[o[0]-n,o[1]+n],i.axisUseArrow&&(e.push([n[0]+1.5,n[1]-7.5]),e.push([n[0]-1,n[1]+1]),e.push([n[0]+7.5,n[1]-1.5])),c.push([n[0],n[1]]),c.push([o[0],o[1]])),c.push([o[2]+5,o[1]]);else{var f=Math.abs(o[1]-o[3])/u,h=o[3];c.push([o[0],h-5]);for(var p,y,d,v=0;v<u;v++)c.push([o[0],h]),c.push([o[0]-5,h]),c.push([o[0],h]),l&&((p=new zi([[o[0],h],[o[2],h]])).style={strokeColor:"#cfcfcf",strokeLinecap:"butt",strokeLineJoin:"round",strokeWidth:1},p.clickable=!1,p.hoverable=!1,i.xReferenceLineStyle&&B.copyAttributesWithClip(p.style,i.xReferenceLineStyle),a.push(t.createShape(p))),h+=f;c.push([o[0],o[1]]),i.axis3DParameter&&!isNaN(i.axis3DParameter)&&15<=i.axis3DParameter&&(y=parseInt(i.axis3DParameter),d=[o[0]-y,o[1]+y],i.axisUseArrow&&(e.push([d[0]+1.5,d[1]-7.5]),e.push([d[0]-1,d[1]+1]),e.push([d[0]+7.5,d[1]-1.5])),c.push([d[0],d[1]]),c.push([o[0],o[1]])),c.push([o[2]+5,o[1]])}i.axisUseArrow&&(y=[[o[2]+5,o[1]+4],[o[2]+13,o[1]],[o[2]+5,o[1]-4]],d=[[o[0]-4,o[3]-5],[o[0],o[3]-13],[o[0]+4,o[3]-5]],(y=new Ki(y)).style={fillColor:"#008acd"},B.copyAttributesWithClip(y.style,i.axisStyle),s.push(t.createShape(y)),(d=new Ki(d)).style={fillColor:"#008acd"},B.copyAttributesWithClip(d.style,i.axisStyle),s.push(t.createShape(d)),i.axis3DParameter&&!isNaN(i.axis3DParameter)&&15<=i.axis3DParameter&&((g=new Ki(e)).style={fillColor:"#008acd"},B.copyAttributesWithClip(g.style,i.axisStyle),s.push(t.createShape(g))));e=new zi(c);e.style={strokeLinecap:"butt",strokeLineJoin:"round",strokeColor:"#008acd",strokeWidth:1},i.axisStyle&&B.copyAttributesWithClip(e.style,i.axisStyle),e.clickable=!1,e.hoverable=!1;var g=[t.createShape(e)],m=[];if(i.axisYLabels&&i.axisYLabels.length&&0<i.axisYLabels.length){var b=i.axisYLabels,S=b.length,_=[0,0];if(i.axisYLabelsOffset&&i.axisYLabelsOffset.length&&(_=i.axisYLabelsOffset),1==S){e=new da(o[0]-5+_[0],o[3]+_[1],b[0]);e.style={labelAlign:"right"},i.axisYLabelsStyle&&B.copyAttributesWithClip(e.style,i.axisYLabelsStyle),e.clickable=!1,e.hoverable=!1,m.push(t.createShape(e))}else for(var w=o[3],O=Math.abs(o[1]-o[3])/(S-1),E=0;E<S;E++){var x=new da(o[0]-5+_[0],w+_[1],b[E]);x.style={labelAlign:"right"},i.axisYLabelsStyle&&B.copyAttributesWithClip(x.style,i.axisYLabelsStyle),x.clickable=!1,x.hoverable=!1,m.push(t.createShape(x)),w+=O}}var P=[];if(i.axisXLabels&&i.axisXLabels.length&&0<i.axisXLabels.length){var C=i.axisXLabels,k=C.length,T=[0,0];if(i.axisXLabelsOffset&&i.axisXLabelsOffset.length&&(T=i.axisXLabelsOffset),r&&r.xPositions&&r.xPositions.length&&r.xPositions.length==k)for(var R=r.xPositions,A=0;A<k;A++){var L=new da(R[A]+T[0],o[1]+T[1],C[A]);L.style={labelAlign:"center",labelBaseline:"top"},i.axisXLabelsStyle&&B.copyAttributesWithClip(L.style,i.axisXLabelsStyle),L.clickable=!1,L.hoverable=!1,P.push(t.createShape(L))}else if(1==k){r=new da(o[0]-5+T[0],o[1]+T[0],C[0]);r.style={labelAlign:"center",labelBaseline:"top"},i.axisXLabelsStyle&&B.copyAttributesWithClip(r.style,i.axisXLabelsStyle),r.clickable=!1,r.hoverable=!1,P.push(t.createShape(r))}else for(var I=o[0],N=Math.abs(o[2]-o[0])/(k-1),j=0;j<k;j++){var M=new da(I+T[0],o[1]+T[1],C[j]);M.style={labelAlign:"center",labelBaseline:"top"},i.axisXLabelsStyle&&B.copyAttributesWithClip(M.style,i.axisXLabelsStyle),M.clickable=!1,M.hoverable=!1,P.push(t.createShape(M)),I+=N}}return a.concat(g).concat(m).concat(P).concat(s)}},{key:"ShapeStyleTool",value:function(t,e,n,r,o,i){var a=t||{};if(e&&B.copyAttributesWithClip(a,e),n&&n.length&&void 0!==o&&!isNaN(o)&&0<=o&&n[o]&&B.copyAttributesWithClip(a,n[o]),r&&r.length&&void 0!==i)for(var s=r,l=s.length,u=parseFloat(i),c=0;c<l;c++)if(s[c].start<=u&&u<s[c].end){B.copyAttributesWithClip(a,s[c].style);break}return a}}],Sl((cs=wl).prototype,[{key:"destroy",value:function(){this.shapeParameters=null}},{key:"createShape",value:function(t){if(t&&(this.shapeParameters=t),!this.shapeParameters)return null;t=this.shapeParameters;if(t instanceof Fi){(e=new Object).x=t.x,e.y=t.y,e.r=t.r;var e=B.copyAttributesWithClip(e,t.style,["x","y"]),n=new As;return n.style=wl.transformStyle(e),n.highlightStyle=wl.transformStyle(t.highlightStyle),B.copyAttributesWithClip(n,t,["x","y","style","highlightStyle"]),n}if(t instanceof zi){if(!t.pointList)return null;(e=new Object).pointList=t.pointList;e=B.copyAttributesWithClip(e,t.style,["pointList"]),n=new el;return n.style=wl.transformStyle(e),n.highlightStyle=wl.transformStyle(t.highlightStyle),B.copyAttributesWithClip(n,t,["pointList","style","highlightStyle"]),n}if(t instanceof Ki){if(!t.pointList)return null;(r=new Object).pointList=t.pointList;var r=B.copyAttributesWithClip(r,t.style,["pointList"]),o=new Js;return o.style=wl.transformStyle(r),o.highlightStyle=wl.transformStyle(t.highlightStyle),B.copyAttributesWithClip(o,t,["pointList","style","highlightStyle"]),o}if(t instanceof ra){if(!t.x&&!t.y&!t.width&!t.height)return null;(r=new Object).x=t.x,r.y=t.y,r.width=t.width,r.height=t.height;r=B.copyAttributesWithClip(r,t.style,["x","y","width","height"]),o=new pl;return o.style=wl.transformStyle(r),o.highlightStyle=wl.transformStyle(t.highlightStyle),B.copyAttributesWithClip(o,t,["x","y","width","height","style","highlightStyle"]),o}if(t instanceof ua){(i=new Object).x=t.x,i.y=t.y,i.r=t.r,i.startAngle=t.startAngle,i.endAngle=t.endAngle,t.r0&&(i.r0=t.r0),t.clockWise&&(i.clockWise=t.clockWise);var i=B.copyAttributesWithClip(i,t.style,["x","y","r","startAngle","endAngle","r0","endAngle"]),a=new bl;return a.style=wl.transformStyle(i),a.highlightStyle=wl.transformStyle(t.highlightStyle),B.copyAttributesWithClip(a,t,["x","y","r","startAngle","endAngle","r0","endAngle","style","highlightStyle"]),a}if(t instanceof da){(i=new Object).x=t.x,i.y=t.y,i.text=t.text;i=B.copyAttributesWithClip(i,t.style,["x","y","text"]),a=new Bs;return a.style=wl.transformStyle(i),a.highlightStyle=wl.transformStyle(t.highlightStyle),B.copyAttributesWithClip(a,t,["x","y","text","style","highlightStyle"]),a}if(t instanceof _a){(s=new Object).x=t.x,s.y=t.y,t.image&&(s.image=t.image),t.width&&(s.width=t.width),t.height&&(s.height=t.height),t.sx&&(s.sx=t.sx),t.sy&&(s.sy=t.sy),t.sWidth&&(s.sWidth=t.sWidth),t.sHeight&&(s.sHeight=t.sHeight);var s=B.copyAttributesWithClip(s,t.style,["x","y","image","width","height","sx","sy","sWidth","sHeight"]),l=new sl;return l.style=wl.transformStyle(s),l.highlightStyle=wl.transformStyle(t.highlightStyle),B.copyAttributesWithClip(l,t,["x","y","image","width","height","style","highlightStyle"]),l}if(t instanceof Ca){(s=new Object).x=t.x,s.r=t.r,s.y=t.y;s=B.copyAttributesWithClip(s,t.style,["x","y","r"]),l=new Ws;return l.style=wl.transformStyle(s),l.highlightStyle=wl.transformStyle(t.highlightStyle),B.copyAttributesWithClip(l,t,["x","y","r","style","highlightStyle","lineWidth","text","textPosition"]),l}return null}}]),Sl(cs,ss),wl);function wl(t){!function(t){if(!(t instanceof wl))throw new TypeError("Cannot call a class as a function")}(this),this.shapeParameters=t,this.CLASS_NAME="SuperMap.Feature.ShapeFactory"}function Ol(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Feature=c.Feature||{},c.Feature.ShapeFactory=_l;var El=(Ol(xl.prototype,[{key:"destroy",value:function(){this.data=null,this.id=null,this.lonlat=null,this.location=null,this.shapes=null,this.layer=null}},{key:"getLocalXY",value:function(t){var e=this.layer.map.getResolution(),n=this.layer.map.getExtent();return t instanceof pe||t instanceof xi?[t.x/e+-n.left/e,n.top/e-t.y/e]:t instanceof Xt?[t.lon/e+-n.left/e,n.top/e-t.lat/e]:null}}]),xl);function xl(t,e){!function(t){if(!(t instanceof xl))throw new TypeError("Cannot call a class as a function")}(this),t&&e&&e.map&&e.renderer&&(this.id=B.createUniqueID(this.CLASS_NAME+"_"),this.lonlat=null,this.location=[],this.data=t,this.shapes=[],this.layer=e,this.CLASS_NAME="SuperMap.Feature.Theme")}function Pl(t){return(Pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function kl(t,e,n){return(kl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Rl(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Tl(t,e){return(Tl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Rl(t){return(Rl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature=c.Feature||{},c.Feature.Theme=El;var Al=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tl(t,e)}(s,El);var n,r,a=(n=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Rl(n);return function(t,e){if(e&&("object"===Pl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Rl(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function s(t,e,n,r,o,i){return function(t){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this),(i=a.call(this,t,e,n,r,o,i)).shapeFactory=new _l,i.shapeParameters=null,i.RelativeCoordinate=!1,i.setting=null,i.origonPoint=null,i.chartBox=null,i.chartBounds=null,i.width=null,i.height=null,i.XOffset=0,i.YOffset=0,i.DVBParameter=null,i.dataViewBox=null,i.DVBCodomain=null,i.DVBCenterPoint=null,i.DVBUnitValue=null,i.DVBOrigonPoint=null,i.DVBWidth=null,i.DVBHeight=null,i.origonPointOffset=null,i.fields=n||[],i.dataValues=null,i.lonlat=o||i.data.geometry.getBounds().getCenterLonLat(),r&&r.width&&r.height&&r.codomain&&(i.setting=r),i.CLASS_NAME="SuperMap.Feature.Theme.Graph",i}return Cl(s.prototype,[{key:"destroy",value:function(){this.shapeFactory=null,this.shapeParameters=null,this.width=null,this.height=null,this.origonPoint=null,this.chartBox=null,this.dataViewBox=null,this.chartBounds=null,this.DVBParameter=null,this.DVBOrigonPoint=null,this.DVBCenterPoint=null,this.DVBWidth=null,this.DVBHeight=null,this.DVBCodomain=null,this.DVBUnitValue=null,this.origonPointOffset=null,this.XOffset=null,this.YOffset=null,this.fields=null,this.dataValues=null,this.setting=null,kl(Rl(s.prototype),"destroy",this).call(this)}},{key:"initBaseParameter",value:function(){if(!this.setting)return!1;var t=this.setting;if(!(t.width&&t.height&&t.codomain))return!1;var e=void 0===t.decimalNumber||isNaN(t.decimalNumber)?-1:t.decimalNumber,n=El.getDataValues(this.data,this.fields,e);this.dataValues=n||[],this.width=parseFloat(t.width),this.height=parseFloat(t.height),this.DVBCodomain=t.codomain,this.XOffset=t.XOffset||0,this.YOffset=t.YOffset||0,this.origonPoint=[],this.chartBox=[],this.dataViewBox=[],this.DVBParameter=t.dataViewBoxParameter||[0,0,0,0],this.DVBOrigonPoint=[],this.DVBCenterPoint=[],this.origonPointOffset=[],this.resetLocation();e=this.width,n=this.height,t=this.location;this.origonPoint=[t[0]-e/2,t[1]-n/2];t=this.origonPoint;this.chartBox=[t[0],t[1]+n,t[0]+e,t[1]];n=this.chartBox,e=this.DVBParameter;this.dataViewBox=[n[0]+e[0],n[1]-e[1],n[2]-e[2],n[3]+e[3]];e=this.dataViewBox;return!(e[0]>=e[2]||e[1]<=e[3]||(this.DVBOrigonPoint=[e[0],e[3]],this.DVBWidth=Math.abs(e[2]-e[0]),this.DVBHeight=Math.abs(e[1]-e[3]),this.DVBCenterPoint=[this.DVBOrigonPoint[0]+this.DVBWidth/2,this.DVBOrigonPoint[1]+this.DVBHeight/2],this.origonPointOffset=[this.DVBOrigonPoint[0]-t[0],this.DVBOrigonPoint[1]-t[1]],0))}},{key:"resetLocation",value:function(t){t&&(this.lonlat=t);var e=this.getLocalXY(this.lonlat);e[0]+=this.XOffset,e[1]+=this.YOffset,this.location=e;var n=this.width,t=this.height,e=this.location;return this.chartBounds=new Kt(e[0]-n/2,e[1]+t/2,e[0]+n/2,e[1]-t/2),this.resetLinearGradient(),e}},{key:"resetLinearGradient",value:function(){}},{key:"shapesConvertToRelativeCoordinate",value:function(){for(var t=this.shapes,e=this.location,n=0,r=t.length;n<r;n++){t[n].refOriginalPosition=e;var o,i=t[n].style;for(o in i)switch(o){case"pointList":for(var a=i[o],s=0,l=a.length;s<l;s++)a[s][0]-=e[0],a[s][1]-=e[1];break;case"x":i[o]-=e[0];break;case"y":i[o]-=e[1]}}this.RelativeCoordinate=!0}},{key:"assembleShapes",value:function(){}},{key:"getLocalXY",value:function(t){return this.layer.getLocalXY(t)}}]),s}();function Ll(t){return(Ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Il(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nl(t,e,n){return(Nl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ml(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function jl(t,e){return(jl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ml(t){return(Ml=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}El.getDataValues=function(t,e,n){if(!t.attributes)return!1;for(var r=[],o=t.attributes,i=0;i<e.length;i++)for(var a in o)if(a===e[i])try{!isNaN(n)&&0<=n?r.push(parseFloat(o[a].toString()).toFixed(n)):r.push(parseFloat(o[a].toString()))}catch(t){throw new Error("not a number")}return r.length===e.length&&r},c.Feature.Theme.Graph=Al;var cs=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jl(t,e)}(a,Al);var n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Ml(n);return function(t,e){if(e&&("object"===Ll(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Ml(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function a(t,e,n,r,o){return function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),(o=i.call(this,t,e,n,r,o)).CLASS_NAME="SuperMap.Feature.Theme.Bar",o}return Il(a.prototype,[{key:"destroy",value:function(){Nl(Ml(a.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function(){var t={showShadow:!0,shadowBlur:8,shadowColor:"rgba(100,100,100,0.8)",shadowOffsetX:2,shadowOffsetY:2},e=this.setting;if(e.barLinearGradient||(e.barLinearGradient=[["#00FF00","#00CD00"],["#00CCFF","#5E87A2"],["#00FF66","#669985"],["#CCFF00","#94A25E"],["#FF9900","#A2945E"]]),e.dataViewBoxParameter||(void 0===e.useAxis||e.useAxis?e.dataViewBoxParameter=[45,15,15,15]:e.dataViewBoxParameter=[5,5,5,5]),this.initBaseParameter()){var n=this.DVBCodomain;this.DVBUnitValue=(n[1]-n[0])/this.DVBHeight;var r=this.dataViewBox,o=this.dataValues;if(!(o.length<1)){for(var i=0,a=o.length;i<a;i++)if(o[i]<n[0]||o[i]>n[1])return;var s=this.calculateXShapeInfo();if(s){var l=s.xPositions,u=s.width;void 0!==e.useBackground&&!e.useBackground||this.shapes.push(_l.Background(this.shapeFactory,this.chartBox,e)),void 0!==e.useAxis&&!e.useAxis||(this.shapes=this.shapes.concat(_l.GraphAxis(this.shapeFactory,r,e,s)));for(var c=0;c<o.length;c++){var f=r[1]-(o[c]-n[0])/this.DVBUnitValue,h=[[l[c]-u/2,r[1]-1],[l[c]+u/2,r[1]-1],[l[c]+u/2,f],[l[c]-u/2,f]],f=new Ki(h);void 0!==e.showShadow&&!e.showShadow||(e.barShadowStyle&&((h=e.barShadowStyle).shadowBlur&&(t.shadowBlur=h.shadowBlur),h.shadowColor&&(t.shadowColor=h.shadowColor),h.shadowOffsetX&&(t.shadowOffsetX=h.shadowOffsetX),h.shadowOffsetY&&(t.shadowOffsetY=h.shadowOffsetY)),f.style={},B.copyAttributesWithClip(f.style,t)),f.refDataID=this.data.id,f.dataInfo={field:this.fields[c],value:o[c]},void 0!==e.barHoverAble&&(f.hoverable=e.barHoverAble),void 0!==e.barClickAble&&(f.clickable=e.barClickAble),this.shapes.push(this.shapeFactory.createShape(f))}this.shapesConvertToRelativeCoordinate()}}}}},{key:"calculateXShapeInfo",value:function(){var t,e=this.dataViewBox,n=this.setting,r=this.dataValues.length;if(r<1)return null;var o=[],i=0,a=this.DVBWidth;if(n.xShapeBlank&&n.xShapeBlank.length&&3==n.xShapeBlank.length){n=a-((t=n.xShapeBlank)[0]+t[2]+(r-1)*t[1]);if(n<=r)return null;i=n/r}else t=[i=a/(2*r+1),i,i];for(var s=0,l=0;l<r;l++)0==l?s=t[0]+i/2:s+=i+t[1],o.push(e[0]+s);return{xPositions:o,width:i}}},{key:"resetLinearGradient",value:function(){if(this.RelativeCoordinate)for(var t=this.shapes.length,e=this.setting.barLinearGradient,n=-1,r=0;r<t;r++){var o,i,a,s,l=this.shapes[r];"SuperMap.LevelRenderer.Shape.SmicPolygon"===l.CLASS_NAME&&(s=l.style,o=this.location[0]+s.pointList[0][0],i=this.location[0]+s.pointList[1][0],++n>=e.length&&(n%=e.length),a=e[n][0],s=e[n][1],s=(new za).getLinearGradient(o,0,i,0,[[0,a],[1,s]]),l.style.color=s)}}}]),a}();function Bl(t){return(Bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Fl(t,e,n){return(Fl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hl(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Ul(t,e){return(Ul=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Hl(t){return(Hl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature.Theme.Bar=cs;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ul(t,e)}(a,Al);var n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Hl(n);return function(t,e){if(e&&("object"===Bl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Hl(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function a(t,e,n,r,o){return function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),(o=i.call(this,t,e,n,r,o)).CLASS_NAME="SuperMap.Feature.Theme.Bar3D",o}return Dl(a.prototype,[{key:"destroy",value:function(){Fl(Hl(a.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function(){var t=this.setting;if(t.dataViewBoxParameter||(void 0===t.useAxis||t.useAxis?t.dataViewBoxParameter=[45,25,20,20]:t.dataViewBoxParameter=[5,5,5,5]),t.axisUseArrow=void 0===t.axisUseArrow||t.axisUseArrow,t.axisXLabelsOffset=void 0!==t.axisXLabelsOffset?t.axisXLabelsOffset:[-10,10],this.initBaseParameter()){var e=this.DVBCodomain;this.DVBUnitValue=(e[1]-e[0])/this.DVBHeight;var n=this.dataViewBox,r=this.dataValues;if(!(r.length<1)){for(var o=0,i=r.length;o<i;o++)if(r[o]<e[0]||r[o]>e[1])return;var a=this.calculateXShapeInfo();if(a){var s=a.xPositions,l=a.width;void 0!==t.useBackground&&!t.useBackground||this.shapes.push(_l.Background(this.shapeFactory,this.chartBox,t)),(!t.axis3DParameter||isNaN(t.axis3DParameter)||t.axis3DParameter<15)&&(t.axis3DParameter=20),void 0!==t.useAxis&&!t.useAxis||(this.shapes=this.shapes.concat(_l.GraphAxis(this.shapeFactory,n,t,a)));for(var u=t.bar3DParameter&&!isNaN(t.bar3DParameter)?t.bar3DParameter:10,c=0;c<r.length;c++){var f=n[1]-(r[c]-e[0])/this.DVBUnitValue,h=s[c]-l/2,p=s[c]+l/2,y=[[p,f],[p-u,f+u],[p-u,n[1]+u],[p,n[1]]],d=[[h-u,n[1]+u],[p-u,n[1]+u],[p-u,f+u],[h-u,f+u]];u<=0&&(d=[[h,n[1]],[p,n[1]],[p,f],[h,f]]);f=new Ki([[h,f],[p,f],[p-u,f+u],[h-u,f+u]]),y=new Ki(y),d=new Ki(d);t.barSideStyle=t.barSideStyle||t.barFaceStyle,t.barSideStyleByFields=t.barSideStyleByFields||t.barFaceStyleByFields,t.barSideStyleByCodomain=t.barSideStyleByCodomain||t.barFaceStyleByCodomain,t.barTopStyle=t.barTopStyle||t.barFaceStyle,t.barTopStyleByFields=t.barTopStyleByFields||t.barFaceStyleByFields,t.barTopStyleByCodomain=t.barTopStyleByCodomain||t.barFaceStyleByCodomain,d.style=_l.ShapeStyleTool({stroke:!0,strokeColor:"#ffffff",fillColor:"#ee9900"},t.barFaceStyle,t.barFaceStyleByFields,t.barFaceStyleByCodomain,c,r[c]),y.style=_l.ShapeStyleTool({stroke:!0,strokeColor:"#ffffff",fillColor:"#ee9900"},t.barSideStyle,t.barSideStyleByFields,t.barSideStyleByCodomain,c,r[c]),f.style=_l.ShapeStyleTool({stroke:!0,strokeColor:"#ffffff",fillColor:"#ee9900"},t.barTopStyle,t.barTopStyleByFields,t.barTopStyleByCodomain,c,r[c]),t.barSideHoverStyle=t.barSideHoverStyle||t.barFaceHoverStyle,t.barTopHoverStyle=t.barTopHoverStyle||t.barFaceHoverStyle,d.highlightStyle=_l.ShapeStyleTool({stroke:!0},t.barFaceHoverStyle),y.highlightStyle=_l.ShapeStyleTool({stroke:!0},t.barSideHoverStyle),f.highlightStyle=_l.ShapeStyleTool({stroke:!0},t.barTopHoverStyle),f.refDataID=y.refDataID=d.refDataID=this.data.id,f.isHoverByRefDataID=y.isHoverByRefDataID=d.isHoverByRefDataID=!0,f.refDataHoverGroup=y.refDataHoverGroup=d.refDataHoverGroup=B.createUniqueID("lr_shg"),f.dataInfo=y.dataInfo=d.dataInfo={field:this.fields[c],value:r[c]},void 0!==t.barHoverAble&&(f.hoverable=y.hoverable=d.hoverable=t.barHoverAble),void 0!==t.barClickAble&&(f.clickable=y.clickable=d.clickable=t.barClickAble),this.shapes.push(this.shapeFactory.createShape(y)),this.shapes.push(this.shapeFactory.createShape(f)),this.shapes.push(this.shapeFactory.createShape(d))}this.shapesConvertToRelativeCoordinate()}}}}},{key:"calculateXShapeInfo",value:function(){var t,e=this.dataViewBox,n=this.setting,r=this.dataValues.length;if(r<1)return null;var o=[],i=0,a=this.DVBWidth;if(n.xShapeBlank&&n.xShapeBlank.length&&3==n.xShapeBlank.length){n=a-((t=n.xShapeBlank)[0]+t[2]+(r-1)*t[1]);if(n<=r)return null;i=n/r}else t=[i=a/(2*r+1),i,i];for(var s=0,l=0;l<r;l++)0==l?s=t[0]+i/2:s+=i+t[1],o.push(e[0]+s);return{xPositions:o,width:i}}}]),a}();function Gl(t){return(Gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vl(t,e,n){return(Vl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Yl(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function zl(t,e){return(zl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yl(t){return(Yl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature.Theme.Bar3D=ss;var ql=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zl(t,e)}(s,Al);var n,r,a=(n=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Yl(n);return function(t,e){if(e&&("object"===Gl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Yl(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function s(t,e,n,r,o,i){return function(t){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this),(i=a.call(this,t,e,n,r,o,i)).setting=null,r&&r.codomain&&(i.setting=r,i.DVBCodomain=i.setting.codomain),i.CLASS_NAME="SuperMap.Feature.Theme.RankSymbol",i}return Wl(s.prototype,[{key:"destroy",value:function(){this.setting=null,Vl(Yl(s.prototype),"destroy",this).call(this)}},{key:"initBaseParameter",value:function(){if(!this.setting)return!1;var t=this.setting;t.XOffset&&(this.XOffset=t.XOffset),t.YOffset&&(this.YOffset=t.YOffset),this.XOffset=t.XOffset||0,this.YOffset=t.YOffset||0,this.origonPoint=[],this.chartBox=[],this.dataViewBox=[],this.DVBParameter=t.dataViewBoxParameter||[0,0,0,0],this.DVBOrigonPoint=[],this.DVBCenterPoint=[],this.origonPointOffset=[],this.resetLocation();var e=this.width,n=this.height,t=this.location;this.origonPoint=[t[0]-e/2,t[1]-n/2];t=this.origonPoint;this.chartBox=[t[0],t[1]+n,t[0]+e,t[1]];n=this.chartBox,e=this.DVBParameter;this.dataViewBox=[n[0]+e[0],n[1]-e[1],n[2]-e[2],n[3]+e[3]];e=this.dataViewBox;return!(e[0]>=e[2]||e[1]<=e[3]||(this.DVBOrigonPoint=[e[0],e[3]],this.DVBWidth=Math.abs(e[2]-e[0]),this.DVBHeight=Math.abs(e[1]-e[3]),this.DVBCenterPoint=[this.DVBOrigonPoint[0]+this.DVBWidth/2,this.DVBOrigonPoint[1]+this.DVBHeight/2],this.origonPointOffset=[this.DVBOrigonPoint[0]-t[0],this.DVBOrigonPoint[1]-t[1]],0))}}]),s}();function Xl(t){return(Xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ql(t,e,n){return(Ql="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zl(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Kl(t,e){return(Kl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Zl(t){return(Zl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature.Theme.RankSymbol=ql;cs=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kl(t,e)}(a,ql);var n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Zl(n);return function(t,e){if(e&&("object"===Xl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Zl(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function a(t,e,n,r,o){return function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),(o=i.call(this,t,e,n,r,o)).CLASS_NAME="SuperMap.Feature.Theme.Circle",o}return Jl(a.prototype,[{key:"destroy",value:function(){Ql(Zl(a.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function(){if(!this.setting)return!1;var t=this.setting;if(!t.codomain)return!1;var e=void 0===t.decimalNumber||isNaN(t.decimalNumber)?-1:t.decimalNumber,n=El.getDataValues(this.data,this.fields,e);this.dataValues=n||[];var r=this.dataValues;t.maxR||(t.maxR=100),t.minR||(t.minR=0);e=this.DVBCodomain;e&&0<e[1]-e[0]?this.DVBUnitValue=t.maxR/(e[1]-e[0]):this.DVBUnitValue=t.maxR;n=this.DVBUnitValue,n=r[0]*n+t.minR;this.width=2*n,this.height=2*n,!this.initBaseParameter()||e&&(r[0]<e[0]||r[0]>e[1])||(e=this.DVBCenterPoint,(e=new Ca(e[0],e[1],n)).style=_l.ShapeStyleTool(null,t.circleStyle,null,null,0),void 0!==t.fillColor?e.style.fillColor=t.fillColor:e.style.fillColor="#ff9277",e.highlightStyle=_l.ShapeStyleTool(null,t.circleHoverStyle),void 0!==t.circleHoverAble&&(e.hoverable=t.circleHoverAble),void 0!==t.circleClickAble&&(e.clickable=t.circleClickAble),e.refDataID=this.data.id,e.dataInfo={field:this.fields[0],r:n,value:r[0]},this.shapes.push(this.shapeFactory.createShape(e)),this.shapesConvertToRelativeCoordinate())}}]),a}();function $l(t){return($l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function eu(t,e,n){return(eu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ru(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function nu(t,e){return(nu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ru(t){return(ru=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature.Theme.Circle=cs;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nu(t,e)}(s,Al);var n,r,a=(n=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=ru(n);return function(t,e){if(e&&("object"===$l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=ru(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function s(t,e,n,r,o,i){return function(t){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this),(i=a.call(this,t,e,n,r,o,i)).CLASS_NAME="SuperMap.Feature.Theme.Line",i}return tu(s.prototype,[{key:"destroy",value:function(){eu(ru(s.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function(){var t=this.setting;if(t.dataViewBoxParameter||(void 0===t.useAxis||t.useAxis?t.dataViewBoxParameter=[45,15,15,15]:t.dataViewBoxParameter=[5,5,5,5]),this.initBaseParameter()){var e=this.dataViewBox,n=this.DVBCodomain;this.DVBUnitValue=(n[1]-n[0])/this.DVBHeight;var r=this.DVBUnitValue,o=this.dataValues;if(!(o.length<1)){var i=this.calculateXShapeInfo();if(i){var a=i.xPositions;void 0!==t.useBackground&&!t.useBackground||this.shapes.push(_l.Background(this.shapeFactory,this.chartBox,t)),this.shapes=this.shapes.concat(_l.GraphAxis(this.shapeFactory,e,t,i));for(var s=[],l=[],u=0,c=o.length;u<c;u++){if(o[u]<n[0]||o[u]>n[1])return null;var f=a[u],h=e[1]-(o[u]-n[0])/r,p=new Fi(f,h);p.style=_l.ShapeStyleTool({fillColor:"#ee9900"},t.pointStyle,t.pointStyleByFields,t.pointStyleByCodomain,u,o[u]),p.highlightStyle=_l.ShapeStyleTool(null,t.pointHoverStyle),void 0!==t.pointHoverAble&&(p.hoverable=t.pointHoverAble),void 0!==t.pointClickAble&&(p.clickable=t.pointClickAble),p.refDataID=this.data.id,p.dataInfo={field:this.fields[u],value:o[u]},l.push(this.shapeFactory.createShape(p)),s.push([f,h])}i=new zi(s);i.style=_l.ShapeStyleTool({strokeColor:"#ee9900"},t.lineStyle),i.clickable=!1,i.hoverable=!1;i=this.shapeFactory.createShape(i);this.shapes.push(i),this.shapes=this.shapes.concat(l),this.shapesConvertToRelativeCoordinate()}}}}},{key:"calculateXShapeInfo",value:function(){var t,e=this.dataViewBox,n=this.setting,r=this.dataValues.length;if(r<1)return null;var o=[],i=this.DVBWidth,a=0;if(n.xShapeBlank&&n.xShapeBlank.length&&2==n.xShapeBlank.length){n=i-((t=n.xShapeBlank)[0]+t[1]);if(n<=r)return null;a=n/(r-1)}else t=[a=i/(r+1),a,a];for(var s=0,l=0;l<r;l++)0==l?s=t[0]:s+=a,o.push(e[0]+s);return{xPositions:o,width:0}}}]),s}();function ou(t){return(ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function iu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function au(t,e,n){return(au="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=lu(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function su(t,e){return(su=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function lu(t){return(lu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature.Theme.Line=ss;cs=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&su(t,e)}(a,Al);var n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=lu(n);return function(t,e){if(e&&("object"===ou(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=lu(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function a(t,e,n,r,o){return function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),(o=i.call(this,t,e,n,r,o)).CLASS_NAME="SuperMap.Feature.Theme.Pie",o}return iu(a.prototype,[{key:"destroy",value:function(){au(lu(a.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function(){var t=this.setting,e=[{fillColor:"#ff9277"},{fillColor:"#dddd00"},{fillColor:"#ffc877"},{fillColor:"#bbe3ff"},{fillColor:"#d5ffbb"},{fillColor:"#bbbbff"},{fillColor:"#ddb000"},{fillColor:"#b0dd00"},{fillColor:"#e2bbff"},{fillColor:"#ffbbe3"},{fillColor:"#ff7777"},{fillColor:"#ff9900"},{fillColor:"#83dd00"},{fillColor:"#77e3ff"},{fillColor:"#778fff"},{fillColor:"#c877ff"},{fillColor:"#ff77ab"},{fillColor:"#ff6600"},{fillColor:"#aa8800"},{fillColor:"#77c7ff"},{fillColor:"#ad77ff"},{fillColor:"#ff77ff"},{fillColor:"#dd0083"},{fillColor:"#777700"},{fillColor:"#00aa00"},{fillColor:"#0088aa"},{fillColor:"#8400dd"},{fillColor:"#aa0088"},{fillColor:"#dd0000"},{fillColor:"#772e00"}];if(this.initBaseParameter()){t.useBackground&&this.shapes.push(_l.Background(this.shapeFactory,this.chartBox,t));var n=this.dataValues;if(!(n.length<1)){for(var r=this.DVBCodomain,o=0;o<n.length;o++)if(n[o]<r[0]||n[o]>r[1])return;for(var i=0,a=0;a<n.length;a++)i+=Math.abs(n[a]);this.DVBUnitValue=360/i;for(var s=this.DVBUnitValue,l=this.DVBCenterPoint,u=0,c=0,f=u,h=this.DVBHeight<this.DVBWidth?this.DVBHeight/2:this.DVBWidth/2,p=0;p<n.length;p++){var y=Math.abs(n[p]);360<=(c=0!==p&&p===y.length-1?f:u+y*s)-u&&(c=359.9999999);y=new ua(l[0],l[1],h,u,c);void 0===t.sectorStyleByFields?y.style=_l.ShapeStyleTool(null,t.sectorStyle,e,null,p%e.length):y.style=_l.ShapeStyleTool(null,t.sectorStyle,t.sectorStyleByFields,t.sectorStyleByCodomain,p,n[p]),y.highlightStyle=_l.ShapeStyleTool(null,t.sectorHoverStyle),void 0!==t.sectorHoverAble&&(y.hoverable=t.sectorHoverAble),void 0!==t.sectorClickAble&&(y.clickable=t.sectorClickAble),y.refDataID=this.data.id,y.dataInfo={field:this.fields[p],value:n[p]},this.shapes.push(this.shapeFactory.createShape(y)),u=c}this.shapesConvertToRelativeCoordinate()}}}}]),a}();function uu(t){return(uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fu(t,e,n){return(fu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=pu(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function hu(t,e){return(hu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pu(t){return(pu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature.Theme.Pie=cs;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hu(t,e)}(s,Al);var n,r,a=(n=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=pu(n);return function(t,e){if(e&&("object"===uu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=pu(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function s(t,e,n,r,o,i){return function(t){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this),(i=a.call(this,t,e,n,r,o,i)).CLASS_NAME="SuperMap.Feature.Theme.Point",i}return cu(s.prototype,[{key:"destroy",value:function(){fu(pu(s.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function(){var t=this.setting;if(t.dataViewBoxParameter||(void 0===t.useAxis||t.useAxis?t.dataViewBoxParameter=[45,15,15,15]:t.dataViewBoxParameter=[5,5,5,5]),this.initBaseParameter()){var e=this.dataViewBox,n=this.DVBCodomain;this.DVBUnitValue=(n[1]-n[0])/this.DVBHeight;var r=this.DVBUnitValue,o=this.dataValues,i=this.calculateXShapeInfo();if(i){var a=i.xPositions;void 0!==t.useBackground&&!t.useBackground||this.shapes.push(_l.Background(this.shapeFactory,this.chartBox,t)),this.shapes=this.shapes.concat(_l.GraphAxis(this.shapeFactory,e,t,i));for(var s=0,l=o.length;s<l;s++){if(o[s]<n[0]||o[s]>n[1])return null;var u=a[s],c=e[1]-(o[s]-n[0])/r,c=new Fi(u,c);c.style=_l.ShapeStyleTool({fillColor:"#ee9900"},t.pointStyle,t.pointStyleByFields,t.pointStyleByCodomain,s,o[s]),c.highlightStyle=_l.ShapeStyleTool(null,t.pointHoverStyle),void 0!==t.pointHoverAble&&(c.hoverable=t.pointHoverAble),void 0!==t.pointClickAble&&(c.clickable=t.pointClickAble),c.refDataID=this.data.id,c.dataInfo={field:this.fields[s],value:o[s]},this.shapes.push(this.shapeFactory.createShape(c))}this.shapesConvertToRelativeCoordinate()}}}},{key:"calculateXShapeInfo",value:function(){var t,e=this.dataViewBox,n=this.setting,r=this.dataValues.length;if(r<1)return null;var o=[],i=this.DVBWidth,a=0;if(n.xShapeBlank&&n.xShapeBlank.length&&2==n.xShapeBlank.length){n=i-((t=n.xShapeBlank)[0]+t[1]);if(n<=r)return null;a=n/(r-1)}else t=[a=i/(r+1),a,a];for(var s=0,l=0;l<r;l++)0==l?s=t[0]:s+=a,o.push(e[0]+s);return{xPositions:o,width:0}}}]),s}();function yu(t){return(yu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function du(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vu(t,e,n){return(vu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=mu(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function gu(t,e){return(gu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mu(t){return(mu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature.Theme.Point=ss;cs=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gu(t,e)}(a,Al);var n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=mu(n);return function(t,e){if(e&&("object"===yu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=mu(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function a(t,e,n,r,o){return function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),(o=i.call(this,t,e,n,r,o)).CLASS_NAME="SuperMap.Feature.Theme.Ring",o}return du(a.prototype,[{key:"destroy",value:function(){vu(mu(a.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function(){if(this.initBaseParameter()){var t=[{fillColor:"#ff9277"},{fillColor:"#dddd00"},{fillColor:"#ffc877"},{fillColor:"#bbe3ff"},{fillColor:"#d5ffbb"},{fillColor:"#bbbbff"},{fillColor:"#ddb000"},{fillColor:"#b0dd00"},{fillColor:"#e2bbff"},{fillColor:"#ffbbe3"},{fillColor:"#ff7777"},{fillColor:"#ff9900"},{fillColor:"#83dd00"},{fillColor:"#77e3ff"},{fillColor:"#778fff"},{fillColor:"#c877ff"},{fillColor:"#ff77ab"},{fillColor:"#ff6600"},{fillColor:"#aa8800"},{fillColor:"#77c7ff"},{fillColor:"#ad77ff"},{fillColor:"#ff77ff"},{fillColor:"#dd0083"},{fillColor:"#777700"},{fillColor:"#00aa00"},{fillColor:"#0088aa"},{fillColor:"#8400dd"},{fillColor:"#aa0088"},{fillColor:"#dd0000"},{fillColor:"#772e00"}],e=this.setting;e.useBackground&&this.shapes.push(_l.Background(this.shapeFactory,this.chartBox,e));var n=this.dataValues;if(!(n.length<1)){for(var r=this.DVBCodomain,o=0;o<n.length;o++)if(n[o]<r[0]||n[o]>r[1])return;for(var i=0,a=0;a<n.length;a++)i+=Math.abs(n[a]);this.DVBUnitValue=360/i;for(var s=this.DVBUnitValue,l=this.DVBCenterPoint,u=0,c=u,f=this.DVBHeight<this.DVBWidth?this.DVBHeight/2:this.DVBWidth/2,h=0<=e.innerRingRadius&&e.innerRingRadius<f,p=void 0!==e.innerRingRadius&&!isNaN(e.innerRingRadius)&&h?e.innerRingRadius:0,y=0;y<n.length;y++){var d=Math.abs(n[y]),v=0!==y&&y===d.length-1?c:u+d*s,d=new ua(l[0],l[1],f,u,v,p);void 0===e.sectorStyleByFields?d.style=_l.ShapeStyleTool(null,e.sectorStyle,t,null,y%t.length):d.style=_l.ShapeStyleTool(null,e.sectorStyle,e.sectorStyleByFields,e.sectorStyleByCodomain,y,n[y]),d.highlightStyle=_l.ShapeStyleTool(null,e.sectorHoverStyle),void 0!==e.sectorHoverAble&&(d.hoverable=e.sectorHoverAble),void 0!==e.sectorClickAble&&(d.clickable=e.sectorClickAble),d.refDataID=this.data.id,d.dataInfo={field:this.fields[y],value:n[y]},this.shapes.push(this.shapeFactory.createShape(d)),u=v}this.shapesConvertToRelativeCoordinate()}}}}]),a}();function bu(t){return(bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Su(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _u(t,e,n){return(_u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=xu(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function wu(t,e){return(wu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ou(t,e){if(e&&("object"===bu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Eu(t)}function Eu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xu(t){return(xu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature.Theme.Ring=cs;var Pu=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wu(t,e)}(a,El);var n,r,i=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=xu(n);return Ou(this,r?(t=xu(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function a(t,e,n,r,o){if(function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),e=i.call(this,t,e),!t.geometry)return Ou(e);if(!(t.geometry instanceof te))return Ou(e);e.dataBounds=t.geometry.getBounds(),e.nodesClipPixel=2,e.isHoverAble=!0,e.isMultiHover=!0,e.isClickAble=!0,e.highlightStyle=null,e.shapeOptions={},e.style=n||{},e.CLASS_NAME="SuperMap.Feature.Theme.Vector",e.style=n||{},r&&B.copyAttributesWithClip(Eu(e),r,["shapeOptions","dataBounds"]),o&&B.copyAttributesWithClip(e.shapeOptions,o);t=t.geometry;return e.lonlat=e.dataBounds.getCenterLonLat(),e.location=e.getLocalXY(e.lonlat),t instanceof De||t instanceof ke?e.lineToTF(t):t instanceof we||(t instanceof me?e.multiPointToTF(t):t instanceof Le?e.multiLineStringToTF(t):t instanceof qe?e.multiPolygonToTF(t):t instanceof We?e.polygonToTF(t):t instanceof se||(t instanceof pe?e.pointToTF(t):t instanceof Ri?e.rectangleToTF(t):t instanceof xi&&e.geoTextToTF(t))),e}return Su(a.prototype,[{key:"destroy",value:function(){this.style=null,this.dataBounds=null,this.nodesClipPixel=null,this.isHoverAble=null,this.isMultiHover=null,this.isClickAble=null,this.highlightStyle=null,this.shapeOptions=null,_u(xu(a.prototype),"destroy",this).call(this)}},{key:"lineToTF",value:function(t){for(var e=t.components,n=[],r=this.location,o=[],i=this.nodesClipPixel,a=0;a<e.length;a++){var s=e[a],n=[],s=this.getLocalXY(s);if(n[0]=s[0]-r[0],n[1]=s[1]-r[1],0<o.length){s=o[o.length-1];if(Math.abs(s[0]-n[0])<=i&&Math.abs(s[1]-n[1])<=i)continue}o.push(n)}if(o.length<2)return null;t=new Object;(t=B.copyAttributesWithClip(t,this.style,["pointList"])).pointList=o;t=new el({style:t,clickable:this.isClickAble,hoverable:this.isHoverAble});this.highlightStyle&&(t.highlightStyle=this.highlightStyle),t.refOriginalPosition=this.location,t.refDataID=this.data.id,t.isHoverByRefDataID=this.isMultiHover,this.shapeOptions&&B.copyAttributesWithClip(t,this.shapeOptions),this.shapes.push(t)}},{key:"multiPointToTF",value:function(t){for(var e=t.components,n=[],r=this.location,o=[],i=this.nodesClipPixel,a=0;a<e.length;a++){var s=e[a],n=[],s=this.getLocalXY(s);if(n[0]=s[0]-r[0],n[1]=s[1]-r[1],0<o.length){var l=o[o.length-1];if(Math.abs(l[0]-n[0])<=i&&Math.abs(l[1]-n[1])<=i)continue}o.push(n);l=new Object;l.r=6,(l=B.copyAttributesWithClip(l,this.style)).x=n[0],l.y=n[1];l=new As({style:l,clickable:this.isClickAble,hoverable:this.isHoverAble});this.highlightStyle&&(l.highlightStyle=this.highlightStyle),l.refOriginalPosition=r,l.refDataID=this.data.id,l.isHoverByRefDataID=this.isMultiHover,this.shapeOptions&&B.copyAttributesWithClip(l,this.shapeOptions),this.shapes.push(l)}}},{key:"multiLineStringToTF",value:function(t){for(var e=t.components,n=0;n<e.length;n++){var r=e[n];this.lineToTF(r)}}},{key:"multiPolygonToTF",value:function(t){for(var e=t.components,n=0;n<e.length;n++){var r=e[n];this.polygonToTF(r)}}},{key:"pointToTF",value:function(t){var e=this.location,n=this.getLocalXY(t),t=new Object;t.r=6,(t=B.copyAttributesWithClip(t,this.style)).x=n[0]-e[0],t.y=n[1]-e[1];t=new As({style:t,clickable:this.isClickAble,hoverable:this.isHoverAble});this.highlightStyle&&(t.highlightStyle=this.highlightStyle),t.refOriginalPosition=e,t.refDataID=this.data.id,t.isHoverByRefDataID=this.isMultiHover,this.shapeOptions&&B.copyAttributesWithClip(t,this.shapeOptions),this.shapes.push(t)}},{key:"polygonToTF",value:function(t){for(var e=t.components,n=[],r=[],o=this.location,i=[],a=[],s=[],l=this.nodesClipPixel,u=0;u<e.length;u++){var c=e[u].components;if(0===u)for(var i=[],f=0;f<c.length;f++){if(r=[],n=this.getLocalXY(c[f]),r[0]=n[0]-o[0],r[1]=n[1]-o[1],0<i.length){var h=i[i.length-1];if(Math.abs(h[0]-r[0])<=l&&Math.abs(h[1]-r[1])<=l)continue}i.push(r)}else for(var a=[],p=0;p<c.length;p++){if(r=[],n=this.getLocalXY(c[p]),r[0]=n[0]-o[0],r[1]=n[1]-o[1],0<a.length){var y=a[a.length-1];if(Math.abs(y[0]-r[0])<=l&&Math.abs(y[1]-r[1])<=l)continue}a.push(r)}a.length<2||s.push(a)}i.length<2||((t=B.copyAttributesWithClip(t={},this.style,["pointList"])).pointList=i,t=new Js({style:t,clickable:this.isClickAble,hoverable:this.isHoverAble}),this.highlightStyle&&(t.highlightStyle=this.highlightStyle),t.refOriginalPosition=this.location,t.refDataID=this.data.id,t.isHoverByRefDataID=this.isMultiHover,0<s.length&&(t.holePolygonPointLists=s),this.shapeOptions&&B.copyAttributesWithClip(t,this.shapeOptions),this.shapes.push(t))}},{key:"rectangleToTF",value:function(t){var e=this.location,n=new Xt(t.x,t.y),r=this.layer.map.getResolution(),o=this.getLocalXY(n),n=new Object;n.r=6,(n=B.copyAttributesWithClip(n,this.style)).x=o[0]-e[0],n.y=o[1]-e[1]-2*t.width/r,n.width=t.width/r,n.height=t.height/r;n=new pl({style:n,clickable:this.isClickAble,hoverable:this.isHoverAble});this.highlightStyle&&(n.highlightStyle=this.highlightStyle),n.refOriginalPosition=e,n.refDataID=this.data.id,n.isHoverByRefDataID=this.isMultiHover,this.shapeOptions&&B.copyAttributesWithClip(n,this.shapeOptions),this.shapes.push(n)}},{key:"geoTextToTF",value:function(t){var e=this.location,n=this.getLocalXY(t),r=new Object;r.r=6,(r=B.copyAttributesWithClip(r,this.style,["x","y","text"])).x=n[0]-e[0],r.y=n[1]-e[1],r.text=t.text;r=new Bs({style:r,clickable:this.isClickAble,hoverable:this.isHoverAble});this.highlightStyle&&(r.highlightStyle=this.highlightStyle),r.refOriginalPosition=e,r.refDataID=this.data.id,r.isHoverByRefDataID=this.isMultiHover,this.shapeOptions&&B.copyAttributesWithClip(r,this.shapeOptions),this.shapes.push(r)}},{key:"updateAndAddShapes",value:function(){var t=this.getLocalXY(this.lonlat);this.location=t;for(var e=this.layer.renderer,n=0,r=this.shapes.length;n<r;n++){var o=this.shapes[n];o.refOriginalPosition=t,e.addShape(o)}}},{key:"getShapesCount",value:function(){return this.shapes.length}},{key:"getLocalXY",value:function(t){return this.layer.getLocalXY(t)}}]),a}();function Cu(t){return(Cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ku(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tu(t,e,n){return(Tu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Lu(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Ru(t,e){return(Ru=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Au(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Lu(t){return(Lu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.Feature.Theme.ThemeVector=Pu;var Iu=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ru(t,e)}(i,c.mixin(Ta,gs));var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Lu(n);return function(t,e){if(e&&("object"===Cu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Au(t)}(this,r?(t=Lu(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t){var e;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),e=o.call(this,t),t=t||{},e.id=null,e.type="group",e.clipShape=null,e._children=[],e._storage=null,e.__dirty=!0,e.ignore=!1,B.extend(Au(e),t),e.id=e.id||B.createUniqueID("smShapeGroup_"),e.CLASS_NAME="SuperMap.LevelRenderer.Group",e}return ku(i.prototype,[{key:"destroy",value:function(){this.id=null,this.type=null,this.clipShape=null,this._children=null,this._storage=null,this.__dirty=null,this.ignore=null,Tu(Lu(i.prototype),"destroy",this).call(this)}},{key:"children",value:function(){return this._children.slice()}},{key:"childAt",value:function(t){return this._children[t]}},{key:"addChild",value:function(t){t!=this&&t.parent!=this&&(t.parent&&t.parent.removeChild(t),this._children.push(t),(t.parent=this)._storage&&this._storage!==t._storage&&(this._storage.addToMap(t),t instanceof i&&t.addChildrenToStorage(this._storage)))}},{key:"removeChild",value:function(t){var e=B.indexOf(this._children,t);this._children.splice(e,1),t.parent=null,this._storage&&(this._storage.delFromMap(t.id),t instanceof i&&t.delChildrenFromStorage(this._storage))}},{key:"eachChild",value:function(t,e){for(var n=!!e,r=0;r<this._children.length;r++){var o=this._children[r];n?t.call(e,o):t(o)}}},{key:"traverse",value:function(t,e){for(var n=!!e,r=0;r<this._children.length;r++){var o=this._children[r];n?t.call(e,o):t(o),"group"===o.type&&o.traverse(t,e)}}},{key:"addChildrenToStorage",value:function(t){for(var e=0;e<this._children.length;e++){var n=this._children[e];t.addToMap(n),"group"===n.type&&n.addChildrenToStorage(t)}}},{key:"delChildrenFromStorage",value:function(t){for(var e=0;e<this._children.length;e++){var n=this._children[e];t.delFromMap(n.id),"group"===n.type&&n.delChildrenFromStorage(t)}}},{key:"modSelf",value:function(){this.__dirty=!0}}]),i}();function Nu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ju=(ss=[{key:"shapeCompareFunc",value:function(t,e){return t.zlevel==e.zlevel?t.z==e.z?t.__renderidx-e.__renderidx:t.z-e.z:t.zlevel-e.zlevel}}],Nu((cs=Mu).prototype,[{key:"destroy",value:function(){this.dispose(),this._shapeList=null,this._shapeListOffset=null}},{key:"iterShape",value:function(t,e){if((e=e||{hover:!1,normal:"down",update:!1}).hover)for(var n=0,r=this._hoverElements.length;n<r;n++){var o=this._hoverElements[n];if(o.updateTransform(),t(o))return this}if("down"===(e.update&&this.updateShapeList(),e.normal)){for(var i=this._shapeList.length;i--;)if(t(this._shapeList[i]))return this}else for(var a=0,s=this._shapeList.length;a<s;a++)if(t(this._shapeList[a]))return this;return this}},{key:"getHoverShapes",value:function(t){for(var e=[],n=this._hoverElements.length,r=0;r<n;r++){e.push(this._hoverElements[r]);var o=this._hoverElements[r].hoverConnect;if(o)for(var i,a=0,s=(o=o instanceof Array?o:[o]).length;a<s;a++)(i=o[a].id?o[a]:this.get(o[a]))&&e.push(i)}if(e.sort(Mu.shapeCompareFunc),t)for(var l=0,u=e.length;l<u;l++)e[l].updateTransform();return e}},{key:"getShapeList",value:function(t){return t&&this.updateShapeList(),this._shapeList}},{key:"updateShapeList",value:function(){this._shapeListOffset=0;for(var t=this._roots.length,e=0;e<t;e++){var n=this._roots[e];this._updateAndAddShape(n)}this._shapeList.length=this._shapeListOffset;for(var r=this._shapeList.length,o=0;o<r;o++)this._shapeList[o].__renderidx=o;this._shapeList.sort(Mu.shapeCompareFunc)}},{key:"_updateAndAddShape",value:function(t,e){if(!t.ignore)if(t.updateTransform(),"group"==t.type){t.clipShape&&((t.clipShape.parent=t).clipShape.updateTransform(),e?(e=e.slice()).push(t.clipShape):e=[t.clipShape]);for(var n=0;n<t._children.length;n++){var r=t._children[n];r.__dirty=t.__dirty||r.__dirty,this._updateAndAddShape(r,e)}t.__dirty=!1}else t.__clipShapes=e,this._shapeList[this._shapeListOffset++]=t}},{key:"mod",value:function(t,e){t=this._elements[t];if(t&&(t.modSelf(),e))if(e.parent||e._storage||e.__startClip){var n,r={};for(n in e)"parent"!=n&&"_storage"!=n&&"__startClip"!=n&&e.hasOwnProperty(n)&&(r[n]=e[n]);(new Ia).merge(t,r,!0)}else(new Ia).merge(t,e,!0);return this}},{key:"drift",value:function(t,e,n){t=this._elements[t];return t&&(t.needTransform=!0,"horizontal"===t.draggable?n=0:"vertical"===t.draggable&&(e=0),t.ondrift&&(!t.ondrift||t.ondrift(e,n))||t.drift(e,n)),this}},{key:"addHover",value:function(t){return t.updateNeedTransform(),this._hoverElements.push(t),this}},{key:"delHover",value:function(){return this._hoverElements=[],this}},{key:"hasHoverShape",value:function(){return 0<this._hoverElements.length}},{key:"addRoot",value:function(t){t instanceof Iu&&t.addChildrenToStorage(this),this.addToMap(t),this._roots.push(t)}},{key:"delRoot",value:function(t){if(void 0===t){for(var e=0;e<this._roots.length;e++){var n=this._roots[e];n instanceof Iu&&n.delChildrenFromStorage(this)}return this._elements={},this._hoverElements=[],void(this._roots=[])}if(t instanceof Array)for(var r=t.length,o=0;o<r;o++)this.delRoot(t[o]);else{var i="string"==typeof t?this._elements[t]:t,a=(new Ia).indexOf(this._roots,i);0<=a&&(this.delFromMap(i.id),this._roots.splice(a,1),i instanceof Iu&&i.delChildrenFromStorage(this))}}},{key:"addToMap",value:function(t){return t instanceof Iu&&(t._storage=this),t.modSelf(),this._elements[t.id]=t,this}},{key:"get",value:function(t){return this._elements[t]}},{key:"delFromMap",value:function(t){var e=this._elements[t];return e&&(delete this._elements[t],e instanceof Iu&&(e._storage=null)),this}},{key:"dispose",value:function(){this._elements=null,this._roots=null,this._hoverElements=null}}]),Nu(cs,ss),Mu);function Mu(){!function(t){if(!(t instanceof Mu))throw new TypeError("Cannot call a class as a function")}(this),this._elements={},this._hoverElements=[],this._roots=[],this._shapeList=[],this._shapeListOffset=0,this.CLASS_NAME="SuperMap.LevelRenderer.Storage"}function Bu(t){return(Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Du(t,e){return(Du=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Fu(t){return(Fu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Uu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gu(t,e,n){return e&&Hu(t.prototype,e),n&&Hu(t,n),t}var Wu=(Gu(zu,[{key:"destroy",value:function(){this.dispose(),this._zlevelList=null,this._layerConfig=null,this._bgDom=null,this.shapeToImage=null}},{key:"render",value:function(t){return this.refresh(t,!0),this}},{key:"refresh",value:function(t,e){var n=this.storage.getShapeList(!0);return this._paintList(n,e),"function"==typeof t&&t(),this}},{key:"_paintList",value:function(t,e){var n,r,o,i;for(i in void 0===e&&(e=!1),this._updateLayerStatus(t),this._layers)"hover"!==i&&(this._layers[i].unusedCount++,this._layers[i].updateTransform());for(var a,s,l=[],u=0,c=t.length;u<c;u++){var f,h,p=t[u];if(r!==p.zlevel&&(n&&n.needTransform&&o.restore(),o=(n=this.getLayer(p.zlevel)).ctx,r=p.zlevel,n.unusedCount=0,(n.dirty||e)&&n.clear(),n.needTransform&&(o.save(),n.setTransform(o))),o&&p.__startClip&&(f=p.__startClip,o.save(),f.needTransform&&(h=f.transform,ys.Util_matrix.invert(l,h),o.transform(h[0],h[1],h[2],h[3],h[4],h[5])),o.beginPath(),f.buildPath(o,f.style),o.clip(),f.needTransform&&o.transform(l[0],l[1],l[2],l[3],l[4],l[5])),(n&&n.dirty||e)&&!p.invisible&&(!p.onbrush||p.onbrush&&!p.onbrush(o,!1)))if(rs.catchBrushException)try{p.brush(o,!1,this.updatePainter)}catch(t){ys.Util_log(t,"brush error of "+p.type,p)}else p.brush(o,!1,this.updatePainter);o&&p.__stopClip&&o.restore(),p.__dirty=!1}for(a in o&&n&&n.needTransform&&o.restore(),this._layers)"hover"!==a&&((s=this._layers[a]).dirty=!1,1==s.unusedCount&&s.clear())}},{key:"getLayer",value:function(t){if(!(o=this._layers[t])){var e=this._zlevelList.length,n=null,r=-1;if(0<e&&t>this._zlevelList[0]){for(r=0;r<e-1&&!(this._zlevelList[r]<t&&this._zlevelList[r+1]>t);r++);n=this._layers[this._zlevelList[r]]}this._zlevelList.splice(r+1,0,t);var o=new Vu(B.createUniqueID("_levelLayer_"+t),this),n=n?n.dom:this._bgDom;n.nextSibling?n.parentNode.insertBefore(o.dom,n.nextSibling):n.parentNode.appendChild(o.dom),o.initContext(),this._layers[t]=o,this._layerConfig[t]&&(new Ia).merge(o,this._layerConfig[t],!0),o.updateTransform()}return o}},{key:"getLayers",value:function(){return this._layers}},{key:"_updateLayerStatus",value:function(t){var e,n=this._layers,r={};for(e in n)"hover"!==e&&(r[e]=n[e].elCount,n[e].elCount=0);for(var o,i=0;i<t.length;i++){var a=t[i],s=n[a.zlevel];s&&(s.elCount++,s.dirty||(s.dirty=a.__dirty))}for(o in n)"hover"!==o&&r[o]!==n[o].elCount&&(n[o].dirty=!0)}},{key:"refreshShapes",value:function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];this.storage.mod(o.id)}return this.refresh(e),this}},{key:"clear",value:function(){for(var t in this._layers)"hover"!=t&&this._layers[t].clear();return this}},{key:"modLayer",value:function(t,e){e&&(this._layerConfig[t]?(new Ia).merge(this._layerConfig[t],e,!0):this._layerConfig[t]=e,(e=this._layers[t])&&(new Ia).merge(e,this._layerConfig[t],!0))}},{key:"delLayer",value:function(t){var e=this._layers[t];e&&(this.modLayer(t,{position:e.position,rotation:e.rotation,scale:e.scale}),e.dom.parentNode.removeChild(e.dom),delete this._layers[t],this._zlevelList.splice((new Ia).indexOf(this._zlevelList,t),1))}},{key:"refreshHover",value:function(){this.clearHover();for(var t=this.storage.getHoverShapes(!0),e=0,n=t.length;e<n;e++)this._brushHover(t[e]);return this.storage.delHover(),this}},{key:"clearHover",value:function(){var t=this._layers.hover;return t&&t.clear(),this}},{key:"resize",value:function(){var t=this._domRoot;t.style.display="none";var e=this._getWidth(),n=this._getHeight();if(t.style.display="",this._width!=e||n!=this._height){for(var r in this._width=e,this._height=n,t.style.width=e+"px",t.style.height=n+"px",this._layers)this._layers[r].resize(e,n);this.refresh(null,!0)}return this}},{key:"clearLayer",value:function(t){t=this._layers[t];t&&t.clear()}},{key:"dispose",value:function(){this.root.innerHTML="",this.root=null,this.storage=null,this._domRoot=null,this._layers=null}},{key:"getDomHover",value:function(){return this._layers.hover.dom}},{key:"toDataURL",value:function(t,e,n){var r=zu.createDom(B.createUniqueID("SuperMap.Theme.image_"),"canvas",this);this._bgDom.appendChild(r);var o=r.getContext("2d");1!=zu.devicePixelRatio&&o.scale(zu.devicePixelRatio,zu.devicePixelRatio),o.fillStyle=e||"#fff",o.rect(0,0,this._width*zu.devicePixelRatio,this._height*zu.devicePixelRatio),o.fill();var i=this;this.storage.iterShape(function(e){if(!e.invisible&&(!e.onbrush||e.onbrush&&!e.onbrush(o,!1)))if(rs.catchBrushException)try{e.brush(o,!1,i.updatePainter)}catch(t){ys.Util_log(t,"brush error of "+e.type,e)}else e.brush(o,!1,i.updatePainter)},{normal:"up",update:!0});n=r.toDataURL(t,n),o=null;return this._bgDom.removeChild(r),n}},{key:"getWidth",value:function(){return this._width}},{key:"getHeight",value:function(){return this._height}},{key:"_getWidth",value:function(){var t=this.root,e=t.currentStyle||document.defaultView.getComputedStyle(t);return+((t.clientWidth||parseInt(e.width,10))-parseInt(e.paddingLeft,10)-parseInt(e.paddingRight,10)).toFixed(0)}},{key:"_getHeight",value:function(){var t=this.root,e=t.currentStyle||document.defaultView.getComputedStyle(t);return+((t.clientHeight||parseInt(e.height,10))-parseInt(e.paddingTop,10)-parseInt(e.paddingBottom,10)).toFixed(0)}},{key:"_brushHover",value:function(t){var e=this._layers.hover.ctx;if(!t.onbrush||t.onbrush&&!t.onbrush(e,!0)){var n=this.getLayer(t.zlevel);if(n.needTransform&&(e.save(),n.setTransform(e)),rs.catchBrushException)try{t.brush(e,!0,this.updatePainter)}catch(e){ys.Util_log(e,"hoverBrush error of "+t.type,t)}else t.brush(e,!0,this.updatePainter);n.needTransform&&e.restore()}}},{key:"_shapeToImage",value:function(t,e,n,r,o){var i=document.createElement("canvas"),a=i.getContext("2d"),o=o||window.devicePixelRatio||1;i.style.width=n+"px",i.style.height=r+"px",i.setAttribute("width",n*o),i.setAttribute("height",r*o),a.clearRect(0,0,n*o,r*o);o={position:e.position,rotation:e.rotation,scale:e.scale};e.position=[0,0,0],e.rotation=0,e.scale=[1,1],e&&e.brush(a,!1);i=new sl({id:t,style:{x:0,y:0,image:i}});return null!=o.position&&(i.position=e.position=o.position),null!=o.rotation&&(i.rotation=e.rotation=o.rotation),null!=o.scale&&(i.scale=e.scale=o.scale),i}},{key:"_createShapeToImageProcessor",value:function(){var o=this;return function(t,e,n,r){return o._shapeToImage(t,e,n,r,zu.devicePixelRatio)}}},{key:"updateHoverLayer",value:function(t){if(!(t instanceof Array))return this;this.clearHover(),this.storage.delHover();for(var e=0;e<t.length;e++)this.storage.addHover(t[e]),this._brushHover(t[e])}}],[{key:"createDom",value:function(t,e,n){var r=document.createElement(e),e=n._width,n=n._height;return r.style.position="absolute",r.style.left=0,r.style.top=0,r.style.width=e+"px",r.style.height=n+"px",r.setAttribute("width",e*zu.devicePixelRatio),r.setAttribute("height",n*zu.devicePixelRatio),r.setAttribute("id",t),r}}]),zu),Vu=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Du(t,e)}(i,gs);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Fu(n);return function(t,e){if(e&&("object"===Bu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Fu(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){var n;return Uu(this,i),(n=o.call(this,t,e)).dom=null,n.domBack=null,n.ctxBack=null,n.painter=e,n.unusedCount=0,n.config=null,n.dirty=!0,n.elCount=0,n.clearColor=0,n.motionBlur=!1,n.lastFrameAlpha=.7,n.zoomable=!1,n.panable=!1,n.maxZoom=1/0,n.minZoom=0,n.ctx=null,n.dom=Wu.createDom(B.createUniqueID("SuperMap.Theme"+t),"canvas",e),n.dom.onselectstart=function(){return!1},n.dom.style["-webkit-user-select"]="none",n.dom.style["user-select"]="none",n.dom.style["-webkit-touch-callout"]="none",n.CLASS_NAME="SuperMap.LevelRenderer.Painter.Layer",n}return Gu(i,[{key:"destroy",value:function(){this.dom=null,this.domBack=null,this.ctxBack=null,this.painter=null,this.unusedCount=null,this.config=null,this.dirty=null,this.elCount=null,this.clearColor=null,this.motionBlur=null,this.lastFrameAlpha=null,this.zoomable=null,this.panable=null,this.maxZoom=null,this.minZoom=null,this.ctx=null,gs.destroy.apply(this,arguments)}},{key:"initContext",value:function(){this.ctx=this.dom.getContext("2d"),1!=Wu.devicePixelRatio&&this.ctx.scale(Wu.devicePixelRatio,Wu.devicePixelRatio)}},{key:"createBackBuffer",value:function(){this.domBack=Wu.createDom(B.createUniqueID("SuperMap.Theme.back-"+this.id),"canvas",this.painter),this.ctxBack=this.domBack.getContext("2d"),1!=Wu.devicePixelRatio&&this.ctxBack.scale(Wu.devicePixelRatio,Wu.devicePixelRatio)}},{key:"resize",value:function(t,e){this.dom.style.width=t+"px",this.dom.style.height=e+"px",this.dom.setAttribute("width",t*Wu.devicePixelRatio),this.dom.setAttribute("height",e*Wu.devicePixelRatio),1!=Wu.devicePixelRatio&&this.ctx.scale(Wu.devicePixelRatio,Wu.devicePixelRatio),this.domBack&&(this.domBack.setAttribute("width",t*Wu.devicePixelRatio),this.domBack.setAttribute("height",e*Wu.devicePixelRatio),1!=Wu.devicePixelRatio&&this.ctxBack.scale(Wu.devicePixelRatio,Wu.devicePixelRatio))}},{key:"clear",value:function(){var t=this.dom,e=this.ctx,n=t.width,r=t.height,o=this.clearColor,i=this.motionBlur,a=this.lastFrameAlpha;i&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(t,0,0,n/Wu.devicePixelRatio,r/Wu.devicePixelRatio)),o?(e.save(),e.fillStyle=this.config.clearColor,e.fillRect(0,0,n/Wu.devicePixelRatio,r/Wu.devicePixelRatio),e.restore()):e.clearRect(0,0,n/Wu.devicePixelRatio,r/Wu.devicePixelRatio),i&&(i=this.domBack,e.save(),e.globalAlpha=a,e.drawImage(i,0,0,n/Wu.devicePixelRatio,r/Wu.devicePixelRatio),e.restore())}}]),i}();function zu(t,e){Uu(this,zu),this.root=t,this.storage=e,this._domRoot=null,this._layers={},this._zlevelList=[],this._layerConfig={},this._bgDom=null,this.shapeToImage=null,zu.devicePixelRatio=Math.max(window.devicePixelRatio||1,1),this.CLASS_NAME="SuperMap.LevelRenderer.Painter",this.root.innerHTML="",this._width=this._getWidth(),this._height=this._getHeight();t=document.createElement("div");(this._domRoot=t).style.position="relative",t.style.overflow="hidden",t.style.width=this._width+"px",t.style.height=this._height+"px",this.root.appendChild(t),this.shapeToImage=this._createShapeToImageProcessor(),this._bgDom=zu.createDom(B.createUniqueID("SuperMap.Theme_background_"),"div",this),t.appendChild(this._bgDom),this._bgDom.onselectstart=r,this._bgDom.style["-webkit-user-select"]="none",this._bgDom.style["user-select"]="none",this._bgDom.style["-webkit-touch-callout"]="none";e=new Vu(B.createUniqueID("_highLightLayer_"),this);this._layers.hover=e,t.appendChild(e.dom),e.initContext(),e.dom.onselectstart=r,e.dom.style["-webkit-user-select"]="none",e.dom.style["user-select"]="none",e.dom.style["-webkit-touch-callout"]="none";var n=this;function r(){return!1}this.updatePainter=function(t,e){n.refreshShapes(t,e)}}function Yu(t){return(Yu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xu(t,e){return(Xu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ju(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qu(t){return(Qu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ku=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xu(t,e)}(l,Ta);var n,r,s=(n=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Qu(n);return function(t,e){if(e&&("object"===Yu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ju(t)}(this,r?(t=Qu(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function l(t,e,n){var r,o,i;!function(t){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}(this),(r=s.call(this,t,e,n)).root=t,r.storage=e,r.painter=n,r._lastX=0,r._lastY=0,r._mouseX=0,r._mouseY=0,r._findHover=null,r._domHover=null,r._findHover=(o=function(t,e,n){var r=this;if(r._draggingTarget&&r._draggingTarget.id==t.id||t.isSilent())return!1;var o=r._event;if(t.isCover(e,n)){if(t.hoverable)if(t.isHoverByRefDataID&&!0===t.isHoverByRefDataID){if(t.refDataID){var i=t.refDataID,a=null;t.refDataHoverGroup&&(a=t.refDataHoverGroup);for(var s=r.storage._shapeList,l=0,u=s.length;l<u;l++){var c=s[l];c.refDataID&&i===c.refDataID&&(!a||c.refDataHoverGroup&&a===c.refDataHoverGroup)&&r.storage.addHover(c)}}}else r.storage.addHover(t);for(var f=t.parent;f;){if(f.clipShape&&!f.clipShape.isCover(r._mouseX,r._mouseY))return!1;f=f.parent}return r._lastHover!=t&&(r._processOutShape(o),r._processDragLeave(o),r._lastHover=t,r._processDragEnter(o)),r._processOverShape(o),r._processDragOver(o),r._hasfound=1,!0}return!1},i=Ju(r),function(t,e,n){return o.call(i,t,e,n)}),r._domHover=n.getDomHover(),r.CLASS_NAME="SuperMap.LevelRenderer.Handler";var a={resize:function(t){t=t||window.event,this._lastHover=null,this._isMouseDown=0,this.dispatch(rs.EVENT.RESIZE,t)},click:function(t){t=this._zrenderEventFixed(t);var e=this._lastHover;(e&&e.clickable||!e)&&this._clickThreshold<10&&this._dispatchAgency(e,rs.EVENT.CLICK,t),this._mousemoveHandler(t)},dblclick:function(t){t=t||window.event,t=this._zrenderEventFixed(t);var e=this._lastHover;(e&&e.clickable||!e)&&this._clickThreshold<5&&this._dispatchAgency(e,rs.EVENT.DBLCLICK,t),this._mousemoveHandler(t)},mousewheel:function(t){var e,n,r,o,i=0<((t=this._zrenderEventFixed(t)).wheelDelta||-t.detail)?1.1:1/1.1,a=this.painter.getLayers(),s=!1;for(e in a)"hover"!==e&&(r=(n=a[e]).position,n.zoomable&&(n.__zoom=n.__zoom||1,o=n.__zoom,o*=i,i=(o=Math.max(Math.min(n.maxZoom,o),n.minZoom))/n.__zoom,n.__zoom=o,r[0]-=(this._mouseX-r[0])*(i-1),r[1]-=(this._mouseY-r[1])*(i-1),n.scale[0]*=i,n.scale[1]*=i,s=n.dirty=!0));s&&this.painter.refresh(),this._dispatchAgency(this._lastHover,rs.EVENT.MOUSEWHEEL,t),this._mousemoveHandler(t)},mousemove:function(t){this._clickThreshold++,t=this._zrenderEventFixed(t),this._lastX=this._mouseX,this._lastY=this._mouseY,this._mouseX=ys.Util_event.getX(t),this._mouseY=ys.Util_event.getY(t);var e=this._mouseX-this._lastX,n=this._mouseY-this._lastY;this._processDragStart(t),this._hasfound=0,this._event=t,this._iterateAndFindHover(),this._hasfound||((!this._draggingTarget||this._lastHover&&this._lastHover!=this._draggingTarget)&&(this._processOutShape(t),this._processDragLeave(t)),this._lastHover=null,this.storage.delHover(),this.painter.clearHover());var r="";if(this._draggingTarget)this.storage.drift(this._draggingTarget.id,e,n),this._draggingTarget.modSelf(),this.storage.addHover(this._draggingTarget);else if(this._isMouseDown){var o,i,a=this.painter.getLayers(),s=!1;for(o in a)"hover"===o||(i=a[o]).panable&&(r="move",i.position[0]+=e,i.position[1]+=n,i.dirty=s=!0);s&&this.painter.refresh()}this._draggingTarget||this._hasfound&&this._lastHover.draggable?r="move":this._hasfound&&this._lastHover.clickable&&(r="pointer"),this.root.style.cursor=r,this._dispatchAgency(this._lastHover,rs.EVENT.MOUSEMOVE,t),(this._draggingTarget||this._hasfound||this.storage.hasHoverShape())&&this.painter.refreshHover()},mouseout:function(t){var e=(t=this._zrenderEventFixed(t)).toElement||t.relatedTarget;if(e!=this.root)for(;e&&9!=e.nodeType;){if(e==this.root)return void this._mousemoveHandler(t);e=e.parentNode}t.zrenderX=this._lastX,t.zrenderY=this._lastY,this.root.style.cursor="",this._isMouseDown=0,this._processOutShape(t),this._processDrop(t),this._processDragEnd(t),this.painter.refreshHover(),this.dispatch(rs.EVENT.GLOBALOUT,t)},mousedown:function(t){if(this._clickThreshold=0,2==this._lastDownButton)return this._lastDownButton=t.button,void(this._mouseDownTarget=null);this._lastMouseDownMoment=new Date,t=this._zrenderEventFixed(t),this._isMouseDown=1,this._mouseDownTarget=this._lastHover,this._dispatchAgency(this._lastHover,rs.EVENT.MOUSEDOWN,t),this._lastDownButton=t.button},mouseup:function(t){t=this._zrenderEventFixed(t),this.root.style.cursor="",this._isMouseDown=0,this._mouseDownTarget=null,this._dispatchAgency(this._lastHover,rs.EVENT.MOUSEUP,t),this._processDrop(t),this._processDragEnd(t)},touchstart:function(t){t=this._zrenderEventFixed(t,!0),this._lastTouchMoment=new Date,this._mobildFindFixed(t),this._mousedownHandler(t)},touchmove:function(t){t=this._zrenderEventFixed(t,!0),this._mousemoveHandler(t),this._isDragging&&ys.Util_event.stop(t)},touchend:function(t){t=this._zrenderEventFixed(t,!0),this._mouseupHandler(t);var e=new Date;e-this._lastTouchMoment<rs.EVENT.touchClickDelay&&(this._mobildFindFixed(t),this._clickHandler(t),e-this._lastClickMoment<rs.EVENT.touchClickDelay/2&&(this._dblclickHandler(t),this._lastHover&&this._lastHover.clickable&&ys.Util_event.stop(t)),this._lastClickMoment=e),this.painter.clearHover()}};return function(t){for(var e=["resize","click","dblclick","mousewheel","mousemove","mouseout","mouseup","mousedown","touchstart","touchend","touchmove"],n=e.length;n--;){var r=e[n];t["_"+r+"Handler"]=function(e,n){return function(t){return e.call(n,t)}}(a[r],t)}}(Ju(r)),window.addEventListener?(window.addEventListener("resize",r._resizeHandler),ys.Util_env.os.tablet||ys.Util_env.os.phone?(t.addEventListener("touchstart",r._touchstartHandler),t.addEventListener("touchmove",r._touchmoveHandler),t.addEventListener("touchend",r._touchendHandler)):(t.addEventListener("click",r._clickHandler),t.addEventListener("dblclick",r._dblclickHandler),t.addEventListener("mousewheel",r._mousewheelHandler),t.addEventListener("mousemove",r._mousemoveHandler),t.addEventListener("mousedown",r._mousedownHandler),t.addEventListener("mouseup",r._mouseupHandler)),t.addEventListener("DOMMouseScroll",r._mousewheelHandler),t.addEventListener("mouseout",r._mouseoutHandler)):(window.attachEvent("onresize",r._resizeHandler),t.attachEvent("onclick",r._clickHandler),t.ondblclick=r._dblclickHandler,t.attachEvent("onmousewheel",r._mousewheelHandler),t.attachEvent("onmousemove",r._mousemoveHandler),t.attachEvent("onmouseout",r._mouseoutHandler),t.attachEvent("onmousedown",r._mousedownHandler),t.attachEvent("onmouseup",r._mouseupHandler)),r}return qu(l.prototype,[{key:"destroy",value:function(){this.dispose(),this._lastX=null,this._lastY=null,this._mouseX=null,this._mouseY=null,this._findHover=null,Ta.prototype.destroy.apply(this,arguments)}},{key:"on",value:function(t,e){return this.bind(t,e),this}},{key:"un",value:function(t,e){return this.unbind(t,e),this}},{key:"trigger",value:function(t,e){var n=rs.EVENT;switch(t){case n.RESIZE:case n.CLICK:case n.DBLCLICK:case n.MOUSEWHEEL:case n.MOUSEMOVE:case n.MOUSEDOWN:case n.MOUSEUP:case n.MOUSEOUT:this["_"+t+"Handler"](e)}}},{key:"dispose",value:function(){var t=this.root;window.removeEventListener?(window.removeEventListener("resize",this._resizeHandler),ys.Util_env.os.tablet||ys.Util_env.os.phone?(t.removeEventListener("touchstart",this._touchstartHandler),t.removeEventListener("touchmove",this._touchmoveHandler),t.removeEventListener("touchend",this._touchendHandler)):(t.removeEventListener("click",this._clickHandler),t.removeEventListener("dblclick",this._dblclickHandler),t.removeEventListener("mousewheel",this._mousewheelHandler),t.removeEventListener("mousemove",this._mousemoveHandler),t.removeEventListener("mousedown",this._mousedownHandler),t.removeEventListener("mouseup",this._mouseupHandler)),t.removeEventListener("DOMMouseScroll",this._mousewheelHandler),t.removeEventListener("mouseout",this._mouseoutHandler)):(window.detachEvent("onresize",this._resizeHandler),t.detachEvent("onclick",this._clickHandler),t.detachEvent("dblclick",this._dblclickHandler),t.detachEvent("onmousewheel",this._mousewheelHandler),t.detachEvent("onmousemove",this._mousemoveHandler),t.detachEvent("onmouseout",this._mouseoutHandler),t.detachEvent("onmousedown",this._mousedownHandler),t.detachEvent("onmouseup",this._mouseupHandler)),this.root=null,this._domHover=null,this.storage=null,this.painter=null,this.un()}},{key:"_processDragStart",value:function(t){var e=this._lastHover;this._isMouseDown&&e&&e.draggable&&!this._draggingTarget&&this._mouseDownTarget==e&&(e.dragEnableTime&&new Date-this._lastMouseDownMoment<e.dragEnableTime||(this._draggingTarget=e=e,this._isDragging=1,e.invisible=!0,this.storage.mod(e.id),this._dispatchAgency(e,rs.EVENT.DRAGSTART,t),this.painter.refresh()))}},{key:"_processDragEnter",value:function(t){this._draggingTarget&&this._dispatchAgency(this._lastHover,rs.EVENT.DRAGENTER,t,this._draggingTarget)}},{key:"_processDragOver",value:function(t){this._draggingTarget&&this._dispatchAgency(this._lastHover,rs.EVENT.DRAGOVER,t,this._draggingTarget)}},{key:"_processDragLeave",value:function(t){this._draggingTarget&&this._dispatchAgency(this._lastHover,rs.EVENT.DRAGLEAVE,t,this._draggingTarget)}},{key:"_processDrop",value:function(t){this._draggingTarget&&(this._draggingTarget.invisible=!1,this.storage.mod(this._draggingTarget.id),this.painter.refresh(),this._dispatchAgency(this._lastHover,rs.EVENT.DROP,t,this._draggingTarget))}},{key:"_processDragEnd",value:function(t){this._draggingTarget&&(this._dispatchAgency(this._draggingTarget,rs.EVENT.DRAGEND,t),this._lastHover=null),this._isDragging=0,this._draggingTarget=null}},{key:"_processOverShape",value:function(t){this._dispatchAgency(this._lastHover,rs.EVENT.MOUSEOVER,t)}},{key:"_processOutShape",value:function(t){this._dispatchAgency(this._lastHover,rs.EVENT.MOUSEOUT,t)}},{key:"_dispatchAgency",value:function(t,e,n,r){var o="on"+e,i={type:e,event:n,target:t,cancelBubble:!1},a=t;for(r&&(i.dragged=r);a&&(a[o]&&(i.cancelBubble=a[o](i)),a.dispatch(e,i),a=a.parent,!i.cancelBubble););t?i.cancelBubble||this.dispatch(e,i):r||this.dispatch(e,{type:e,event:n})}},{key:"_iterateAndFindHover",value:function(){for(var t,e=ys.Util_matrix.create(),n=this.storage.getShapeList(),r=[0,0],o=n.length-1;0<=o;o--){var i=n[o];if(void 0!==i.zlevel&&(t=this.painter.getLayer(i.zlevel,t),r[0]=this._mouseX,r[1]=this._mouseY,t.needTransform&&(ys.Util_matrix.invert(e,t.transform),ys.Util_vector.applyTransform(r,r,e))),this._findHover(i,r[0],r[1]))break}}},{key:"_mobildFindFixed",value:function(t){var e=[{x:10},{x:-20},{x:10,y:10},{y:-20}];this._lastHover=null,this._mouseX=t.zrenderX,this._mouseY=t.zrenderY,this._event=t,this._iterateAndFindHover();for(var n=0;!this._lastHover&&n<e.length;n++){var r=e[n];r.x&&(this._mouseX+=r.x),r.y&&(this._mouseX+=r.y),this._iterateAndFindHover()}this._lastHover&&(t.zrenderX=this._mouseX,t.zrenderY=this._mouseY)}},{key:"_zrenderEventFixed",value:function(t,e){return t.zrenderFixed||(e?(e=("touchend"!=t.type?t.targetTouches:t.changedTouches)[0])&&(n=this.root.getBoundingClientRect(),t.zrenderX=e.clientX-n.left,t.zrenderY=e.clientY-n.top):(n=(t=t||window.event).toElement||t.relatedTarget||t.srcElement||t.target)&&n!=this._domHover&&(t.zrenderX=(void 0!==t.offsetX?t.offsetX:t.layerX)+n.offsetLeft,t.zrenderY=(void 0!==t.offsetY?t.offsetY:t.layerY)+n.offsetTop),t.zrenderFixed=1),t;var n}},{key:"getLastHoverOne",value:function(){return this._lastHover||null}}]),l}();function Zu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $u=(Zu(tc.prototype,[{key:"destroy",value:function(){}},{key:"Linear",value:function(t){return t}},{key:"QuadraticIn",value:function(t){return t*t}},{key:"QuadraticOut",value:function(t){return t*(2-t)}},{key:"QuadraticInOut",value:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},{key:"CubicIn",value:function(t){return t*t*t}},{key:"CubicOut",value:function(t){return--t*t*t+1}},{key:"CubicInOut",value:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},{key:"QuarticIn",value:function(t){return t*t*t*t}},{key:"QuarticOut",value:function(t){return 1- --t*t*t*t}},{key:"QuarticInOut",value:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},{key:"QuinticIn",value:function(t){return t*t*t*t*t}},{key:"QuinticOut",value:function(t){return--t*t*t*t*t+1}},{key:"QuinticInOut",value:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},{key:"SinusoidalIn",value:function(t){return 1-Math.cos(t*Math.PI/2)}},{key:"SinusoidalOut",value:function(t){return Math.sin(t*Math.PI/2)}},{key:"SinusoidalInOut",value:function(t){return.5*(1-Math.cos(Math.PI*t))}},{key:"ExponentialIn",value:function(t){return 0===t?0:Math.pow(1024,t-1)}},{key:"ExponentialOut",value:function(t){return 1===t?1:1-Math.pow(2,-10*t)}},{key:"ExponentialInOut",value:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},{key:"CircularIn",value:function(t){return 1-Math.sqrt(1-t*t)}},{key:"CircularOut",value:function(t){return Math.sqrt(1- --t*t)}},{key:"CircularInOut",value:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},{key:"ElasticIn",value:function(t){var e,n=.1;return 0===t?0:1===t?1:(e=n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*--t)*Math.sin((t-e)*(2*Math.PI)/.4))}},{key:"ElasticOut",value:function(t){var e,n=.1;return 0===t?0:1===t?1:(e=n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)}},{key:"ElasticInOut",value:function(t){var e,n=.1;return 0===t?0:1===t?1:(e=n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),(t*=2)<1?n*Math.pow(2,10*--t)*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:n*Math.pow(2,-10*--t)*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)}},{key:"BackIn",value:function(t){return t*t*(2.70158*t-1.70158)}},{key:"BackOut",value:function(t){return--t*t*(2.70158*t+1.70158)+1}},{key:"BackInOut",value:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)}},{key:"BounceIn",value:function(t){return 1-this.BounceOut(1-t)}},{key:"BounceOut",value:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},{key:"BounceInOut",value:function(t){return t<.5?.5*this.BounceIn(2*t):.5*this.BounceOut(2*t-1)+.5}}]),tc);function tc(){!function(t){if(!(t instanceof tc))throw new TypeError("Cannot call a class as a function")}(this),this.CLASS_NAME="SuperMap.LevelRenderer.Animation.easing"}function ec(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var nc=(ec(rc.prototype,[{key:"destroy",value:function(){}},{key:"step",value:function(t){var e=new $u;if(!((t=(t-this._startTime)/this._life)<0)){t=Math.min(t,1),e="string"==typeof this.easing?e[this.easing]:this.easing,e="function"==typeof e?e(t):t;return this.fire("frame",e),1==t?this.loop?(this.restart(),"restart"):(this._needsRemove=!0,"destroy"):null}}},{key:"restart",value:function(){var t=((new Date).getTime()-this._startTime)%this._life;this._startTime=(new Date).getTime()-t+this.gap}},{key:"fire",value:function(t,e){for(var n=0,r=this._targetPool.length;n<r;n++)this["on"+t]&&this["on"+t](this._targetPool[n],e)}}]),rc);function rc(t){!function(t){if(!(t instanceof rc))throw new TypeError("Cannot call a class as a function")}(this),this._targetPool=t.target||{},this._targetPool instanceof Array||(this._targetPool=[this._targetPool]),this._life=t.life||1e3,this._delay=t.delay||0,this._startTime=(new Date).getTime()+this._delay,this._endTime=this._startTime+1e3*this._life,this.loop=void 0!==t.loop&&t.loop,this.gap=t.gap||0,this.easing=t.easing||"Linear",this.onframe=t.onframe,this.ondestroy=t.ondestroy,this.onrestart=t.onrestart,this.CLASS_NAME="SuperMap.LevelRenderer.Animation.Clip"}function oc(t){return(oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ic(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ac(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sc(t,e,n){return e&&ac(t.prototype,e),n&&ac(t,n),t}function lc(t,e){return(lc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function uc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cc(t){return(cc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var fc=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lc(t,e)}(y,Ta);var n,r,o=(n=y,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=cc(n);return function(t,e){if(e&&("object"===oc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return uc(t)}(this,r?(t=cc(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function y(t){var e;return ic(this,y),e=o.call(this,t),t=t||{},e.stage={},e.onframe=function(){},e._clips=[],e._running=!1,e._time=0,B.extend(uc(e),t),e.CLASS_NAME="SuperMap.LevelRenderer.Animation",e}return sc(y,[{key:"add",value:function(t){this._clips.push(t)}},{key:"remove",value:function(t){t=(new Ia).indexOf(this._clips,t);0<=t&&this._clips.splice(t,1)}},{key:"_update",value:function(){for(var t=(new Date).getTime(),e=t-this._time,n=this._clips,r=n.length,o=[],i=[],a=0;a<r;a++){var s=n[a],l=s.step(t);l&&(o.push(l),i.push(s))}this.stage.update&&this.stage.update();for(var u=0;u<r;)n[u]._needsRemove?(n[u]=n[r-1],n.pop(),r--):u++;for(var r=o.length,c=0;c<r;c++)i[c].fire(o[c]);this._time=t,this.onframe(e),this.dispatch("frame",e)}},{key:"start",value:function(){var e=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){setTimeout(t,16)},n=this;this._running=!0,this._time=(new Date).getTime(),e(function t(){n._running&&(n._update(),e(t))})}},{key:"stop",value:function(){this._running=!1}},{key:"clear",value:function(){this._clips=[]}},{key:"animate",value:function(t,e){e=new hc(t,(e=e||{}).loop,e.getter,e.setter);return e.animation=this,e}}],[{key:"_interpolateNumber",value:function(t,e,n){return(e-t)*n+t}},{key:"_interpolateArray",value:function(t,e,n,r,o){var i=t.length;if(1==o)for(var a=0;a<i;a++)r[a]=y._interpolateNumber(t[a],e[a],n);else for(var s=t[0].length,l=0;l<i;l++)for(var u=0;u<s;u++)r[l][u]=y._interpolateNumber(t[l][u],e[l][u],n)}},{key:"_isArrayLike",value:function(t){switch(oc(t)){case"undefined":case"string":return!1}return void 0!==t.length}},{key:"_catmullRomInterpolateArray",value:function(t,e,n,r,o,i,a,s,l){var u=t.length;if(1==l)for(var c=0;c<u;c++)s[c]=y._catmullRomInterpolate(t[c],e[c],n[c],r[c],o,i,a);else for(var f=t[0].length,h=0;h<u;h++)for(var p=0;p<f;p++)s[h][p]=y._catmullRomInterpolate(t[h][p],e[h][p],n[h][p],r[h][p],o,i,a)}},{key:"_catmullRomInterpolate",value:function(t,e,n,r,o,i,a){t=.5*(n-t),r=.5*(r-e);return(2*(e-n)+t+r)*a+(-3*(e-n)-2*t-r)*i+t*o+e}},{key:"_cloneValue",value:function(t){var e=Array.prototype.slice;if(y._isArrayLike(t)){var n=t.length;if(y._isArrayLike(t[0])){for(var r=[],o=0;o<n;o++)r.push(e.call(t[o]));return r}return e.call(t)}return t}},{key:"rgba2String",value:function(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),"rgba("+t.join(",")+")"}}]),y}(),hc=(sc(pc,[{key:"when",value:function(t,e){for(var n in e)this._tracks[n]||(this._tracks[n]=[],0!==t&&this._tracks[n].push({time:0,value:fc._cloneValue(this._getter(this._target,n))})),this._tracks[n].push({time:parseInt(t,10),value:e[n]});return this}},{key:"during",value:function(t){return this._onframeList.push(t),this}},{key:"start",value:function(_){function w(){if(O._clipCount--,0===O._clipCount){O._tracks={};for(var t=O._doneList.length,e=0;e<t;e++)O._doneList[e].call(O)}}var t,O=this,E=this._setter,x=this._getter,P=O._onframeList.length,C="spline"===_;for(t in this._tracks)!function(t,o){var i=t.length;if(i){var e=t[0].value,a=fc._isArrayLike(e),s=!1,l=a&&fc._isArrayLike(e[0])?2:1;t.sort(function(t,e){return t.time-e.time});for(var n=t[i-1].time,u=[],c=[],r=0;r<i;r++){u.push(t[r].time/n);var f=t[r].value;"string"==typeof f&&(0===(f=ys.Util_color.toArray(f)).length&&(f[0]=f[1]=f[2]=0,f[3]=1),s=!0),c.push(f)}var h,p,y,d,v,g,m,b=0,S=0;s&&(m=[0,0,0,0]);e=new nc({target:O._target,life:n,loop:O._loop,delay:O._delay,onframe:function(t,e){if(e<S){for(g=Math.min(b+1,i-1),h=g;0<=h&&!(u[h]<=e);h--);h=Math.min(h,i-2)}else{for(h=b;h<i&&!(u[h]>e);h++);h=Math.min(h-1,i-2)}S=e;var n,r=u[(b=h)+1]-u[h];if(0!=r)for(p=(e-u[h])/r,C?(d=c[h],y=c[0===h?h:h-1],v=c[i-2<h?i-1:h+1],g=c[i-3<h?i-1:h+2],a?fc._catmullRomInterpolateArray(y,d,v,g,p,p*p,p*p*p,x(t,o),l):(n=s?fc.rgba2String(m):fc._catmullRomInterpolate(y,d,v,g,p,p*p,p*p*p),E(t,o,n))):a?fc._interpolateArray(c[h],c[h+1],p,x(t,o),l):(n=s?(fc._interpolateArray(c[h],c[h+1],p,m,1),fc.rgba2String(m)):fc._interpolateNumber(c[h],c[h+1],p),E(t,o,n)),h=0;h<P;h++)O._onframeList[h](t,e)},ondestroy:w});_&&"spline"!==_&&(e.easing=_),O._clipList.push(e),O._clipCount++,O.animation.add(e)}}(this._tracks[t],t);return this}},{key:"stop",value:function(){for(var t=0;t<this._clipList.length;t++){var e=this._clipList[t];this.animation.remove(e)}this._clipList=[]}},{key:"delay",value:function(t){return this._delay=t,this}},{key:"done",value:function(t){return t&&this._doneList.push(t),this}}]),pc);function pc(t,e,n,r){ic(this,pc),this._tracks={},this._target=t,this._loop=e||!1,this._getter=n||function(t,e){return t[e]},this._setter=r||function(t,e,n){t[e]=n},this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[],this.CLASS_NAME="SuperMap.LevelRenderer.Animation.Animator"}function yc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var dc=(cs=[{key:"getFrameCallback",value:function(r){return function(){var t=r.animatingElements;if(t instanceof Array){for(var e=0,n=t.length;e<n;e++)r.storage.mod(t[e].id);(t.length||r._needsRefreshNextFrame)&&r.refresh()}}}}],yc((ss=vc).prototype,[{key:"destroy",value:function(){this.id=null,this.storage=null,this.painter=null,this.handler=null,this.animatingElements=null,this.animation=null,this._needsRefreshNextFrame=null}},{key:"getId",value:function(){return this.id}},{key:"addShape",value:function(t){return this.storage.addRoot(t),this}},{key:"addGroup",value:function(t){return this.storage.addRoot(t),this}},{key:"delShape",value:function(t){return this.storage.delRoot(t),this}},{key:"delGroup",value:function(t){return this.storage.delRoot(t),this}},{key:"modShape",value:function(t,e){return this.storage.mod(t,e),this}},{key:"modGroup",value:function(t,e){return this.storage.mod(t,e),this}},{key:"modLayer",value:function(t,e){return this.painter.modLayer(t,e),this}},{key:"addHoverShape",value:function(t){return this.storage.addHover(t),this}},{key:"render",value:function(t){return this.painter.render(t),this._needsRefreshNextFrame=!1,this}},{key:"refresh",value:function(t){return this.painter.refresh(t),this._needsRefreshNextFrame=!1,this}},{key:"refreshNextFrame",value:function(){return this._needsRefreshNextFrame=!0,this}},{key:"refreshHover",value:function(t){return this.painter.refreshHover(t),this}},{key:"refreshShapes",value:function(t,e){return this.painter.refreshShapes(t,e),this}},{key:"resize",value:function(){return this.painter.resize(),this}},{key:"animate",value:function(e,t,n){if(e="string"==typeof e?this.storage.get(e):e){var r;if(t){for(var o=t.split("."),i=e,a=0,s=o.length;a<s;a++)i=i&&i[o[a]];i&&(r=i)}else r=e;if(!r)return void ys.Util_log('Property "'+t+'" is not existed in element '+e.id);var l=this.animatingElements;return void 0===e.__aniCount&&(e.__aniCount=0),0===e.__aniCount&&l.push(e),e.__aniCount++,this.animation.animate(r,{loop:n}).done(function(){var t;e.__aniCount--,0===e.__aniCount&&(t=(new Ia).indexOf(l,e),l.splice(t,1))})}ys.Util_log("Element not existed")}},{key:"clearAnimation",value:function(){this.animation.clear()}},{key:"getWidth",value:function(){return this.painter.getWidth()}},{key:"getHeight",value:function(){return this.painter.getHeight()}},{key:"toDataURL",value:function(t,e,n){return this.painter.toDataURL(t,e,n)}},{key:"shapeToImage",value:function(t,e,n){var r=B.createUniqueID("SuperMap.LevelRenderer.ToImage_");return this.painter.shapeToImage(r,t,e,n)}},{key:"on",value:function(t,e){return this.handler.on(t,e),this}},{key:"un",value:function(t,e){return this.handler.un(t,e),this}},{key:"trigger",value:function(t,e){return this.handler.trigger(t,e),this.handler.dispatch(t,e),this}},{key:"clear",value:function(){return this.storage.delRoot(),this.painter.clear(),this}},{key:"dispose",value:function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=null,this.animatingElements=null,this.storage=null,this.painter=null,this.handler=null}},{key:"updateHoverShapes",value:function(t){return this.painter.updateHoverLayer(t),this}},{key:"getAllShapes",value:function(){return this.storage._shapeList}},{key:"clearAll",value:function(){return this.clear(),this.painter.clearHover(),this}},{key:"getHoverOne",value:function(){return this.handler.getLastHoverOne()}}]),yc(ss,cs),vc);function vc(t,e){!function(t){if(!(t instanceof vc))throw new TypeError("Cannot call a class as a function")}(this),this.id=t,this.storage=new ju,this.painter=new Wu(e,this.storage),this.handler=new Ku(e,this.storage,this.painter),this.animatingElements=[],this.animation=new fc({stage:{update:vc.getFrameCallback(this)}}),this._needsRefreshNextFrame=!1,this.animation.start(),this.CLASS_NAME="SuperMap.LevelRenderer.Render"}function gc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var mc=(gc(bc.prototype,[{key:"destroy",value:function(){this.dispose(),this.version=null}},{key:"init",value:function(t){t=new dc(B.createUniqueID("LRenderer_"),t);return bc._instances[t.id]=t}},{key:"dispose",value:function(t){if(t)t.dispose(),this.delInstance(t.id);else{for(var e in bc._instances)bc._instances[e].dispose();bc._instances={}}return this}},{key:"getInstance",value:function(t){return bc._instances[t]}},{key:"delInstance",value:function(t){return delete bc._instances[t],this}}]),bc);function bc(){!function(t){if(!(t instanceof bc))throw new TypeError("Cannot call a class as a function")}(this),bc._instances={},bc.Tool={},this.version="2.0.4",this.CLASS_NAME="SuperMap.LevelRenderer"}function Sc(t){return(Sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wc(t,e){return(wc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Oc(t){return(Oc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}c.LevelRenderer=mc;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),wc(t,e)}(o,V);var n,r,e=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Oc(n);return function(t,e){if(e&&("object"===Sc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Oc(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function o(t){return function(t){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this),(t=e.call(this,t)).regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},t.CLASS_NAME="SuperMap.Format.WKT",t.extract={point:function(t){return t.x+" "+t.y},multipoint:function(t){for(var e=[],n=0,r=t.components.length;n<r;++n)e.push("("+this.extract.point.apply(this,[t.components[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,r=t.components.length;n<r;++n)e.push(this.extract.point.apply(this,[t.components[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,r=t.components.length;n<r;++n)e.push("("+this.extract.linestring.apply(this,[t.components[n]])+")");return e.join(",")},polygon:function(t){for(var e=[],n=0,r=t.components.length;n<r;++n)e.push("("+this.extract.linestring.apply(this,[t.components[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,r=t.components.length;n<r;++n)e.push("("+this.extract.polygon.apply(this,[t.components[n]])+")");return e.join(",")},collection:function(t){for(var e=[],n=0,r=t.components.length;n<r;++n)e.push(this.extractGeometry.apply(this,[t.components[n]]));return e.join(",")}},t.parse={point:function(t){t=a.trim(t).split(this.regExes.spaces);return new Wt(new pe(t[0],t[1]))},multipoint:function(t){for(var e,n=a.trim(t).split(","),r=[],o=0,i=n.length;o<i;++o)e=n[o].replace(this.regExes.trimParens,"$1"),r.push(this.parse.point.apply(this,[e]).geometry);return new Wt(new me(r))},linestring:function(t){for(var e=a.trim(t).split(","),n=[],r=0,o=e.length;r<o;++r)n.push(this.parse.point.apply(this,[e[r]]).geometry);return new Wt(new ke(n))},multilinestring:function(t){for(var e,n=a.trim(t).split(this.regExes.parenComma),r=[],o=0,i=n.length;o<i;++o)e=n[o].replace(this.regExes.trimParens,"$1"),r.push(this.parse.linestring.apply(this,[e]).geometry);return new Wt(new Le(r))},polygon:function(t){for(var e,n=a.trim(t).split(this.regExes.parenComma),r=[],o=0,i=n.length;o<i;++o)e=n[o].replace(this.regExes.trimParens,"$1"),e=this.parse.linestring.apply(this,[e]).geometry,e=new De(e.components),r.push(e);return new Wt(new We(r))},multipolygon:function(t){for(var e,n=a.trim(t).split(this.regExes.doubleParenComma),r=[],o=0,i=n.length;o<i;++o)e=n[o].replace(this.regExes.trimParens,"$1"),r.push(this.parse.polygon.apply(this,[e]).geometry);return new Wt(new qe(r))},geometrycollection:function(t){t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var e=a.trim(t).split("|"),n=[],r=0,o=e.length;r<o;++r)n.push(this.read(e[r]));return n}},t}return _c(o.prototype,[{key:"read",value:function(t){var e;t=t.replace(/[\n\r]/g," ");var n=this.regExes.typeStr.exec(t);return n&&(t=n[1].toLowerCase(),n=n[2],this.parse[t]&&(e=this.parse[t].apply(this,[n]))),e}},{key:"write",value:function(t){var e,n,r=t.constructor===Array?(e=t,!0):!(e=[t]),o=[];r&&o.push("GEOMETRYCOLLECTION(");for(var i=0,a=e.length;i<a;++i)r&&0<i&&o.push(","),n=e[i].geometry,o.push(this.extractGeometry(n));return r&&o.push(")"),o.join("")}},{key:"extractGeometry",value:function(t){var e=t.CLASS_NAME.split(".")[2].toLowerCase();return this.extract[e]?("collection"===e?"GEOMETRYCOLLECTION":e.toUpperCase())+"("+this.extract[e].apply(this,[t])+")":null}}]),o}();function Ec(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.Format.WKT=ss;var xc=new za,cs=(cs=Pc,ss=[{key:"createCanvas",value:function(t,e){var n=document.createElement("canvas");return n.height=t,n.width=e,n.getContext("2d")}},{key:"getLinearGradient",value:function(t,e,n,r,o){this._ctx||(this._ctx=this.getContext());for(var i=this._ctx.createLinearGradient(t,e,n,r),a=o.length,s=1/(a-1),l=0,u=0;u<a;u++)i.addColorStop(l,o[u]),l+=s;return i.__nonRecursion=!0,i}},{key:"getContext",value:function(){return this._ctx||(this._ctx=document.createElement("canvas").getContext("2d")),this._ctx}},{key:"getStepColors",value:function(t,e,n){t=xc.toRGBA(t),e=xc.toRGBA(e),t=xc.getData(t);for(var r=[],o=((e=xc.getData(e))[0]-t[0])/n,i=(e[1]-t[1])/n,a=(e[2]-t[2])/n,s=(e[3]-t[3])/n,l=0,u=t[0],c=t[1],f=t[2],h=t[3];l<n;l++)r[l]=xc.toColor([xc.adjust(Math.floor(u),[0,255]),xc.adjust(Math.floor(c),[0,255]),xc.adjust(Math.floor(f),[0,255]),+h.toFixed(4)],"hex"),u+=o,c+=i,f+=a,h+=s;return u=e[0],c=e[1],f=e[2],h=e[3],r[l]=xc.toColor([u,c,f,h],"hex"),r}},{key:"getGradientColors",value:function(t,e,n){var r,o,i,a=[],s=t.length;if(void 0!==e){if(e<=s)if("RANGE"===n)for(o=0;o<e;o++)a.push(t[o]);else for(o=0;o<e;o++){var l=Math.floor(o/2);o%2==0?a.push(t[l]):(l=t.length-1-l,a.push(t[l]))}else{for(r=Math.ceil(e/(s-1)),o=0,i=s-1;o<i;o++){var u=this.getStepColors(t[o],t[o+1],r);o<i-1&&u.pop(),a=a.concat(u)}for(var c=a.length-e,f=0;f<c;f++)a.splice(2,1)}return a}}}],null&&Ec(cs.prototype,null),Ec(cs,ss),Pc);function Pc(){!function(t){if(!(t instanceof Pc))throw new TypeError("Cannot call a class as a function")}(this)}function Cc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}c.ColorsPickerUtil=cs;ss=kc,cs=[{key:"newInstance",value:function(){return this.geostatsInstance||(this.geostatsInstance=new window.geostats),this.geostatsInstance}},{key:"getInstance",value:function(t){var e=this.newInstance();return e.setSerie(t),e}},{key:"getArrayStatistic",value:function(t,e){return t.length?"Sum"===e||"求和"===e?this.getSum(t):"Maximum"===e||"最大值"===e?this.getMax(t):"Minimum"===e||"最小值"===e?this.getMin(t):"Average"===e||"平均值"===e?this.getMean(t):"Median"===e||"中位数"===e?this.getMedian(t):"times"===e||"计数"===e?this.getTimes(t):void 0:0}},{key:"getArraySegments",value:function(t,e,n){return"offset"===e?this.getEqInterval(t,n):"jenks"===e?this.getJenks(t,n):"square"===e?0<=this.getMin(t)&&this.getSqrtInterval(t,n):"logarithm"===e?0<this.getMin(t)&&this.getGeometricProgression(t,n):void 0}},{key:"getSum",value:function(t){return this.getInstance(t).sum()}},{key:"getMax",value:function(t){return this.getInstance(t).max()}},{key:"getMin",value:function(t){return this.getInstance(t).min()}},{key:"getMean",value:function(t){return this.getInstance(t).mean()}},{key:"getMedian",value:function(t){return this.getInstance(t).median()}},{key:"getTimes",value:function(t){return t.length}},{key:"getEqInterval",value:function(t,e){return this.getInstance(t).getClassEqInterval(e)}},{key:"getJenks",value:function(t,e){return this.getInstance(t).getClassJenks(e)}},{key:"getSqrtInterval",value:function(t,e){return t=t.map(function(t){return Math.sqrt(t)}),this.getInstance(t).getClassEqInterval(e).map(function(t){return t*t})}},{key:"getGeometricProgression",value:function(t,e){return this.getInstance(t).getClassGeometricProgression(e)}}],null&&Cc(ss.prototype,null),Cc(ss,cs),ss=kc;function kc(){!function(t){if(!(t instanceof kc))throw new TypeError("Cannot call a class as a function")}(this)}c.ArrayStatistic=ss,c.ThemeStyle=function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),t=t||{},this.fill=!0,this.fillColor="#000000",this.fillOpacity=1,this.stroke=!1,this.strokeColor="#000000",this.strokeOpacity=1,this.strokeWidth=1,this.strokeLinecap="butt",this.strokeLineJoin="miter",this.strokeDashstyle="solid",this.pointRadius=6,this.shadowBlur=0,this.shadowColor="#000000",this.shadowOffsetX=0,this.shadowOffsetY=0,this.label="",this.labelRect=!1,this.fontColor="",this.fontSize=12,this.fontStyle="normal",this.fontVariant="normal",this.fontWeight="normal",this.fontFamily="arial,sans-serif",this.labelPosition="top",this.labelAlign="center",this.labelBaseline="middle",this.labelXOffset=0,this.labelYOffset=0,B.extend(this,t)};var cs=mapboxgl,Tc=Th.n(cs);function Rc(t){return(Rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ac(t,e){return(Ac=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Lc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ic(t){return(Ic=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().Map.prototype.overlayLayersManager={},void 0===Tc().Map.prototype.addLayerBak&&(Tc().Map.prototype.addLayerBak=Tc().Map.prototype.addLayer,Tc().Map.prototype.addLayer=function(t,e){return t.source||"custom"===t.type||"background"===t.type?(this.addLayerBak(t,e),this):this.overlayLayersManager[t.id]||this.style._layers[t.id]?void this.fire("error",{error:new Error("A layer with this id already exists.")}):(n=this,(e=t).onAdd&&e.onAdd(n),this.overlayLayersManager[t.id]=t,this);var n}),Tc().Map.prototype.getLayer=function(t){return this.overlayLayersManager[t]||this.style.getLayer(t)},Tc().Map.prototype.moveLayer=function(t,e){return this.overlayLayersManager[t]?(n=e,o=document.getElementById(t),n&&((r=document.getElementById(n))||Tc().Evented.prototype.fire("error",{error:new Error('Layer with id "'.concat(n,'" does not exist on this document.'))})),o&&r?r.parentNode.insertBefore(o,r):o.parentNode.appendChild(o),this):this.style._layers[t]?(this.style.moveLayer(t,e),this._update(!0),this):void 0;var n,r,o},Tc().Map.prototype.removeLayer=function(t){return this.overlayLayersManager[t]?((e=this.overlayLayersManager[t]).removeFromMap&&e.removeFromMap(),delete this.overlayLayersManager[t]):(this.style.removeLayer(t),this._update(!0)),this;var e},Tc().Map.prototype.setLayoutProperty=function(t,e,n){return this.overlayLayersManager[t]?"visibility"===e&&(o=n="visible"===n,(r=this.overlayLayersManager[t]).setVisibility&&r.setVisibility(o),this.style.fire("data",{dataType:"style"})):(this.style.setLayoutProperty(t,e,n),this._update(!0)),this;var r,o},Tc().Map.prototype.updateTransform=function(t,n,r,e,o,i,a){this.transform.units=t;var s=this.mercatorZfromAltitude;Tc().MercatorCoordinate.fromLngLat=function(t,e){e=e||0;t=Tc().LngLat.convert(t);return new(Tc().MercatorCoordinate)((t.lng-n)/i,(r-t.lat)/a,s(e,t.lat))},Tc().MercatorCoordinate.prototype.toLngLat=function(){return new(Tc().LngLat)(this.x*i+n,r-this.y*a)},this.customConvertPoint=window.URL.createObjectURL(new Blob(["customConvertPoint = {projectX:function(x){return (x - "+e+") / "+i+" + 0.5},projectY:function(y){y = 0.5 - ((y - "+o+") / "+a+");return y < 0 ? 0 : y > 1 ? 1 : y;},toY:function(y){return (0.5-y)*"+a+"+"+o+";}}"],{type:"text/javascript"}))},Tc().supermap=Tc().supermap||{};var Nc=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ac(t,e)}(i,Tc().Evented);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Ic(n);return function(t,e){if(e&&("object"===Rc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Lc(t)}(this,r?(t=Ic(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){var n;return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(n=o.call(this)).options=e||{},n.url=t,n.fire("initialized",Lc(n)),n}return i}();function jc(t){return(jc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bc(t,e){return(Bc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dc(t){return(Dc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.ServiceBase=Nc;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bc(t,e)}(i,Nc);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Dc(n);return function(t,e){if(e&&("object"===jc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Dc(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),o.call(this,t,e)}return Mc(i.prototype,[{key:"getMapInfo",value:function(t){new at(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{scope:this,processCompleted:t,processFailed:t},projection:this.options.projection}).processAsync()}},{key:"getTilesets",value:function(t){new ht(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{scope:this,processCompleted:t,processFailed:t}}).processAsync()}}]),i}();function Fc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Tc().supermap.MapService=ss;var Uc=(cs=Hc,ss=[{key:"toSuperMapGeometry",value:function(t){if(t&&t.type)return(new _n).read(t,"FeatureCollection")[0].geometry}},{key:"toSuperMapBounds",value:function(t){return this.isArray(t)?new Kt(t[0],t[1],t[2],t[3]):new Kt(t.getWest(),t.getSouth(),t.getEast(),t.getNorth())}},{key:"toSuperMapPoint",value:function(t){return this.isArray(t)?new pe(t[0],t[1]):t.lng&&t.lat?new pe(t.lng,t.lat):new pe(t.geometry.coordinates[0],t.geometry.coordinates[1])}},{key:"toSuperMapPolygon",value:function(t){var e=t.getWest(),n=t.getEast(),r=t.getSouth(),t=t.getNorth();return new We([new De([new pe(e,r),new pe(n,r),new pe(n,t),new pe(e,t)])])}},{key:"isArray",value:function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{key:"toGeoJSON",value:function(t){if(t)return(new _n).toGeoJSON(t)}},{key:"toProcessingParam",value:function(t){var e={};if(t.length<1)e="";else{for(var n=[],r=0;r<t.length;r++){var o={};o.x=t[r][0],o.y=t[r][1],n.push(o)}e.type="REGION",e.points=n}return e}},{key:"extend",value:function(t){for(var e=0;e<Object.getOwnPropertyNames(arguments).length;e++){var n=Object.getOwnPropertyNames(arguments)[e];if("caller"!=n&&"callee"!=n&&"length"!=n&&"arguments"!=n){var r=arguments[n];if(r)for(var o=0;o<Object.getOwnPropertyNames(r).length;o++){var i=Object.getOwnPropertyNames(r)[o];"caller"!=n&&"callee"!=n&&"length"!=n&&"arguments"!=n&&(t[i]=r[i])}}}return t}},{key:"isNumber",value:function(t){if(""===t)return!1;t=Number(t);return 0===t||!isNaN(t)}},{key:"isString",value:function(t){return"string"==typeof t&&t.constructor===String}},{key:"newGuid",value:function(t){for(var e=t||32,n="",r=1;r<e;r++)n+=Math.floor(16*Math.random()).toString(16);return n}},{key:"hexToRgba",value:function(t,e){var n=[],r=[];if(3==(t=t.replace(/#/,"")).length){for(var o=[],i=0;i<3;i++)o.push(t.charAt(i)+t.charAt(i));t=o.join("")}for(var a=0;a<6;a+=2)n[a]="0x"+t.substr(a,2),r.push(parseInt(Number(n[a])));return r.push(e),"rgba("+r.join(",")+")"}},{key:"isMatchAdministrativeName",value:function(t,e){if(this.isString(e)){var n=t.substr(0,2);return"张家"===n&&(n=t.substr(0,3)),!!e.match(new RegExp(n))}return!1}}],null&&Fc(cs.prototype,null),Fc(cs,ss),Hc);function Hc(){!function(t){if(!(t instanceof Hc))throw new TypeError("Cannot call a class as a function")}(this)}function Gc(t){return(Gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vc(t,e){return(Vc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function zc(t){return(zc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.Util=Uc;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vc(t,e)}(i,Nc);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=zc(n);return function(t,e){if(e&&("object"===Gc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=zc(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),o.call(this,t,e)}return Wc(i.prototype,[{key:"getFeaturesByIDs",value:function(t,e,n){new To(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{processCompleted:e,processFailed:e},format:this._processFormat(n)}).processAsync(this._processParams(t))}},{key:"getFeaturesByBounds",value:function(t,e,n){new Wr(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{processCompleted:e,processFailed:e},format:this._processFormat(n)}).processAsync(this._processParams(t))}},{key:"getFeaturesByBuffer",value:function(t,e,n){new no(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{processCompleted:e,processFailed:e},format:this._processFormat(n)}).processAsync(this._processParams(t))}},{key:"getFeaturesBySQL",value:function(t,e,n){new Go(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{processCompleted:e,processFailed:e},format:this._processFormat(n)}).processAsync(this._processParams(t))}},{key:"getFeaturesByGeometry",value:function(t,e,n){new vo(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{processCompleted:e,processFailed:e},format:this._processFormat(n)}).processAsync(this._processParams(t))}},{key:"editFeatures",value:function(t,e){var n,r,o;t&&t.dataSourceName&&t.dataSetName&&(o=this.url,n=t.dataSourceName,r=t.dataSetName,o=B.urlPathAppend(o,"datasources/"+n+"/datasets/"+r),new Zo(o,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{processCompleted:e,processFailed:e}}).processAsync(this._processParams(t)))}},{key:"_processParams",value:function(t){if(!t)return{};var e,n=this;return t.returnContent=null==t.returnContent||t.returnContent,t.fromIndex=t.fromIndex||0,t.toIndex=0===t.toIndex?0:t.toIndex||-1,t.bounds&&(t.bounds=Uc.toSuperMapBounds(t.bounds)),t.editType&&(t.editType=t.editType.toLowerCase()),t.geometry&&(t.geometry instanceof Tc().LngLatBounds?(t.geometry=Uc.toSuperMapPolygon(t.geometry),t.geometry.SRID=4326):t.geometry instanceof Tc().Point?t.geometry=new pe(t.geometry.x,t.geometry.y):t.geometry instanceof Tc().LngLat?(t.geometry=new pe(t.geometry.lng,t.geometry.lat),t.geometry.SRID=4326):t.geometry instanceof te||(t.geometry=Uc.toSuperMapGeometry(t.geometry))),t.features&&(e=[],Uc.isArray(t.features)?t.features.map(function(t){return e.push(n._createServerFeature(t)),e}):e.push(n._createServerFeature(t.features)),t.features=e),t}},{key:"_createServerFeature",value:function(t){var e,n={},r=[],o=[],i=t.properties;for(e in i)r.push(e),o.push(i[e]);return n.fieldNames=r,n.fieldValues=o,t.id&&(n.id=t.id),n.geometry=Uc.toSuperMapGeometry(t),n}},{key:"_processFormat",value:function(t){return t||s.GEOJSON}}]),i}();function Yc(t){return(Yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xc(t,e){return(Xc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Jc(t){return(Jc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.FeatureService=ss;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xc(t,e)}(i,Nc);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Jc(n);return function(t,e){if(e&&("object"===Yc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=Jc(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),o.call(this,t,e)}return qc(i.prototype,[{key:"queryByBounds",value:function(t,e,n){new jn(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{scope:this,processCompleted:e,processFailed:e},format:this._processFormat(n)}).processAsync(this._processParams(t))}},{key:"queryByDistance",value:function(t,e,n){new Xn(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{scope:this,processCompleted:e,processFailed:e},format:this._processFormat(n)}).processAsync(this._processParams(t))}},{key:"queryBySQL",value:function(t,e,n){new Sr(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{scope:this,processCompleted:e,processFailed:e},format:this._processFormat(n)}).processAsync(this._processParams(t))}},{key:"queryByGeometry",value:function(t,e,n){new sr(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{scope:this,processCompleted:e,processFailed:e},format:this._processFormat(n)}).processAsync(this._processParams(t))}},{key:"_processParams",value:function(t){return t?(t.returnContent=null==t.returnContent||t.returnContent,t.queryParams&&!Uc.isArray(t.queryParams)&&(t.queryParams=[t.queryParams]),t.bounds&&(t.bounds instanceof Array&&(t.bounds=new Kt(t.bounds[0],t.bounds[1],t.bounds[2],t.bounds[3])),t.bounds instanceof Tc().LngLatBounds&&(t.bounds=new Kt(t.bounds.getSouthWest().lng,t.bounds.getSouthWest().lat,t.bounds.getNorthEast().lng,t.bounds.getNorthEast().lat))),t.geometry&&(t.geometry instanceof Tc().LngLat&&(t.geometry=new pe(t.geometry.lng,t.geometry.lat)),t.geometry instanceof Tc().Point&&(t.geometry=new pe(t.geometry.x,t.geometry.y)),t.geometry instanceof Tc().LngLatBounds&&(t.geometry=Uc.toSuperMapPolygon(t.geometry)),t.geometry instanceof te||(t.geometry=Uc.toSuperMapGeometry(t.geometry))),t):{}}},{key:"_processFormat",value:function(t){return t||s.GEOJSON}}]),i}();function Qc(t){return(Qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zc(t,e){return(Zc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $c(t){return($c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.QueryService=ss;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zc(t,e)}(i,Nc);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=$c(n);return function(t,e){if(e&&("object"===Qc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=$c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),o.call(this,t,e)}return Kc(i.prototype,[{key:"code",value:function(t,e){new vi(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{scope:this,processCompleted:e,processFailed:e}}).code(B.urlPathAppend(this.url,"geocoding"),t)}},{key:"decode",value:function(t,e){new vi(this.url,{proxy:this.options.proxy,withCredentials:this.options.withCredentials,crossOrigin:this.options.crossOrigin,headers:this.options.headers,eventListeners:{scope:this,processCompleted:e,processFailed:e}}).decode(B.urlPathAppend(this.url,"geodecoding"),t)}}]),i}();function tf(t){return(tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ef(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nf(t,e){return(nf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function of(t){return(of=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.AddressMatchService=ss;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nf(t,e)}(i,Nc);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=of(n);return function(t,e){if(e&&("object"===tf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rf(t)}(this,r?(t=of(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){var n;!function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(e=e||{}).projection&&(e.prjCoordSys=e.projection),(n=o.call(this,t,e)).dataFlow=new oi(t,e),n.dataFlow.events.on({broadcastSocketConnected:n._defaultEvent,broadcastSocketError:n._defaultEvent,broadcastFailed:n._defaultEvent,broadcastSucceeded:n._defaultEvent,subscribeSocketConnected:n._defaultEvent,subscribeSocketError:n._defaultEvent,messageSucceeded:n._defaultEvent,setFilterParamSucceeded:n._defaultEvent,scope:rf(n)});var r=rf(n);return r.on("subscribeSocketConnected",function(t){r.fire("subscribesucceeded",t)}),n}return ef(i.prototype,[{key:"initBroadcast",value:function(){return this.dataFlow.initBroadcast(),this}},{key:"broadcast",value:function(t){this.dataFlow.broadcast(t)}},{key:"initSubscribe",value:function(){return this.dataFlow.initSubscribe(),this}},{key:"setExcludeField",value:function(t){return this.dataFlow.setExcludeField(t),this.options.excludeField=t,this}},{key:"setGeometry",value:function(t){return this.dataFlow.setGeometry(t),this.options.geometry=t,this}},{key:"unSubscribe",value:function(){this.dataFlow.unSubscribe()}},{key:"unBroadcast",value:function(){this.dataFlow.unBroadcast()}},{key:"_defaultEvent",value:function(t){this.fire(t.eventType||t.type,t)}}]),i}();function af(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Tc().supermap.DataFlowService=ss;var sf=(af(lf.prototype,[{key:"toFeature",value:function(){var t=Uc.toSuperMapGeometry(this.geometry),e=[];return this.geometry instanceof Tc().LngLat?e=[this.geometry.lng,this.geometry.lat]:this.geometry instanceof Tc().Point?e=[this.geometry.x,this.geometry.y]:3===this.geometry.length&&(t=new xi(this.geometry[0],this.geometry[1],this.geometry[2])),1<e.length&&(t=new pe(e[0],e[1])),new Wt(t,this.attributes)}}]),lf);function lf(t,e){!function(t){if(!(t instanceof lf))throw new TypeError("Cannot call a class as a function")}(this),this.geometry=t,this.attributes=e}function uf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Tc().supermap.ThemeFeature=sf;var cf=(uf(ff.prototype,[{key:"onAdd",value:function(t){this.map=t,this._createCanvasContainer(),this.addTFEvents(),this.map.on("resize",this.resizeEvent.bind(this)),this.map.on("zoomstart",this.zoomStartEvent.bind(this)),this.map.on("zoomend",this.zoomEndEvent.bind(this)),this.map.on("rotatestart",this.rotateStartEvent.bind(this)),this.map.on("rotate",this.rotateEvent.bind(this)),this.map.on("rotateend",this.rotateEndEvent.bind(this)),this.map.on("dragend",this.dragEndEvent.bind(this)),this.map.on("movestart",this.moveStartEvent.bind(this)),this.map.on("move",this.moveEvent.bind(this)),this.map.on("moveend",this.moveEndEvent.bind(this)),this.map.on("remove",this.removeFromMap.bind(this)),this.refresh()}},{key:"refresh",value:function(){0!==this.features.length&&this.map&&this.redrawThematicFeatures(this.map.getBounds())}},{key:"_createCanvasContainer",value:function(){this.movingOffset=[0,0],this.mapContainer=this.map.getCanvasContainer(),this.div=document.createElement("div"),this.div.id=this.id,this.div.style.position="absolute";var t=this.map.getCanvasContainer(),e=this.map.getCanvas();this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px",this.div.style.width=e.style.width,this.div.style.height=e.style.height,this.div.className="themeLayer",this.div.width=parseInt(e.width),this.div.height=parseInt(e.height),t.appendChild(this.div),this.setOpacity(this.opacity),this.levelRenderer=new mc,this.renderer=this.levelRenderer.init(this.div),this.renderer.clear()}},{key:"destroyFeatures",value:function(t){if(t=null==t?this.features:t){this.removeFeatures(t);for(var e=t.length-1;0<=e;e--)t[e].destroy()}}},{key:"setVisibility",value:function(t){t!==this.visibility&&(this.visibility=t,this.display(t),this.redrawThematicFeatures(this.map.getBounds()))}},{key:"display",value:function(t){this.div.style.display=t?"block":"none"}},{key:"setOpacity",value:function(t){var e;t!==this.opacity&&(this.opacity=t,e=this.div,B.modifyDOMElement(e,null,null,null,null,null,null,t),null!==this.map&&Tc().Evented.prototype.fire("changelayer",{layer:this,property:"opacity"}))}},{key:"addFeatures",value:function(t){}},{key:"removeFeatures",value:function(t){if(t&&0!==t.length){if(t===this.features)return this.removeAllFeatures();for(var e=[],n=(t=!B.isArray(t)?[t]:t).length-1;0<=n;n--){var r=t[n],o=B.indexOf(this.features,r);-1!==o?this.features.splice(o,1):e.push(r)}for(var i=[],a=0,s=this.features.length;a<s;a++)r=this.features[a],i.push(r);this.features=[],this.addFeatures(i),this.renderer&&this.redrawThematicFeatures(this.map.getBounds());var l=0==e.length;Tc().Evented.prototype.fire("featuresremoved",{features:e,succeed:l})}}},{key:"removeAllFeatures",value:function(){this.renderer&&this.renderer.clear(),this.features=[],Tc().Evented.prototype.fire("featuresremoved",{features:[],succeed:!0})}},{key:"getFeatures",value:function(){for(var t=this.features.length,e=new Array(t),n=0;n<t;++n)e[n]=this.features[n];return e}},{key:"getFeatureBy",value:function(t,e){var n,r=null;for(n in this.features)if(this.features[n][t]===e){r=this.features[n];break}return r}},{key:"getFeatureById",value:function(t){return this.getFeatureBy("id",t)}},{key:"getFeaturesByAttribute",value:function(t,e){var n,r,o=[];for(r in this.features)(n=this.features[r])&&n.attributes&&n.attributes[t]===e&&o.push(n);return o}},{key:"redrawThematicFeatures",value:function(t){}},{key:"on",value:function(t,e,n){return(this.renderer||this.map).on(t,e),this}},{key:"off",value:function(t,e,n){return this.renderer?this.renderer.un(t,e):this.map.off(t,e),this}},{key:"addTFEvents",value:function(){for(var t=this.TFEvents,e=t.length,n=0;n<e;n++)this.renderer.on(t[n][0],t[n][1])}},{key:"getLocalXY",value:function(t){var e,n=this.map;return(t instanceof pe||t instanceof xi)&&(e=[(e=n.project(new(Tc().LngLat)(t.x,t.y))).x,e.y]),e=t instanceof Xt?[(t=n.project(new(Tc().LngLat)(t.lon,t.lat))).x,t.y]:e}},{key:"toiClientFeature",value:function(t){B.isArray(t)||(t=[t]);for(var e=[],n=0;n<t.length;n++)if(t[n]instanceof sf)e.push(t[n].toFeature());else if(t[n]instanceof Wt)e.push(t[n]);else if(-1!=["FeatureCollection","Feature","Geometry"].indexOf(t[n].type))var r=new _n,e=e.concat(r.read(t[n]));else{if(!t[n].geometry||!t[n].geometry.parts)throw new Error("features's type is not be supported.");e.push(mi.fromJson(t[n]).toFeature())}return e}},{key:"toFeature",value:function(t){return this.toiClientFeature(t)}},{key:"moveEndEvent",value:function(){!this.loadWhileAnimating&&this.visibility&&(this.div.style.transform="",this.redrawThematicFeatures(this.map.getBounds()),this._show())}},{key:"moveStartEvent",value:function(){var t;!this.loadWhileAnimating&&this.visibility&&(this.startPitch=this.map.getPitch(),this.startBearing=this.map.getBearing(),t=this.map.project(new(Tc().LngLat)(0,0)),this.startMoveX=t.x,this.startMoveY=t.y)}},{key:"moveEvent",value:function(){var t,e,n,r;!this.loadWhileAnimating&&this.visibility?this.rotating||this.zooming||(0!==this.map.getPitch()&&this._hide(),this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px",t=this.map.getPitch()-this.startPitch,e=-this.map.getBearing()+this.startBearing,n=(r=this.map.project(new(Tc().LngLat)(0,0))).x-this.startMoveX,r=r.y-this.startMoveY,this.div.style.transform="rotateX("+t+"deg) rotateZ("+e+"deg) translate3d("+n+"px, "+r+"px, 0px)"):this.redrawThematicFeatures(this.map.getBounds())}},{key:"zoomStartEvent",value:function(){!this.loadWhileAnimating&&this.visibility&&(this.zooming=!0,this._hide())}},{key:"zoomEndEvent",value:function(){!this.loadWhileAnimating&&this.visibility&&(this.zooming=!1,this._show())}},{key:"rotateStartEvent",value:function(){!this.loadWhileAnimating&&this.visibility&&(this.rotating=!0)}},{key:"rotateEvent",value:function(){var t,e;!this.loadWhileAnimating&&this.visibility&&(0!==this.map.getPitch()&&this._hide(),this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px",t=this.map.getPitch()-this.startPitch,e=-this.map.getBearing()+this.startBearing,this.div.style.transform="rotateX("+t+"deg) rotateZ("+e+"deg)")}},{key:"rotateEndEvent",value:function(){!this.loadWhileAnimating&&this.visibility&&(this.rotating=!1,this._show())}},{key:"dragEndEvent",value:function(){!this.loadWhileAnimating&&this.visibility&&this._hide()}},{key:"resizeEvent",value:function(){this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px";var t=this.map.getCanvas();this.div.style.width=t.style.width,this.div.style.height=t.style.height,this.div.width=parseInt(t.width),this.div.height=parseInt(t.height),this.renderer.resize()}},{key:"removeFromMap",value:function(){this.mapContainer.removeChild(this.div),this.removeAllFeatures()}},{key:"moveTo",value:function(t,e){var n=document.getElementById(this.div.id);(e=void 0===e||e)?(e=document.getElementById(t),n&&e&&e.parentNode.insertBefore(n,e)):(t=document.getElementById(t),n&&(t.nextSibling?t.parentNode.insertBefore(n,t.nextSibling):t.parentNode.appendChild(n)))}},{key:"_hide",value:function(){this.renderer.painter.root.style.display="none"}},{key:"_show",value:function(){this.renderer.painter.root.style.display="block"}}]),ff);function ff(t,e){!function(t){if(!(t instanceof ff))throw new TypeError("Cannot call a class as a function")}(this);e=e||{};this.name=t,this.id=e.id||B.createUniqueID("themeLayer_"),this.opacity=e.opacity||1,this.visibility=!0,this.loadWhileAnimating=void 0===e.loadWhileAnimating||e.loadWhileAnimating,this.map=e.map||null,this.features=[],this.TFEvents=[],this.map&&this.map.addLayer(this)}function hf(t){return(hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yf(t,e,n){return(yf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vf(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function df(t,e){return(df=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vf(t){return(vf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.ThemeLayer=cf;var gf=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&df(t,e)}(i,cf);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=vf(n);return function(t,e){if(e&&("object"===hf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=vf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e,n){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t,n)).chartsSetting=n.chartsSetting||{},t.themeFields=n.themeFields||null,t.overlayWeightField=n.overlayWeightField||null,t.isOverLay=void 0===n.isOverLay||n.isOverLay,t.charts=n.charts||[],t.cache=n.cache||{},t.chartsType=e,t}return pf(i.prototype,[{key:"setChartsType",value:function(t){this.chartsType=t,this.redraw()}},{key:"addFeatures",value:function(t){!1!==Tc().Evented.prototype.fire("beforefeaturesadded",{features:t})&&(this.features=this.toiClientFeature(t),this.renderer&&this.redrawThematicFeatures(this.map.getBounds()))}},{key:"redrawThematicFeatures",value:function(t){this.clearCache(),this.renderer.clearAll();for(var e=this.features,n=0,r=e.length;n<r;n++){var o=e[n],i=this.cache,a=o.id;i[a]||(i[a]=a,(a=this.createThematicFeature(o))&&this.overlayWeightField&&o.attributes[this.overlayWeightField]&&!isNaN(o.attributes[this.overlayWeightField])&&(a.__overlayWeight=o.attributes[this.overlayWeightField]),a&&this.charts.push(a))}this.drawCharts()}},{key:"createThematicFeature",value:function(t){var e;return!!(e=El[this.chartsType]&&this.themeFields&&this.chartsSetting?new El[this.chartsType](t,this,this.themeFields,this.chartsSetting):e)&&(e.assembleShapes(),e)}},{key:"drawCharts",value:function(){if(this.renderer){var t=this.charts;if(this.overlayWeightField&&t.sort(function(t,e){return void 0===t.__overlayWeight&&void 0===e.__overlayWeight?0:void 0!==t.__overlayWeight&&void 0===e.__overlayWeight?-1:void 0===t.__overlayWeight&&void 0!==e.__overlayWeight?1:void 0!==t.__overlayWeight&&void 0!==e.__overlayWeight?parseFloat(t.__overlayWeight)<parseFloat(e.__overlayWeight)?1:-1:0}),this.isOverLay)for(var e=[],n=0,r=t.length;n<r;n++){var o=t[n],i=o.resetLocation(),a=o.chartBounds,s=[{x:a.left,y:a.top},{x:a.left,y:a.bottom},{x:a.right,y:a.bottom},{x:a.right,y:a.top},{x:a.left,y:a.top}],l=!1;if(0!==n)for(var u=0;u<e.length;u++)if(this.isQuadrilateralOverLap(s,e[u])){l=!0;break}if(!l){e.push(s);for(var c=o.shapes,f=0,h=c.length;f<h;f++)c[f].refOriginalPosition=i,this.renderer.addShape(c[f])}}else for(var p=0,y=t.length;p<y;p++)for(var d=t[p],v=d.resetLocation(),g=d.shapes,m=0,b=g.length;m<b;m++)g[m].refOriginalPosition=v,this.renderer.addShape(g[m]);this.renderer.render()}}},{key:"getShapesByFeatureID",value:function(t){var e=[],n=this.renderer.getAllShapes();if(!t)return n;for(var r=0,o=n.length;r<o;r++){var i=n[r];i.refDataID&&t===i.refDataID&&e.push(i)}return e}},{key:"isQuadrilateralOverLap",value:function(t,e){var n=t.length,r=e.length;if(5!==n||5!==r)return null;for(var o=!1,i=0;i<n;i++)if(this.isPointInPoly(t[i],e)){o=!0;break}for(var a=0;a<r;a++)if(this.isPointInPoly(e[a],t)){o=!0;break}for(var s=0;s<n-1&&!o;s++)for(var l=0;l<r-1;l++)if("SuperMap.Geometry.Point"===B.lineIntersection(t[s],t[s+1],e[l],e[l+1]).CLASS_NAME){o=!0;break}return o}},{key:"isPointInPoly",value:function(t,e){for(var n=!1,r=-1,o=e.length,i=o-1;++r<o;i=r)(e[r].y<=t.y&&t.y<e[i].y||e[i].y<=t.y&&t.y<e[r].y)&&t.x<(e[i].x-e[r].x)*(t.y-e[r].y)/(e[i].y-e[r].y)+e[r].x&&(n=!n);return n}},{key:"isChartInMap",value:function(t,e){for(var n=t,r=!1,o=0,i=e.length;o<i;o++){var a=e[o];if(a.x>=n.left&&a.x<=n.right&&a.y>=n.top&&a.y<=n.bottom){r=!0;break}}return r}},{key:"clearCache",value:function(){this.cache={},this.charts=[]}},{key:"removeFeatures",value:function(t){this.clearCache(),yf(vf(i.prototype),"removeFeatures",this).call(this,t)}},{key:"removeAllFeatures",value:function(){this.clearCache(),yf(vf(i.prototype),"removeAllFeatures",this).call(this)}},{key:"redraw",value:function(){return this.clearCache(),!!this.renderer&&(this.redrawThematicFeatures(this.map.getBounds()),!0)}},{key:"clear",value:function(){this.renderer&&(this.renderer.clearAll(),this.renderer.refresh()),this.removeAllFeatures(),this.clearCache()}}]),i}();function mf(t){return(mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Sf(t,e){return(Sf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wf(t){return(wf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.GraphThemeLayer=gf;var Of=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sf(t,e)}(i,cf);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=wf(n);return function(t,e){if(e&&("object"===mf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _f(t)}(this,r?(t=wf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t,e)).name=null,t.style=null,t.highlightStyle=null,t.nodesClipPixel=2,t.isHoverAble=!1,t.isMultiHover=!1,t.isClickAble=!0,t.isAllowFeatureStyle=!1,B.extend(_f(t),e),t.cache=e.cache||{},t.cacheFields=e.cacheFields||[],t.maxCacheCount=e.maxCacheCount||0,t.isCustomSetMaxCacheCount=void 0!==e.isCustomSetMaxCacheCount&&e.isCustomSetMaxCacheCount,t}return bf(i.prototype,[{key:"addFeatures",value:function(t){Tc().Evented.prototype.fire("beforefeaturesadded",{features:t}),this.features=this.toiClientFeature(t),this.isCustomSetMaxCacheCount||(this.maxCacheCount=5*this.features.length),this.renderer&&this.redrawThematicFeatures(this.map.getBounds())}},{key:"removeFeatures",value:function(t){this.clearCache(),cf.prototype.removeFeatures.apply(this,arguments)}},{key:"removeAllFeatures",value:function(){this.clearCache(),cf.prototype.removeAllFeatures.apply(this,arguments)}},{key:"redrawThematicFeatures",value:function(t){this.clearCache();var e=this.renderer.getHoverOne(),n=null;e&&e.refDataID&&(n=e.refDataID),this.renderer.clearAll();for(var r=this.features,o=this.cache,i=this.cacheFields,a=this.map.getZoom(),s=this.maxCacheCount,l=0,u=r.length;l<u;l++){var c,f=r[l].id+"_zoom_"+a.toString();o[f]?o[f].updateAndAddShapes():(c=this.createThematicFeature(r[l])).getShapesCount()<1||(o[f]=c,i.push(f),i.length>s&&(f=i[0],i.splice(0,1),delete o[f]))}this.renderer.render(),n&&this.isHoverAble&&this.isMultiHover&&(n=this.getShapesByFeatureID(n),this.renderer.updateHoverShapes(n))}},{key:"createThematicFeature",value:function(t){var e=B.copyAttributesWithClip(this.style);t.style&&!0===this.isAllowFeatureStyle&&(e=B.copyAttributesWithClip(t.style));var n={};n.nodesClipPixel=this.nodesClipPixel,n.isHoverAble=this.isHoverAble,n.isMultiHover=this.isMultiHover,n.isClickAble=this.isClickAble,n.highlightStyle=_l.transformStyle(this.highlightStyle);for(var r=new Pu(t,this,_l.transformStyle(e),n),o=0;o<r.shapes.length;o++)this.renderer.addShape(r.shapes[o]);return r}},{key:"clearCache",value:function(){this.cache={},this.cacheFields=[]}},{key:"clear",value:function(){this.renderer.clearAll(),this.renderer.refresh(),this.removeAllFeatures(),this.clearCache()}},{key:"getCacheCount",value:function(){return this.cacheFields.length}},{key:"setMaxCacheCount",value:function(t){isNaN(t)||(this.maxCacheCount=t,this.isCustomSetMaxCacheCount=!0)}},{key:"getShapesByFeatureID",value:function(t){var e=[],n=this.renderer.getAllShapes();if(!t)return n;for(var r=0,o=n.length;r<o;r++){var i=n[r];i.refDataID&&t===i.refDataID&&e.push(i)}return e}}]),i}();function Ef(t){return(Ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pf(t,e,n){return(Pf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Tf(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Cf(t,e){return(Cf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tf(t){return(Tf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.GeoFeatureThemeLayer=Of;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cf(t,e)}(i,Of);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Tf(n);return function(t,e){if(e&&("object"===Ef(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return kf(t)}(this,r?(t=Tf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t,e)).isOverLay=!0,t.isAvoid=!0,t.themeField=null,t.styleGroups=null,B.extend(kf(t),e),t.defaultStyle={fontColor:"#000000",fontOpacity:1,fontSize:"12px",fontStyle:"normal",fontWeight:"normal",labelAlign:"cm",labelXOffset:0,labelYOffset:0,labelRotation:0,fill:!1,fillColor:"#ee9900",fillOpacity:.4,stroke:!1,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",labelRect:!0,labelSelect:!0,_isGeoTextStrategyStyle:!0},t.getPxBoundsMode=0,t.labelFeatures=[],t}return xf(i.prototype,[{key:"redrawThematicFeatures",value:function(t){if(0<this.features.length&&0==this.labelFeatures.length)for(var e=this.setLabelsStyle(this.features),n=0,r=e.length;n<r;n++)this.labelFeatures.push(e[n]);this.features=this.getDrawnLabels(this.labelFeatures),Pf(Tf(i.prototype),"redrawThematicFeatures",this).call(this,t)}},{key:"removeFeatures",value:function(t){this.labelFeatures=[],Pf(Tf(i.prototype),"removeFeatures",this).call(this,arguments)}},{key:"removeAllFeatures",value:function(){this.labelFeatures=[],Pf(Tf(i.prototype),"removeAllFeatures",this).call(this,arguments)}},{key:"createThematicFeature",value:function(t){var e=this.getStyleByData(t),n={};n.nodesClipPixel=this.nodesClipPixel,n.isHoverAble=this.isHoverAble,n.isMultiHover=this.isMultiHover,n.isClickAble=this.isClickAble,n.highlightStyle=_l.transformStyle(this.highlightStyle);for(var r=new Pu(t,this,_l.transformStyle(e),n),o=0;o<r.shapes.length;o++)this.renderer.addShape(r.shapes[o]);return r}},{key:"getDrawnLabels",value:function(t){for(var e,n=[],r=[],o={labelAlign:"cm",labelXOffset:0,labelYOffset:0},i=this.map,a=i.getZoom(),s=i.getCanvas(),l={x:parseFloat(s.style.width),y:parseFloat(s.style.height)},u=0,c=t.length;u<c;u++){!(e=t[u]).isStyleChange&&void 0!==e.isStyleChange||(e=this.setStyle(e));var f=this.getLabelPxLocation(e);if(0<=f.x&&f.x<=l.x&&0<=f.y&&f.y<=l.y&&!(-1<e.style.minZoomLevel&&a<=e.style.minZoomLevel||-1<e.style.maxZoomLevel&&a>e.style.maxZoomLevel)){var h=null,h=e.isStyleChange?(e.isStyleChange=null,this.calculateLabelBounds(e,f)):e.geometry.bsInfo.w&&e.geometry.bsInfo.h?this.calculateLabelBounds2(e,f):this.calculateLabelBounds(e,f),p=new Kt(0,l.y,l.x,0),y=h.length;if(this.isAvoid){var d=this.getAvoidInfo(p,h);if(d){if("left"===d.aspectW){e.style.labelXOffset+=d.offsetX;for(var v=0;v<y;v++)h[v].x+=d.offsetX}else if("right"===d.aspectW){e.style.labelXOffset+=-d.offsetX;for(var g=0;g<y;g++)h[g].x+=-d.offsetX}if("top"===d.aspectH){e.style.labelYOffset+=d.offsetY;for(var m=0;m<y;m++)h[m].y+=d.offsetY}else if("bottom"===d.aspectH){e.style.labelYOffset+=-d.offsetY;for(var b=0;b<y;b++)h[b].y+=-d.offsetY}e.isStyleChange=!0}}if(this.isOverLay){var S=!1;if(0!=u)for(var _=0;_<r.length;_++)if(this.isQuadrilateralOverLap(h,r[_])){S=!0;break}if(S)continue;r.push(h)}for(var w=[],O=0;O<y-1;O++)w.push(i.unproject(h[O]));var f=w[3],p=w[1],f=new Kt(f.lng,f.lat,p.lng,p.lat).getCenterLonLat(),p=new xi(f.lon,f.lat,e.attributes[this.themeField]);p.calculateBounds(),f=B.cloneObject(e.style),f=B.cloneObject(B.copyAttributes(f,o)),(f=new Wt(p,e.attributes,f)).id=e.id,f.fid=e.fid,n.push(f)}}return n}},{key:"getStyleByData",value:function(t){var e=t;if(e.style=B.copyAttributes(e.style,this.defaultStyle),this.style&&this.style.fontSize&&parseFloat(this.style.fontSize)<12&&(this.style.fontSize="12px"),e.style=B.copyAttributes(e.style,this.style),this.themeField&&this.styleGroups&&e.attributes){var n,r,o=this.themeField,i=e.attributes,a=this.styleGroups,s=!1,l=null;for(n in i)if(o===n){s=!0,l=i[n];break}if(s)for(var u=0,c=a.length;u<c;u++)l>=a[u].start&&l<a[u].end&&((r=a[u].style)&&r.fontSize&&parseFloat(r.fontSize)<12&&(r.fontSize="12px"),e.style=B.copyAttributes(e.style,r));e.style.label=e.attributes[this.themeField]}return e.style}},{key:"setLabelsStyle",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var o=t[n];if("SuperMap.Geometry.GeoText"!==o.geometry.CLASS_NAME)return t;(o.geometry.bsInfo.w||o.geometry.bsInfo.h)&&(o.geometry.bsInfo.w=null,o.geometry.bsInfo.h=null,o.geometry.labelWTmp=null),(o=this.setStyle(o)).layer=this.layer,e.push(o)}return e}},{key:"setStyle",value:function(t){var e=t;if(e.style=B.copyAttributes(e.style,this.defaultStyle),this.style&&this.style.fontSize&&parseFloat(this.style.fontSize)<12&&(this.style.fontSize="12px"),e.style=B.copyAttributes(e.style,this.style),this.groupField&&this.styleGroups&&e.attributes){var n,r,o=this.groupField,i=e.attributes,a=this.styleGroups,s=!1,l=null;for(n in i)if(o===n){s=!0,l=i[n];break}if(s)for(var u=0,c=a.length;u<c;u++)l>=a[u].start&&l<a[u].end&&((r=a[u].style)&&r.fontSize&&parseFloat(r.fontSize)<12&&(r.fontSize="12px"),e.style=B.copyAttributes(e.style,r))}return e.style.label=e.geometry.text,e}},{key:"getLabelPxLocation",value:function(t){var e=t.geometry,n=t.style,t=e.getCentroid(),e=this.map.project(new(Tc().LngLat)(t.x,t.y)),t=new(Tc().Point)(e.x,e.y);if(n.labelXOffset||n.labelYOffset){e=isNaN(n.labelXOffset)?0:n.labelXOffset,n=isNaN(n.labelYOffset)?0:n.labelYOffset,n=t.add(new(Tc().Point)(e,-n));return new(Tc().Point)(n.x,n.y)}return new(Tc().Point)(t.x,t.y)}},{key:"calculateLabelBounds",value:function(t,e){var n,r=t.geometry,o=null;if(0==this.getPxBoundsMode)o=r.getLabelPxBoundsByText(e,t.style);else{if(1!==this.getPxBoundsMode)return null;n=this.getLabelInfo(t.geometry.getCentroid(),t.style),o=r.getLabelPxBoundsByLabel(e,n.w,n.h,t.style)}t=t.style.labelRotation%180==0?[{x:o.left,y:o.top},{x:o.right,y:o.top},{x:o.right,y:o.bottom},{x:o.left,y:o.bottom},{x:o.left,y:o.top}]:this.rotationBounds(o,e,t.style.labelRotation);return r.bounds=new Kt(t[1].x,t[3].y,t[2].x,t[4].y),t}},{key:"calculateLabelBounds2",value:function(t,e){var n=t.geometry.bsInfo,r=t.style,o=B.cloneObject(e);if(r.labelAlign&&"cm"!==r.labelAlign)switch(r.labelAlign){case"lt":o.x+=n.w/2,o.y+=n.h/2;break;case"lm":o.x+=n.w/2;break;case"lb":o.x+=n.w/2,o.y-=n.h/2;break;case"ct":o.y+=n.h/2;break;case"cb":o.y-=n.h/2;break;case"rt":o.x-=n.w/2,o.y+=n.h/2;break;case"rm":o.x-=n.w/2;break;case"rb":o.x-=n.w/2,o.y-=n.h/2}var i=o.x-n.w/2,a=o.y+n.h/2,s=r.fontStyle&&"italic"===r.fontStyle?o.x+n.w/2+parseInt(parseFloat(r.fontSize)/2):o.x+n.w/2,l=o.y-n.h/2,l=new Kt(i,a,s,l),r=r.labelRotation%180==0?[{x:l.left,y:l.top},{x:l.right,y:l.top},{x:l.right,y:l.bottom},{x:l.left,y:l.bottom},{x:l.left,y:l.top}]:this.rotationBounds(l,e,r.labelRotation);return t.geometry.bounds=new Kt(r[1].x,r[3].y,r[2].x,r[4].y),r}},{key:"getLabelInfo",value:function(t,e){var n={l:"left",r:"right",t:"top",b:"bottom"},r={l:0,r:-1,t:0,b:-1};e=B.extend({fontColor:"#000000",labelAlign:"cm"},e);var o=this.getLocalXY(t),i=0;(e.labelXOffset||e.labelYOffset)&&(t=isNaN(e.labelXOffset)?0:e.labelXOffset,a=isNaN(e.labelYOffset)?0:e.labelYOffset,o[0]+=t,o[1]-=a);var a=document.createElement("canvas");a.globalAlpha=0,a.lineWidth=1;var s=a.getContext("2d");s.fillStyle=e.fontColor,s.globalAlpha=e.fontOpacity||1;var l,u,a=[e.fontStyle||"normal","normal",e.fontWeight||"normal",e.fontSize||"1em",e.fontFamily||"sans-serif"].join(" "),c=e.label.split("\n"),f=c.length;if(s.fillText){s.font=a,s.textAlign=n[e.labelAlign[0]]||"center",s.textBaseline=n[e.labelAlign[1]]||"middle",null==(y=r[e.labelAlign[1]])&&(y=-.5),l=s.measureText("Mg").height||s.measureText("xx").width,o[1]+=l*y*(f-1);for(var h=0;h<f;h++)i<(u=s.measureText(c[h]).width)&&(i=u)}else if(s.mozDrawText){s.mozTextStyle=a,null==(y=r[e.labelAlign[1]])&&(y=-.5),l=s.mozMeasureText("xx"),o[1]+=l*(1+y*f);for(var p=0;p<f;p++)i<(u=s.measureText(c[p]).width)&&(i=u)}var y={};return i?(y.w=i,y.h=e.fontSize,y.rows=c.length,y):null}},{key:"rotationBounds",value:function(t,e,n){var r=new(Tc().Point)(t.left,t.top),o=new(Tc().Point)(t.right,t.top),i=new(Tc().Point)(t.right,t.bottom),t=new(Tc().Point)(t.left,t.bottom),a=[];a.push(this.getRotatedLocation(r.x,r.y,e.x,e.y,n)),a.push(this.getRotatedLocation(o.x,o.y,e.x,e.y,n)),a.push(this.getRotatedLocation(i.x,i.y,e.x,e.y,n)),a.push(this.getRotatedLocation(t.x,t.y,e.x,e.y,n));for(var s=[],l=0;l<a.length;l++)s.push({x:a[l].x,y:a[l].y});return s.push({x:a[0].x,y:a[0].y}),s}},{key:"getRotatedLocation",value:function(t,e,n,r,o){var i,a={};return e=-e,r=-r,o=-o,i=(t-n)*Math.cos(o/180*Math.PI)-(e-r)*Math.sin(o/180*Math.PI)+n,r=(t-n)*Math.sin(o/180*Math.PI)+(e-r)*Math.cos(o/180*Math.PI)+r,a.x=i,a.y=-r,a}},{key:"getAvoidInfo",value:function(r,t){if(5!==t.length)return null;for(var e=[{x:r.left,y:r.top},{x:r.right,y:r.top},{x:r.right,y:r.bottom},{x:r.left,y:r.bottom},{x:r.left,y:r.top}],n=!1,o=e.length,i=t.length,a=0,s=0,l="",u="",c=0;c<o-1;c++)for(var f=0;f<i-1;f++)"SuperMap.Geometry.Point"===B.lineIntersection(e[c],e[c+1],t[f],t[f+1]).CLASS_NAME&&(h(t[f]),h(t[f+1]),n=!0);return n?{aspectW:u,aspectH:l,offsetX:a,offsetY:s}:null;function h(t){var e,n;r.contains(t.x,t.y)||(t.y<r.top&&(e=Math.abs(r.top-t.y),s<e&&(s=e,l="top")),t.y>r.bottom&&(n=Math.abs(t.y-r.bottom),s<n&&(s=n,l="bottom")),t.x<r.left&&(n=Math.abs(r.left-t.x),a<n&&(a=n,u="left")),t.x>r.right&&(t=Math.abs(t.x-r.right),a<t&&(a=t,u="right")))}}},{key:"isQuadrilateralOverLap",value:function(t,e){var n=t.length,r=e.length;if(5!==n||5!==r)return null;for(var o=!1,i=0;i<n;i++)if(this.isPointInPoly(t[i],e)){o=!0;break}for(var a=0;a<r;a++)if(this.isPointInPoly(e[a],t)){o=!0;break}for(var s=0;s<n-1&&!o;s++)for(var l=0;l<r-1;l++)if("SuperMap.Geometry.Point"===B.lineIntersection(t[s],t[s+1],e[l],e[l+1]).CLASS_NAME){o=!0;break}return o}},{key:"isPointInPoly",value:function(t,e){for(var n=!1,r=-1,o=e.length,i=o-1;++r<o;i=r)(e[r].y<=t.y&&t.y<e[i].y||e[i].y<=t.y&&t.y<e[r].y)&&t.x<(e[i].x-e[r].x)*(t.y-e[r].y)/(e[i].y-e[r].y)+e[r].x&&(n=!n);return n}}]),i}();Tc().supermap.LabelThemeLayer=ss;var Rf=function(){try{return mapv}catch(t){return{}}}();function Af(t){return(Af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function If(t,e,n){return(If="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bf(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function Nf(t,e){return(Nf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jf(t,e){if(e&&("object"===Af(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Mf(t)}function Mf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bf(t){return(Bf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Df=Rf.baiduMapLayer?Rf.baiduMapLayer.__proto__:Function,Ff=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nf(t,e)}(i,Df);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=Bf(n);return jf(this,r?(t=Bf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e,n,r){if(function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),n=o.call(this,t,n,r),!Df)return jf(n);n.map=t;t=Mf(n);return t.init(r=r||{}),t.argCheck(r),n.canvasLayer=e,n.stopAniamation=!1,n.animation=r.animation,n.clickEvent=n.clickEvent.bind(Mf(n)),n.mousemoveEvent=n.mousemoveEvent.bind(Mf(n)),n.bindMapEvent(),n.bindEvent(),n._expectShow=!0,n}return Lf(i.prototype,[{key:"clickEvent",value:function(t){var e=t.point;If(Bf(i.prototype),"clickEvent",this).call(this,e,t)}},{key:"mousemoveEvent",value:function(t){var e=t.point;If(Bf(i.prototype),"mousemoveEvent",this).call(this,e,t)}},{key:"bindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.on("click",this.clickEvent),this.options.methods.mousemove&&t.on("mousemove",this.mousemoveEvent))}},{key:"unbindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.off("click",this.clickEvent),this.options.methods.mousemove&&t.off("mousemove",this.mousemoveEvent))}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"addData",value:function(t,e){var n=t;t&&t.get&&(n=t.get()),this.dataSet.add(n),this.update({options:e})}},{key:"update",value:function(t){var e=t||{},t=e.data;null!=(t=t&&t.get?t.get():t)&&this.dataSet.set(t),If(Bf(i.prototype),"update",this).call(this,{options:e.options})}},{key:"getData",value:function(){return this.dataSet}},{key:"removeData",value:function(e){var t;this.dataSet&&(t=this.dataSet.get({filter:function(t){return null==e||"function"!=typeof e||!e(t)}}),this.dataSet.set(t),this.update({options:null}))}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"updateData",value:function(t,e){t&&t.get&&this.dataSet.set(t.get()),this.update({options:e})}},{key:"_canvasUpdate",value:function(n){var r=this.map;if(this.canvasLayer&&!this.stopAniamation){var o,i,a,s,t,e,l=this,u=l.options.animation,c=this.getContext();if(l.isEnabledTime()){if(void 0===n)return void this.clear(c);"2d"===this.context&&(c.save(),c.globalCompositeOperation="destination-out",c.fillStyle="rgba(0, 0, 0, .1)",c.fillRect(0,0,c.canvas.width,c.canvas.height),c.restore())}else this.clear(c);if("2d"===this.context)for(var f in l.options)c[f]=l.options[f];else c.clear(c.COLOR_BUFFER_BIT);l.options.minZoom&&r.getZoom()<l.options.minZoom||l.options.maxZoom&&r.getZoom()>l.options.maxZoom||(e=(t=r.getBounds()).getEast()-t.getWest(),t=t.getNorth()-t.getSouth(),o=e/this.canvasLayer.canvas.width,i=t/this.canvasLayer.canvas.height,e=function(t){var e;if(t===h.METER)e=1;else if(t===h.DEGREE)e=2*Math.PI*6378137/360;else if(t===h.KILOMETER)e=.001;else if(t===h.INCH)e=1/.025399999918;else{if(t!==h.FOOT)return e;e=.3048}return e}("DEGREE")*o,a=r.getCenter(),s=r.project(a),t={transferCoordinate:function(t){if(r.transform.rotationMatrix||"2d"===l.context){var e=r.project(new(Tc().LngLat)(t[0],t[1]));return[e.x,e.y]}t=[(t[0]-a.lng)/o,(a.lat-t[1])/i];return[t[0]+s.x,t[1]+s.y]}},void 0!==n&&(t.filter=function(t){var e=u.trails||10;return n&&t.time>n-e&&t.time<n}),t=l.dataSet.get(t),this.processData(t),"m"===l.options.unit?(l.options.size&&(l.options._size=l.options.size/e),l.options.width&&(l.options._width=l.options.width/e),l.options.height&&(l.options._height=l.options.height/e)):(l.options._size=l.options.size,l.options._height=l.options.height,l.options._width=l.options.width),e=r.project(new(Tc().LngLat)(0,0)),this.drawContext(c,t,l.options,e),l.options.updateCallback&&l.options.updateCallback(n))}}},{key:"init",value:function(t){this.options=t,this.initDataRange(t),this.context=this.options.context||"2d",this.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(this.options.zIndex),this.initAnimator()}},{key:"bindMapEvent",value:function(){this.mapEvent={resizeEvent:this.resizeEvent.bind(this),zoomStartEvent:this.zoomStartEvent.bind(this),zoomEndEvent:this.zoomEndEvent.bind(this),rotateStartEvent:this.rotateStartEvent.bind(this),rotateEvent:this.rotateEvent.bind(this),moveStartEvent:this.moveStartEvent.bind(this),rotateEndEvent:this.rotateEndEvent.bind(this),moveEvent:this.moveEvent.bind(this),moveEndEvent:this.moveEndEvent.bind(this),removeEvent:this.removeEvent.bind(this)},this.map.on("resize",this.mapEvent.resizeEvent),this.map.on("zoomstart",this.mapEvent.zoomStartEvent),this.map.on("zoomend",this.mapEvent.zoomEndEvent),this.map.on("rotatestart",this.mapEvent.rotateStartEvent),this.map.on("rotate",this.mapEvent.rotateEvent),this.map.on("rotateend",this.mapEvent.rotateEndEvent),this.map.on("movestart",this.mapEvent.moveStartEvent),this.map.on("move",this.mapEvent.moveEvent),this.map.on("moveend",this.mapEvent.moveEndEvent),this.map.on("remove",this.mapEvent.removeEvent)}},{key:"unbindMapEvent",value:function(){this.map.off("resize",this.mapEvent.resizeEvent),this.map.off("zoomstart",this.mapEvent.zoomStartEvent),this.map.off("zoomend",this.mapEvent.zoomEndEvent),this.map.off("rotatestart",this.mapEvent.rotateStartEvent),this.map.off("rotate",this.mapEvent.rotateEvent),this.map.off("rotateend",this.mapEvent.rotateEndEvent),this.map.off("movestart",this.mapEvent.moveStartEvent),this.map.off("move",this.mapEvent.moveEvent),this.map.off("moveend",this.mapEvent.moveEndEvent),this.map.off("remove",this.mapEvent.removeEvent)}},{key:"destroy",value:function(){this.unbindMapEvent(),this.unbindEvent(),this.clearData(),this.animator&&this.animator.stop(),this.animator=null,this.canvasLayer=null}},{key:"addAnimatorEvent",value:function(){}},{key:"removeEvent",value:function(){this.canvasLayer.mapContainer.removeChild(this.canvasLayer.canvas)}},{key:"resizeEvent",value:function(){this.canvasLayer.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px";var t=this.canvasLayer.canvas;t.style.position="absolute",t.style.top="0px",t.style.left="0px";var e="undefined"==typeof window?{}:window,e=this.canvasLayer.devicePixelRatio=e.devicePixelRatio||1;t.width=parseInt(this.map.getCanvas().style.width)*e,t.height=parseInt(this.map.getCanvas().style.height)*e,this.canvasLayer.mapVOptions.context&&"2d"!=this.canvasLayer.mapVOptions.context||t.getContext("2d").scale(e,e),t.style.width=this.map.getCanvas().style.width,t.style.height=this.map.getCanvas().style.height}},{key:"moveEndEvent",value:function(){this.stopAniamation=!1,this.getContext().canvas.style.transform="",this._canvasUpdate(),!0===this._expectShow&&this._show()}},{key:"moveStartEvent",value:function(){this.startPitch=this.map.getPitch(),this.startBearing=this.map.getBearing();var t=this.map.project(new(Tc().LngLat)(0,0));this.startMoveX=t.x,this.startMoveY=t.y,this.animation&&(this.stopAniamation=!0),this.rotating||this.zooming||(this._expectShow="none"!==this.canvasLayer.canvas.style.display,0!==this.map.getPitch()&&this._hide())}},{key:"moveEvent",value:function(){this.canvasLayer.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px";var t=this.map.getPitch()-this.startPitch,e=-this.map.getBearing()+this.startBearing,n=this.map.project(new(Tc().LngLat)(0,0)),r=n.x-this.startMoveX,n=n.y-this.startMoveY;this.getContext().canvas.style.transform="rotateX("+t+"deg) rotateZ("+e+"deg) translate3d("+r+"px, "+n+"px, 0px)"}},{key:"zoomStartEvent",value:function(){this.zooming=!0,this._hide()}},{key:"zoomEndEvent",value:function(){this.zooming=!1}},{key:"rotateStartEvent",value:function(){this.rotating=!0,0!==this.map.getPitch()&&this._hide()}},{key:"rotateEvent",value:function(){this.canvasLayer.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px";var t=this.map.getPitch()-this.startPitch,e=-this.map.getBearing()+this.startBearing;this.getContext().canvas.style.transform="rotateX("+t+"deg) rotateZ("+e+"deg)"}},{key:"rotateEndEvent",value:function(){this.rotating=!1}},{key:"clear",value:function(t){t&&t.clearRect&&t.clearRect(0,0,parseInt(this.map.getCanvas().style.width),parseInt(this.map.getCanvas().style.height))}},{key:"draw",value:function(){this._canvasUpdate()}},{key:"_hide",value:function(){this.canvasLayer.canvas.style.display="none"}},{key:"_show",value:function(){this.canvasLayer.canvas.style.display="block"}}]),i}();function Uf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Uf(Hf.prototype,[{key:"onAdd",value:function(t){this.map=t,this.renderer=new Ff(this.map,this,this.dataSet,this.mapVOptions),this.canvas=this._createCanvas(),this.renderer._canvasUpdate(),this.mapContainer=t.getCanvasContainer(),this.mapContainer.appendChild(this.canvas),this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px"}},{key:"removeFromMap",value:function(){this.mapContainer.removeChild(this.canvas),this.renderer.destroy()}},{key:"setVisibility",value:function(t){t!==this.visibility&&((this.visibility=t)?this.show():this.hide())}},{key:"moveTo",value:function(t,e){var n=document.getElementById(this.canvas.id);(e=void 0===e||e)?(e=document.getElementById(t),n&&e&&e.parentNode.insertBefore(n,e)):(t=document.getElementById(t),n&&(t.nextSibling?t.parentNode.insertBefore(n,t.nextSibling):t.parentNode.appendChild(n)))}},{key:"getTopLeft",value:function(){var t,e=this.map;return t=e?e.getBounds().getNorthWest():t}},{key:"addData",value:function(t,e){this.renderer.addData(t,e)}},{key:"update",value:function(t){this.renderer.update(t)}},{key:"getData",value:function(){return this.renderer&&(this.dataSet=this.renderer.getData()),this.dataSet}},{key:"removeData",value:function(t){this.renderer&&this.renderer.removeData(t)}},{key:"clearData",value:function(){this.renderer.clearData()}},{key:"show",value:function(){return this.renderer&&this.renderer._show(),this}},{key:"hide",value:function(){return this.renderer&&this.renderer._hide(),this}},{key:"_createCanvas",value:function(){var t=document.createElement("canvas");t.id=this.id,t.style.position="absolute",t.style.top="0px",t.style.left="0px";var e="undefined"==typeof window?{}:window,e=this.devicePixelRatio=e.devicePixelRatio||1;return t.width=parseInt(this.map.getCanvas().style.width)*e,t.height=parseInt(this.map.getCanvas().style.height)*e,this.mapVOptions.context&&"2d"!=this.mapVOptions.context||t.getContext("2d").scale(e,e),t.style.width=this.map.getCanvas().style.width,t.style.height=this.map.getCanvas().style.height,t}},{key:"setZIndex",value:function(t){this.canvas.style.zIndex=t}}]),ss=Hf;function Hf(t,e,n){!function(t){if(!(t instanceof Hf))throw new TypeError("Cannot call a class as a function")}(this),this.map=t,this.id=n.layerID||B.createUniqueID("mapvLayer_"),delete n.layerID,this.mapVOptions=n,this.dataSet=e,this.visibility=!0,this.map&&this.map.addLayer(this)}function Gf(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Wf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Tc().supermap.MapvLayer=ss;var Vf={textSize:"12px",textFont:["12px Calibri","sans-serif"],textAnchor:"bottom",textColor:"rgba(0,0,0,1)",textHaloColor:"rgba(255,255,255,1)",textHaloWidth:1},zf={lineColor:"red",lineCap:"round",lineJoin:"round",lindDasharray:[.4,5],lineDashOffset:0,lineWidth:1},Yf={showLabel:!0,opacity:1,visible:!0,interval:10,extent:null,minZoom:0,maxZoom:50,wrapX:!0,strokeStyle:zf,lngLabelFormatter:null,latLabelFormatter:null,lngLabelStyle:Vf,latLabelStyle:Vf},ss=(Wf(qf.prototype,[{key:"onAdd",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.map;this.map=t,this._initialize(),this._createCanvas(),this._bindEvent(),this._drawCanvas(),this._addGraticuleLayer(),this.setVisibility()}},{key:"removeFromMap",value:function(){this.mapContainer.removeChild(this.canvas),this.canvas=null,this._unbindEvent()}},{key:"setVisibility",value:function(t){var e=this.map&&this.map.getZoom();this.options.visible="boolean"==typeof t?t:this.options.visible,this.visible="boolean"==typeof t?t:this.options.visible&&e>=this.options.minZoom&&e<=this.options.maxZoom,this.map.getLayer(this.sourceId)&&this.map.setLayoutProperty(this.sourceId,"visibility",this.visible?"visible":"none"),this._drawLabel()}},{key:"setMinZoom",value:function(t){this.options.minZoom=t,this.setVisibility()}},{key:"setMaxZoom",value:function(t){this.options.maxZoom=t,this.setVisibility()}},{key:"setShowLabel",value:function(t){this.options.showLabel=t,this._drawLabel()}},{key:"setExtent",value:function(t){this.options.extent=this._getDefaultExtent(t,this.map),this.features=this._getGraticuleFeatures(),this._updateGraticuleLayer(),this._drawLabel()}},{key:"setStrokeStyle",value:function(t){if(this.map&&this.map.getLayer(this.sourceId)){this.options.strokeStyle=t;var e,n,t=this._transformStrokeStyle(t),r=t.layout,o=t.paint;for(e in r)this.map.setLayoutProperty(this.sourceId,e,r[e]);for(n in o)this.map.setPaintProperty(this.sourceId,n,o[n])}}},{key:"setLngLabelStyle",value:function(t){this.options.lngLabelStyle=t,this._drawLabel()}},{key:"setLatLabelStyle",value:function(t){this.options.latLabelStyle=t,this._drawLabel()}},{key:"setIntervals",value:function(t){this.options.interval=t,this._calcInterval(),this.features=this._getGraticuleFeatures(),this._updateGraticuleLayer(),this._drawLabel()}},{key:"_bindEvent",value:function(){this.map.on("move",this.resetEvent),this.map.on("moveend",this.resetEvent),this.map.on("styledata",this.styleDataEevent),this.map.on("resize",this.resizeEvent),this.map.on("zoomend",this.zoomendEvent)}},{key:"_unbindEvent",value:function(){this.map.off("move",this.resetEvent),this.map.off("moveend",this.resetEvent),this.map.off("styledata",this.styleDataEevent),this.map.off("resize",this.resizeEvent),this.map.off("zoomend",this.zoomendEvent)}},{key:"_initialize",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.map,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.options;(e=e||{}).strokeStyle=Object.assign({},zf,e.strokeStyle||{}),e.lngLabelStyle=Object.assign({},Vf,e.lngLabelStyle||{}),e.latLabelStyle=Object.assign({},Vf,e.latLabelStyle||{}),this.options=Object.assign({},Yf,e,{extent:this._getDefaultExtent(e.extent,t),wrapX:"boolean"==typeof e.wrapX?e.wrapX:t.getRenderWorldCopies()}),this.oldExtent=this.options.extent,this._calcInterval(),this.isRotate=!1,this.visible=!0,this.features=this._getGraticuleFeatures()}},{key:"_createCanvas",value:function(){var t;this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.id=this.canvasId,this.canvas.style.position="absolute",this.canvas.style.top="0px",this.canvas.style.left="0px",t=("undefined"==typeof window?{}:window).devicePixelRatio||1,this.canvas.width=parseInt(this.map.getCanvas().style.width)*t,this.canvas.height=parseInt(this.map.getCanvas().style.height)*t,this.canvas.style.width=this.map.getCanvas().style.width,this.canvas.style.height=this.map.getCanvas().style.height,this.canvas.globalAlpha=this.options.opacity,this.mapContainer=this.map.getCanvasContainer(),this.mapContainer.appendChild(this.canvas))}},{key:"_drawCanvas",value:function(){this.canvas||this._createCanvas(),this.setVisibility(),this._reset()}},{key:"_resizeCallback",value:function(){this.mapContainer&&this.mapContainer.removeChild(this.canvas),this.canvas=null,this._drawCanvas()}},{key:"_reset",value:function(){this._updateRotate(),this._updateExtent(),this._calcInterval(),this._drawLabel()}},{key:"_setLayerTop",value:function(){var t,e=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.map;!n||(t=n.getStyle&&n.getStyle().layers)&&t.length&&t.findIndex(function(t){return t.id===e.sourceId})!==t.length-1&&n.getLayer(this.sourceId)&&(n.removeLayer(this.sourceId),this._addGraticuleLayer())}},{key:"_getDefaultExtent",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.map,n=(n=(e.getCRS&&e.getCRS()||{}).extent)||[-180,-85.05119,180,85.05119];if(!t||0===t.length)return n;var r=Tc().LngLatBounds.convert(t),e=r._sw,r=r._ne;return t=[e.lng,e.lat,r.lng,r.lat],[Math.max(n[0],t[0]),Math.max(n[1],t[1]),Math.min(n[2],t[2]),Math.min(n[3],t[3])]}},{key:"_updateRotate",value:function(){var t=this.map.getBearing();this.isRotate=-180<t&&t<=-90||90<=t&&t<180}},{key:"_updateExtent",value:function(){var t,e;this.options.wrapX&&!this.oldExtent&&(t=(e=this.map.getBounds())._ne,e=e._sw,this.options.extent=[e.lng,e.lat,t.lng,t.lat])}},{key:"_calcInterval",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options.interval;"function"==typeof t&&(t=t(this.map)),this._currLngInterval=t,this._currLatInterval=t}},{key:"_formatLat",value:function(t){return this.options.latFormatTickLabel?this.options.latLabelFormatter(t):t<0?I(-1*t)+"S":0<t?I(t)+"N":""+I(t)}},{key:"_formatLng",value:function(t){return this.options.lngLabelFormatter?this.options.lngLabelFormatter(t):0<(t=L(t))&&t<=180?I(t)+"E":t<0&&-180<=t?I(-1*t)+"W":""+I(t)}},{key:"_parsePxToInt",value:function(t){2<t.length&&"p"===t.charAt(t.length-2)&&(t=t.substr(0,t.length-2));try{return parseInt(t,10)}catch(t){console.log(t)}return 0}},{key:"_drawLabel",value:function(){var e,n,t,r=this,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.visible,i=this.canvas,a=i.getContext("2d");o&&this.options.showLabel?this.map&&(this._currLngInterval&&this._currLatInterval||this._calcInterval(),a.clearRect(0,0,i.width,i.height),t=this.options,e=t.lngLabelStyle,n=t.latLabelStyle,t=(o=this._getGridiculePoints()).lngPoints,o=o.latPonits,t.forEach(function(t){r._drawLng(a,t[0],t[1],t[2],e)}),o.forEach(function(t){r._drawLat(a,t[0],t[1],t[2],n)})):a.clearRect(0,0,i.width,i.height)}},{key:"_drawLat",value:function(t,e,n,r,o){t=this._setLabelStyle(t,o);var i=this.canvas.width,o=12;try{var a=t.font.split(" ")[0],o=this._parsePxToInt(a)}catch(t){console.log(t)}r||(s=e,e=n,n=this.map.project([s,e]));var s=this._formatLat(e),e=t.measureText(s).width;t.strokeText(s,(r?i:n.x)-e,(r?n:n.y)+o/2),t.fillText(s,(r?i:n.x)-e,(r?n:n.y)+o/2)}},{key:"_drawLng",value:function(t,e,n,r,o){t=this._setLabelStyle(t,o);o=this.canvas.height;r||(i=n,n=this.map.project([e,i]));var i=this._formatLng(e),e=t.measureText(i).width;t.strokeText(i,(r?n:n.x)-e/2,r?o:n.y),t.fillText(i,(r?n:n.x)-e/2,r?o:n.y)}},{key:"_getLatPoints",value:function(){var n=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[-180,180],o=1<arguments.length?arguments[1]:void 0,i=2<arguments.length?arguments[2]:void 0,t=3<arguments.length&&void 0!==arguments[3]?arguments[3]:this.features;if(t){if(this.options.wrapX&&-180===r[0]&&180===r[1])return[];var a=[];return t.forEach(function(t){var e=t.geometry.coordinates[0][1];t.geometry.coordinates[1][1]===e&&(t="number"==typeof i?i:r[1],n.isRotate&&(t="number"==typeof o?o:r[0]),(a=n.options.wrapX?a.concat(n._getWrapPoints(t,e,[t,t])):a).push([t,e]))}),a}}},{key:"_getLngPoints",value:function(){var n=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[-90,90],e=1<arguments.length?arguments[1]:void 0,r=2<arguments.length?arguments[2]:void 0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:this.features;if(o){var i="number"==typeof e?e:t[0];this.isRotate&&(i="number"==typeof r?r:t[1]);var a=[];return o.forEach(function(t){var e=t.geometry.coordinates[0][0];t.geometry.coordinates[1][0]===e&&(a.push([e,i]),n.options.wrapX&&(a=a.concat(n._getWrapPoints(e,i))))}),a}}},{key:"_getWrapPoints",value:function(t,e){for(var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.oldExtent,r=[],o=this.map.getBounds(),i=o._ne,a=o._sw,s=2<n.length?n[2]:n[1];t>=a.lng;){var l=L(t,180===s,-180===n[0]);(!n||l>=n[0]&&l<=s)&&r.push([t,e]),t-=360}for(;t<=i.lng;){var u=L(t,180===s,-180===n[0]);(!n||u>=n[0]&&u<=s)&&r.push([t,e]),t+=360}return r}},{key:"_getGridiculePoints",value:function(){var t=this._getEdgeLat(),e=this._getEdgeLng(),n=this._getRange(),r=n.latRange,o=n.lngRange,i=n.firstLat,a=n.firstLng,s=n.lastLat,n=n.lastLng;return{latPonits:this._getUniquePoint(this._getLatPoints(o,a,n),t,1),lngPoints:this._getUniquePoint(this._getLngPoints(r,i,s),e,0)}}},{key:"_getEdgeLat",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._currLatInterval,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.map,n=[],r=[],o=this.canvas.width,i=this.canvas.height,a=this._getRange().extent,s=this.map.getBounds()._ne;if(this.options.wrapX&&L(s.lng)>a[2])return[];for(var l=this._countDecimals(t),u=0;u<=i;u++){var c=e.unproject([o,u]),f=L(c.lng);(this.options.wrapX?f>=a[0]&&f<=a[2]:c.lng>=a[0]&&c.lng<=a[2])&&c.lat>=a[1]&&c.lat<=a[3]&&(n.push([c.lat,u]),r.push(c.lat),void 0===d&&c.lat.toFixed(l)%t==0&&(d=Number(c.lat.toFixed(l))))}var h=this._getIntersectRange(d,r,n,t),p=h.first,y=h.last,s=h.coordinates,h=h.points,d=Math.min(Math.max(p,-90),90),y=Math.max(Math.min(Math.round(y),90),-90);return-90!==d||-90!==y?this._getClosestCoordinate(d,y,s,h,t):[]}},{key:"_getEdgeLng",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._currLngInterval,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.map,n=[],r=[],o=this.canvas.width,i=this.canvas.height,a=this.options.extent,s=this._countDecimals(t),l=this.map.getBounds()._sw;if(this.options.wrapX&&L(l.lat)>a[3])return[];for(var u=0;u<=o;u++){var c=e.unproject([u,i]),f=L(c.lng);(this.options.wrapX?f>=a[0]&&f<=a[2]:c.lng>=a[0]&&c.lng<=a[2])&&c.lat>=a[1]&&c.lat<=a[3]&&(n.push([c.lng,u]),r.push(c.lng),void 0===d&&c.lng.toFixed(s)%t==0&&(d=Number(c.lng.toFixed(s))))}var h=this._getIntersectRange(d,r,n,t),p=h.first,y=h.last,l=h.coordinates,h=h.points,d=p;return this._getClosestCoordinate(d,y,l,h,t)}},{key:"_getIntersectRange",value:function(t,e,n,r){var o=e[e.length-1];if(o<t){o=t,e.reverse(),n.reverse();for(var i=this._countDecimals(r),a=0;a<=e.length;a++){var s=e[a];if(s.toFixed(i)%r==0){t=Number(s.toFixed(i));break}}}return{first:t,last:o,coordinates:e,points:n}}},{key:"_getClosestCoordinate",value:function(t,e,n,r,o){for(var i=[],a=t;a<=e;){var s=this._getClosestNumberIndex(a,n),l=r[s];i.push([Math.round(l[0]),l[1],!0]),a+=o,n=n.slice(s),r=r.slice(s)}return i}},{key:"_getClosestNumberIndex",value:function(t,e){for(var n=0,r=Number.MAX_VALUE,o=0;o<e.length;o++){var i=Math.abs(e[o]-t);i<=r&&(i===r&&e[o]<e[n]||(n=o,r=i))}return n}},{key:"_getUniquePoint",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(this.options.wrapX)return e.concat(t);if(!t||0===t.length)return e;var r,o=t,i=this.canvas.width,a=this.canvas.height;for(r in e){var s=this.map.project(e[r]),l=o.findIndex(function(t){return t[0]===e[r][n]});l<=-1?o.push(e[r]):s&&0<=s.x&&s.x<=i&&0<=s.y&&s.y<=a&&(o[l]=e[r])}return o}},{key:"_countDecimals",value:function(t){return Math.floor(t)!==t&&t.toString().split(".")[1].length||0}},{key:"_addGraticuleLayer",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.features;this.map.getSource(this.sourceId)||this.map.addSource(this.sourceId,{type:"geojson",data:{type:"FeatureCollection",features:t}}),this.map.getLayer(this.sourceId)||(t=Object.assign({id:this.sourceId,type:"line",source:this.sourceId},this._transformStrokeStyle()),this.map.addLayer(t))}},{key:"_updateGraticuleLayer",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.features;this.map.getSource(this.sourceId)&&(t={type:"FeatureCollection",features:t},this.map.getSource(this.sourceId).setData(t)),this._addGraticuleLayer()}},{key:"_getGraticuleFeatures",value:function(){var t=this._currLngInterval||10,e=this._currLatInterval||10,n=[],r=this._getRange(),o=r.latRange,i=r.lngRange,a=r.firstLat,s=r.firstLng,l=r.lastLat,u=r.lastLng;this.options.wrapX&&!this.oldExtent&&(o=[-90,90],i=[-180,180],a=s=l=u=null),"number"==typeof s&&n.unshift(this._makeLineFeature(this._makeLineCoords(s,o,a,l))),"number"==typeof u&&n.unshift(this._makeLineFeature(this._makeLineCoords(u,o,a,l)));for(var c=i[0];c<=i[1];c+=t)n.unshift(this._makeLineFeature(this._makeLineCoords(c,o,a,l)));"number"==typeof a&&n.unshift(this._makeLineFeature(this._makeLineCoords(a,i,s,u,"lat"))),"number"==typeof l&&n.unshift(this._makeLineFeature(this._makeLineCoords(l,i,s,u,"lat")));for(var f=o[0];f<=o[1];f+=e)n.unshift(this._makeLineFeature(this._makeLineCoords(f,i,s,u,"lat")));return n}},{key:"_getRange",value:function(){var t,e,n,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options.extent&&(function(t){if(Array.isArray(t))return Gf(t)}(t=this.options.extent)||function(){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}()||function(t){if(t){if("string"==typeof t)return Gf(t,void 0);var e=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(e="Object"===e&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Gf(t,void 0):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o={};return(r=(r=!r||0===r.length?this._getDefaultExtent():r).map(function(t){return Number(t.toFixed(6))}))[1]%this._currLatInterval!=0&&(o.firstLat=r[1],e=Math.ceil(r[1]/this._currLatInterval),r[1]=e*this._currLatInterval),r[3]%this._currLatInterval!=0&&(o.lastLat=r[3],e=Math.floor(r[3]/this._currLatInterval),r[3]=e*this._currLatInterval),r[0]%this._currLngInterval!=0&&(o.firstLng=r[0],n=Math.ceil(r[0]/this._currLngInterval),r[0]=n*this._currLngInterval),r[2]%this._currLngInterval!=0&&(o.lastLng=r[2],n=Math.floor(r[2]/this._currLngInterval),r[2]=n*this._currLngInterval),Object.assign({latRange:[r[1],r[3]],lngRange:[r[0],r[2]],extent:r},o)}},{key:"_makeLineCoords",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[-90,90],n=2<arguments.length?arguments[2]:void 0,r=3<arguments.length?arguments[3]:void 0,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"lng";t="lng"===o?this._lngFix(t):t;for(var n="number"==typeof n?n:e[0],r="number"==typeof r?r:e[1],i=Math.abs(n-r),a=[],s=n;s<=r;s+=i)"lng"===o?a.push([t,s]):a.push([s,t]);return a}},{key:"_makeLineFeature",value:function(t){return{type:"Feature",geometry:{type:1<arguments.length&&void 0!==arguments[1]?arguments[1]:"LineString",coordinates:t}}}},{key:"_lngFix",value:function(t){return 180<=t?180:t<=-180?-180:t}},{key:"_transformStrokeStyle",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options.strokeStyle;if(!t||"string"==typeof t)return{paint:{"line-color":t||"rgba(0,0,0,0.2)"}};var e={visibility:this.visible?"visible":"none","line-join":t.lineJoin||"round","line-cap":t.lineCap||"round"},n={"line-color":t.lineColor||"rgba(0,0,0,0.2)","line-width":t.lineWidth||1,"line-offset":t.lineDashOffset||0,"line-translate-anchor":"viewport"};return t.lineWidth&&("function"==typeof t.lineWidth?n["line-width"]=t.lineWidth(this.map):n["line-width"]=t.lineWidth),t.lindDasharray&&("function"==typeof t.lindDasharray?n["line-dasharray"]=t.lindDasharray(this.map):n["line-dasharray"]=t.lindDasharray),{layout:e,paint:n}}},{key:"_setLabelStyle",value:function(t,e){return e.textColor&&(t.fillStyle=e.textColor),e.textSize&&(t.font=e.textSize+" "+(e.textFont||["Calibri","sans-serif"]).join(",")),e.textHaloColor&&(t.strokeStyle=e.textHaloColor,t.lineWidth=e.textHaloWidth||1),e.textAnchor&&(t.textBaseline=this._getTxetBaseline(e.textAnchor),t.textAligin=this._getTxetAlign(e.textAligin)),t}},{key:"_getTxetBaseline",value:function(t){if(!t)return"bottom";t=t.split("-");return t.includes("bottom")?"bottom":t.includes("top")?"top":t.includes("center")?"middle":void 0}},{key:"_getTxetAlign",value:function(t){if(!t)return"center";t=t.split("-");return t.includes("left")?"left":t.includes("right")?"right":t.includes("center")?"center":void 0}}]),qf);function qf(t){!function(t){if(!(t instanceof qf))throw new TypeError("Cannot call a class as a function")}(this),this.id=t&&t.layerID?t.layerID:B.createUniqueID("graticuleLayer_"),this.sourceId=this.id+"_line",this.canvasId=this.id,this.options=t,this.resetEvent=this._reset.bind(this),this.styleDataEevent=this._setLayerTop.bind(this),this.resizeEvent=this._resizeCallback.bind(this),this.zoomendEvent=this.setVisibility.bind(this)}function Xf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Tc().supermap.GraticuleLayer=ss;var Jf=(Xf(Qf.prototype,[{key:"setLayerOptions",value:function(t){return this._extend(this,t),this}},{key:"setHighlightStyleOptions",value:function(t){return this._extend(this.highlight,t),this}},{key:"setData",value:function(t,e){var n=this;return n.data=t,null!=e&&(n.parseNumber=e),n.parseNumber&&n.data&&n.data.features&&n.data.features.map(function(t){return n.baseHeightField&&t.properties[n.baseHeightField]&&(t.properties[n.baseHeightField]=parseFloat(t.properties[n.baseHeightField])),n.heightField&&t.properties[n.heightField]&&(t.properties[n.heightField]=parseFloat(t.properties[n.heightField])),t}),this}},{key:"getData",value:function(){return this.data}},{key:"addTo",value:function(t){return this.map=t,this.map&&this.show(),this}},{key:"show",value:function(t){return this._extend(this,t),this._addLayer(),this.enableHighlight&&this._addHighLightLayer(),this.showLegend&&(this.legend||(this.legend=this._createLegendControl()),this.map.addControl(this.legend,this.legendPosition)),this}},{key:"remove",value:function(){if(!this.map)return this;var t=this.id||"theme3DLayer";return this.map.getLayer(t)&&(this.map.off("mousemove",t,this._onMouseMove.bind(this)),this.map.on("mouseout",t,this._onMouseMove.bind(this)),this.map.removeLayer(t)),this.map.getLayer(this._highlightLayerId)&&(this._selectFeatureId=null,this.map.removeLayer(this._highlightLayerId)),this.legend&&this.map.removeControl(this.legend),this}},{key:"getLayerStyleOptions",value:function(){}},{key:"getHighlightStyleOptions",value:function(){}},{key:"_createLegendControl",value:function(n){var r=this;function t(){}return t.prototype.onAdd=function(t){this._map=t,this._container=document.createElement("div");var e="legend-light";"dark"===r.legendTheme&&(e="legend-dark");var t=" legend-horizontal";return"vertical"===r.legendOrientation&&(t=" legend-vertical"),this._container.className="mapboxgl-ctrl legend "+e+t,n?this._container.innerHTML=n:(e=" <div class='legend-title'>"+(r.legendTitle||"")+"</div>",t="<div class='legend-content'>"+(r._createLegendElement.call(r)||"")+"</div>",this._container.innerHTML=e+t),r._appendLegendCSSStyle(),this._container},t.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map=void 0},new t}},{key:"_createLegendElement",value:function(){}},{key:"_addLayer",value:function(){var t=this.getLayerStyleOptions(),e=this.id||"theme3DLayer",n=this.sourceId=e+"Source";this.map.getSource(n)&&this.map.removeSource(n),this.map.addSource(n,{type:"geojson",data:this.data}),this.map.addLayer({id:e,type:"fill-extrusion",source:n,paint:t}),this.map.moveLayer(e)}},{key:"_addHighLightLayer",value:function(){var t;this.map&&((t=this.map).addLayer({id:this._highlightLayerId,type:"fill-extrusion",source:this.sourceId,paint:this.getHighlightStyleOptions(),filter:["in","$id",""]}),this._selectFeatureId=null,t.on("mousemove",this.id,this._onMouseMove.bind(this)),t.on("mouseout",this.id,this._onMouseMove.bind(this)))}},{key:"_onMouseMove",value:function(t){var e=this,n=this.map,r=n.queryRenderedFeatures(t.point,{layers:[e.id]});if(e.highlight&&e.highlight.callback&&e.highlight.callback(r,t),!r||r.length<1)return e._clearHighlight.call(e),void(e._selectFeatureId=null);r=r[0].id;e._selectFeatureId!==r&&(e._selectFeatureId=r,n.setFilter(e._highlightLayerId,["==","$id",e._selectFeatureId]))}},{key:"_clearHighlight",value:function(){this.map&&this.map.setFilter(this._highlightLayerId,["in","$id",""])}},{key:"_appendLegendCSSStyle",value:function(){var t=document.createElement("style");t.type="text/css",t.innerHTML="\n        .legend {\n            display: inline-block;\n            border-radius: 2px;\n            -moz-border-radius: 2px;\n            -webkit-border-radius: 2px;\n            font-size: 12px;\n            color: rgba(0, 0, 0, 0.8);\n            background-color: rgb(255, 255, 255);\n        }\n        .legend-light {\n            color: rgba(0, 0, 0, 0.8);\n            background-color: rgb(255, 255, 255);\n            box-shadow: 0px 0px 6px #bbbbbb;\n            -moz-box-shadow: 0px 6px 10px #bbbbbb;\n            -webkit-box-shadow: 0px 0px 6px #bbbbbb;\n        }\n        .legend-dark {\n            color: rgba(255, 255, 255, 0.8);\n            background-color: rgb(64, 64, 64);\n        }\n        .legend .legend-title {\n            min-height: 14px;\n            max-width: 500px;\n            padding:6px 10px;\n        }\n        .legend-light .legend-title {\n            color: rgba(0, 0, 0, 0.8);\n        }\n        .legend-dark .legend-title {\n            color: rgba(255, 255, 255, 0.8);\n        }\n        .legend-content{\n            padding:6px 10px;\n        }\n        "+this._legendCSSStyle(),document.getElementsByTagName("head")[0].appendChild(t)}},{key:"_legendCSSStyle",value:function(){return"\n        .legend ul {\n            padding: 0;\n            margin: 0 16px;\n            height: 100%;\n            display: block;\n            list-style: none;\n        }\n\n        .legend li {\n            vertical-align: middle;\n        }\n\n        .legend li span:first-child {\n            vertical-align: middle;\n        }\n\n        .legend li span:last-child {\n            line-height: 28px;\n            max-width: 200px;\n            vertical-align: middle;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            -ms-text-overflow: ellipsis;\n        }\n\n        .legend-vertical li {\n            height: 28px;\n        }\n\n        .legend-vertical li span:first-child {\n            display: inline-block;\n            width: 60px;\n            height: 100%;\n        }\n\n        .legend-vertical li span:last-child {\n            display: inline-block;\n            margin-left: 16px;\n            height: 100%;\n        }\n\n        .legend-horizontal li {\n            height: 56px;\n            float: left;\n        }\n\n        .legend-horizontal li span:first-child {\n            display: block;\n            width: 100%;\n            height: 50%;\n        }\n\n        .legend-horizontal li span:last-child {\n            display: block;\n            vertical-align: middle;\n            width: 60px;\n            height: 50%;\n            text-align: center;\n        }\n        "}},{key:"_extend",value:function(t){for(var e=0;e<Object.getOwnPropertyNames(arguments).length;e++){var n=Object.getOwnPropertyNames(arguments)[e];if("caller"!=n&&"callee"!=n&&"length"!=n&&"arguments"!=n){var r=arguments[n];if(r)for(var o=0;o<Object.getOwnPropertyNames(r).length;o++){var i=Object.getOwnPropertyNames(r)[o];"caller"!=n&&"callee"!=n&&"length"!=n&&"arguments"!=n&&(t[i]=r[i])}}}return t}}]),Qf);function Qf(t,e){!function(t){if(!(t instanceof Qf))throw new TypeError("Cannot call a class as a function")}(this),this.id=t,this.map=null,this.opacity=1,this.parseNumber=!1,this.enableHighlight=!1,this.highlight={color:"#ADA91E"},this.baseHeightField=null,this.height=null,this.heightField="height",this.themeField=this.heightField,this.showLegend=!0,this.legendTitle=null,this.legendTheme="light",this.legendOrientation="horizontal",this.legendPosition="bottom-right",this._highlightLayerId="".concat(this.id,"-highlightLayer"),this._extend(this,e)}function Kf(t){return(Kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $f(t,e){return($f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function th(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eh(t){return(eh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.Theme3DLayer=Jf;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),$f(t,e)}(i,Jf);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=eh(n);return function(t,e){if(e&&("object"===Kf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return th(t)}(this,r?(t=eh(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t,e)).heightStops=null,t.colorStops=null,t.base=null,t.legendRatio=1,t._extend(th(t),e),t}return Zf(i.prototype,[{key:"getLayerStyleOptions",value:function(){var t=null==this.opacity?1:this.opacity,t=isNaN(parseFloat(t))?1:parseFloat(t),e=/^[0-9]+.?[0-9]*$/,t={"fill-extrusion-color":{stops:this.colorStops,property:this.themeField||this.heightField,type:"interval",base:e.test(this.base)?this.base:1},"fill-extrusion-opacity":t};return this.heightStops?t["fill-extrusion-height"]={stops:this.heightStops,property:this.heightField||"height",base:e.test(this.base)?this.base:1}:this.height?t["fill-extrusion-height"]=this.height:t["fill-extrusion-height"]={property:this.heightField||"height",type:"identity"},this.baseHeightField&&(t["fill-extrusion-base"]={property:this.baseHeightField,type:"identity"}),t}},{key:"getHighlightStyleOptions",value:function(){return{"fill-extrusion-color":this.highlight&&null!=this.highlight.color?this.highlight.color:"#ADA91E","fill-extrusion-height":{stops:this.heightStops,property:this.heightField},"fill-extrusion-opacity":this.highlight&&this.highlight.opacity||.6}}},{key:"_createLegendElement",value:function(){for(var t=this.colorStops&&this.colorStops.length||0,e="<ul>",n=0;n<t;n++){var r=this.colorStops[n][0],r=this._getWrapperText(r),r=n===t-1?"> "+r:r+"-"+this._getWrapperText(this.colorStops[n+1][0]);e+="<li><span style='background-color:"+this.colorStops[n][1]+";'></span><span>"+r+"</span></li>"}return e+"</ul>"}},{key:"_getWrapperText",value:function(t){t*=null==this.legendRatio?1:parseFloat(this.legendRatio),t=parseFloat(t);return t%1e6<=1e6?t.toString():parseInt(t/1e3)+"k"}}]),i}();function nh(t){return(nh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oh(t,e){return(oh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ih(t){return(ih=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.RangeTheme3DLayer=ss;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oh(t,e)}(i,Of);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=ih(n);return function(t,e){if(e&&("object"===nh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=ih(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t,e)).style=e.style,t.isHoverAble=e.isHoverAble,t.highlightStyle=e.highlightStyle,t.themeField=e.themeField,t.styleGroups=e.styleGroups,t}return rh(i.prototype,[{key:"createThematicFeature",value:function(t){var e=this.getStyleByData(t),n={};n.nodesClipPixel=this.nodesClipPixel,n.isHoverAble=this.isHoverAble,n.isMultiHover=this.isMultiHover,n.isClickAble=this.isClickAble,n.highlightStyle=_l.transformStyle(this.highlightStyle);for(var r=new Pu(t,this,_l.transformStyle(e),n),o=0;o<r.shapes.length;o++)this.renderer.addShape(r.shapes[o]);return r}},{key:"getStyleByData",value:function(t){var e={},t=t;if(e=B.copyAttributesWithClip(e,this.style),this.themeField&&this.styleGroups&&0<this.styleGroups.length&&t.attributes){var n,r,o=this.themeField,i=t.attributes,a=this.styleGroups,s=!1,l=null;for(n in i)if(o===n){s=!0,l=i[n];break}if(s)for(var u=0,c=a.length;u<c;u++)l>=a[u].start&&l<a[u].end&&(r=a[u].style,e=B.copyAttributesWithClip(e,r))}return e=t.style&&!0===this.isAllowFeatureStyle?B.copyAttributesWithClip(t.style):e}}]),i}();function ah(t){return(ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lh(t,e){return(lh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function uh(t){return(uh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.RangeThemeLayer=ss;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lh(t,e)}(i,gf);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=uh(n);return function(t,e){if(e&&("object"===ah(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=uh(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e,n){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t,e,n)).symbolType=e,t.symbolSetting=n.symbolSetting,t.themeField=n.themeField,t}return sh(i.prototype,[{key:"setSymbolType",value:function(t){this.symbolType=t,this.redraw()}},{key:"createThematicFeature",value:function(t){var e;return!!(e=El[this.symbolType]&&this.themeField&&this.symbolSetting?new El[this.symbolType](t,this,[this.themeField],this.symbolSetting):e)&&(e.assembleShapes(),e)}}]),i}();function ch(t){return(ch="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hh(t,e){return(hh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ph(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yh(t){return(yh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.RankSymbolThemeLayer=ss;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),hh(t,e)}(i,Jf);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=yh(n);return function(t,e){if(e&&("object"===ch(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ph(t)}(this,r?(t=yh(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t,e)).colorStops=null,t._extend(ph(t),e),t}return fh(i.prototype,[{key:"getLayerStyleOptions",value:function(){var t=null==this.opacity?1:this.opacity,t=isNaN(parseFloat(t))?1:parseFloat(t),t={"fill-extrusion-color":{stops:this.colorStops,property:this.themeField,type:"categorical"},"fill-extrusion-opacity":t};return null!=this.height?t["fill-extrusion-height"]=this.height:t["fill-extrusion-height"]={property:this.heightField||"height",type:"categorical"},this.baseHeightField&&(t["fill-extrusion-base"]={property:this.baseHeightField,type:"identity"}),t}},{key:"getHighlightStyleOptions",value:function(){var t={"fill-extrusion-color":this.highlight&&null!=this.highlight.color?this.highlight.color:"#ADA91E","fill-extrusion-height":{stops:this.heightStops,property:this.heightField,type:"categorical"},"fill-extrusion-opacity":this.highlight&&this.highlight.opacity||.6};return null!=this.height&&(t["fill-extrusion-height"]=this.height||0),t}},{key:"_createLegendElement",value:function(){for(var t="<ul>",e=this.colorStops&&this.colorStops.length||0,n=0;n<e;n++){var r=this.colorStops[n][0];t+="<li><span style='background-color:"+this.colorStops[n][1]+";'></span><span>"+r+"</span></li>"}return t+"</ul>"}}]),i}();function dh(t){return(dh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gh(t,e){return(gh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mh(t){return(mh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.UniqueTheme3DLayer=ss;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gh(t,e)}(i,Of);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=mh(n);return function(t,e){if(e&&("object"===dh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=mh(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){return function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=o.call(this,t,e)).themeField=e.themeField,t.style=e.style,t.styleGroups=e.styleGroups,t.isHoverAble=e.isHoverAble,t.highlightStyle=e.highlightStyle,t}return vh(i.prototype,[{key:"createThematicFeature",value:function(t){var e=this.getStyleByData(t),n={};n.nodesClipPixel=this.nodesClipPixel,n.isHoverAble=this.isHoverAble,n.isMultiHover=this.isMultiHover,n.isClickAble=this.isClickAble,n.highlightStyle=_l.transformStyle(this.highlightStyle);for(var r=new Pu(t,this,_l.transformStyle(e),n),o=0;o<r.shapes.length;o++)this.renderer.addShape(r.shapes[o]);return r}},{key:"getStyleByData",value:function(t){var e={},t=t;if(e=B.copyAttributesWithClip(e,this.style),this.themeField&&this.styleGroups&&0<this.styleGroups.length&&t.attributes){var n,r,o=this.themeField,i=t.attributes,a=this.styleGroups,s=!1,l=null;for(n in i)if(o===n){s=!0,l=i[n];break}if(s)for(var u=0,c=a.length;u<c;u++)l.toString()===a[u].value.toString()&&(r=a[u].style,e=B.copyAttributesWithClip(e,r))}return e=t.style&&!0===this.isAllowFeatureStyle?B.copyAttributesWithClip(t.style):e}}]),i}();function bh(t){return(bh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _h(t,e){return(_h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wh(t){return(wh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Tc().supermap.UniqueThemeLayer=ss;ss=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_h(t,e)}(i,Tc().Evented);var n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=wh(n);return function(t,e){if(e&&("object"===bh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r?(t=wh(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))});function i(t,e){!function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this);var n=e||{};return(e=o.call(this)).name=t,e.id=n.id||B.createUniqueID("HeatMapLayer_"),e.map=n.map||null,e.loadWhileAnimating=void 0===n.loadWhileAnimating||n.loadWhileAnimating,e.visibility=!0,e.opacity=n.opacity||1,e.colors=n.colors||["blue","cyan","lime","yellow","red"],e.useGeoUnit=!!n.useGeoUnit&&n.useGeoUnit,e.radius=n.radius||50,e.featureWeight=n.featureWeight||null,e.features=[],e.maxWeight=null,e.minWeight=null,e.EVENT_TYPES=["featuresadded","featuresremoved","featuresdrawcompleted"],e.supported=!1,e.rootCanvas=null,e.canvasContext=null,e.maxWidth=null,e.maxHeight=null,e}return Sh(i.prototype,[{key:"onAdd",value:function(t){this.map=t,0!==this.features.length&&(this._createCanvasContainer(),this.map.on("resize",this._resizeEvent.bind(this)),this.map.on("zoomstart",this._zoomStartEvent.bind(this)),this.map.on("zoomend",this._zoomEndEvent.bind(this)),this.map.on("rotatestart",this._rotateStartEvent.bind(this)),this.map.on("rotate",this._rotateEvent.bind(this)),this.map.on("rotateend",this._rotateEndEvent.bind(this)),this.map.on("dragend",this._dragEndEvent.bind(this)),this.map.on("movestart",this._moveStartEvent.bind(this)),this.map.on("move",this._moveEvent.bind(this)),this.map.on("moveend",this._moveEndEvent.bind(this)),this.map.on("remove",this.removeFromMap.bind(this)),this.refresh())}},{key:"removeFromMap",value:function(){this.removeAllFeatures(),this.map.getCanvasContainer().removeChild(this.rootCanvas)}},{key:"_createCanvasContainer",value:function(){this.supported=!0,this.mapContainer=this.map.getCanvasContainer(),this.rootCanvas=document.createElement("canvas"),this.rootCanvas.id=this.id;var t=this.map.getCanvas();this.rootCanvas.width=this.maxWidth=parseInt(t.width),this.rootCanvas.height=this.maxHeight=parseInt(t.height),B.modifyDOMElement(this.rootCanvas,null,null,null,"absolute",null,null,this.opacity),this.canvasContext=this.rootCanvas.getContext("2d"),this.mapContainer.appendChild(this.rootCanvas)}},{key:"addFeatures",value:function(t){this.features=this.toiClientFeature(t),this.fire(this.EVENT_TYPES[0],{features:t,succeed:!0}),this.refresh()}},{key:"refresh",value:function(){var t;0!==this.features.length&&this.map&&(t=this.map.getBounds(),this.updateHeatPoints(t))}},{key:"setOpacity",value:function(t){t!==this.opacity&&(this.opacity=t,B.modifyDOMElement(this.rootCanvas,null,null,null,null,null,null,t),null!==this.map&&this.fire("changelayer",{layer:this,property:"opacity"}))}},{key:"updateHeatPoints",value:function(t){this.features&&0<this.features.length?this.convertFastToPixelPoints(t):this.canvasContext.clearRect(0,0,this.maxWidth,this.maxWidth)}},{key:"convertFastToPixelPoints",value:function(t){var e,n,r=[],o=t.getEast()-t.getWest(),i=t.getNorth()-t.getSouth(),t=this.map.getCanvas(),t=o/t.width>i/t.height?o/t.width:i/t.height;this.useRadius=this.useGeoUnit?parseInt(this.radius/t):this.radius;for(var a=0;a<this.features.length;a++){var s=this.features[a],l=s.geometry,u=this.getPixelXY(new Xt(l.x,l.y));this.featureWeight?(u.weight=s.attributes[this.featureWeight],this.maxWeight||(e=e||u.weight,n=n||u.weight,e=Math.max(e,u.weight),n=Math.min(n,u.weight))):u.weight=1,l=Math.floor(u.x),s=Math.floor(u.y),u=u.weight,r.push([l,s,u])}this.maxWeight?this.draw(r,this.maxWeight):this.draw(r,e&&n?(e+n)/2:1)}},{key:"draw",value:function(t,e){if(!(0<this.maxHeight&&0<this.maxWidth))return!1;var n=this.canvasContext;this.canvasContext.clearRect(0,0,this.maxWidth,this.maxHeight),this.drawCircle(this.useRadius),this.createGradient();for(var r=0;r<t.length;r++){var o=t[r];this.canvasContext.globalAlpha=Math.max(o[2]/e,.05),this.canvasContext.drawImage(this.circle,o[0]-this.useRadius,o[1]-this.useRadius)}var i=n.getImageData(0,0,this.maxWidth,this.maxHeight);this.colorize(i.data,this.grad),n.putImageData(i,0,0)}},{key:"colorize",value:function(t,e){for(var n,r=0;r<t.length;r+=4)(n=4*t[r+3])&&(t[r]=e[n],t[r+1]=e[1+n],t[r+2]=e[2+n])}},{key:"drawCircle",value:function(t){var e=t/2,n=this.circle=document.createElement("canvas"),r=n.getContext("2d");n.height=2*t,n.width=2*t,r.shadowOffsetX=r.shadowOffsetY=2*t,r.shadowBlur=e,r.shadowColor="#000000",r.beginPath(),r.arc(-t,-t,t/2,0,2*Math.PI,!0),r.closePath(),r.fill()}},{key:"createGradient",value:function(){var t=this.colors,e=document.createElement("canvas"),n=e.getContext("2d"),r=n.createLinearGradient(0,0,0,256);e.height=256;for(var o=e.width=1,i=0,a=t.length;i<a;i++)r.addColorStop(o/a,t[i]),o++;n.fillStyle=r,n.fillRect(0,0,1,256),this.grad=n.getImageData(0,0,1,256).data}},{key:"getPixelXY",value:function(t){var e,n=this.map;return(t instanceof pe||t instanceof xi)&&(e=n.project(new(Tc().LngLat)(t.x,t.y)),e={x:parseInt(e.x),y:parseInt(e.y)}),t instanceof Xt&&(t=n.project(new(Tc().LngLat)(t.lon,t.lat)),e={x:parseInt(t.x),y:parseInt(t.y)}),e}},{key:"toiClientFeature",value:function(t){B.isArray(t)||(t=[t]);for(var e=[],n=0;n<t.length;n++)if(t[n]instanceof Wt)e.push(t[n]);else if(-1!=["FeatureCollection","Feature","Geometry"].indexOf(t[n].type))var r=new _n,e=e.concat(r.read(t[n]));else{if(!t[n].geometry||!t[n].geometry.parts)throw new Error("Features[".concat(n,"]'s type does not match, please check."));e.push(mi.fromJson(t[n]).toFeature())}return e}},{key:"removeFeatures",value:function(t){if(t&&0!==t.length&&this.features&&0!==this.features.length){if(t===this.features)return this.removeAllFeatures();for(var e,n,r=[],o=0,i=(t=!B.isArray(t)?[t]:t).length;o<i;o++)e=t[o],-1!==(n=B.indexOf(this.features,e))?this.features.splice(n,1):r.push(e);var a=0==r.length;this.fire(this.EVENT_TYPES[1],{features:r,succeed:a}),this.refresh()}}},{key:"removeAllFeatures",value:function(){this.features=[],this.refresh()}},{key:"moveTo",value:function(t,e){var n=document.getElementById(this.rootCanvas.id);(e=void 0===e||e)?(e=document.getElementById(t),n&&e&&e.parentNode.insertBefore(n,e)):(t=document.getElementById(t),n&&(t.nextSibling?t.parentNode.insertBefore(n,t.nextSibling):t.parentNode.appendChild(n)))}},{key:"setVisibility",value:function(t){this.rootCanvas&&t!==this.visibility&&(this.visibility=t,this.rootCanvas.style.display=t?"block":"none")}},{key:"_resizeEvent",value:function(){this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px";var t=this.map.getCanvas();this.rootCanvas.style.width=t.style.width,this.rootCanvas.style.height=t.style.height,this.rootCanvas.width=this.maxWidth=parseInt(t.width),this.rootCanvas.height=this.maxHeight=parseInt(t.height);t=window.devicePixelRatio||1;1!==t&&this.canvasContext&&this.canvasContext.scale(t,t),this.refresh()}},{key:"_zoomStartEvent",value:function(){!this.loadWhileAnimating&&this.visibility&&(this.zooming=!0,this._hide())}},{key:"_zoomEndEvent",value:function(){!this.loadWhileAnimating&&this.visibility&&(this.zooming=!1,this._show())}},{key:"_rotateStartEvent",value:function(){!this.loadWhileAnimating&&this.visibility&&(this.rotating=!0)}},{key:"_rotateEvent",value:function(){var t,e;!this.loadWhileAnimating&&this.visibility&&(0!==this.map.getPitch()&&this._hide(),this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px",t=this.map.getPitch()-this.startPitch,e=-this.map.getBearing()+this.startBearing,this.rootCanvas.style.transform="rotateX("+t+"deg) rotateZ("+e+"deg)")}},{key:"_rotateEndEvent",value:function(){!this.loadWhileAnimating&&this.visibility&&(this.rotating=!1,this._show())}},{key:"_dragEndEvent",value:function(){!this.loadWhileAnimating&&this.visibility&&this._hide()}},{key:"_moveEndEvent",value:function(){!this.loadWhileAnimating&&this.visibility&&(this.rootCanvas.style.transform="",this.refresh(),this._show())}},{key:"_moveStartEvent",value:function(){var t;!this.loadWhileAnimating&&this.visibility&&(this.startPitch=this.map.getPitch(),this.startBearing=this.map.getBearing(),t=this.map.project(new(Tc().LngLat)(0,0)),this.startMoveX=t.x,this.startMoveY=t.y)}},{key:"_moveEvent",value:function(){var t,e,n,r;!this.loadWhileAnimating&&this.visibility?this.rotating||this.zooming||(0!==this.map.getPitch()&&this._hide(),this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px",t=this.map.getPitch()-this.startPitch,e=-this.map.getBearing()+this.startBearing,n=(r=this.map.project(new(Tc().LngLat)(0,0))).x-this.startMoveX,r=r.y-this.startMoveY,this.rootCanvas.style.transform="rotateX("+t+"deg) rotateZ("+e+"deg) translate3d("+n+"px, "+r+"px, 0px)"):this.refresh()}},{key:"_hide",value:function(){this.rootCanvas.style.display="none"}},{key:"_show",value:function(){this.rootCanvas.style.display="block"}}]),i}();function Oh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Tc().supermap.HeatMapLayer=ss;Oh(Eh.prototype,[{key:"getId",value:function(){return this.id}},{key:"setId",value:function(t){this.id=t}},{key:"getLngLat",value:function(){return this.lngLat}},{key:"setLngLat",value:function(t){this.lngLat=Uc.isArray(t)?{lng:t[0],lat:t[1]}:t}},{key:"setStyle",value:function(t){this.style=Uc.extend(this.style,t)}},{key:"getStyle",value:function(){return this.style}},{key:"setAttributes",value:function(t){this.attributes=Uc.extend({},this.attributes,t)}},{key:"getAttributes",value:function(){return this.attributes}}]),ss=Eh;function Eh(t,e,n){!function(t){if(!(t instanceof Eh))throw new TypeError("Cannot call a class as a function")}(this),this.lngLat=Uc.isArray(t)?{lng:t[0],lat:t[1]}:t,this.style=Uc.extend({},e),this.attributes=n}function xh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Tc().supermap.Graphic=ss;xh(Ph.prototype,[{key:"onAdd",value:function(t){if(this.map=t,this.canvas)return this.mapContainer=this.map.getCanvasContainer(),this.mapContainer.appendChild(this.canvas),this;t.getCRS&&t.getCRS()!==Tc().CRS.EPSG3857&&(this.coordinateSystem=3,this.isGeographicCoordinateSystem=!0),this._initContainer(),this._createLayerByLayerTypeID();var e,n=this._getState(),r={};for(e in n)r[e]=n[e];return r.layers=[this.layer],r.canvas=this.canvas,this.deckGL=new window.DeckGL.experimental.DeckGLJS(r),this.map.on("render",this._moveEvent.bind(this)),this.map.on("resize",this._resizeEvent.bind(this)),this._draw(),this}},{key:"remove",value:function(){this.map.off("render",this._moveEvent.bind(this)),this.map.off("resize",this._resizeEvent.bind(this)),this.map.getCanvasContainer().removeChild(this.canvas)}},{key:"removeFromMap",value:function(){this.remove(),this.clear()}},{key:"moveTo",value:function(t,e){var n=document.getElementById(this.id);(e=void 0===e||e)?(e=document.getElementById(t),n&&e&&e.parentNode.insertBefore(n,e)):(t=document.getElementById(t),n&&(t.nextSibling?t.parentNode.insertBefore(n,t.nextSibling):t.parentNode.appendChild(n)))}},{key:"setVisibility",value:function(t){this.canvas&&t!==this.visibility&&(this.visibility=t,this.canvas.style.display=t?"block":"none")}},{key:"setStyle",value:function(t){Uc.extend(this.props,t),this._createLayerByLayerTypeID(),this.update()}},{key:"setData",value:function(t){this.data=this.data||[],this.data.length=0;var e=Uc.isArray(t)?[].concat(t):[t];this.layer.props.data||(this.layer.props.data=[]);for(var n=this.layer.props.data.length=0;n<e.length;n++)this.layer.props.data.push(e[n]);this.data=this.layer.props.data,this.update()}},{key:"addData",value:function(t){this.data=this.data||[];var e=Uc.isArray(t)?[].concat(t):[t];this.layer.props.data||(this.layer.props.data=[]);for(var n=0;n<e.length;n++)this.layer.props.data.push(e[n]);this.update()}},{key:"update",value:function(){"Awaiting state"!==this.layer.lifecycle&&this.layer.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,updateTriggersChanged:!0}),this._draw()}},{key:"clear",value:function(){this.removeData(),this.deckGL.finalize()}},{key:"removeData",value:function(){this.data.length=0,this.layer.props.data&&(this.layer.props.data.length=0),this.update()}},{key:"_draw",value:function(){var t=this._getState();t.layers=[this.layer],t.canvas=this.canvas,this.deckGL.setProps(t)}},{key:"_getState",value:function(){var t,e,n=this.map,r=parseInt(this.canvas.style.width),o=parseInt(this.canvas.style.height),i=n.getCenter(),a={width:r,height:o,longitude:i.lng,latitude:i.lat,zoom:n.getZoom(),maxZoom:n.getMaxZoom(),pitch:n.getPitch(),bearing:n.getBearing()},s={};for(t in a)s[t]=a[t];for(e in this.props)s[e]=this.props[e];return n.getCRS&&n.getCRS()!==Tc().CRS.EPSG3857&&(s.coordinateSystem=this.coordinateSystem,s.isGeographicCoordinateSystem=this.isGeographicCoordinateSystem),s.data=this.data,s}},{key:"_createLayerByLayerTypeID",value:function(){if(this.props.data=this.data,this.props.isGeographicCoordinateSystem=this.isGeographicCoordinateSystem,this.props.coordinateSystem=this.coordinateSystem,this.props.pickable=Boolean(this.props.onClick)||Boolean(this.props.onHover),"scatter-plot"===this.layerTypeID)this.props.id="scatter-plot",this._createScatterPlotLayer();else if("path-layer"===this.layerTypeID)this.props.id="path-layer",this._createPathLayer();else if("polygon-layer"===this.layerTypeID)this.props.id="polygon-layer",this._createPolygonLayer();else if("arc-layer"===this.layerTypeID)this.props.id="arc-layer",this._createArcLineLayer();else{if("hexagon-layer"!==this.layerTypeID)throw new Error(this.layerTypeID+" does not support");this.props.id="hexagon-layer",this._createHexagonLayer()}}},{key:"_createScatterPlotLayer",value:function(){var e=this;this.props.getPosition=this.callback.getPosition||function(t){if(!t)return[0,0,0];t=t.getLngLat();return t&&[t.lng,t.lat,0]},this.callback.getColor&&(this.props.getColor=this.callback.getColor||function(t){t=t&&t.getStyle();return t&&t.color||e.props.color}),this.callback.getRadius&&(this.props.getRadius=this.callback.getRadius||function(t){t=t&&t.getStyle();return t&&t.radius||e.props.radius}),(this.props.color||this.props.radius)&&(this.props.updateTriggers={},this.props.radius&&(this.props.updateTriggers.getRadius=[this.props.radius]),this.props.color&&(this.props.updateTriggers.getColor=[this.props.color])),this.layer=new window.DeckGL.ScatterplotLayer(this.props)}},{key:"_createPathLayer",value:function(){this.props.getPath=this.callback.getPath||function(t){return t.geometry.coordinates},this.callback.getColor&&(this.props.getColor=this.callback.getColor),this.callback.getWidth&&(this.props.getWidth=this.callback.getWidth),this.callback.getDashArray&&(this.props.getDashArray=this.callback.getDashArray),this.layer=new window.DeckGL.PathLayer(this.props)}},{key:"_createPolygonLayer",value:function(){this.props.getPolygon=this.callback.getPolygon||function(t){return t.geometry.coordinates},this.callback.getElevation&&(this.props.getElevation=this.callback.getElevation),this.callback.getFillColor&&(this.props.getFillColor=this.callback.getFillColor),this.callback.getLineColor&&(this.props.getLineColor=this.callback.getLineColor),this.callback.getLineWidth&&(this.props.getLineWidth=this.callback.getLineWidth),this.props.updateTriggers={},this.props.updateTriggers.getColor=this.props.color||[0,0,128,128],this.layer=new window.DeckGL.PolygonLayer(this.props)}},{key:"_createArcLineLayer",value:function(){this.props.getSourcePosition=this.callback.getSourcePosition||function(t){return t?t.geometry.coordinates[0]:[0,0,0]},this.props.getTargetPosition=this.callback.getTargetPosition||function(t){return t?t.geometry.coordinates[1]:[0,0,0]},this.callback.getStrokeWidth&&(this.props.getStrokeWidth=this.callback.getStrokeWidth),this.callback.getSourceColor&&(this.props.getSourceColor=this.callback.getSourceColor),this.callback.getTargetColor&&(this.props.getTargetColor=this.callback.getTargetColor),this.layer=new window.DeckGL.ArcLayer(this.props)}},{key:"_createHexagonLayer",value:function(){this.props.getPosition=this.callback.getPosition||function(t){return t?t.geometry.coordinates:[0,0,0]},this.callback.getColorValue&&(this.props.getColorValue=this.callback.getColorValue),this.callback.getElevationValue&&(this.props.getElevationValue=this.callback.getElevationValue),this.layer=new window.DeckGL.HexagonLayer(this.props)}},{key:"_initContainer",value:function(){this.canvas=this._createCanvas(),this.mapContainer=this.map.getCanvasContainer(),this.mapContainer.appendChild(this.canvas)}},{key:"_createCanvas",value:function(){var t=document.createElement("canvas");t.id=this.id,t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.cursor="";var e=this.map;return t.width=parseInt(e.getCanvas().style.width),t.height=parseInt(e.getCanvas().style.height),t.style.width=e.getCanvas().style.width,t.style.height=e.getCanvas().style.height,t}},{key:"_moveEvent",value:function(){this._draw()}},{key:"_resizeEvent",value:function(){var t=this.canvas,e=this.map;t.width=parseInt(e.getCanvas().style.width),t.height=parseInt(e.getCanvas().style.height),t.style.width=e.getCanvas().style.width,t.style.height=e.getCanvas().style.height,this._draw()}}]),ss=Ph;function Ph(t,e){!function(t){if(!(t instanceof Ph))throw new TypeError("Cannot call a class as a function")}(this),this.layerTypeID=t,this.data=[].concat(e.data),this.props=e.props||{},this.callback=e.callback||{},this.id=e.layerId||B.createUniqueID("graphicLayer_"+this.layerTypeID+"_"),this.visibility=!0}Tc().supermap.DeckglLayer=ss;ss={getPoint:function(t){if(t&&t instanceof Array)return new Rf.DataSet([{geometry:{type:"Point",coordinates:t}}])},getPoints:function(t){if(t&&t instanceof Array){var e=[];return t.forEach(function(t){e.push({geometry:{type:"Point",coordinates:t.geometry.coordinates}})}),new Rf.DataSet(e)}},getCurveLines:function(n,t){if(n&&n instanceof Array&&t&&t instanceof Array){var r=[];return t.forEach(function(t){var e=t.geometry&&t.geometry.coordinates,t={lng:e[0],lat:e[1]},e={lng:n[0],lat:n[1]},t=Rf.utilCurve.getPoints([e,t]);r.push({geometry:{type:"LineString",coordinates:t}})}),new Rf.DataSet(r)}},getCurveDynamicPoints:function(o,t){if(o&&o instanceof Array&&t&&t instanceof Array){var i=[];return t.forEach(function(t){for(var e=t.geometry&&t.geometry.coordinates,t={lng:e[0],lat:e[1]},e={lng:o[0],lat:o[1]},n=Rf.utilCurve.getPoints([e,t]),r=0;r<n.length;r++)i.push({geometry:{type:"Point",coordinates:n[r]},time:r})}),new Rf.DataSet(i)}}};function Ch(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Tc().supermap.MapvDataSet=ss,Tc().supermap=Tc().supermap||{},Tc().supermap.map=Tc().supermap.map||{},Tc().supermap.map.getDefaultVectorTileStyle=function(t,e){var n={};n.version=(e=e||{}).version||8,n.layers=e.layers||[],n.light=e.light||{anchor:"viewport",color:"#fcf6ef",intensity:.5,position:[1.15,201,20]};n={version:n.version,sources:{"vector-tiles":{type:"vector",tiles:[t]}},layers:n.layers,light:n.light};return null!=e.sprite&&(n.sprite=e.sprite),null!=e.glyphs&&(n.glyphs=e.glyphs),n},Tc().supermap.map.setBackground=function(t,e){e&&t&&t.addLayer({id:"background",type:"background",paint:{"background-color":e}},"background")},Tc().supermap.map.setPaintProperty=function(t,e,n,r,o,i){if(e&&t){"[object Array]"!==Object.prototype.toString.call(e)&&(e=[e]);for(var a=0;a<e.length;a++){var s=i?i[a]:null,l={id:l=e[a],type:n,source:o||"vector-tiles","source-layer":s||l,paint:r};t.addLayer(l,e[a]),t.moveLayer(e[a])}}var l};Ch(kh.prototype,[{key:"onAdd",value:function(t){this._map=t,this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl iclient-logo",this._container.style.marginTop=0,this._container.style.marginBottom=0,this._container.style.marginLeft=0,this._container.style.marginRight=0;var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF4AAAAdCAYAAAAjHtusAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDozYWZlOGIwMi01MWE3LTRiZjYtYWVkYS05MGQ2ZTQ4YjZiMmUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ODg0NkFBQUE3RjEzMTFFNzhFRjJFQkY4RjcxQjc1NjIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODg0NkFBQTk3RjEzMTFFNzhFRjJFQkY4RjcxQjc1NjIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4MWI3NzdhNC1lZmEyLTQ1MzUtOGQzNi03MmRjNDkyODMzN2UiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpjYTYzODVjMi1jNDQ1LTExN2EtYTc0ZC1lM2I5MzJlMGE4Y2QiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5q1HM0AAAF/ElEQVR42tSabYhUVRjHZ7W01C1uaCRW4F3oi9SXCUnwQ9gsGUFvOEtQH1bLu5VS9sbYh5KicjYt29qiGQwVg2xWWKgocob91AvC+CWsoJqB3qHMSdTMpZyeU/+Df07n3pk7997Z6cBv99z7nHvOvf/z/pxJNZvNVI/jCKXmv6EquAmVkxPSlvtp2GItr0/96fFQForChJAWDiVYTkMYMu4XBFcYjLOwWS3sNwmn8NGzZ0h4Flv/zwIdchAnh/slCGmmKUNIBzYPaXOUr0vPuEjD71JAPh7l61embzinhV3V8nnCGmGT8LwlzSL8/yUh4Tfjo9T/CgnCIYNKycA2Qq21AcHU/VHE80Idoo3Qs0W6p0UtUnkZvEMDeVcCyqxEafF7hL8Qf0oYsIj+lfC9cH1CwhchWAGCtZO+AooQOkdC1Km1VtCb63StW73uFSzgKFUkNwBbmZGGmqowhvg8ZNpH9oXChcIcYRdeNomgxLkaH+S1SGubAxyIpFv+Zp+0DYjrAS00j/dem2VGEl6FJ4Qa4quEu8j2hTCJ+GJhe4JjfQMf6JCYPPbysMPxBlp0BUKOogEF9Rg9/heNvNKYfM0KsZUZaYxX4STGrzJa+zbhPeFH2DcK10KItcI+pI0rVElwXl1ULaKnIJhDw0oRQpTQc1zcbwRU8ATy4DR6yMlTzwkqMziEWHvubJ4Nk4ZtHdnqwvwY17xq3Z4FjrG+z2Kdrdf2ZSGD+xlLPh6t1R0jP9fI22ZzKI92yvQl7EbmBxI4S7Y+vIAOL87QZqsc5uNnssxZIcfYjXT9snCR7jjobidp+FkxA2v+Cq1QervMDmp4P7Xs3YZtE9kOC3P/By6JGaETl8ElwueYTNTDq4UDsKnd7YfCNbT239LF1udS72xYJt1UWxNfN4IIP4bWuTpEja01JtMFZFsm/AHbtHBlDE6yasA4moYTrUbvdBTXHqUrAH4uSadbyzF+vbBM2IsNkS3MNa5305JxqfA02T4TnkX8XOH1mPw8ruVejpxbI9hZD2Cz1U7LdrrUvjP/WfZinNZhr6V27hP+FPZh9aLvLxVO4DllX0G2OcKnlO/DCblxaz6uXBtmi+8mBaP3/SP8IuEIiTRoPPQm2TaEmEyXo0JU+F0YiPFD0hhOsiE/vqeEVwyTgF8L51OilcIZ2I4Ll5NttvAJPfukUeB2sk0ZPSbKIUUJpCII7+DasWy08uhNNazT0wGHI7mAtB7KqMKm38HhDdAUibTVKGicbB8YAqrJ9DRsp43JdB4qUof1HQrPE6XTQWu3Ce/inVzjXhXpMiTwUYugNVQ+p80jrUsV5EH0POKeuXO9QjhFq5GryNYvfEMCDhsftYVsB9ETtG0V9ZjfhCURhbcJFpfwVZ9jvhxsLHwTYtp2svlWQw3vXL8UnqHVSIG8l8ex+tHhBXgjddgqHEZ8ufAA2aaEnYgrF/KrPXrEmMUqZ9THLW06xhoBaVueQpkug+ewOUphE3Qv2Q5gGamXYa+QbVq4O+DQ5FHyZqrjxNt7UHh9uuRa0F7HjCF8o9PCTOGnscM7g2u1Hl9C9oeEnxC/1ajZg8JLiM9Hj9GHJseMShwL2DO0G5yEWn3Zh1QUods5CPkIoqlwAZxhXMsb6HrcEPBxchhdJ6wj29vCW4hfLOzo8J3rltYX50nXQAATSf/K4DEaGlTLvplsk/QCpoD60EQ7gLYZc8H9wq+I3yncEOEcNhuz6HWf3XEiwU/4Y8YEqVp2P10rt+8REvBGw026i4aDcbL9jF8r8Blmf4fCOzhViiscskygXRdehf3CO4hfigmTBXyQrl8TFtD1IzQX3CbcQrY3hPcRv4z8OmHPXwchVNln2MmE7BX6VwIFi/he6uxvb6JM3m0fdqvx/ATidxg2JeC7VDErAw5NzGfvwRJVheEIQ8Mg/pdwIM+UOmi9Q8ivCsrIy0tF+wVbEcLrd3Pb2XisEb4Tdlhsi4WP4RBbaLGrHfC3PrvMIezy9rTpGm5lz9LOMG15xvFxD/j5gjzjjDbMOzk+9zzt3v5bgAEAibzFeFHVgYkAAAAASUVORK5CYII=";this.imageUrl&&(e=this.imageUrl);var n=this.alt,r="width:94px;height:29px;";this.imageUrl&&(r="width:"+(t=this.width)+";height:"+(o=this.height)+";",t&&o||(r=""));var o=this.link||"https://iclient.supermap.io";return this._container.innerHTML="<a href='"+o+"' target='_blank'><img src="+e+" alt='"+n+"' style='"+r+"margin-bottom: 2px'></a>",this._createStyleSheet(),this._container}},{key:"_createStyleSheet",value:function(){var t=document.createElement("style");t.type="text/css",t.innerHTML=".iclient-logo{margin:0 !important;}.iclient-logo a{border: none;display: block;height:31px;}.iclient-logo img{border: none;white-space: nowrap}",document.getElementsByTagName("head")[0].appendChild(t)}},{key:"_extend",value:function(t){for(var e=0;e<Object.getOwnPropertyNames(arguments).length;e++){var n=Object.getOwnPropertyNames(arguments)[e];if("caller"!=n&&"callee"!=n&&"length"!=n&&"arguments"!=n){var r=arguments[n];if(r)for(var o=0;o<Object.getOwnPropertyNames(r).length;o++){var i=Object.getOwnPropertyNames(r)[o];"caller"!=n&&"callee"!=n&&"length"!=n&&"arguments"!=n&&(t[i]=r[i])}}}return t}}]),ss=kh;function kh(t){!function(t){if(!(t instanceof kh))throw new TypeError("Cannot call a class as a function")}(this),this.imageUrl=null,this.link=null,this.width=null,this.height=null,this.alt="SuperMap iClient",this._extend(this,t)}Tc().supermap.LogoControl=ss}()}}]);